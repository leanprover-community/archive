[
    {
        "content": "<p>I know that <span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> 's project also formalised resultants. We have independently come up with the same approach to first let the Sylvester matrix have any size, and then later restricting it to the degrees of the two polynomials.</p>",
        "id": 525244519,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750642431
    },
    {
        "content": "<p>This PR adds the following three definitions:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">sylvester</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"bp\">+</span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n\n<span class=\"sd\">/-- A version of `resultant` where the degrees of the polynomials `f` and `g` are free variables.</span>\n<span class=\"sd\">This is useful for proving theorems, and comparing `resultant` across rings, where the ring</span>\n<span class=\"sd\">homomorphism might map some coefficient to `0`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">resultantAux</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">sylvester</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matrix</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">det</span>\n\n<span class=\"sd\">/-- The resultant of two polynomials `f` and `g` is the determinant of the Sylvester matrix of `f`</span>\n<span class=\"sd\">and `g`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">resultant</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"n\">resultantAux</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">natDegree</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">natDegree</span>\n</code></pre></div>",
        "id": 525244569,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750642501
    },
    {
        "content": "<p>Is <code>Aux</code> the best way to deal with definitions of this kind?</p>",
        "id": 525244581,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750642543
    },
    {
        "content": "<p>Maybe you can even give <code>m</code> and <code>n</code> default values? And have just one definition?</p>",
        "id": 525277008,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1750666436
    },
    {
        "content": "<p>That did cross my mind before, not sure if it's a good solution...</p>",
        "id": 525287323,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750669855
    },
    {
        "content": "<p>What makes <code>Fin (n + m)</code> a better choice than <code>Fin n ⊕ Fin m</code> here?</p>",
        "id": 525288916,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750670392
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525288916\">said</a>:</p>\n<blockquote>\n<p>What makes <code>Fin (n + m)</code> a better choice than <code>Fin n ⊕ Fin m</code> here?</p>\n</blockquote>\n<p><a href=\"/user_uploads/3121/Yc2Zl0Dc7cTULQwLxrw8LRxX/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Yc2Zl0Dc7cTULQwLxrw8LRxX/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"467x281\" src=\"/user_uploads/thumbnail/3121/Yc2Zl0Dc7cTULQwLxrw8LRxX/image.png/840x560.webp\"></a></div><p>The matrix looks like this but transposed, so <code>Fin (n+m)</code> is the better choice for the vertical axis (<code>i</code>), and I thought it might be better to make the two domains the same? But I think I'm not completely rejecting the idea to make <code>j</code> indexed by <code>Fin n ⊕ Fin m</code> yet, that is indeed an interesting suggestion.</p>",
        "id": 525289483,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750670600
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525277008\">said</a>:</p>\n<blockquote>\n<p>Maybe you can even give <code>m</code> and <code>n</code> default values? And have just one definition?</p>\n</blockquote>\n<p>I think the concern was that this might be considered too \"hacky\"?</p>",
        "id": 525289616,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750670654
    },
    {
        "content": "<p>I think that's the wrong matrix from the wikipedia page?</p>",
        "id": 525289619,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750670654
    },
    {
        "content": "<p>Well they have the same determinant <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span></p>",
        "id": 525289747,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750670682
    },
    {
        "content": "<p>That's the one of size <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mo separator=\"true\">,</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">2\\max(m,n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span>, not <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>+</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m + n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span></p>",
        "id": 525289759,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750670685
    },
    {
        "content": "<p>ah, didn't notice that, i've replaced it with the correct image</p>",
        "id": 525289960,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750670753
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525289616\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525277008\">said</a>:</p>\n<blockquote>\n<p>Maybe you can even give <code>m</code> and <code>n</code> default values? And have just one definition?</p>\n</blockquote>\n<p>I think the concern was that this might be considered too \"hacky\"?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> do you think this would be too hacky?</p>",
        "id": 525290042,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750670795
    },
    {
        "content": "<p>Sounds ok to me, but there's not yet enough in the PR right now to tell why having the unspecialized version is useful</p>",
        "id": 525290276,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750670891
    },
    {
        "content": "<p>I think you can trust Anne and me since we independently came up with this solution <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span> it's better for proving lemmas, you don't want to attach to <code>f.natDegree</code> all the time, because then it's harder to change <code>f</code></p>",
        "id": 525290612,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671017
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525288916\">said</a>:</p>\n<blockquote>\n<p>What makes <code>Fin (n + m)</code> a better choice than <code>Fin n ⊕ Fin m</code> here?</p>\n</blockquote>\n<p>Aha, found the reason, <code>Matrix.det</code> requires a definitionally square matrix already.</p>",
        "id": 525290750,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671071
    },
    {
        "content": "<p>Also, for more information, the resultant actually changes if you input the \"wrong\" dimensions</p>",
        "id": 525290815,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671098
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525290276\">said</a>:</p>\n<blockquote>\n<p>Sounds ok to me, but there's not yet enough in the PR right now to tell why having the unspecialized version is useful</p>\n</blockquote>\n<p>I can confirm this is useful. I came up with that design independently myself when advising a fellow PhD student in Stockholm</p>",
        "id": 525290845,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1750671107
    },
    {
        "content": "<p>three anecdotes is equivalent to data right XD</p>",
        "id": 525290914,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671134
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> what do you think of using default arguments?</p>",
        "id": 525290965,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671152
    },
    {
        "content": "<p>I don't see the point of the specialised version</p>",
        "id": 525291001,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1750671168
    },
    {
        "content": "<p>well, I think we have to have a public-facing definition that follows the convention...</p>",
        "id": 525291117,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671203
    },
    {
        "content": "<p>Is the sylvester matrix only interesting for the resultant? Is it \"nicer\" to go via the <a href=\"https://en.wikipedia.org/wiki/B%C3%A9zout_matrix\">Bézout matrix</a> instead, which seems to have an explicit size argument in informal mathematics too?</p>",
        "id": 525291144,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750671215
    },
    {
        "content": "<p>Well, Anne and me (I don't know about Yael's fellow student) already have like 1000 lines of code using the Sylvester matrix, and I think the Sylvester matrix is good enough?</p>",
        "id": 525292152,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671534
    },
    {
        "content": "<p>Is the argument here that it would be more justified to have an explicit size argument if using the Bezout matrix, because of differing conventions?</p>",
        "id": 525292274,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671579
    },
    {
        "content": "<p>Yes, though it's certainly a weak argument</p>",
        "id": 525293215,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750671880
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/YQE9BkEEESd8KI-PYf8LKYdV/Screenshot_23-Jun_11-43-53_14917.png\">Screenshot_23-Jun_11-43-53_14917.png</a><br>\nFwiw, Bourbaki also feels that the unspecialized version is worth a definition and a notation.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/YQE9BkEEESd8KI-PYf8LKYdV/Screenshot_23-Jun_11-43-53_14917.png\" title=\"Screenshot_23-Jun_11-43-53_14917.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"610x127\" src=\"/user_uploads/thumbnail/3121/YQE9BkEEESd8KI-PYf8LKYdV/Screenshot_23-Jun_11-43-53_14917.png/840x560.webp\"></a></div>",
        "id": 525293281,
        "sender_full_name": "Robin Carlier",
        "timestamp": 1750671905
    },
    {
        "content": "<p>wow, that looks like a direct translation of the <code>optParam</code> solution! XD</p>",
        "id": 525293386,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750671935
    },
    {
        "content": "<p>I've pushed the optParam approach, and it seems to be working fine!</p>",
        "id": 525294498,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750672337
    },
    {
        "content": "<p>Can you include the case of two binary forms?</p>",
        "id": 525296614,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750673094
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"479359\">Michael Stoll</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525296614\">said</a>:</p>\n<blockquote>\n<p>Can you include the case of two binary forms?</p>\n</blockquote>\n<p>Sorry, I'm not sure what you mean here, what are the two binary forms?</p>",
        "id": 525303867,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750675918
    },
    {
        "content": "<p>Are you talking about the sylvester map (a,b) =&gt; f<em>a+g</em>b?</p>",
        "id": 525303952,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750675946
    },
    {
        "content": "<p>I think that Michael probably means including/easily allowing the case in which <code>f</code> and <code>g</code> are binary forms, instead of polynomials in one variable.</p>",
        "id": 525305054,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750676357
    },
    {
        "content": "<p>In fact, after working a little with degrees of polynomials, I am more and more convinced that the informal notion of \"the degree of a polynomial\" is better formalised as \"the degree of a binary form\".</p>",
        "id": 525305059,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750676360
    },
    {
        "content": "<p>In this specific case, I wonder if it would make sense to define the resultant of two forms first, and specialising it later to the resultant of two polynomials.</p>",
        "id": 525305062,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750676360
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525290612\">said</a>:</p>\n<blockquote>\n<p>it's better for proving lemmas, you don't want to attach to <code>f.natDegree</code> all the time, because then it's harder to change <code>f</code></p>\n</blockquote>\n<p>I suspect the following is obvious to most people in this thread but for the sake of newcomers, I'll emphasise that a major advantage of this design is that it \"takes definitional control\". What I mean by this is that you are creating data (a matrix) whose type depends on data (<code>f.natDegree</code>). This often leads to DTT hell unless you give yourself the extra definitional control to specify the matrix dimensions (as proposed).</p>",
        "id": 525305120,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1750676381
    },
    {
        "content": "<p>I don't think I've heard about that before (the binary form thing)...</p>",
        "id": 525305157,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750676395
    },
    {
        "content": "<p>How do I even write binary form in Lean?</p>",
        "id": 525305504,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750676525
    },
    {
        "content": "<p><a href=\"https://leansearch.net/?q=Binary%20form%2C%20polynomial\">Leansearch</a> doesn't give me anything</p>",
        "id": 525305531,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750676533
    },
    {
        "content": "<p>do I write like MvPolynomial Bool R and then homogeneous degree d?</p>",
        "id": 525305942,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750676668
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"240862\">Oliver Nash</span> <a href=\"#narrow/stream/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525305120\">said</a>:</p>\n<blockquote>\n<p>unless you give yourself the extra definitional control to specify the matrix dimensions (as proposed).</p>\n</blockquote>\n<p>I think it's more than this, sometimes it's helpful to think as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">aX + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><msup><mi>X</mi><mn>2</mn></msup><mo>+</mo><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">0X^2 + aX + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>.</p>",
        "id": 525312971,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750679190
    },
    {
        "content": "<p>I'm always dubious about this definitional control argument, because really you're just folding the casting operation into your function, and now the lemmas commuting your function with other functions are more numerous as a result</p>",
        "id": 525313295,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1750679303
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525312971\">said</a>:</p>\n<blockquote>\n<p>I think it's more than this, sometimes it's helpful to think as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">aX + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><msup><mi>X</mi><mn>2</mn></msup><mo>+</mo><mi>a</mi><mi>X</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">0X^2 + aX + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\">0</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>.</p>\n</blockquote>\n<p>That's where it is useful to be able to work with resultants of binary forms. (Not to mention that there is a generalization to resultants of triples of ternary forms etc.)</p>",
        "id": 525315240,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750680001
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> can you direct me to where binary forms are defined in the library?</p>",
        "id": 525315331,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750680034
    },
    {
        "content": "<p>I don't know <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span> ; I haven't had opportunity to use them yet.<br>\nBut as a first approximation, <code>MvPolynomial (Fin 2) R</code> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MvPolynomial.Ishomogeneous#doc\">docs#MvPolynomial.Ishomogeneous</a> look reasonable.</p>",
        "id": 525316062,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750680264
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> I think Polynomial might be easier to use...</p>",
        "id": 525320654,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750681818
    },
    {
        "content": "<p>Afterall, if you have a binary form, you can then substitute y to be 1 and then make it into a polynomial</p>",
        "id": 525320766,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750681854
    },
    {
        "content": "<p>so it isn't hard to use it for binary form given the current definition that I have in the PR</p>",
        "id": 525320868,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750681878
    },
    {
        "content": "<p>Yes; you can then use this dehomogenization map to reduce it to polynomials. The point is that the \"degrees\" should then be the degrees of the binary forms.</p>",
        "id": 525320950,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750681910
    },
    {
        "content": "<p>I just would like the resultant of two binary forms to be included.</p>",
        "id": 525321051,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750681946
    },
    {
        "content": "<p>To be completely explicit, the binary form <code>x * y</code> \"obviously\" has degree 2, but dehomogenizing with respect to either variable does not.</p>",
        "id": 525321982,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750682277
    },
    {
        "content": "<p>This (trivial) observation causes all sorts of problems when \"hard-coding\" a <code>natDegree</code>/<code>degree</code> anywhere.</p>",
        "id": 525322230,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750682356
    },
    {
        "content": "<p>In particular, the statement \"the binary form <code>x * y</code> \"obviously\" has degree 2\" is false for the trivial ring and this is a situation where the degree of the form and of its dehomogenisations are the same!  <span aria-label=\"man facepalming\" class=\"emoji emoji-1f926-200d-2642\" role=\"img\" title=\"man facepalming\">:man_facepalming:</span></p>",
        "id": 525322483,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1750682426
    },
    {
        "content": "<p>Also, the zero binary form is homogeneous of every degree!</p>",
        "id": 525322623,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750682462
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525322230\">said</a>:</p>\n<blockquote>\n<p>This (trivial) observation causes all sorts of problems when \"hard-coding\" a <code>natDegree</code>/<code>degree</code> anywhere.</p>\n</blockquote>\n<p>but I did not hard code the degree, I included them as default values and all my theorems are proved initially using the free degree variable</p>",
        "id": 525337319,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750686598
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> <span class=\"user-mention\" data-user-id=\"321459\">@Damiano Testa</span> my complaint is that you're asking me to add support for something with completely no API. Binary forms don't exist elsewhere in the library. Am I supposed to name it <code>MvPolynomial.Binary.resultant</code>? Or just <code>MvPolynomial.resultant</code>? Or <code>BinaryForm.resultant</code>? Since it does not exist in the library, there is also no conventional namespace assigned to it.</p>",
        "id": 525338124,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750686849
    },
    {
        "content": "<p>and the problem with adding something with no API is that it would be an unusable definition.</p>",
        "id": 525338177,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750686864
    },
    {
        "content": "<p>And then now you're asking me to define a partial function</p>",
        "id": 525338473,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750686958
    },
    {
        "content": "<p>It would be much better if you first PR binary forms in, and make the submodule of binary forms of degree d, and prove that it is a free module of rank d+1</p>",
        "id": 525338576,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750686987
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">BinaryForm</span>\n\n<span class=\"sd\">/-- Resultant of two binary forms, i.e. homogeneous polynomials in two variables. There is no</span>\n<span class=\"sd\">support for binary forms in the library at the moment. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">resultant</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPolynomial</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">totalDegree</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">totalDegree</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">resultant</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">eval₂</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">eval₂</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">[</span><span class=\"bp\">.</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">])</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">BinaryForm</span>\n</code></pre></div>",
        "id": 525340736,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750687589
    },
    {
        "content": "<p>I've added this to my PR now</p>",
        "id": 525340749,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750687593
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> what do you think?</p>",
        "id": 525340813,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750687606
    },
    {
        "content": "<p>I'm just gonna be honest, I think this is a really bad idea. I can make a separate binary form PR but I really don't think I should include resultant of binary forms before we've even got anything about binary forms.</p>",
        "id": 525341630,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750687805
    },
    {
        "content": "<p>ok maybe I can change it to <code>MvPolynomial.homogeneousSubmodule (Fin 2) R d</code></p>",
        "id": 525342522,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750688052
    },
    {
        "content": "<p>This looks reasonable.</p>\n<p>Sorry for creating more work for you. If you think the infrastructure for binary forms is not really there, it would be OK with me if you just add a \"TODO\" in the file. There certainly should be a good API for dealing with homogeneous polynomials (not just in two variables) at some point. I was assuming that it would be there already (but hadn't really checked).</p>",
        "id": 525346430,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1750689143
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> ok, i've made it into a TODO:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">Resultant</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">two</span><span class=\"w\"> </span><span class=\"n\">binary</span><span class=\"w\"> </span><span class=\"n\">forms</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"n\">homogeneous</span><span class=\"w\"> </span><span class=\"n\">polynomials</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">two</span><span class=\"w\"> </span><span class=\"n\">variables</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">binary</span><span class=\"w\"> </span><span class=\"n\">forms</span>\n<span class=\"w\">  </span><span class=\"n\">are</span><span class=\"w\"> </span><span class=\"n\">implemented</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 525347659,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750689511
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> I've made <a href=\"https://github.com/leanprover-community/mathlib4/pull/26310\">#26310</a> Binary form</p>",
        "id": 525364969,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750694705
    },
    {
        "content": "<p>If you feed in an auxiliary number like Kenny is doing (a surrogate for the degree) then binary forms buy you much less.</p>",
        "id": 525367988,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1750695754
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"479359\">@Michael Stoll</span> please reivew the main lemmas instead of the auxiliary ones at the beginning</p>",
        "id": 525381345,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750700563
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2326285.20Resultant.20of.20two.20polynomials/near/525290276\">said</a>:</p>\n<blockquote>\n<p>Sounds ok to me, but there's not yet enough in the PR right now to tell why having the unspecialized version is useful</p>\n</blockquote>\n<p>If the unspecialized version is the one that gives explicit parameters for the size (not depending on the polynomials as input), this is definitely the one to have, because it is the one that is functorial along ring morphisms. Otherwise, the degree might fall, and then sh*t happens if you've imposed that the size of the matrix is given by the degrees. When the literature has fixed the degrees, the subsequent lemmas have added hypotheses which make it difficult to use.</p>",
        "id": 525625336,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1750818605
    },
    {
        "content": "<p>With fixed sizes, you'll get that when the specialization of a resultant if and only if the polynomials acquire a root or the degrees both fall (which has a nice projective interpretation — the homogeneous binary forms acquire a common root at infinity.)</p>",
        "id": 525625427,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1750818686
    },
    {
        "content": "<p>So how is the PR now?</p>",
        "id": 525713819,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750858300
    }
]