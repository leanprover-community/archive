[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a> I have discovered that <code>group</code> is a very heavy tactic (it imports <code>ring</code> to normalise exponents) which is no more powerful than a mere <code>simp [commutatorElement_def, mul_assoc]</code> in all the cases I have encountered</p>",
        "id": 497141394,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738396495
    },
    {
        "content": "<p>I don't really like substituting a high level tactic by a dumber tactic for the sake of imports, but here the import reduction really is quite substantial (120 imports) and the high level tactic is used quite trivially</p>",
        "id": 497141445,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738396552
    },
    {
        "content": "<p>It makes me think that <code>group</code> is too high powered for its use case of non-abelian groups: Who needs to normalise exponents when all your expressions are made out of atoms and <code>⁻¹</code>?</p>",
        "id": 497141588,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738396686
    },
    {
        "content": "<p>Should we preserve the current behaviour of <code>group</code> as <code>group_exp</code>, and provide a simpler, better spec'd <code>group</code>?</p>",
        "id": 497141795,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738396866
    },
    {
        "content": "<p>Maybe! But would you like to read through the diff in <a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a> and comment on whether any proof got uglier by replacing <code>group</code> with a simp call?</p>",
        "id": 497141880,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738396925
    },
    {
        "content": "<p>My personal opinion is that \"No, they all got nicer or at least not worse\", so maybe <code>group</code> is a <a href=\"https://youtu.be/IxNb1WG_Ido\">\"tattoo on tactics\"</a> and doesn't even need existing</p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"IxNb1WG_Ido\" href=\"https://youtu.be/IxNb1WG_Ido\"><img src=\"https://uploads.zulipusercontent.net/dfc64c762c29fc03c7a2325bfd022774e3930c6d/68747470733a2f2f692e7974696d672e636f6d2f76692f49784e623157475f49646f2f64656661756c742e6a7067\"></a></div>",
        "id": 497141964,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738397031
    },
    {
        "content": "<p>Hmm, if there is well-spec'd and lightweight <code>group</code>, then I would prefer <code>by group</code> over <code>by simp [mul_assoc]</code>.</p>",
        "id": 497143859,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738398649
    },
    {
        "content": "<p>Or actually: I don't care which one is used, but I would want both of them to work.</p>",
        "id": 497143892,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738398673
    },
    {
        "content": "<p>That's a valid opinion</p>",
        "id": 497144074,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738398781
    },
    {
        "content": "<p>The series now goes:</p>",
        "id": 497153276,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406379
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a></li>\n</ul>",
        "id": 497153285,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406384
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21304\">#21304</a></li>\n</ul>",
        "id": 497153289,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406388
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21307\">#21307</a></li>\n</ul>",
        "id": 497153291,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406391
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21317\">#21317</a></li>\n</ul>",
        "id": 497153295,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406395
    },
    {
        "content": "<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/20552\">#20552</a></li>\n</ul>",
        "id": 497153343,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738406405
    },
    {
        "content": "<p>I do think the lightweight <code>group</code> would be better / more readable than <code>simp</code>, but that doesn't need to block this work</p>",
        "id": 497160455,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1738412539
    },
    {
        "content": "<p>I've opened issue <a href=\"https://github.com/leanprover-community/mathlib4/pull/21324\">#21324</a> to track removals of <code>group</code></p>",
        "id": 497168655,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738420054
    },
    {
        "content": "<p>And since <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> blocked merging, I've opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/21360\">#21360</a> to rename <code>group</code> to <code>group_exp</code> and add a lightweight <code>group</code></p>",
        "id": 497346881,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738567089
    },
    {
        "content": "<p>I don't think it's a good idea to have two tactics which have essentially the same goals, just for the sake of imports. For newcomers and users of the library, it just adds to the complexity they have to master, for essentially no gain. I'd rather keep <code>group</code> as the powerful tactic, and replace it by a simp invocation in files low in the hierarchy if you want to avoid heavy imports.</p>",
        "id": 497350537,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738568340
    },
    {
        "content": "<p>That almost perfectly disagrees with Kim's and Patrick's opinion. Here is maybe a way to sidestep the issue: Have <code>group</code> mean the  simp call when importing Tactic.Group only, then have it mean <code>simp</code> + <code>ring_nf</code> when Tactic.Ring too is imported</p>",
        "id": 497355074,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738569693
    },
    {
        "content": "<p>How many <code>group</code> calls in low import files are we talking about? I'm not sure overengineering is worth it here.</p>",
        "id": 497357562,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738570421
    },
    {
        "content": "<p>41 in total. <a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a> removes 24 of them (those are the low imports ones). Out of the 41, one needs the <code>simp</code> + <code>ring_nf</code> <code>group</code> and all others work with the <code>simp</code> <code>group</code></p>",
        "id": 497357897,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738570514
    },
    {
        "content": "<p>Personally, I would be much more happy with merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a> than having two different tactics <code>group</code> and <code>group_exp</code>. For users of the libary, having two tactics doing essentially the same thing looks like useless complexity to me.</p>",
        "id": 497358899,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738570791
    },
    {
        "content": "<p>Shouldn’t we try to make the <code>ring</code> tactic less costly from an import point of view? It is really a very fundamental tactic. We need it as soon as we have any natural number around for instance.</p>",
        "id": 497396478,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1738579734
    },
    {
        "content": "<p>(Don't hold your breath, but I expect within 3-6 months there will be a no-import version of <code>ring</code>, but Mathlib will still need to provide glue to translate from Mathlib typeclasses to the tactic-internal ones.)</p>",
        "id": 497403076,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738581327
    },
    {
        "content": "<p>Ah that's great news! I've been annoyed that nice tactics very quickly import heavy stuff like <code>LinearOrderedField</code>. Kim, this feels like the solution of merging <a href=\"https://github.com/leanprover-community/mathlib4/pull/21296\">#21296</a> and tracking regressions through <a href=\"https://github.com/leanprover-community/mathlib4/pull/21324\">#21324</a> is most adapted to \"Imports will reduce back in a few months\"</p>",
        "id": 497407071,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738582218
    },
    {
        "content": "<p>Yes, I keep forgetting that you're tracking changees in <a href=\"https://github.com/leanprover-community/mathlib4/pull/21324\">#21324</a>. With that in place I don't object to proceeding as you propose.</p>",
        "id": 497408045,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738582487
    },
    {
        "content": "<p>But I wouldn't mind checking with <span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span>.</p>",
        "id": 497408065,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738582495
    },
    {
        "content": "<p>I don’t want to be annoying with this, so you can merge whatever you want. But this is clearly a regression and should be marked as such. And I wouldn’t mind seeing the work on ring as rather high priority (but again I have no time for this myself so I cannot complain).</p>",
        "id": 497621427,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1738662546
    },
    {
        "content": "<p>I also think it's a terrible idea to change <code>group</code> to <code>simp [mul_assoc]</code> or whatever. The point of a tactic like <code>group</code> is precisely that it is supposed to be saving the user from having to know/type the names of lemmas. Any refactor where tactics are replaced by explicit invocations of lemmas is a step backwards in my opinion and I think the argument for doing this is dubious at best. I'd be happy with <code>group</code> and <code>group!</code> (which imports a lot more) if necessary.</p>",
        "id": 497621914,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738662706
    },
    {
        "content": "<p>My argument against two tactics <code>group</code> and <code>group!</code> is that it makes more things to learn for users of mathlib, and especially for newcomers. While changing a few files in mathlib, low in the hierarchy, will not harm these users at all.</p>",
        "id": 497658928,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738673757
    },
    {
        "content": "<p>(Keeping the current situation is also fine to me, with slightly too heavy imports in some basic file. But if I understand correctly disentangling the import structure is very important to some people)</p>",
        "id": 497659220,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1738673831
    },
    {
        "content": "<p>What if the changes from <code>group</code> to <code>simp [mul_assoc]</code></p>\n<ul>\n<li>only happen low in the hierarchy</li>\n<li>there is a comment at <em>each</em> such site, saying \"We avoid <code>group</code> here to minimize imports while low in the hierarchy; typically it would be better to invoke the tactic.\"</li>\n</ul>",
        "id": 497774126,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1738710551
    },
    {
        "content": "<p>Oh this sounds more appealing! I can definitely see an argument for \"crappy proof genuinely forced upon us by import issues\".</p>",
        "id": 497775309,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738711162
    },
    {
        "content": "<p>But for people like me who import all of group and ring theory before they even touch the keyboard first thing in the morning, you can see why \"strip out the tactic and replace with a more low-level proof\" looks unappealing.</p>",
        "id": 497775489,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738711246
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110087\">Kim Morrison</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2321296.20don't.20import.20Ring.20in.20GroupTheory.2ECommutator.2EBasic/near/497774126\">said</a>:</p>\n<blockquote>\n<p>What if the changes from <code>group</code> to <code>simp [mul_assoc]</code></p>\n<ul>\n<li>only happen low in the hierarchy</li>\n<li>there is a comment at <em>each</em> such site, saying \"We avoid <code>group</code> here to minimize imports while low in the hierarchy; typically it would be better to invoke the tactic.\"</li>\n</ul>\n</blockquote>\n<p>I have updated the PR accordingly</p>",
        "id": 497860440,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1738751925
    },
    {
        "content": "<p>I have borsified the PR accordingly</p>",
        "id": 498167980,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738860934
    }
]