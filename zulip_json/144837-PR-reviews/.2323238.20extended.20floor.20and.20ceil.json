[
    {
        "content": "<p>Could I please get a review here? <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> has seemingly blocked the PR for the past six months because he disagrees with my approach to define floor and ceil for <code>ENNReal</code> only rather than for <code>WithTop R</code> where <code>R</code> is some sort of floor semiring (but <code>FloorSemiring R</code> isn't enough! we would need a new typeclass). I believe my approach is okay for now because:</p>\n<ol>\n<li>The only other potential application would be to <code>ENNRat</code>, which doesn't exist yet</li>\n<li>We don't yet have the appropriate typeclass for the generalisation</li>\n<li><code>ENNReal</code> isn't <em>syntactically</em> of the form <code>WithTop R</code>, so the generalised lemmas wouldn't apply to it anyway</li>\n</ol>",
        "id": 558172666,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763550362
    },
    {
        "content": "<p>For context, this is blocking some Porte-Manteau Theorem material for <span class=\"user-mention\" data-user-id=\"373986\">@Kalle Kytölä</span>, as well as of my own work.</p>",
        "id": 558172820,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763550407
    },
    {
        "content": "<p>See also discussion here <a href=\"https://github.com/leanprover-community/mathlib4/pull/23238#issuecomment-2869974204\">https://github.com/leanprover-community/mathlib4/pull/23238#issuecomment-2869974204</a>.</p>\n<ol>\n<li>Why is that the only other application? Surely WithTop on other semirings (as is relevant in tropical geometry) would be useful too?</li>\n<li>Then I don't think we should just do one special case, which would need to be refactored when the generalisation happens</li>\n<li>As mentioned in that thread, you already don't want to use the defeqs, let alone synteqs for ENNReal, so this shouldn't impact anything. As you wrote: \"the proofs in the PR will not fundamentally change when doing the generalisation\" </li>\n</ol>\n<p>My impression of this PR was that I was waiting for you to respond to my questions in that thread, not that I was blocking things! :)</p>\n<p>Ultimately this PR seems to me like it's adding a whole new file whose original motivation was to give overly long proofs of iSup results, and whose secondary aim seems overly specialised. So I'd personally prefer to see us doing the correct generalisation the first time round, especially because everyone's agreed the real generalisation is easy and the right thing to ultimately do</p>",
        "id": 558174379,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763550848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558174379\">said</a>:</p>\n<blockquote>\n<p>Why is that the only other application? Surely WithTop on other semirings (as is relevant in tropical geometry) would be useful too?</p>\n</blockquote>\n<p>Sure, there are other instances of <code>WithTop R</code> on semirings, but do we care about floor and ceil on them? I don't know!</p>",
        "id": 558202269,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763558885
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558174379\">said</a>:</p>\n<blockquote>\n<p>Then I don't think we should just do one special case, which would need to be refactored when the generalisation happens</p>\n</blockquote>\n<p>Kalle had originally done the generalisation, and it was very messy, because similar lemmas needed very different sets of assumptions. The proofs were mostly the same, however, which is why I claim that doing the generalisation later (if ever!) will not be much work.</p>",
        "id": 558202330,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763558898
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558174379\">said</a>:</p>\n<blockquote>\n<p>As mentioned in that thread, you already don't want to use the defeqs, let alone synteqs for ENNReal, so this shouldn't impact anything. As you wrote: \"the proofs in the PR will not fundamentally change when doing the generalisation\"</p>\n</blockquote>\n<p>Sorry, I don't understand this at all: All I'm saying is that <code>WithTop</code> lemmas don't apply to <code>ENNReal</code>, and so if we ever do the generalisation then we will need both <code>WithTop</code> and <code>ENNReal</code> lemmas. I am adding the <code>ENNReal</code> lemmas here.</p>\n<p>Note that this situation has precedent: Many <code>ENNReal</code> lemmas were originally added without a <code>WithTop</code> counterpart, and those counterparts were added over the years as our algebraic order theory library grew strong enough to accommodate them (and as the need was being felt: not all <code>ENNReal</code> lemmas that could come from <code>WithTop</code> ones currently do).</p>",
        "id": 558202907,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763559029
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558174379\">said</a>:</p>\n<blockquote>\n<p>Ultimately this PR seems to me like it's adding a whole new file whose original motivation was to give overly long proofs of iSup results, and whose secondary aim seems overly specialised.</p>\n</blockquote>\n<p>No, the original motivation was Kalle's, and I merely noticed it let me prove <code>ENat.toENNReal_iSup</code>/<code>ENat.toENNReal_iInf</code>. You claim that my proof of those is overly long, but I have no constructive evidence of the fact you can do shorter <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>",
        "id": 558203237,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763559122
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558174379\">said</a>:</p>\n<blockquote>\n<p>My impression of this PR was that I was waiting for you to respond to my questions in that thread, not that I was blocking things! :)</p>\n</blockquote>\n<p><code>awaiting-author</code> would like to have a word with you <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>",
        "id": 558203325,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763559143
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558202907\">said</a>:</p>\n<blockquote>\n<p>All I'm saying is that <code>WithTop</code> lemmas don't apply to <code>ENNReal</code>, and so if we ever do the generalisation then we will need both <code>WithTop</code> and <code>ENNReal</code> lemmas. I am adding the <code>ENNReal</code> lemmas here.</p>\n</blockquote>\n<p>But I don't see why we will need both of those, if EFloorSemiring is created?</p>",
        "id": 558345834,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763612015
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558202907\">said</a>:</p>\n<blockquote>\n<p>Note that this situation has precedent: Many <code>ENNReal</code> lemmas were originally added without a <code>WithTop</code> counterpart, and those counterparts were added over the years as our algebraic order theory library grew strong enough to accommodate them (and as the need was being felt: not all <code>ENNReal</code> lemmas that could come from <code>WithTop</code> ones currently do).</p>\n</blockquote>\n<p>Then surely we should learn from our mistakes, and get it right the first time! :)</p>",
        "id": 558345855,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763612033
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558203237\">said</a>:</p>\n<blockquote>\n<p>No, the original motivation was Kalle's, and I merely noticed it let me prove <code>ENat.toENNReal_iSup</code>/<code>ENat.toENNReal_iInf</code>. You claim that my proof of those is overly long, but I have no constructive evidence of the fact you can do shorter <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span></p>\n</blockquote>\n<p>Ah, I was confused because the motivation you gave when you first asked me to review was for the ENat lemmas, and the motivation from Kalle was only mentioned in the thread two months after the PR was made! <br>\nI thought I sent you shorter proofs of at least one of these, though I can't find them now; I'll try again if you're really sure that these can't be proved in less than 400 lines!</p>",
        "id": 558346035,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763612168
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558203325\">said</a>:</p>\n<blockquote>\n<p><code>awaiting-author</code> would like to have a word with you <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span></p>\n</blockquote>\n<p>That's fair, my mistake!</p>",
        "id": 558346049,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1763612179
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/144837-PR-reviews/topic/.2323238.20extended.20floor.20and.20ceil/near/558345834\">said</a>:</p>\n<blockquote>\n<p>But I don't see why we will need both of those, if EFloorSemiring is created?</p>\n</blockquote>\n<p>Oh, you want this to be a property of <code>WithTop R</code>, rather than <code>R</code> itself? Then it could make sense, but I am not yet sure what the statement should be. We currently have no axiomatisation of extended semirings.</p>",
        "id": 558362032,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1763623011
    }
]