[
    {
        "content": "<p>The above PR just renames a few declarations, but causes the tests for the <code>continuity</code> tactic to fail. I don't see why this would happen (all renamed declarations are tagged <code>continuity</code> both before and after the change). Does anybody know why and would like to help me fix or diagnose this?</p>",
        "id": 573285262,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1770816385
    },
    {
        "content": "<p>Yeah that is pretty weird! </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Continuous</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">continuity</span>\n</code></pre></div>\n<p>now fails (line 28 of <code>MathlibTest/Continuity.lean</code>). <code>continuity</code> is supposed to be just <code>aesop</code> with a prescribed ruleset. On master the proof unfolds to <code>exact continuous_const</code>, which has been renamed <code>Continuous.const</code> in this PR. Weirdly, the <code>aesop</code> error in the PR is</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>tactic 'aesop' failed, failed to prove the goal after exhaustive search.\nInitial goal:\n\nW : Type ?u.43426\nX : Type u_1\nY : Type u_2\nZ : Type ?u.43435\ninst✝⁴ : TopologicalSpace W\ninst✝³ : TopologicalSpace X\ninst✝² : TopologicalSpace Y\ninst✝¹ : TopologicalSpace Z\nI : Type ?u.43438\nX' : I → Type ?u.43443\ninst✝ : (i : I) → TopologicalSpace (X' i)\nf : X → Y\nx : X\n⊢ Continuous fun x_1 =&gt; f x\n\nRemaining goals after safe rules:\n\ncase hg\nW : Type ?u.43426\nX : Type u_1\nY : Type u_2\nZ : Type ?u.43435\ninst : TopologicalSpace W\ninst_1 : TopologicalSpace X\ninst_2 : TopologicalSpace Y\ninst_3 : TopologicalSpace Z\nI : Type ?u.43438\nX' : I → Type ?u.43443\ninst_4 : (i : I) → TopologicalSpace (X' i)\nf : X → Y\nx : X\n⊢ Continuous f\n</code></pre></div>\n<p>so something has gone wrong here -- aesop has applied a rule which isn't safe in its \"safe\" rules, because <code>Continuous f</code> is not provable whereas the goal (continuity of the constant function sending anything in X to <code>f x</code>) is certainly true.</p>",
        "id": 573352324,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1770832179
    },
    {
        "content": "<p>Conjecture: (a) the renaming in the PR changes the order in which aesop applies things, and (b) <code>continuity</code> is assuming that certain applications are \"safe\", for example \"if the goal is to prove that f \\circ g is continuous, and we know already that g is continuous, then it's safe to reduce the goal to the claim that f is continuous\". So (a) is exposing some kind of non-confluence and the usually-safe (b) is tripping us up because another reason that f \\circ g can be continuous is that g is constant and f is arbitrary -- something which was tried first in master and is being tried too late in this PR.</p>",
        "id": 573354617,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1770832806
    },
    {
        "content": "<p>Tangential questions: do we have any tests where <code>fun_prop</code> still fails but <code>continuity</code> succeeds?</p>",
        "id": 573378338,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1770840806
    }
]