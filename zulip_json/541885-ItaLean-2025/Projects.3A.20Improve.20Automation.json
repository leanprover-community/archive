[
    {
        "content": "<p>This thread is dedicated to the Improve Automation project:</p>\n<ul>\n<li>Repository: ?</li>\n<li>Formal Manager: <span class=\"user-mention\" data-user-id=\"256311\">@Jannis Limperg</span></li>\n</ul>",
        "id": 562738613,
        "sender_full_name": "Lorenzo Luccioli",
        "timestamp": 1765298625
    },
    {
        "content": "<p>Aesop reference docs (such as they are): <a href=\"https://github.com/leanprover-community/aesop\">https://github.com/leanprover-community/aesop</a></p>",
        "id": 562768436,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765305553
    },
    {
        "content": "<p>Grind reference: <a href=\"https://lean-lang.org/doc/reference/latest/The--grind--tactic/\">https://lean-lang.org/doc/reference/latest/The--grind--tactic/</a></p>",
        "id": 562768564,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765305583
    },
    {
        "content": "<p>I realized that <code>guard</code> constraint of <code>grind_pattern</code>isn't yet available in <code>mathlib4:master</code>, which is tied to <a href=\"https://github.com/leanprover/lean4/releases/tag/v4.26.0-rc2\">v4.26.0-rc2</a>. I guess I'll start working with <code>lean4:master</code>. (context: I want <code>lemma val_natCast_of_lt {n a : ℕ} (h : a &lt; n) : (a : ZMod n).val = a</code> around only when the side-condition is known).</p>",
        "id": 562875576,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765349345
    },
    {
        "content": "<p>Maybe using a nightly toolchain is easier? This should work with Mathlib.</p>",
        "id": 562876166,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765349618
    },
    {
        "content": "<p>I put</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">09</span>\n</code></pre></div>\n<p>in <code>lean-toolchain</code> and ran <code>lake update</code>.</p>",
        "id": 562877249,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765350074
    },
    {
        "content": "<p>ohh, maybe I need to change the battery version etc</p>",
        "id": 562877369,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765350132
    },
    {
        "content": "<p>I have a feeling I'm not doing the right thing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">**</span><span class=\"n\">zksecurity</span><span class=\"bp\">@</span><span class=\"n\">Ubuntu</span><span class=\"bp\">-</span><span class=\"mi\">2404</span><span class=\"bp\">-</span><span class=\"n\">noble</span><span class=\"bp\">-</span><span class=\"n\">amd64</span><span class=\"bp\">-</span><span class=\"n\">base</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"bp\">**~/</span><span class=\"n\">mathlib4</span><span class=\"bp\">**$</span><span class=\"w\"> </span><span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">update</span>\n<span class=\"bp\">**</span><span class=\"n\">warning</span><span class=\"o\">:</span><span class=\"bp\">**</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">updated</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">multiple</span><span class=\"w\"> </span><span class=\"n\">toolchain</span><span class=\"w\"> </span><span class=\"n\">candidates</span><span class=\"o\">:</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">09</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">mathlib</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">plausible</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">25</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc1</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">LeanSearchClient</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">importGraph</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">proofwidgets</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">Qq</span>\n\n<span class=\"w\">  </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n\n<span class=\"w\">    </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">batteries</span>\n<span class=\"bp\">**</span><span class=\"n\">info</span><span class=\"o\">:</span><span class=\"bp\">**</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">running</span><span class=\"w\"> </span><span class=\"n\">post</span><span class=\"bp\">-</span><span class=\"n\">update</span><span class=\"w\"> </span><span class=\"n\">hooks</span>\n</code></pre></div>",
        "id": 562879940,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765350599
    },
    {
        "content": "<p>There is a repo <a href=\"https://github.com/leanprover-community/mathlib4-nightly-testing\">https://github.com/leanprover-community/mathlib4-nightly-testing</a> that has the nightly branches. You can check out <code>nightly-testing</code> or a <code>bump/YYYY-MM-DD</code> branch and work from there. You should not have to update the toolchain or  <code>lake update</code> yourself.</p>",
        "id": 562882284,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765351396
    },
    {
        "content": "<p>^ seems to be working (now building). Thank you!</p>",
        "id": 562886436,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765352645
    },
    {
        "content": "<p>Great! Note that <code>lake exe cache get</code> will still work for these branches as well.</p>",
        "id": 562888481,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765353350
    },
    {
        "content": "<p>@Jannis Limperg, as we talked yesterday, here is the pull request for aesop for basic lib - <a href=\"https://github.com/leanprover-community/mathlib4/pull/32682\">https://github.com/leanprover-community/mathlib4/pull/32682</a>, but it looks like we can't create pull request against the master branch, and I've no idea how to add you as an reviewer as it's disabled.</p>",
        "id": 562926096,
        "sender_full_name": "Farruh Habibullaev",
        "timestamp": 1765364131
    },
    {
        "content": "<p>I can do this, and have requested review rom Jannis.</p>",
        "id": 562927755,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1765364683
    },
    {
        "content": "<p>Thank you!</p>",
        "id": 562928907,
        "sender_full_name": "Farruh Habibullaev",
        "timestamp": 1765365064
    },
    {
        "content": "<p>I'm trying to add a <code>grind_pattern</code> on a lemma <code>mod_eq_of_lt</code> in <code>lean4</code> repo. The test is not working unless I copy the <code>grind_pattern</code> into the test file. I'm puzzled <a href=\"https://github.com/leanprover/lean4/pull/11584\">https://github.com/leanprover/lean4/pull/11584</a></p>",
        "id": 562938483,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765368256
    },
    {
        "content": "<p>I asked about the question we had yesterday, whether we should be actively replacing manual proofs with automated proofs. TLDR: yes, but only if the manual proof is more than 2-3 lines. Details: <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/Policy.20on.20replacing.20manual.20proofs.20with.20automated.20proofs/with/562949639\">#mathlib4 &gt; Policy on replacing manual proofs with automated proofs</a></p>\n<p>This doesn't affect PRs adding annotations -- please make these even if they only save one line. In a bigger proof, they may well enable the automation to make more progress and save more lines.</p>",
        "id": 562960938,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765374947
    },
    {
        "content": "<p>I need some design decision about <code>grind_pattern</code>. The issue is that I don't want <code>a % b = a</code> when both <code>a</code> and <code>b</code> are values, but I want it when either <code>a</code> or <code>b</code> is not_value. <span class=\"user-mention\" data-user-id=\"112857\">@Leonardo de Moura</span> </p>\n<p>Do we want to add disjunction as guard? Is it okay to repeat the <code>grind_pattern</code>?</p>\n<p><a href=\"https://github.com/leanprover/lean4/pull/11584\">https://github.com/leanprover/lean4/pull/11584</a></p>",
        "id": 563211181,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765465759
    },
    {
        "content": "<p>^ I spoke with Leo offline about this and got an answer.</p>",
        "id": 563212862,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765466154
    },
    {
        "content": "<p>Is this something interesting to debug</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">kernel</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">application</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"n\">eq_false_of_decide</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">eagerReduce</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"o\">))</span>\n<span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">false</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">function</span><span class=\"w\"> </span><span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">False</span>\n</code></pre></div>\n<p>on</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">**</span><span class=\"n\">Operating</span><span class=\"w\"> </span><span class=\"n\">system</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Linux</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">release</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">6.8</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"mi\">88</span><span class=\"bp\">-</span><span class=\"n\">generic</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">CPU</span><span class=\"w\"> </span><span class=\"n\">architecture</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x64</span>\n<span class=\"bp\">**</span><span class=\"n\">CPU</span><span class=\"w\"> </span><span class=\"n\">model</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">32</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">AMD</span><span class=\"w\"> </span><span class=\"n\">Ryzen</span><span class=\"w\"> </span><span class=\"mi\">9</span><span class=\"w\"> </span><span class=\"mi\">7950</span><span class=\"n\">X3D</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"bp\">-</span><span class=\"n\">Core</span><span class=\"w\"> </span><span class=\"n\">Processor</span>\n<span class=\"bp\">**</span><span class=\"n\">Available</span><span class=\"w\"> </span><span class=\"n\">RAM</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">134.24</span><span class=\"w\"> </span><span class=\"n\">GB</span>\n\n<span class=\"bp\">**</span><span class=\"n\">VS</span><span class=\"w\"> </span><span class=\"n\">Code</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Reasonably</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">1.106</span><span class=\"bp\">.</span><span class=\"m\">3</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">extension</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">0.0</span><span class=\"bp\">.</span><span class=\"m\">221</span>\n<span class=\"bp\">**</span><span class=\"n\">Curl</span><span class=\"w\"> </span><span class=\"n\">installed</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"bp\">**</span><span class=\"n\">Git</span><span class=\"w\"> </span><span class=\"n\">installed</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">true</span>\n<span class=\"bp\">**</span><span class=\"n\">Elan</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Reasonably</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">4.1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">Lean</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Reasonably</span><span class=\"w\"> </span><span class=\"n\">up</span><span class=\"bp\">-</span><span class=\"n\">to</span><span class=\"bp\">-</span><span class=\"n\">date</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mf\">4.27</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">10</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">Project</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Valid</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">project</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">path</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">zksecurity</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">Active</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">10</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"ss\">`file</span><span class=\"o\">:</span><span class=\"bp\">///</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">zksecurity</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"n\">testing</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">-</span><span class=\"n\">toolchain</span><span class=\"bp\">`</span><span class=\"o\">)</span>\n<span class=\"bp\">**</span><span class=\"n\">Installed</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">versions</span><span class=\"bp\">**</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">stage0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">09</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">10</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">nightly</span><span class=\"o\">:</span><span class=\"n\">nightly</span><span class=\"bp\">-</span><span class=\"mi\">2025</span><span class=\"bp\">-</span><span class=\"mi\">12</span><span class=\"bp\">-</span><span class=\"mi\">11</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">24</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">25</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"o\">:</span><span class=\"n\">v4</span><span class=\"bp\">.</span><span class=\"m\">26</span><span class=\"bp\">.</span><span class=\"m\">0</span><span class=\"bp\">-</span><span class=\"n\">rc2</span>\n</code></pre></div>\n<p>observed on <a href=\"https://github.com/pirapira/mathlib4/commit/329354a78e0799c612a01c4701da6ac000ef01dd\">https://github.com/pirapira/mathlib4/commit/329354a78e0799c612a01c4701da6ac000ef01dd</a></p>",
        "id": 563236029,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765471314
    },
    {
        "content": "<blockquote>\n<p>^ I spoke with Leo offline about this and got an answer.</p>\n</blockquote>\n<p>What was the answer, just out of curiosity?</p>",
        "id": 563246001,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765474029
    },
    {
        "content": "<blockquote>\n<p>Is this something interesting to debug</p>\n</blockquote>\n<p>Looks like a tactic bug, where a tactic constructs a malformed expression. Definitely interesting.</p>",
        "id": 563246106,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765474060
    },
    {
        "content": "<blockquote>\n<p>What was the answer, just out of curiosity?</p>\n</blockquote>\n<p>having this repetition is fine, the overhead is minimal, was the answer.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">grind_pattern</span><span class=\"w\"> </span><span class=\"n\">mod_eq_of_lt</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">not_value</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">  </span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span>\n\n<span class=\"n\">grind_pattern</span><span class=\"w\"> </span><span class=\"n\">mod_eq_of_lt</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">not_value</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"w\">  </span><span class=\"n\">guard</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span>\n</code></pre></div>",
        "id": 563248553,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765474752
    },
    {
        "content": "<blockquote>\n<p>a tactic bug</p>\n</blockquote>\n<p>It's caused by <code>grind =</code> annotation on <code>natCast_self</code>. I'll clean up the example and file an issue. <a href=\"https://github.com/pirapira/mathlib4/commit/329354a78e0799c612a01c4701da6ac000ef01dd#diff-045563e9a620ceedb72bba37de77554038dfe9d0ec1bcdc4989585c5020e6b77R147\">https://github.com/pirapira/mathlib4/commit/329354a78e0799c612a01c4701da6ac000ef01dd#diff-045563e9a620ceedb72bba37de77554038dfe9d0ec1bcdc4989585c5020e6b77R147</a></p>",
        "id": 563248808,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765474821
    },
    {
        "content": "<p>I've updated RP with aesop / simp automation - <a href=\"https://github.com/leanprover-community/mathlib4/pull/32698\">https://github.com/leanprover-community/mathlib4/pull/32698</a></p>",
        "id": 563265828,
        "sender_full_name": "Farruh Habibullaev",
        "timestamp": 1765480669
    },
    {
        "content": "<p>I pushed a PR for changes that don't require nightly <a href=\"https://github.com/leanprover-community/mathlib4/pull/32776\">https://github.com/leanprover-community/mathlib4/pull/32776</a></p>\n<p>I have more changes that require <code>guard</code> feature of <code>grind</code>. Shall I wait till <code>guard</code> becomes available in <code>mathlib4</code> CI?</p>",
        "id": 563366954,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765525279
    },
    {
        "content": "<p>CI is failing on <a href=\"https://github.com/leanprover/lean4/pull/11584\">another lean4 PR</a> because <code>changelog-*</code> tag is missing. Can somebody add this tag?</p>",
        "id": 563377086,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765525698
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"899757\">Yoichi Hirai</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Improve.20Automation/near/563377086\">said</a>:</p>\n<blockquote>\n<p>CI is failing on <a href=\"https://github.com/leanprover/lean4/pull/11584\">another lean4 PR</a> because <code>changelog-*</code> tag is missing. Can somebody add this tag?</p>\n</blockquote>\n<p>you usually can add it writing the tag you want (e.g. <code>changelog-library</code>) in the github comments :)</p>",
        "id": 563384189,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765526001
    },
    {
        "content": "<p>worked! <a href=\"https://github.com/leanprover/lean4/pull/11584#issuecomment-3645387120\">https://github.com/leanprover/lean4/pull/11584#issuecomment-3645387120</a></p>",
        "id": 563405514,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765526940
    },
    {
        "content": "<p>dumping some thoughts: </p>\n<ul>\n<li>I spent the last couple days thinking about the <a href=\"https://github.com/luisacicolini/mathlib4/pull/2/files\">lemmas</a>) in <code>Mathlib/Logic/Relation</code>: in particular the lemmas describing the relations between transitive and reflexive closures. The objective would be to make the lemmas about the <code>ReflTransGen</code> (reflexive and transitive closure) <code>grind</code>able. </li>\n<li>The draft above summarizes my failed attempt: the only resulting <code>grind</code>able lemmas were trivial</li>\n<li>However, I came to conclude that the minimal theory for this is already in the file, and we might want to tag for <code>grind</code> all the lemmas in <code>Relation</code> that characterize the relations between <code>ReflGen</code>, <code>TransGen</code> and <code>ReflTransGen</code>.  It seems to me that those lemmas are basically (and useful) enough to make more complex reasoning about <code>Relation</code> <code>grind</code>able. </li>\n</ul>\n<p>I'd be curious to see if anyone has any thoughts or opinions on this :)</p>",
        "id": 563427964,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765531373
    },
    {
        "content": "<p>In the quadratic Integers projects we have goals like <code>4 ∣ 1 - d</code>, knowing that <code>4 * n = t ^ 2 - d * (2 * B' + 1) ^ 2</code> and <code>t = 2 * t' + 1</code> (all the variables are in <code>ℤ</code>). It's easy to use <code>grind</code> to show that <code>-t' ^ 2 - t' + d * B' ^ 2 + d * B' + n</code> works and this is already very nice. Do you think it is possible to make <code>grind</code> guess the element? On paper it is very easy, <code>4 ∣ 1 - d</code> means that there is <code>k</code> such that <code>4 * k = 1 - d</code>, and the other relations force <code>k</code> to be what it is.</p>",
        "id": 563431798,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765532699
    },
    {
        "content": "<p>I don't think grind creates data, I think this has come up before. Just to clarify the issue:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- goes to pencil and paper and multiplies everything out...</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- manually calculated</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span>\n</code></pre></div>",
        "id": 563433682,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765533260
    },
    {
        "content": "<p>It's extra-hard because the solution can't be solved by eliminating d -- you can't just \"evaluate (1-d)/4 by subbing in for d\", you do need intelligence here to realise that you don't figure out d by dividing by (2B'+1)^2 in h1, you actually need to do something clever. So I'm not even clear what algorithm would be good enough to do this. I think I'm solving this by pattern-spotting -- \"oh look there's a 1+4B'+4B'^2, those 4's can help us\".</p>\n<p>In particular I am not immediately convinced by Riccardo's \"the other relations force k to be what it is\" -- things like k=(1-(t^2-4n)/(2B'+1)^2)/4 also work algebraically, but the 4's happen not to cancel for this choice.</p>",
        "id": 563434585,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765533529
    },
    {
        "content": "<p>I asked Claude and it found the factor essentially immediately. This might be a workaround for now!</p>",
        "id": 563435270,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765533719
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"696010\">@Luisa Cicolini</span> I find it very reasonable to annotate <code>Mathlib/Logic/Relation</code> for <code>grind</code>. I have been doing this a bit for the term rewriting project. See <a href=\"https://github.com/leanprover/cslib/compare/55d8cf5b125dc1ec8930a358d684bfb41cf99d8a...chenson2018:79d703ff0ba745f2d74889c08057dcab4238ba68\">this slightly messy diff</a> as an example.</p>",
        "id": 563437212,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765534342
    },
    {
        "content": "<p>thank you very much! it's very helpful to see how that's used in cslib. I will annotate it and share the result!</p>",
        "id": 563437623,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765534495
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Improve.20Automation/near/563433682\">said</a>:</p>\n<blockquote>\n<p>I don't think grind creates data, I think this has come up before. Just to clarify the issue:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- goes to pencil and paper and multiplies everything out...</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"bp\">^</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- manually calculated</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I think this oversimplifies the situation, you can get <code>grind</code> to \"create the data\" here with less help:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">B'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"bp\">∣</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">h2</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span>\n</code></pre></div>\n<p>But the truth of this example is that we're not really creating data here, instead <code>grind</code> knows enough about the <code>dvd</code> relation to prove it. eg in this case <code>grind</code> knows <code>4 ∣ 4 * m</code> (inside the <code>lia</code> module). In fact I wonder if it should be solvable without the <code>subst</code>, although I think I understand why it's currently not</p>",
        "id": 563444454,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765536524
    },
    {
        "content": "<p>Yeah, finding the quotient is what I thought it was the most direct way, but maybe for a tactic it's easier to  use properties of <code>dvd</code>.</p>",
        "id": 563449687,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765538147
    },
    {
        "content": "<p>I wonder if people in this project were thinking about inequalities: <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/channel/287929-mathlib4/topic/aesop.20and.20inequalities/with/563451130\">#mathlib4 &gt; aesop and inequalities</a></p>",
        "id": 563451293,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765538668
    },
    {
        "content": "<p>I don't think anyone looked at inequalities specifically. Would have been a good target; I should have thought of that.</p>",
        "id": 563453008,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765539256
    },
    {
        "content": "<p>I <a href=\"https://github.com/leanprover-community/mathlib4/pull/32791\">updated the <code>grind</code> annotations</a> after chatting a bit with <span class=\"user-mention\" data-user-id=\"687698\">@Chris Henson</span> and looking at what they're using in cslib. One thing that is not clear to me is what's the preference among the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">reflGen_iff</span>\n<span class=\"kn\">attribute</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">grind</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ReflGen</span>\n</code></pre></div>\n<p>and in general thoughts on what is helpful to tag <code>grind</code> in <code>Relation</code> are appreciated :)</p>",
        "id": 563454355,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765539780
    },
    {
        "content": "<p>I hacked together a quick presentation for later: <br>\n<a href=\"/user_uploads/3121/IILfpUTWo7JVYPVmraIHTw4g/italean.pptx\">italean.pptx</a><br>\nPlease lmk if you feel misrepresented. <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> <span class=\"user-mention\" data-user-id=\"899757\">@Yoichi Hirai</span> <span class=\"user-mention\" data-user-id=\"696010\">@Luisa Cicolini</span> <span class=\"user-mention\" data-user-id=\"979973\">@Farruh Habibullaev</span> <span class=\"user-mention\" data-user-id=\"904188\">@Paul Dietze</span></p>",
        "id": 563461233,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765542024
    },
    {
        "content": "<p>By the way, it's blank, I see no content in the presentation</p>",
        "id": 563468037,
        "sender_full_name": "Farruh Habibullaev",
        "timestamp": 1765544317
    },
    {
        "content": "<p>Version where I actually hit the save button: <br>\n<a href=\"/user_uploads/3121/rSGByK0o2q83tORoNuXIbFIO/italean.pptx\">italean.pptx</a></p>",
        "id": 563468064,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765544323
    },
    {
        "content": "<p>Do you guys want to do the presentation yourselves?</p>",
        "id": 563487069,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765549796
    },
    {
        "content": "<p>I personally prefer you to do it.</p>",
        "id": 563488133,
        "sender_full_name": "Farruh Habibullaev",
        "timestamp": 1765550073
    },
    {
        "content": "<p>I agree with the statement by <span class=\"user-mention\" data-user-id=\"979973\">@Farruh Habibullaev</span> :)</p>",
        "id": 563488806,
        "sender_full_name": "Paul Dietze",
        "timestamp": 1765550270
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"696010\">@Luisa Cicolini</span> your PR is marked as draft, but I think it's basically ready; and it would be nice to have the stuff merged before you all present. Do you want to mark it as ready?</p>",
        "id": 563489364,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765550422
    },
    {
        "content": "<p>I talked about this a bit with <span class=\"user-mention\" data-user-id=\"256311\">@Jannis Limperg</span> and we were actually working on a refactoring to build the necessary infra around <code>ReflGen</code> and <code>TransGen</code>, so that all the lemmas about <code>ReflTransGen</code> are derived from there (that's why it was drafted). <span class=\"user-mention\" data-user-id=\"256311\">@Jannis Limperg</span> what do you think?</p>",
        "id": 563489818,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765550547
    },
    {
        "content": "<p>This refactoring will take a while, so I'd say let's merge the incremental improvement rather than wait for perfection.</p>",
        "id": 563490093,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1765550619
    },
    {
        "content": "<p>okay! in that case I'm opening it now</p>",
        "id": 563490139,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765550631
    },
    {
        "content": "<p>have hit merge on it :)</p>",
        "id": 563491176,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765550937
    },
    {
        "content": "<p>ci did not pass <span aria-label=\"melt\" class=\"emoji emoji-1fae0\" role=\"img\" title=\"melt\">:melt:</span> I will try to fix the issue (and maybe add some <code>grind</code>ed theorems, as was also requested)</p>",
        "id": 563501437,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765553435
    },
    {
        "content": "<p>I mentioned in person, but will write here as well for other's benefit: the error in CI is from <code>MathlibTest/grind/lint.lean</code>. This is a recently added test that checks that grind annotations in Mathlib do not pass a given threshold of instantiations. You can look at the output of that test to see what theorems are the problem and change/remove the annotation. In a few days I believe the next release will also add the ability to add constraints to <code>grind_pattern</code> which can also potentially help.</p>",
        "id": 563505499,
        "sender_full_name": "Chris Henson",
        "timestamp": 1765554523
    },
    {
        "content": "<p>should be fixed now! <code>EqvGen</code> was understandably the problem</p>",
        "id": 563525730,
        "sender_full_name": "Luisa Cicolini",
        "timestamp": 1765559923
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"246273\">Bhavik Mehta</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Improve.20Automation/near/563444454\">said</a>:</p>\n<blockquote>\n<p>In fact I wonder if it should be solvable without the <code>subst</code></p>\n</blockquote>\n<p>I convinced myself that this counts as a grind bug, or at least seemingly inconsistent with the docs about <code>grind</code>, so it's reported here: <a href=\"https://github.com/leanprover/lean4/pull/11631\">lean4#11631</a></p>",
        "id": 563576250,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1765582418
    },
    {
        "content": "<p>A different issue I saw in <code>grind</code> use (<code>(kernel) application type mismatch</code>) seems to have disappeared in the nightly build.  Minimizing the example was educational though. I saw lots of important type classes.</p>",
        "id": 564100179,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765906934
    },
    {
        "content": "<p>I started looking for a reviewer for <a href=\"https://github.com/leanprover-community/mathlib4/pull/32776\">mathlib4#32776</a> . I also <a href=\"#narrow/channel/144837-PR-reviews/topic/.2332776.20grind.20and.20aesop.20annotations.20for.20ZMod/near/564210091\">posted</a> in the PR reviews channel. My usual strategy in this phase is gentle persistence.</p>",
        "id": 564213410,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1765966116
    },
    {
        "content": "<p>I got <a href=\"https://github.com/leanprover-community/mathlib4/pull/32776#issuecomment-3667363461\">my first PR merged</a> to mathlib. Thank you! I'll continue with more because now <code>grind_pattern</code> can take <code>guard</code>-conditions on <code>mathlib4:master</code>.</p>",
        "id": 564358220,
        "sender_full_name": "Yoichi Hirai",
        "timestamp": 1766013467
    }
]