[
    {
        "content": "<p>This thread is dedicated to the Finitely Presented Groups project:</p>\n<ul>\n<li>Repository: ?</li>\n<li>Informal Manager: <span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> </li>\n<li>Formal Manager: <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span></li>\n</ul>",
        "id": 562741721,
        "sender_full_name": "Lorenzo Luccioli",
        "timestamp": 1765299331
    },
    {
        "content": "<p>Repo: <a href=\"https://github.com/homeowmorphism/FinitelyPresentedGroups\">https://github.com/homeowmorphism/FinitelyPresentedGroups</a></p>",
        "id": 562745331,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1765300105
    },
    {
        "content": "<p>Hi, went to the repo but the proof we wrote today is not there? I can see is 2 sorrys and one unfinished lemma with ‘constructor’ as last line</p>",
        "id": 562807309,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1765317326
    },
    {
        "content": "<p>I guess <span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> forgot to push. There was definitely something in her computer</p>",
        "id": 562807438,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765317365
    },
    {
        "content": "<p>wait no, the definition is there. You have to do <code>git pull</code> (in VS Code click on the little circle in the bottom left part of the window)</p>",
        "id": 562807606,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765317421
    },
    {
        "content": "<p>Ah sorry, I misunderstood you message. She probably forgot to push</p>",
        "id": 562807970,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765317530
    },
    {
        "content": "<p>Looks like a good start! Is there a dream theorem you're working towards?</p>",
        "id": 562808064,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1765317557
    },
    {
        "content": "<p>Hang Lu Su mentioned the Reidemeister-Schreier Theorem</p>",
        "id": 562808729,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1765317770
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1004251\">@Valerio</span> Thanks for the notice! I just pushed again and the latest changes should be in the repo now. Sorry about that. </p>\n<p>The Reidemeister-Schreier theorem would be really cool to be able to make good progress on this week indeed :). </p>\n<p>Edit: I should mention I wrote an introductory chapter on it in my thesis <a href=\"https://arxiv.org/abs/2512.07035\">https://arxiv.org/abs/2512.07035</a> p. 169-177 in case someone finds this useful.</p>",
        "id": 562809356,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1765317965
    },
    {
        "content": "<p>I don't know how difficult it is, but since it seems it is an algorithm that actually gives the presentation of the subgroup, the next step is probably to link our definition to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PresentedGroup#doc\">docs#PresentedGroup</a></p>",
        "id": 562809892,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765318124
    },
    {
        "content": "<p>anyway since this is also the topic of the conference I am throwing the first <code>sorry</code> to aristotle</p>",
        "id": 562810389,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765318304
    },
    {
        "content": "<p>I don't really know the math, but this is what I've cooked up so far:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Pointwise</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FinitePresentation</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ReidemeisterSchreierMethod</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinitePresentation</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- G is presented by generators ι</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- The transversal</span>\n<span class=\"w\">    </span><span class=\"c1\">-- These are from `Subgroup.closure_mul_image_mul_eq_top`</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hT</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">IsComplement</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"c1\">-- T is a right transversal</span>\n<span class=\"w\">    </span><span class=\"c1\">-- TODO: should be Hg, not gH?</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hT_covers</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">⋃</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- T covers H</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hT1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- 1 is in T</span>\n<span class=\"w\">    </span><span class=\"c1\">-- Definition: T is a Schreier transversal if it is prefix-closed with respect to generators of P.</span>\n<span class=\"w\">    </span><span class=\"c1\">-- TODO: we need some order relation to prevent cycles, i.e. t' &lt; t.</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hT_is_schreier</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t'</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">⁻¹</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FinitePresentation</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"c1\">-- H is presented by T × ι</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">reidemeister_schreier</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">H</span><span class=\"bp\">.</span><span class=\"n\">FiniteIndex</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hG</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- obtain a *Finset* *Schreier* right transversal somehow</span>\n<span class=\"w\">  </span><span class=\"c1\">-- and then call ReidemeisterSchreierMethod</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 563240466,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1765472436
    },
    {
        "content": "<p>Hi, with some help from GPT, I added a new file (didn’t make a PR) which compares our definition and the notion of PresentedGroup already in Mathlib. It’s probably rough, but I hope it’s a start.</p>",
        "id": 563293585,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1765492074
    },
    {
        "content": "<p>I added the <code>ReidemeisterSchreier.lean</code> that combines the improvements that <span class=\"user-mention\" data-user-id=\"1004246\">@Francesco Milizia</span> and <span class=\"user-mention\" data-user-id=\"607118\">@Lawrence Wu (llllvvuu)</span> made today, plus some edits. </p>\n<p>In the end, I felt like it might be easier for now (given the timing of the presentation being tomorrow) to just offload the requirement of being a Schreier transversal as a \"sorry\".</p>",
        "id": 563302786,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1765497950
    },
    {
        "content": "<p>Indeed the design of <code>IsSchreierTransversal</code> seems tricky. It is possible that we would actually want a <code>structure SchreierTransversal</code> that contains not only the data <code>T</code> but some additional data <code>parent</code> which tells you exactly what the \"parent\" / prefix of each element is instead of just asserting that one exists. Otherwise, <code>ReidemeisterSchreierMethod</code> may have to use axiom of choice e.g. <code>Exists.choose</code> and hence be <code>noncomputable</code>.</p>\n<p>An interesting design for the ordering thing could be to have <code>T</code> be a <code>Fin n -&gt; G</code> instead of <code>Finset G</code>, then <code>Fin n</code> gives an ordering i.e. it could be asserted that <code>parent</code> has a lower index in <code>Fin n</code>.</p>",
        "id": 563310192,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1765502500
    },
    {
        "content": "<p>Aristotle did prove a version of the theorem yesterday: <a href=\"https://github.com/homeowmorphism/FinitelyPresentedGroups/pull/2\">https://github.com/homeowmorphism/FinitelyPresentedGroups/pull/2</a></p>\n<p>Maybe possible that it can also do it with the new definitions and prompted to make it computable as mentioned above</p>",
        "id": 563421493,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1765528951
    },
    {
        "content": "<p>This is great! Did Aristotle find the proof by itself or did you help it?</p>",
        "id": 563422328,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1765529293
    },
    {
        "content": "<p>It formalized everything itself including the statement</p>",
        "id": 563431285,
        "sender_full_name": "Lawrence Wu (llllvvuu)",
        "timestamp": 1765532514
    },
    {
        "content": "<p>Hi everyone! I hope travel home went smoothly for those who attended the conference in-person. </p>\n<p>I made a mathlib fork for this project. <a href=\"https://github.com/homeowmorphism/mathlib4\">https://github.com/homeowmorphism/mathlib4</a></p>\n<p>My intention is to upstream it to mathlib in small PRs, and I would appreciate guidance on how to go about it and on the credit conventions. (For context I'm new to the community, so extra guidance is very welcome!)</p>\n<p>From what I can tell, there's a group of separate files with some overlaps and some different features, which need to be merged and polished together and separated into different PRs. Does the following rough plan seem reasonable from a maintainer/reviewer perspective? </p>\n<ol>\n<li>\n<p>add to, polish and submit the <code>IsFinitelyPresented</code>-related statements/proofs we developed with @Riccardo Brasca, since this appears minimally invasive. <br>\n<strong>Edit:</strong> I'm currently working on this and the branch can be found here: <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup</a></p>\n</li>\n<li>\n<p>add <code>Presentation</code> and <code>FinitePresentation</code> we did with <span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span> , and then adjust so that <code>PresentedGroup</code> (a 2019 package we did not work on) and <code>FinitelyPresentedGroup</code> are groups obtained from a presentation. <br>\n<strong>Edit:</strong> <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> is working on this, and his branch can be found here: <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...jazzits:mathlib4:finitely-presented-groups\">https://github.com/leanprover-community/mathlib4/compare/master...jazzits:mathlib4:finitely-presented-groups</a></p>\n</li>\n<li>\n<p>Work on the Reidemeister-Schreier method/theorem on a different branch. Many thanks to <span class=\"user-mention\" data-user-id=\"607118\">@Lawrence Wu (llllvvuu)</span> for helping with this and the Aristotle workflow.</p>\n</li>\n</ol>\n<p><strong>Credit questions:</strong></p>\n<p>Copyright: Who should I put for that? I'm not sure what that's supposed to do <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>. </p>\n<p>Authors: I added everyone who worked on this in alphabetic order in the header of the file I'm working on (I got the names from the Google Sheet). I was wondering if that's ok with everyone, or if anyone would like to be excluded? <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> <span class=\"user-mention\" data-user-id=\"626233\">@Fabrizio Barroero</span> <span class=\"user-mention\" data-user-id=\"1004246\">@Francesco Milizia</span> @<strong>Valerio</strong> <span class=\"user-mention\" data-user-id=\"607118\">@Lawrence Wu (llllvvuu)</span> (I'm not sure what Stefano Francaviglia's username is so I didn't tag him.)</p>",
        "id": 564593272,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766104032
    },
    {
        "content": "<p>Starting with a small PR is surely a good idea. Put your name in the copyright header and everybody else as author. It a good idea to read the <a href=\"https://leanprover-community.github.io/contribute/index.html\">doc page</a> before opening the PR, and don't hesitate to ask questions here!</p>",
        "id": 564722456,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766158179
    },
    {
        "content": "<p>I made a PR addressing point 2 above. First time doing this so I hope I am doing things right, perhaps somebody knowledgeable can review it.</p>",
        "id": 565046484,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766425297
    },
    {
        "content": "<p>Can you post the PR number eg <a href=\"https://github.com/leanprover-community/mathlib4/pull/12345\">#12345</a> ?</p>",
        "id": 565051036,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766427364
    },
    {
        "content": "<p>Can you link the PR here? You can write # 12345 (without the space and with the correct number)</p>",
        "id": 565051115,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766427404
    },
    {
        "content": "<p>Sorry, I meant I made a PR to Hang's repo, not to mathlib (I guess the one to mathlib should be much smaller)</p>",
        "id": 565051515,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766427626
    },
    {
        "content": "<p>I think Valerio means this one: <a href=\"https://github.com/homeowmorphism/FinitelyPresentedGroups/pull/3\">https://github.com/homeowmorphism/FinitelyPresentedGroups/pull/3</a>.</p>",
        "id": 565053431,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766428593
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> this is your repo, so it's really up to you :)</p>",
        "id": 565055373,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766429593
    },
    {
        "content": "<p>In my experience anything that compiles is fine for repository whose goal is to end up in mathlib. The mathlib PR process is already long enough, we probably don't want to have two reviews</p>",
        "id": 565055521,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766429671
    },
    {
        "content": "<p>Okay, so I will try to extract something and make a PR to mathlib in the following days. Thanks</p>",
        "id": 565055803,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766429819
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> for the contribution! I'm currently working on PR 1 and this code looks pretty advanced for me, but I'll merge it as part of the project and I agree with you probably best if you PR it directly to mathlib since I'm probably not the reviewer needed here <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> .</p>",
        "id": 565055946,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766429898
    },
    {
        "content": "<p>it's still fine to have one repo to point out to show what we want to do</p>",
        "id": 565056636,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766430200
    },
    {
        "content": "<p>Is it ok to use <code>classical</code> for <code>isFinitelyPresented_iff</code>, defined as </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>to get rid of the <code>DecidableEq G</code>problem when using <code>Finset G</code>? I was stuck and it was proposed by an LLM, but it seems strange since group element equality isn't actually decidable. </p>\n<p>Or maybe <code>Finset</code> isn't the right thing to use for finitely presented groups for this reason? </p>\n<p>Edit: I'm thinking of the context where we are using finitely presented groups algorithmically, which is common in geometric group theory.</p>",
        "id": 565077784,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766442652
    },
    {
        "content": "<p>Putting <code>classical</code> inside the proof is the usual pattern for this kind of thing, yeah</p>",
        "id": 565078568,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1766443262
    },
    {
        "content": "<p>I double-checked with <code>Group.FG</code> and it looks like it's using <code>Set</code> and <code>S.Finite</code></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>Source: <a href=\"https://github.com/leanprover-community/mathlib4/blob/8fc0483a875e84b83c6cdb6f5c124bcbb3530370/Mathlib/GroupTheory/Finiteness.lean#L376-L378\">https://github.com/leanprover-community/mathlib4/blob/8fc0483a875e84b83c6cdb6f5c124bcbb3530370/Mathlib/GroupTheory/Finiteness.lean#L376-L378</a></p>\n<p>it seems to get rid of the <code>DecidableEq</code> problem as well, but not sure if there's actually a difference philosophically?</p>",
        "id": 565078753,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766443442
    },
    {
        "content": "<p>Nevermind, it also uses Finset right after <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>, so seems like both are fine. It doesn't seem to use <code>classical</code> to show the proof though. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff'</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_def</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨_</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">hn</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"bp\">⟩⟩</span>\n</code></pre></div>",
        "id": 565080239,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766444620
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"1004097\">Hang Lu Su</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Finitely.20Presented.20Groups/near/565077784\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Note that the fact that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> is a finite subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> is completely spurious here: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> is an arbitrary function, so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> may as well be an arbitrary finite type here (and you should change it to a finite type) rather than a finite subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> being used in a way which is unrelated to the inclusion <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>⊆</mo><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">S\\subseteq G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>.</p>",
        "id": 565086810,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766451545
    },
    {
        "content": "<p>I don't know if you mean for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> to be the function induced by the inclusion <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>⊆</mo><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">S\\subseteq G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> but that's not what the code says.</p>",
        "id": 565086935,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1766451626
    },
    {
        "content": "<p>Hi, so I made the PR to mathlib. It is <a href=\"https://github.com/leanprover-community/mathlib4/pull/33233\">#33233</a>. As I said, first time doing this so high chance I did something silly. I'd appreciate any guidance.</p>",
        "id": 565142375,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766490406
    },
    {
        "content": "<p>(I can already see one check has failed, and github tells me it's because I should put the word \"module\" at the beginning?)</p>",
        "id": 565142725,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766490580
    },
    {
        "content": "<p>Just start with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Presentation</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Finiteness</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Finitely presented groups</span>\n<span class=\"cm\">...</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">expose</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Group</span>\n</code></pre></div>",
        "id": 565143945,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766491170
    },
    {
        "content": "<p>(we are in a transition period where mathlib and projects depending on mathlib behave differently)</p>",
        "id": 565144177,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766491253
    },
    {
        "content": "<p>Ok, I got the green check mark now!</p>",
        "id": 565148186,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766492989
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Finitely.20Presented.20Groups/near/565086810\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"1004097\">Hang Lu Su</span> <a href=\"#narrow/channel/541885-ItaLean-2025/topic/Projects.3A.20Finitely.20Presented.20Groups/near/565077784\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Note that the fact that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> is a finite subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> is completely spurious here: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> is an arbitrary function, so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> may as well be an arbitrary finite type here (and you should change it to a finite type) rather than a finite subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span> being used in a way which is unrelated to the inclusion <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi><mo>⊆</mo><mi>G</mi></mrow><annotation encoding=\"application/x-tex\">S\\subseteq G</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8193em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⊆</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">G</span></span></span></span>.</p>\n</blockquote>\n<p>I think the context for this (if I'm understanding correctly) is that we have already defined <code>IsFinitelyPresented</code> there existing a surjective function from a <code>FreeGroup</code> on some arbitrary set of cardinality <code>n</code> to <code>G</code> such that the kernel has a finitely generated normal closure, and the <code>isFinitelyPresented_iff</code> lemma is there to offer an alternative to the potential user in case they're working with a <code>Finset</code> of <code>G</code>. It's modeled after <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> 's code for <code>Group.FG</code> <a href=\"https://github.com/leanprover-community/mathlib4/blob/8fc0483a875e84b83c6cdb6f5c124bcbb3530370/Mathlib/GroupTheory/Finiteness.lean#L376-L378\">https://github.com/leanprover-community/mathlib4/blob/8fc0483a875e84b83c6cdb6f5c124bcbb3530370/Mathlib/GroupTheory/Finiteness.lean#L376-L378</a>, but perhaps in the context of <code>FinitelyPresentedGroup</code> there is a way to do this differently that would be less spurious? I've included the code below for full context. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">H</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_finset</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">normalClosureIsFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>If I remember correctly, this is part of why <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> championed doing this in terms of presentations (which would indeed be more general), but I wasn't sure about the implementation tradeoffs to mathlib.</p>\n<p>Edit 1: accidentally copy-pasted the wrong  <code>isFinitelyPresented_iff </code> statement in the full context as I had replaced it with <code>Set </code>and <code>Set.Finite</code> in my own editor. To avoid future confusion, I've changed the old function name to <code>isFinitelyPresented_iff_finset</code> as it appears in my editor now. </p>\n<p>Edit 2: I think I'm starting to see the point more clearly, so let me say it in my own words: we want to avoid using concrete elements of <code>G</code> as generators since they live in the <code>FreeGroup</code> lift, and so <code>Fintype</code> provides the correct level of abstraction to do that, whereas <code>Finset G</code> is taking generators of <code>G</code>, using them to generate the <code>FreeGroup</code> lift and then sending them back using the quotient map, which does indeed seem spurious. I've made the change from <code>Finset</code> to <code>Fintype</code> in my code as Kevin suggested in my fork. The branch can be found here: <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup</a>.</p>",
        "id": 565151998,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766494545
    },
    {
        "content": "<p>I think perhaps I'm missing some context to have an intuition for what's best to do and it's part of why I'm having trouble figuring out what needs to be done to add a good <code>FinitelyPresentedGroup</code>implementation to mathlib. Maybe someone more senior could weight in on this?</p>",
        "id": 565153974,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766495236
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> Perhaps it's worth waiting to see what happens to my PR? The PR also adds a file <code>Mathlib/GroupTheory/FinitelyPresented.lean</code> which defines the notion more or less based off what Francesco had started writing during ItaLean. The feedback we get there might clear up your doubts too.</p>",
        "id": 565155275,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1766495794
    },
    {
        "content": "<p>I am busy with family/Christmas things these days, but I may have some time to have a look tomorrow</p>",
        "id": 565155369,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1766495844
    },
    {
        "content": "<p>No rush on my end! I'll be busy with Christmas things as well. And thanks for the help with all this.</p>",
        "id": 565156317,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766496358
    },
    {
        "content": "<p>Thanks Valerio for your work! I will also have a look when I have time. I wish a good break to you all</p>",
        "id": 565211293,
        "sender_full_name": "Francesco Milizia",
        "timestamp": 1766523284
    },
    {
        "content": "<p>Hey <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span>, I came back to check on the updates for your PR and noticed that your latest commit <code>fin n approach</code> has been significantly overlapping with PR 1 while we had previously agreed (both in DMs and implicitly here) I'd be doing point 1 while you do 2? </p>\n<p>This is my branch: <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup</a></p>\n<p>And this is your latest commit: <a href=\"https://github.com/leanprover-community/mathlib4/pull/33233/commits/a1a99f5d04a5e08e065b43f2d6cf7307837c004c\">https://github.com/leanprover-community/mathlib4/pull/33233/commits/a1a99f5d04a5e08e065b43f2d6cf7307837c004c</a></p>\n<p>I’d like to keep point 1 as the part I'm in charge of and complete since this is a beginner-friendly mathlib project I proposed and want to learn from. Maybe my progress seems slow, but I've been spending a lot of time reading the docs and trying to understand what I'm doing as a first-timer. It would help a lot if you could focus on point 2 (or leave feedback on my code) rather than implementing point 1 in parallel. </p>\n<p>This might be a misunderstanding, but I just wanted to make my intentions clear.</p>",
        "id": 565605062,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1766972357
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> this is completely fine, I'm sorry I never meant to \"steal your thunder\". Following a request to allow the group and the generating set to live in different universes, I made some other changes that led me to define some things wrong, and so before stopping with my edits I wanted to push one last commit to fix those, and to check whether the definition of \"finite presentation\" would work well with \"finitely presented group\". In any case, I am not planning any other edits now, and I absolutely don't mind if the progress is slow, so we can coordinate better from now on.</p>",
        "id": 565640203,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1767001213
    },
    {
        "content": "<p>Thanks for the clarification Valerio. I can see how that happened, and happy to move forward and better coordinate in the future. </p>\n<p>I think I could have been clearer about my ideas on how to do this. For the <code>FinitelyPresentedGroup</code> vs <code>FinitePresentation</code> files, I was thinking something along the lines of what GAP has done, where they are two separate things can be bridged together: </p>\n<p>FpGroups: <a href=\"https://docs.gap-system.org/doc/ref/chap47.html\">https://docs.gap-system.org/doc/ref/chap47.html</a><br>\nPresentations: <a href=\"https://docs.gap-system.org/doc/ref/chap48.html\">https://docs.gap-system.org/doc/ref/chap48.html</a></p>\n<p>Not sure if that would be the best way to do it for mathlib and happy to get feedback on this, but I figured I should put the idea out there so that we can be on the same page. </p>\n<p>Anyhow, I agree with your proposed coordination plans and let's wait a bit for me to finish working on Part 1 so we can coordinate the next step together. Thanks for your patience and understanding!</p>",
        "id": 565684063,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767020569
    },
    {
        "content": "<p>Hi everyone! </p>\n<p>I'm starting to feel stuck so I thought I'd give an update. Essentially, I took <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> feedback and rewrote the <code>isFinitelyPresented_iff</code> lemma using a <code>Fintype</code> (and <code>Type*</code>). (I followed <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> 's advice to throw it into Aristotle, then rewrote it to be prettier once I understood what was going on). The full progress can be found <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">here</a> but the relevant code so far is this: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"sd\">/-- The kernel of a homomorphism composed with an isomorphism is equal to the kernel of</span>\n<span class=\"sd\">the homomorphism mapped by the inverse isomorphism. -/</span>\n<span class=\"c1\">-- TODO not sure if this is the right abstraction / right name for this.</span>\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">comap_ker</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">comap_equiv_eq_map_symm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)))</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span>\n\n<span class=\"sd\">/-- Definition of subgroup that is given by the normal closure of finitely many elements. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">H</span>\n\n<span class=\"sd\">/-- The above property is invariant under surjective homomorphism. -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hK</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"w\"> </span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hK</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map_normalClosure</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A finitely presented group is given by a surjective homomorphism from a free group on n</span>\n<span class=\"sd\">elements whose normal closure of its kernel is finitely generated. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- TODO calls to IsNormalClosureFG.map could be simplified? Like maybe using the iso functions.</span>\n<span class=\"w\">  </span><span class=\"c1\">-- seems like we apply a lot of `MonoidHom.ker_comp_mulEquiv + IsNormalClosureFG.map`.</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">ulift</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">equivFin</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n</code></pre></div>\n<p>I wanted to recover <code>IsFinitelyPresented</code> is an instance of <code>Group.FG</code> and to do so, we originally had to use the fact that an <code>FG</code> group admits a surjective homorphism from a <code>FreeGroup</code> on a finite type. Originally, I was using <code>Group.fg_iff_exists_freeGroup_hom_surjective</code>, but this uses that the surjection is from <code>FreeGroup S</code> where <code>S: Set G</code> which took me back in the \"spurious\" direction of showing <code>isFinitelyPresented_iff</code> using a surjection <code>FreeGroup S</code> where <code>S: Set G</code>, so I wrote two versions using <code>Fintype</code> which seems to avoid this problem. The difference between version 1 and 2 is that <code>α : Type</code> and <code>α : Type*</code>. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE1</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Aristotle was able to find proofs for both of them, but the thing I'm stuck on is that while this compiles</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE1</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hkernel</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span>\n</code></pre></div>\n<p>the ARISTOTLE2 version gives me the following error message: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"ss\">`instFGOfIsFinitelyPresented</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">contains</span><span class=\"w\"> </span><span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"w\"> </span><span class=\"n\">metavariables</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">expression</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">φ</span>\n<span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">declaration</span><span class=\"w\"> </span><span class=\"n\">body</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">    </span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">mpr</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">id</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">congrArg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">a</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"o\">(</span><span class=\"n\">propext</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE2</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u_1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">})))</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">casesOn</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Eq</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">congrArg</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">propext</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u_1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}))</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">            </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">),</span>\n<span class=\"w\">              </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">                </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">        </span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">casesOn</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">          </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hSfinite</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">              </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">                </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">          </span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">casesOn</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">            </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n<span class=\"w\">              </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">            </span><span class=\"n\">And</span><span class=\"bp\">.</span><span class=\"n\">casesOn</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">              </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hfsurj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"w\">                </span><span class=\"o\">(</span><span class=\"n\">hkernel</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"bp\">?</span><span class=\"n\">u</span><span class=\"bp\">.</span><span class=\"m\">29684</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">↦</span>\n<span class=\"w\">              </span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Exists</span><span class=\"bp\">.</span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">)))</span>\n</code></pre></div>\n<p>Overall, I think the main thing now that's slowly me down is struggling on how to understand the universe levels and how Lean infers from context which makes it hard to work with <code>Type*</code> (edit: not <code>Fintype</code>). (I first wrote <code> isFinitelyPresented_iff_fintype</code> with <code>\\a: Type</code> as well and found it pretty painful to figure out how to adapt it to <code>\\a: Type*</code> with <code>ULift</code>). </p>\n<p>If anyone has advice or references they could point me towards dealing with the above problem better that would be greatly appreciated! </p>\n<p>Incidentally, if anyone would like to give me some feedback my approach, refactoring, and whether the coding style matches that of mathlib, that would be greatly appreciated also.</p>",
        "id": 566812379,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767815763
    },
    {
        "content": "<p>Yikes that's a terrifying error message :-) </p>\n<p>I think I would be tempted to write <code>∃ (α : Type) (_ : Finite α) (f : FreeGroup α →* G)</code>. It's kind of scary to quantify over all universes, and typically I avoid <code>Fintype</code> when I can get away with <code>Finite</code> although maybe <code>Fintype</code> is easier, I'm not sure. <code>Fintype X</code> basically means \"a fixed bijection X &lt;-&gt; {1,2,...,n}\" (in particular it's data) whereas <code>Finite X</code> just means \"there exists a bijection...\".</p>",
        "id": 566813366,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1767816105
    },
    {
        "content": "<p>It's much easier for someone to give feedback on code if they can get the code compiling. Your code does not compile as it stands without other stuff before it, so people have to read it, they can't play with it, which is much more fun. Are you able to post the code which you want people to look at as a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> ?</p>",
        "id": 566813576,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1767816190
    },
    {
        "content": "<p>Oops, seems like I forgot to include the <code>import Mathlib</code> statement at the top. I edited the code to include it. When I copy-paste it now it should compile in the editor, but please let me know if it doesn't. (The later code snippets can just be pasted sequentially). </p>\n<p>Ok, understood for the <code>Finite</code> vs <code>Fintype</code>. The reason I chose <code>α : Type*</code> (edit: not <code>Fintype</code>) was for compatibility as <code>PresentedGroup</code> is defined using <code>\\a: Type*</code>, but maybe that's not quite the right way to think about it? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n\n<span class=\"sd\">/-- Given a set of relations, `rels`, over a type `α`, `PresentedGroup` constructs the group with</span>\n<span class=\"sd\">generators `x : α` and relations `rels` as a quotient of `FreeGroup α`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">rels</span>\n<span class=\"bp\">```</span>\n</code></pre></div>",
        "id": 566814509,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767816549
    },
    {
        "content": "<p>I just realized that I was saying I was struggling to work with <code>Fintype</code> when really I meant I was struggling to work with <code>Type*</code> and I think that was probably confusing. I've fixed the above comments for clarity.</p>",
        "id": 566820358,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767818731
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> I don't know if this helps, but I can get this to compile (I am using an explicit universe in the ARISTOTLE2 theorem). The last theorem is an alternative shorter approach but maybe not what you want?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">module</span>\n\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Presentation</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Finiteness</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">expose</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Group</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- The kernel of a homomorphism composed with an isomorphism is equal to the kernel of</span>\n<span class=\"sd\">the homomorphism mapped by the inverse isomorphism. -/</span>\n<span class=\"c1\">-- TODO not sure if this is the right abstraction / right name for this.</span>\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">comap_ker</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">comap_equiv_eq_map_symm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"sd\">/-- Definition of subgroup that is given by the normal closure of finitely many elements. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">H</span>\n\n<span class=\"sd\">/-- The above property is invariant under surjective homomorphism. -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hK</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"w\"> </span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hK</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map_normalClosure</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A finitely presented group is given by a surjective homomorphism from a free group on n</span>\n<span class=\"sd\">elements whose normal closure of its kernel is finitely generated. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"c1\">-- TODO calls to IsNormalClosureFG.map could be simplified? Like maybe using the iso functions.</span>\n<span class=\"w\">  </span><span class=\"c1\">-- seems like we apply a lot of `MonoidHom.ker_comp_mulEquiv + IsNormalClosureFG.map`.</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">ulift</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">equivFin</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE2</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">rcases</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">      </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hφ</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"n\">haveI</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hS</span><span class=\"bp\">.</span><span class=\"n\">fintype</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Subtype</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">φ</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hφ</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hφ</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hlift</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">φ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">val</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hsurj'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hlift</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hφ</span>\n<span class=\"w\">    </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hcl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">range_lift_eq_closure</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">range_eq_top</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">hsurj'</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hcl</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">finite_range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_fintype_ARISTOTLE2</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hkernel</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">fg_of_finitelyPresented'</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">-⟩</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hlift</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">val</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hsurj'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">lift</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hlift</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hsurj</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hcl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">range_lift_eq_closure</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">range_eq_top</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"n\">hsurj'</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hcl</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">finite_range</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"o\">)</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Group</span>\n</code></pre></div>",
        "id": 566920362,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1767871474
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> ! </p>\n<p>Do you mind explaining why <code>G</code> and <code>\\a</code> should live in the same type universe? <br>\n(Edit: is it because <code>FreeGroup \\a</code> is <code>Type u</code> and so is <code>G</code> its quotient?)</p>\n<p><code>instance {G : Type*} [Group G] [h : IsFinitelyPresented G]</code> could totally be made simpler! Aristotle had even come up with a more elementary proof, but I figured it would be a good test of my already written lemmas if they work as intended.</p>",
        "id": 566934375,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767876630
    },
    {
        "content": "<p>Ok, I think I answered by own question above! Let me spell out the reasoning because this is new to me: </p>\n<p>Starting with <code>variable {α : Type u}</code>, we have:</p>\n<ul>\n<li><code>FreeGroup (α : Type u) : Type u</code> from <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/GroupTheory/FreeGroup/Basic.html#FreeGroup\">#FreeGroup</a></li>\n<li>The quotient can be traced back to <code>Quot {\\b : Sort v} (r : \\b → \\b → Prop) : Sort v</code>. from <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Prelude.html#Quot\">#Quot</a></li>\n<li>Therefore, since <code>G = FreeGroup α / rels</code> where <code>rels</code> are a <code>Set: (α : Type u) : Type u</code> (<a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Set/Defs.html#Set\">#Set</a>), <code>G: Type u</code>.</li>\n</ul>\n<p>So yeah actually I think this helps a lot <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> ! I think I now have a better idea on how to reason about types <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span> .</p>",
        "id": 566940325,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767878550
    },
    {
        "content": "<p>Ok, maybe I'm overthinking it, but now I'm wondering if what I wrote above really stands when you have isomorphism instead of equality? As in, if <code>G ≃* FreeGroup α / rels</code>, then<code>MulEquiv : {M : Type u} → {N : Type v} → [Mul M] → [Mul N] → Type (max u v)</code> so <code>α</code> and <code>G</code> are allowed to be from different type universes. </p>\n<p>The reason I'm wondering this is that if I have the following <a href=\"https://live.lean-lang.org/#codez=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\">MWE</a>. </p>\n<p>We have <code>IsFinitelyPresented</code> group as an instance of <code>IsPresentedGroup</code> which I define as admitting an isomorphism from <code>G</code> to a <code>PresentedGroup</code>, but such an isomorphism doesn't force <code>\\a</code> to be of the same type as <code>G</code>.</p>\n<p>If I'm thinking of the <code>iff</code>statements above now as isomorphisms from <code>FreeGroup / \\a / rels</code> to <code>G</code> instead of straight equalities (which seems more flexible and general), it's not clear to me that <code>\\a</code> and <code>G</code> have to live in the same universe? </p>\n<p>However, in addition to the above <code>iff</code> statements breaking the (very wip) proof of <code>instance {G : Type*} [Group G] [h : IsFinitelyPresented G] : IsPresentedGroup G</code> breaks if I write <code>`G: Type*</code> and <code>\\a: Type*</code> instead of forcing them to live in the same universe (there's probably a way around that, but just wanted to point it out). </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">comap_ker</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">comap_equiv_eq_map_symm</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span>\n\n<span class=\"sd\">/-- Definition of subgroup that is given by the normal closure of finitely many elements. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">H</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">invariant_surj_hom</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hK</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"w\"> </span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hK</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">map_normalClosure</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"o\">]</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_finite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">    </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">      </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">ulift</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">invariant_surj_hom</span>\n<span class=\"w\">        </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">        </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">equivFin</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">      </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">invariant_surj_hom</span>\n<span class=\"w\">        </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsPresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">)</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">isFinitelyPresented_iff_finite</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfkernel</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSfinite</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hfkernel</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">IsPresentedGroup</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">S</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">QuotientGroup</span><span class=\"bp\">.</span><span class=\"n\">quotientKerEquivOfSurjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨?_⟩</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">hSclosure_equiv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">QuotientGroup</span><span class=\"bp\">.</span><span class=\"n\">quotientMulEquivOfEq</span><span class=\"w\"> </span><span class=\"n\">hSclosure</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">hSclosure_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">iso'</span>\n</code></pre></div>\n<p><strong>TLDR:</strong> I'm still unsure as to what should be left flexible in terms of universe levels vs what should be forced when defining isomorphism statements for <code>FinitelyPresentedGroups</code>. </p>\n<p>It seems like <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/GroupTheory/Finiteness.html#Group.FG\">#Group.FG</a> deals with this by defining everything inside the group itself, such as the statement <code>Group.fg_iff_exists_freeGroup_hom_surjective</code> using a surjection <code>FreeGroup S</code> where <code>S: Set G</code>, whereas <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/GroupTheory/PresentedGroup.html#PresentedGroup\">#PresentedGroup</a> defines a group in terms of a <code>FreeGroup \\a</code> where <code>\\a : Type*</code> and I'm not sure where <code>FinitelyPresentedGroup.lean</code> should sit in terms of flexibility of universe levels. Both have that the <code>FreeGroup</code> generators are of the same type as the group <code>G</code> though.</p>",
        "id": 566993166,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767892242
    },
    {
        "content": "<p>I agree with you that isomorphism (unlike equality) should not force the same universe (this goes against my code where I did fix the same universe, however that was just so that it compiles). In these cases, as far as I understand (which is not much), it would be preferable to find an alternative proof which does not require fixing universes. In the specific case of proving FP implies FG, I suppose the theorem <code>fg_of_finitelyPresented'</code> would do the job. I will also note that, in the case of FP groups, because of the finiteness assumption, one can always have generators be of Type 0, so that overall the different universes level don't matter too much in this case.<br>\nWhat I mean is one can prove</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- If `α` and `rels` are finite, then `PresentedGroup rels` is finitely presented. -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">finitelyPresented_of_finite</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">-- Choose `Fin n` equivalent to `α`.</span>\n<span class=\"w\">  </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">exists_equiv_fin</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">eα</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">eα</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"c1\">-- Continues...</span>\n</code></pre></div>\n<p>So you can have <code>α : Type u</code> and <code>Fin n : Type 0</code> and still form <code>α ≃ Fin n</code></p>",
        "id": 566997011,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1767893407
    },
    {
        "content": "<blockquote>\n<p>In these cases, as far as I understand (which is not much), it would be preferable to find an alternative proof which does not require fixing universes. In the specific case of proving FP implies FG, I suppose the theorem <code>fg_of_finitelyPresented'</code> would do the job.</p>\n</blockquote>\n<p>It's a nice proof! My concern is that if the current statements can't be used to prove simple desired facts about FP groups, then there is a problem with the statements which need to be fixed before PR'ing to mathlib since other people might run into the same issues in the future, which is why I prefer to use them to show other simple statements and see if something breaks. </p>\n<blockquote>\n<p>I will also note that, in the case of FP groups, because of the finiteness assumption, one can always have generators be of Type 0, so that overall the different universes level don't matter too much in this case.</p>\n</blockquote>\n<p>Mhm, this is going in line with what Kevin was saying about using <code>\\a: Type</code>. I think I'll go with this for now since it seems like it might fix the problem in a way that makes the statements more robust to use.  </p>\n<p>Thanks a lot for the discussion <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span>! This really helped me get a better sense of what to do next.</p>",
        "id": 567020834,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1767901919
    },
    {
        "content": "<p>I agree with Kevin that the universe polymorphism was the scary bit here; essentially the error is happening because in</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">isFinitelyPresented_iff_fintype</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>when you try to apply this lemma from the left to right, Lean will know what <code>G</code> should be and therefore which universe it should be in. But it doesn't know what the universe variable corresponding to <code>α</code> should be, so you get the error  \"<code>contains universe level metavariables</code>\"</p>",
        "id": 567167719,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1767972655
    },
    {
        "content": "<p>Perhaps the simplest fix for this is just <code>...↔ ∃ (n : \\N) (f : FreeGroup (Fin n) →* G)</code></p>",
        "id": 567241440,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1767984445
    },
    {
        "content": "<p>Hi everyone! Thanks for the help. I've made some significant changes to the code since which I believe makes everything feel \"smoother\" and at the same time is more in line with what <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span>  and I were thinking mathematically. Of course, feel free to chime in if you have feedback / reservations on this approach. </p>\n<p>Here's how the code looks like now <a href=\"https://live.lean-lang.org/#codez=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\">MWE</a>, also found here: <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup</a></p>\n<p>Basically, I decided to define a <code>FinitelyPresentedGroup</code> using the existing <code>PresentedGroup</code> with finiteness conditions on <code>\\a: Type</code> and the relations. Then, a group <code>IsFinitelyPresented</code> and <code>IsPresented</code> if you can find an isomorphism to the appropriate (Finitely)Presented group. (This is the literal definition of (finitely) presented group I'm used to in geometric group theory). </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"o\">)</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">IsPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Using this, you can recover that a group that <code>IsFinitelyPresented</code> is also a <code>Group.FG</code>, and also <code>IsFinitelyPresented</code> is <code>IsPresented</code> via using a <code>ULift</code> on <code>\\a</code> since <code>PresentedGroup</code> was defined using <code>\\a: Type*</code> instead of <code>\\a: Type</code>. <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/GroupTheory/PresentedGroup.html#PresentedGroup\">#PresentedGroup</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">FG</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"bp\">.</span><span class=\"n\">fg_iff_exists_freeGroup_hom_surjective_finite</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hrels</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">iso</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">iso</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">iso</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hα</span>\n<span class=\"w\">  </span><span class=\"c1\">-- TODO probably a nicer way to do this.</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">QuotientGroup</span><span class=\"bp\">.</span><span class=\"n\">mk'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">iso'</span>\n<span class=\"w\">  </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iso'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">QuotientGroup</span><span class=\"bp\">.</span><span class=\"n\">mk'_surjective</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">)))</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hrels</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">iso</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">ULift</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">rels</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ULift</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">ulift</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PresentedGroup</span><span class=\"bp\">.</span><span class=\"n\">equivPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n</code></pre></div>\n<p>Finally, it was easy to recover the lemma that a <code>PresentedGroup</code> <code>IsFinitelyPresented</code>, which was the last lemma that we wrote with <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> during the workshop! </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">FPgroup</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">MulEquiv</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_⟩</span>\n</code></pre></div>\n<p>Overall, this code felt a lot easier to write and work with due to the notion of isomorphism being natural here (although this might also be due that I'm getting more in the flow of things now), and thanks to <code>\\a: Type</code>, I haven't had to use universe constraints unlike the previous version (although given <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> 's insight, maybe it isn't so bad to use that <code>\\a</code> and <code>G</code> are in the same type universe?)</p>\n<p>Edit: I thought a bit further about why the isomorphism to a <code>FinitelyPresentedGroup</code> approach for <code>IsFinitelyPresented</code> seems to work better apart from being more literal, and I think it's because when a <code>FinitelyPresentedGroup</code> <code>G</code> is defined as a <code>PresentedGroup</code> <code>G</code>, it naturally acquires the type <code>\\a</code> since <code>G = FreeGroup \\a / normalClosure rels</code> where <code>rels : Set (FreeGroup \\a)</code>. On the other hand, when we write <code>IsFinitelyPresented</code> as <code>\\exists \\a: Type</code> and a surjective map <code>f: FreeGroup \\a to* G</code> such that <code>f.ker</code> is finitely generated, since <code>MonoidHom</code> allows <code>FreeGroup \\a</code> and <code>G</code> to be different types, we have to specify that <code>\\a</code> and <code>G</code> live in the same type universe to get the same result. </p>\n<p>What I would like to do next (if the above seems reasonable) is work out some more simple examples of <code>FinitelyPresentedGroup</code>s and then write a <code>FinitelyPresentedGroup.toPresentation</code> function with <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> and then pass it along to him.</p>",
        "id": 567283058,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768007149
    },
    {
        "content": "<p>More update: </p>\n<p>The <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">latest commit</a> (which can also be found <a href=\"https://live.lean-lang.org/#codez=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\">here</a>) has compiling proofs of the following statements: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> Every FP group is FP -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">FPgroup</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> Trivial group is FP -/</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">instTrivial</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Unit</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> ℤ is finitely presented -/</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">Int</span><span class=\"bp\">.</span><span class=\"n\">instFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> FP groups are closed under isomorphism -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">of_mulEquiv</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">]</span>\n<span class=\"o\">(</span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">H</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>",
        "id": 567296056,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768024398
    },
    {
        "content": "<p>Random idea after not sleeping, but would a classification on of <code>PresentedGroup</code>s based on their presentations be something welcome in mathlib? Something like this (<a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCM4ChcAmApgGZwBiwAdsDEegJ4AKURAzkVXQQOJQQBXMHADegRuA4ALjgAVBmCIBfOAG1KNOnDEBdOAApW6NlLgBlIvD3lWRPoOFiAlI9x6A+qhOG2AOnW0iRykAXjgWdk5uOyF9bxdcajYYJCoAYyJ9CWk5BSC1agCtXQN6Y2lzS2siW34YpyC9T2lvPwK6IMlcaOErNvpmVg4uIl5a4W84VA7g3Dg4AEUBCBhgSO6fReXVrh8AczG4N3xU9CQ2YwBJNn86RnCh7n0eExyiACo87rgeXWkWCGEAHdUERWLM4IIYNJAMBEmRe8kC+jc0huGScsVKJgq+iqNXsWmc+iacBaqMcABpwQA5CBUIjgGAMJ5wQDCRG8cX07oNIiMvhMpvETmdLmwAPJ0gBK9BQ0GZ2QRH1UXx+Jn+QJBYLmkJMsL0WVkCoaE3KFhxNi+9SJxpJpVaGkClLmTrgNLpDKZemebLC3OGo3xcTggHIicHO1AtGAQdQcGA+VJIKAEOChACMQA\">here</a> is a MWE)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsOneRelator</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hrels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">      </span><span class=\"n\">hrels</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>but replace other types of classes of groups from presentation with <code>OneRelator</code> (ex: Artin).</p>",
        "id": 567304234,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768035095
    },
    {
        "content": "<p>Can you prove that a group <code>G</code> if finitely presented if and only if there is a surjective morphism <code>FreeGroup (Fin n) →* G</code>?If you can prove this I think that the actual definition doesn't matter.</p>",
        "id": 567304577,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1768035524
    },
    {
        "content": "<p>That's not true right? That's finitely generated</p>",
        "id": 567307242,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768038740
    },
    {
        "content": "<p>Sorry, plus the condition on the kernel.</p>",
        "id": 567307269,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1768038760
    },
    {
        "content": "<p>Yes, all that matters is that you can prove that the definition coincides with any sensible characterisation</p>",
        "id": 567307622,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768039132
    },
    {
        "content": "<p>I see three equivalent formulations for a group <code>G</code>:</p>\n<ul>\n<li>there is a <code>n</code> and a surjective <code>FreeGroup (Fin n) →* G</code> with kernel finitely presented (in the sense of normal closure)</li>\n<li>There is a <code>S : Finset G</code> and a surjective <code>FreeGroup S →* G</code> with kernel finitely presented</li>\n<li>There is a type <code>T</code> with <code>Fintype T</code> and a surjective <code>FreeGroup T →* G</code> with kernel finitely presented. Here it would be nice to prove one direction with <code>T : Type</code> (just take <code>Fin n</code>), but the other one should hold for <code>T : Type u</code>.</li>\n</ul>\n<p><span class=\"user-mention\" data-user-id=\"1004097\">@Hang Lu Su</span> once we have these characterizations we can forget about what is the actual definition.</p>",
        "id": 567311236,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1768042928
    },
    {
        "content": "<blockquote>\n<ul>\n<li>There is a <code>S : Finset G</code> and a surjective <code>FreeGroup S →* G</code> with kernel finitely presented</li>\n</ul>\n</blockquote>\n<p>I don't think you want this. It is not \"a random map <code>FreeGroup S →* G</code>\", it is \"the canonical map <code>FreeGroup S →* G</code>\". And also you don't want the kernel finitely presented, you want the kernel finitely-generated.</p>",
        "id": 567331134,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768062371
    },
    {
        "content": "<p>Ah yes, we surely want the canonical map. And I mean finitely generated yes, sorry (but using the normal closure, not the notion in mathlib).</p>",
        "id": 567350494,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1768083005
    },
    {
        "content": "<blockquote>\n<p>there is a <code>n</code> and a surjective <code>FreeGroup (Fin n) →* G</code> with kernel finitely presented (in the sense of normal closure)</p>\n</blockquote>\n<p>I managed to prove this first one! The latest commit is <a href=\"https://github.com/leanprover-community/mathlib4/commit/dfc4fd357be2d05f75fba2d0b9a49bc44e62e9ac\">here</a> and it compiles!</p>\n<p>Edit: For clarity, the two added iff statements for which the proofs compile are: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">iff_hom_surj_finite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">iff_hom_surj_fin_n</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 567352202,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768085771
    },
    {
        "content": "<p>This is great! Can you prove the right to left arrow in the first theorem for <code>α</code> in <code>Type*</code>? It shouldn't be hard since <code>α</code> is finite.</p>",
        "id": 567352589,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1768086195
    },
    {
        "content": "<p>Done! This compile in context and I made the <a href=\"https://github.com/leanprover-community/mathlib4/commit/bdda1f1d48a8e19a601e056ef35f4393253ab501\">commit</a>. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">implied_by_hom_surj_finite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"o\">(</span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hfker</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">iff_hom_surj_fin_n</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"c1\">-- TODO considering refactoring this since it seems used for the second time.</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">α</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">FreeGroup</span><span class=\"bp\">.</span><span class=\"n\">freeGroupCongr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">equivFin</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→*</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">hf'surj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hfsurj</span><span class=\"bp\">.</span><span class=\"n\">comp</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">surjective</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hf'ker</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsNormalClosureFG</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">f'</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MonoidHom</span><span class=\"bp\">.</span><span class=\"n\">ker_comp_mulEquiv</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span>\n<span class=\"w\">    </span><span class=\"n\">IsNormalClosureFG</span><span class=\"bp\">.</span><span class=\"n\">invariant_surj_hom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">toMonoidHom</span><span class=\"w\"> </span><span class=\"n\">iso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">hfker</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf'surj</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf'ker</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 567354091,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768088439
    },
    {
        "content": "<p>Onto the last of Riccardo's statements! </p>\n<blockquote>\n<blockquote>\n<ul>\n<li>There is a <code>S : Finset G</code> and a surjective <code>FreeGroup S →* G</code> with kernel finitely presented</li>\n</ul>\n</blockquote>\n<p>I don't think you want this. It is not \"a random map <code>FreeGroup S →* G</code>\", it is \"the canonical map <code>FreeGroup S →* G</code>\". And also you don't want the kernel finitely presented, you want the kernel finitely-generated.</p>\n</blockquote>\n<p>Could someone confirm to me if there's already a usual mathlib way to write the <code>canonical map FreeGroup S →* G?</code></p>\n<p>Edit: Is it <code>FreeGroup.lift (fun s =&gt; (s : G))</code>?</p>",
        "id": 567354589,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768089301
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FreeGroup.lift#doc\">docs#FreeGroup.lift</a></p>",
        "id": 567357275,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768093389
    },
    {
        "content": "<p>Yes that looks like the canonical group homomorphism (although usually we use <code>\\mapsto</code> rather than <code>=&gt;</code> in mathlib)</p>",
        "id": 567357303,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1768093438
    },
    {
        "content": "<p>Just had a very productive Zoom meeting with <span class=\"user-mention\" data-user-id=\"1004251\">@Valerio Proietti</span> about what we're planning next! We concluded <code>FinitelyPresented</code> and <code>Presentation</code> can work independently with bridge functions between them so one can pass from a <code>PresentedGroup</code> to a <code>Presentation</code> and vice-versa. </p>\n<p>As for the PR plan, it's now as follows: </p>\n<ul>\n<li>I will PR my <code>FinitelyPresentedGroup.lean</code> file with the statements about finitely presented groups from my <a href=\"https://github.com/leanprover-community/mathlib4/compare/master...homeowmorphism:mathlib4:FinitelyPresentedGroup\">branch</a>.</li>\n<li>Valerio will PR his <code>Presentation.lean</code> file with the statements about presentations from his <a href=\"https://github.com/leanprover-community/mathlib4/pull/33233/files\">branch</a>.</li>\n<li>As a third PR, we will submit code which bridges the two. This code is pretty minimal and Valerio has mostly already done the work in this regard, which can be found in his <code>FinitelyPresented.lean</code> file on his <a href=\"https://github.com/leanprover-community/mathlib4/pull/33233/files\">branch</a>. </li>\n</ul>\n<p>We thought this might be better as we can work mostly independently of one another which seems easier to coordinate since we are in different locations. Moreover, that way it is clear who has technical ownership of what in case we need to make a call on how to do something (although obviously we welcome the feedback on the maintainers to guide us).</p>",
        "id": 567565752,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1768231572
    },
    {
        "content": "<p>Hi! After encouragement by <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span>, I finally went ahead and made the draft PR for my part of the project. <a href=\"https://github.com/leanprover-community/mathlib4/pull/34236\">https://github.com/leanprover-community/mathlib4/pull/34236</a></p>\n<p>This PR includes the notion of <code>IsPresented</code> and <code>IsFinitelyPresented</code> via isomorphism with a <code>(Finitely)PresentedGroup</code> and satisfies the three equivalent formulations posed by <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> . I've also included some auxiliary results for this and some instances of finitely presented groups. </p>\n<p>I included some comments within the code of what's still a work in progress imo. It's nothing that doesn't compile, but little notes to myself on what I'd like to do better in the future. I must also admit that while I did the mathematical reasoning by myself and tried to write code that is transparent in terms of human understanding, in terms of being able to write code more efficiently I did resort to vibe-coding when it came to some of the substatements in the proofs (with this context, please feel free to question my code as it will probably help me improve a lot). </p>\n<p>I would really welcome feedback on this. Specifically, I would appreciate feedback on: </p>\n<ul>\n<li>I'm not sure why my code is failing the tests <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span>. It says </li>\n</ul>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">non</span><span class=\"bp\">-</span><span class=\"ss\">`module</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"ss\">`module</span><span class=\"bp\">`</span>\n</code></pre></div>\n<p>but I'm not sure why it tried to auto-import this as a module in the first place? (in the file <code>Mathlib.lean</code>)</p>\n<ul>\n<li>Factoring this PR. I was told the average length of a PR is usually 100 lines (this clearly got out of hand). There are auxiliary results that I'm happy to factor into other PR dependencies. </li>\n<li>Factoring proofs sub-steps. I found many proofs had a repetitive pattern. </li>\n<li>Code clarity and mathlib best practices. </li>\n<li>More 1-1 discussion on <code>\\a: Type*</code> vs <code>\\a: Type</code> in terms of usability now that I (think) I understand what went wrong in terms of type inference. </li>\n<li>Anything else you can think of. </li>\n</ul>\n<p>PS: sorry for disappearing last week right after having a wind of productivity and announcing the PR. I had the flu but I'm recovered.</p>",
        "id": 569543326,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769101107
    },
    {
        "content": "<p>I think all the CI errors can be fixed as follows:</p>\n<p>1) The second line should start <code>Copyright (c) 2025 Hang Lu Su...</code> (the error says \"you wrote Hang but I was expecting a number\")</p>\n<p>2) The file should start</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">copyright</span><span class=\"w\"> </span><span class=\"n\">notice</span><span class=\"o\">]</span>\n<span class=\"n\">module</span>\n\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">blah</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">blah</span><span class=\"bp\">.</span><span class=\"n\">blah</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n\n<span class=\"cm\">[module docstring]</span>\n\n<span class=\"cm\">-/</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">expose</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n</code></pre></div>\n<p>Just look at any other file in mathlib to see the correct syntax.</p>",
        "id": 569553827,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769104008
    },
    {
        "content": "<p>It now passes more checks but still has the following error</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">non</span><span class=\"bp\">-</span><span class=\"ss\">`module</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"ss\">`module</span><span class=\"bp\">`</span>\n</code></pre></div>\n<p>I tried a <a href=\"https://github.com/leanprover-community/mathlib4/pull/34236/commits/bf2c719fc2783dcd879fcb78d56e98db9f477b36\">commit</a> where I changed the <code>public import Mathlib.Algebra.Group.Defs</code>in to </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Exponent</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">FiniteAbelian</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">FiniteAbelian</span><span class=\"bp\">.</span><span class=\"n\">Duality</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Finiteness</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">FixedPointFree</span>\n<span class=\"n\">public</span><span class=\"w\"> </span><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">Frattini</span>\n</code></pre></div>\n<p>and it solved the problem in the file containing that import statement, but then returned the same error in another file containing the importing definitions line. </p>\n<p>Is there a better way to get rid of the error than to repeat this process in every file containing the def import?</p>",
        "id": 569586164,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769115005
    },
    {
        "content": "<p>You need to put the <code>module</code> keyword at the top of your Mathlib/GroupTheory/FinitelyPresentedGroup.lean file as Kevin showed in his template.</p>",
        "id": 569586797,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1769115245
    },
    {
        "content": "<p>The error is about the file FinitelyPresentedGroup.lean, that should start with <code>module</code>, have the import <code>public</code> and have then <code>@[expose] public section</code>. You can copy any other file, they are all more or less the same (ignore non public <code>import</code> for the moment).</p>",
        "id": 569586825,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769115251
    },
    {
        "content": "<p>There is no need to touch any other file (except <code>Mathlib.lean</code>), you should revert that changes</p>",
        "id": 569586899,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769115284
    },
    {
        "content": "<p>Thank you Kevin, Henrik and Riccardo for the help! And sorry I did not the first line of instruction properly in the first place. </p>\n<p>The errors have now disappeared with the exception of this </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span><span class=\"cm\"> The `unusedArguments` linter reports:</span>\n<span class=\"cm\">UNUSED ARGUMENTS. -/</span>\n<span class=\"c1\">-- Mathlib.GroupTheory.FinitelyPresentedGroup</span>\n<span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">actions</span><span class=\"bp\">-</span><span class=\"n\">runner</span><span class=\"bp\">/_</span><span class=\"n\">work</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">mathlib4</span><span class=\"bp\">/</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">branch</span><span class=\"bp\">/</span><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">GroupTheory</span><span class=\"bp\">/</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">197</span><span class=\"o\">:</span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"bp\">✝</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span>\n<span class=\"w\">  </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">✝</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">status</span><span class=\"bp\">=</span><span class=\"mi\">1</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"n\">arguments'</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">lake</span><span class=\"bp\">/</span><span class=\"n\">lint_output_attempt_1</span><span class=\"bp\">.</span><span class=\"n\">txt</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"o\">[</span><span class=\"bp\">'</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">eq</span><span class=\"w\"> </span><span class=\"mi\">124</span><span class=\"w\"> </span><span class=\"bp\">'</span><span class=\"o\">]</span><span class=\"bp\">'</span>\n<span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"n\">Error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Process</span><span class=\"w\"> </span><span class=\"n\">completed</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"w\"> </span><span class=\"n\">code</span><span class=\"w\"> </span><span class=\"mf\">1.</span>\n</code></pre></div>\n<p>I think the problem is that the linter doesn't like the way I've defined <code>FinitelyPresentedGroup</code> in my code: </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A finitely presented group is defined as a presented group with generators of a finite type</span>\n<span class=\"sd\">and finite relations. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span>\n<span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">)</span>\n<span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I defined a finitely presented group as a presented group with generators <code>\\a</code> of finite type and a finite hypothesis on the set of relations <code>_ : rels.Finite</code>. In the info view, it didn't like when I wrote the hypothesis as <code>h : rels.Finite</code> but the error went away when I changed it to <code>_</code>. However, it seems like the CI still has a problem with this. </p>\n<p>Is there a different formulation that could get rid of this error? I'm happy to define <code>FinitelyPresentedGroup</code> apart from <code>PresentedGroup</code> separately if needs be as the definition is quite straightforward. My thought process was just to try and make compatible what's already existing. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Given a set of relations, `rels`, over a type `α`, `PresentedGroup` constructs the group with</span>\n<span class=\"sd\">generators `x : α` and relations `rels` as a quotient of `FreeGroup α`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">Subgroup</span><span class=\"bp\">.</span><span class=\"n\">normalClosure</span><span class=\"w\"> </span><span class=\"n\">rels</span>\n</code></pre></div>",
        "id": 569729658,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769178732
    },
    {
        "content": "<p>You can just tell the linter to ignore this. I don't remember exactly the syntax, isn't it written in the error?</p>",
        "id": 569729938,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769178809
    },
    {
        "content": "<p>Something like \"this linter can be turned off by...\"</p>",
        "id": 569730019,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769178833
    },
    {
        "content": "<p>The linter doesn't say anything is wrong in the infoView when I use <code>_</code> for the hypothesis just the CI when I try to PR the code. Do you mean I should use the error I get with <code>h</code> as the hypothesis? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unused</span><span class=\"w\"> </span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"ss\">`h</span><span class=\"bp\">`</span>\n\n<span class=\"n\">Note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedVariables</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n</code></pre></div>",
        "id": 569730398,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769178930
    },
    {
        "content": "<p>The linter is telling you that the definition makes sense without assuming  that <code>rels</code> is finite and usually we prefer to make definition as general as possible. In this case I think you can just write</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedVariables</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n</code></pre></div>\n<p>before the declaration.</p>",
        "id": 569731032,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769179105
    },
    {
        "content": "<p>It is like if you say \"a finite group is simple if it has no nontrivial normal subgroups\". The linter would say \"well, you can make the same definition for any group, no need to assume that is finite\".</p>",
        "id": 569731316,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769179179
    },
    {
        "content": "<p>This fix still returns the same error for some reason? </p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34236/commits/1968c14113204786dbc74b8e4e215e110bc6be70\">https://github.com/leanprover-community/mathlib4/pull/34236/commits/1968c14113204786dbc74b8e4e215e110bc6be70</a></p>",
        "id": 569738636,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769180906
    },
    {
        "content": "<p>Mmm, I am not at the computer at the moment, but you can try to not name the argument (use an underscore). Otherwise just do Ctrl + shift + f and look for the line <code>set_option blahblahlinter false</code> in mathlib and copy the syntax.</p>",
        "id": 569747736,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769183312
    },
    {
        "content": "<p>Why do you want this definition anyway?</p>\n<p>The point of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PresentedGroup#doc\">docs#PresentedGroup</a> is \"I have a bunch of relations in a free group on some generators and I want to make the corresponding group defined by these generators and relations\".</p>\n<p>So the point of your <code>FinitelyPresentedGroup</code> must be \"I have a finite bunch of relations in a free group on finitely many generators and I want to make the corresponding group defined by these generators and relations\" -- but you can <em>already do this</em>, just using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PresentedGroup#doc\">docs#PresentedGroup</a>.</p>\n<p>That's what the linter is telling you. It's saying \"the thing you're trying to make is something you can already make\".</p>",
        "id": 569750514,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769184042
    },
    {
        "content": "<blockquote>\n<p>Why do you want this definition anyway?</p>\n</blockquote>\n<p>I guess there are two answers to this question, which may or may not be \"good\" reasons: </p>\n<ol>\n<li>Because finitely presented groups are \"special\" in geometric group theory, so being able to have a constructor for this specifically seems nice in the sense that it's a guarantee the user has defined a finitely presented group, and not just a presented group (but perhaps not necessary). </li>\n<li>Because the way that I defined <code>IsFinitelyPresented</code> is by saying that a group is finitely presented if it admits an isomorphism to a finitely presented group </li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FinitelyPresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>I suppose I can try defining <code>IsFinitelyPresented</code> as a presented group with the finiteness conditions as well. Let me try that and see what happens.</p>",
        "id": 569760917,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769186913
    },
    {
        "content": "<p>It breaks a lot of proofs but it isn't unfixable of course. It will just take more time to PR, and I sort of believe in point 1, but if someone strongly believes there shouldn't be a special constructor for <code>FinitelyPresentedGroup</code> I can make a commit where I fix this problem.</p>",
        "id": 569764446,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769187904
    },
    {
        "content": "<p>This is exactly the same, right?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 569764478,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769187912
    },
    {
        "content": "<p>This has the same issue that now <code>h</code> is unused. </p>\n<p>I tried with </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- A group is finitely presented if it admits an isomorphism to a finitely presented group. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">IsFinitelyPresented</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">out</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rels</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FreeGroup</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)),</span>\n<span class=\"w\">  </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">≃*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PresentedGroup</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">rels</span><span class=\"bp\">.</span><span class=\"n\">Finite</span>\n</code></pre></div>\n<p>which is what breaks the proofs.</p>",
        "id": 569764739,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769187986
    },
    {
        "content": "<p>Don't worry about the unused variable linter, it is just a warning and we can turn it off.</p>",
        "id": 569764845,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769188013
    },
    {
        "content": "<p>Surely in Riccardo's definition h is being used!</p>",
        "id": 569764954,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769188046
    },
    {
        "content": "<p>Well I tried this first but it returned this in the infoView</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">unused</span><span class=\"w\"> </span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"ss\">`h</span><span class=\"bp\">`</span>\n\n<span class=\"n\">Note</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"w\"> </span><span class=\"n\">can</span><span class=\"w\"> </span><span class=\"n\">be</span><span class=\"w\"> </span><span class=\"n\">disabled</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"ss\">`set_option</span><span class=\"w\"> </span><span class=\"n\">linter</span><span class=\"bp\">.</span><span class=\"n\">unusedVariables</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"bp\">`</span>\n</code></pre></div>\n<p>But I can try to commit this and see what the CI thinks.</p>",
        "id": 569765203,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769188122
    },
    {
        "content": "<p>this is just about the name</p>",
        "id": 569765367,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769188178
    },
    {
        "content": "<p>anyway, if only need <code>FinitelyPresentedGroup</code> to define <code>IsFinitelyPresented</code> I agree with Kevin that you go directly with <code>IsFinitelyPresented</code>.</p>",
        "id": 569765546,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769188224
    },
    {
        "content": "<p>Objection 1: I know finitely presented groups are special but that specialness comes up in the <em>proofs</em>, not in the definition itself. It's like how we define a group ring R[G] but when you look at the <em>definition</em> of a group ring in lean, G isn't assumed to be a group and R isn't assumed to be a ring, those assumptions come later on in the code. This is the formalisation philosophy.</p>\n<p>The solution to 2 is given by Riccardo.</p>",
        "id": 569765703,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769188270
    },
    {
        "content": "<p>Thank you both for the help and explaining the philosophy behind this. </p>\n<p>I made the commit using Riccardo's solution with the <code>_</code> variable name and it now passes the checks! <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 569770065,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1769189572
    },
    {
        "content": "<p>I've been factoring this project into dependencies and I GOT MY FIRST PR MERGED!!! </p>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34580\">https://github.com/leanprover-community/mathlib4/pull/34580</a></p>\n<p><span aria-label=\"dancer\" class=\"emoji emoji-1f483\" role=\"img\" title=\"dancer\">:dancer:</span> </p>\n<p>A big thank you again to everyone for continued support. <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span></p>",
        "id": 571726114,
        "sender_full_name": "Hang Lu Su",
        "timestamp": 1770141007
    },
    {
        "content": "<p>Following the redistribution of tasks, I changed my (draft) PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/33233\">#33233</a> accordingly. Now it only deals with the notion of presentations and the Tietze transformations. I have implemented 2/4 Tietze moves (adding/removing a relator). I have working code for the remaining two but probably not super polished now so perhaps it's for another PR. If anybody wants to have a look, I'd appreciate it as I am new to this process.</p>",
        "id": 573506479,
        "sender_full_name": "Valerio Proietti",
        "timestamp": 1770899060
    }
]