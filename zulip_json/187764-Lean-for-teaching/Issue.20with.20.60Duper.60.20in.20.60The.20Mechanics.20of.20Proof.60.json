[
    {
        "content": "<p>Maybe there is a quick fix for this weird emergent problem. I'm teaching using <a href=\"https://hrmacbeth.github.io/math2001/\">Heather Macbeth's book</a> , and everything was going very well. Suddenly, though, on my local machine the import for the <code>exhaust</code> tactic failed. If I comment out this import, things work fine (actually, there is an autograder import that also needs to be removed, but I can live without that because my class is small). The students don't have this trouble (yet), so I expect the problem might be something that I did.  I believe the problem is a mismatch of something with <code>Duper</code>, as in the lakefile for my fork of this repo I have </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">mathlib</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover-community/mathlib4\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"n\">s!</span><span class=\"s2\">\"v{Lean.versionString}\"</span>\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">Duper</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/hrmacbeth/duper\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n<span class=\"n\">require</span><span class=\"w\"> </span><span class=\"n\">autograder</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/robertylewis/lean4-autograder-main\"</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"w\"> </span><span class=\"s2\">\"864b34ce06d8536aec0c38e57448c17d1f83572a\"</span>\n</code></pre></div>\n<p>I've tried changing this local version of Duper to the leanprover-community one, but that didn't work. I've also deleted the repo and re-cloned it, and the problem persists. Has anyone had an issue like this?  If so, what's the repair?</p>",
        "id": 511407415,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744290970
    },
    {
        "content": "<p>If you've deleted and recloned, can you give a more precise repro? i.e. \"open this file, add this import, it should work, but I get this error\"?</p>",
        "id": 511413637,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744292359
    },
    {
        "content": "<p>OK. I deleted and recloned. If I open the file <code>Math2001/Homework/hw9.lean</code> and comment out <code>import AutograderLib</code> and <code>import Library.Tactic.Exhaust</code> things work. If I leave these in then I get the following (too large for comment so I have truncated) error that begins:</p>\n<p><code>/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lake print-paths Init Mathlib.Data.Real.Basic Library.Basic Library.Tactic.Exhaust Library.Tactic.ModEq AutograderLib</code> failed:</p>\n<p>stderr:<br>\ninfo: [614/898] Building Duper.Order<br>\ninfo: [617/913] Building Duper.DUnif.UnifProblem<br>\ninfo: [631/925] Building Duper.Util.AbstractMVars<br>\nerror: &gt; LEAN_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib DYLD_LIBRARY_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib:./.lake/packages/Duper/.lake/build/lib /Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean -Dlinter.unusedVariables=false ./.lake/packages/Duper/././Duper/DUnif/UnifProblem.lean -R ./.lake/packages/Duper/./. -o ./.lake/packages/Duper/.lake/build/lib/Duper/DUnif/UnifProblem.olean -i ./.lake/packages/Duper/.lake/build/lib/Duper/DUnif/UnifProblem.ilean -c ./.lake/packages/Duper/.lake/build/ir/Duper/DUnif/UnifProblem.c --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-LazyList-1.dylib<br>\nerror: stderr:<br>\nlibc++abi: terminating due to uncaught exception of type lean::exception: error loading library, dlopen(./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib, 0x0009): tried: './.lake/packages/std/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/usr/lib/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file, not in dyld cache), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/std/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libDuper-Util-MessageData-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (no such file), '/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-MessageData-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag)<br>\nerror: external command <code>/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean</code> exited with code 134<br>\nerror: &gt; LEAN_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib DYLD_LIBRARY_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib:./.lake/packages/Duper/.lake/build/lib /Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean -Dlinter.unusedVariables=false ./.lake/packages/Duper/././Duper/Order.lean -R ./.lake/packages/Duper/./. -o ./.lake/packages/Duper/.lake/build/lib/Duper/Order.olean -i ./.lake/packages/Duper/.lake/build/lib/Duper/Order.ilean -c ./.lake/packages/Duper/.lake/build/ir/Duper/Order.c --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Reduction-1.dylib --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Expr-1.dylib<br>\nerror: stderr:<br>\nlibc++abi: terminating due to uncaught exception of type lean::exception: error loading library, dlopen(./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib, 0x0009): tried: './.lake/packages/std/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--...<br>\n`</p>",
        "id": 511415270,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744292698
    },
    {
        "content": "<p><del><code>@ s!\"v{Lean.versionString}\"</code> doesn't look particularly sensible to me</del> I guess that's upstream though</p>",
        "id": 511416843,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1744293050
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"462733\">@Jon Bannon</span> I just did a fresh clone of this repo, ran <code>lake exe cache get</code> and open <code>hw9.lean</code> without issue (after it built the files leading up to it).</p>",
        "id": 511417025,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293083
    },
    {
        "content": "<p>What version of <code>elan</code> do you have?</p>",
        "id": 511417494,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293184
    },
    {
        "content": "<p><code>elan --version</code> (mine: <code>4.0.0</code>)</p>",
        "id": 511417504,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293188
    },
    {
        "content": "<p>Me too: <code>git clone &lt;repo&gt;</code>, <code>lake exe cache get</code>, <code>lake build</code> (runs mostly without errors), I open the file and it's fine. I'm on <code>elan 4.0.0</code>. (<code>elan self update</code> if you're not)</p>",
        "id": 511417668,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744293233
    },
    {
        "content": "<p>Kevin, this is on a really old version of the Lean toolchain (<code>4.3.0</code>), so the errors don't all collect at the end. You got no errors at all?</p>",
        "id": 511418357,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293400
    },
    {
        "content": "<p>(try running <code>lake build</code> again)</p>",
        "id": 511418399,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293413
    },
    {
        "content": "<p>You're right -- scrolling up a I see a few errors, but the file in question was fine. I was misled by there being no reporting at the end of the form \"here are the files with errors\" but as you say this is because it's an old version of Lean. I'll edit.</p>",
        "id": 511418685,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744293485
    },
    {
        "content": "<p>The first file to error for me is <code>Math2001/09_Sets/02_Set_Operations.lean</code> and when you open it, it's failing at the <code>check_equality_of_explicit_sets</code> tactic, just saying that it failed to rule out other cases.</p>",
        "id": 511419228,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744293605
    },
    {
        "content": "<p>I'm away from my computer, but I expect my elan version is wrong.</p>",
        "id": 511419480,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744293656
    },
    {
        "content": "<p>Strange. My elan version is <code>elan 4.0.0 (bb75b50d2 2025-01-30)</code></p>",
        "id": 511438798,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744298147
    },
    {
        "content": "<p>I deleted the repo again, and then cloned Heather's : <a href=\"https://github.com/hrmacbeth/math2001\">https://github.com/hrmacbeth/math2001</a></p>\n<p>There, her hw 9 doesn't use exhaust, but the file Jireh mentioned : </p>\n<p><code>Math2001/09_Sets/02_Set_Operations.lean</code></p>\n<p>won't compile for me if I don't comment out the <code>Exhaust</code> import, as above.</p>",
        "id": 511443788,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744299311
    },
    {
        "content": "<p>Oh so we're not cloning the same repo?? So your question is \"I changed the repo and then it broke and I'm asking why but I'm not telling you which repo I'm using\"??</p>",
        "id": 511443922,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744299351
    },
    {
        "content": "<p>Sorry Kevin. That was indeed EVIL. <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 511444165,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744299401
    },
    {
        "content": "<p>Originally I was using my own fork of the repo (which I just realized). Alas, the original repo you cloned (which given my crime I should explicitly state as <a href=\"https://github.com/hrmacbeth/math2001\">https://github.com/hrmacbeth/math2001</a>) still gives me the error I was seeing. Sorry again! </p>\n<p>Here is the error, too:</p>\n<p><code>/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lake print-paths Init Mathlib.Data.Real.Basic Library.Theory.ParityModular Library.Basic Library.Tactic.Exhaust Library.Tactic.ModEq</code> failed:</p>\n<p>stderr:<br>\ninfo: [613/894] Building Duper.Order<br>\ninfo: [621/913] Building Duper.DUnif.UnifProblem<br>\ninfo: [642/936] Building Duper.Util.AbstractMVars<br>\nerror: &gt; LEAN_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib DYLD_LIBRARY_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean:/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib:./.lake/packages/Duper/.lake/build/lib /Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean -Dlinter.unusedVariables=false ./.lake/packages/Duper/././Duper/Order.lean -R ./.lake/packages/Duper/./. -o ./.lake/packages/Duper/.lake/build/lib/Duper/Order.olean -i ./.lake/packages/Duper/.lake/build/lib/Duper/Order.ilean -c ./.lake/packages/Duper/.lake/build/ir/Duper/Order.c --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Reduction-1.dylib --load-dynlib=./.lake/packages/Duper/.lake/build/lib/libDuper-Expr-1.dylib<br>\nerror: stderr:<br>\nlibc++abi: terminating due to uncaught exception of type lean::exception: error loading library, dlopen(./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib, 0x0009): tried: './.lake/packages/std/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/usr/lib/./.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file, not in dyld cache), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/std/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libDuper-Util-Misc-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (no such file), '/Users/jon/LeanRepos/math2001/.lake/packages/Duper/.lake/build/lib/libDuper-Util-Misc-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag)<br>\nerror: external command <code>/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean</code> exited with code 134</p>",
        "id": 511444442,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744299476
    },
    {
        "content": "<p>OK so just to be clear, if you do this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"n\">clone</span><span class=\"w\"> </span><span class=\"n\">git</span><span class=\"bp\">@</span><span class=\"n\">github</span><span class=\"bp\">.</span><span class=\"n\">com</span><span class=\"o\">:</span><span class=\"n\">hrmacbeth</span><span class=\"bp\">/</span><span class=\"n\">math2001</span><span class=\"bp\">.</span><span class=\"n\">git</span>\n<span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"n\">math2001</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">exe</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"w\"> </span><span class=\"n\">get</span>\n<span class=\"n\">lake</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">Math2001</span><span class=\"bp\">.</span><span class=\"n\">Homework</span><span class=\"bp\">.</span><span class=\"n\">hw9</span>\n</code></pre></div>\n<p>are you error-free?</p>",
        "id": 511445194,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744299659
    },
    {
        "content": "<p>That error looks to me like it says \"you are using a version of Duper which doesn't play well with some of your other choices\"</p>",
        "id": 511445435,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744299722
    },
    {
        "content": "<p>Let me try this explicit sequence ot steps to ensure we are on the same page...</p>",
        "id": 511445596,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744299760
    },
    {
        "content": "<p>Huh, this time I got an error!</p>\n<blockquote>\n<p>error: &gt; LEAN_PATH=./.lake/packages/std/.lake/build/lib:./.lake/packages/Qq/.lake/build/lib:./.lake/packages/aesop/.lake/build/lib:./.lake/packages/proofwidgets/.lake/build/lib:./.lake/packages/Cli/.lake/build/lib:./.lake/packages/mathlib/.lake/build/lib:./.lake/packages/Duper/.lake/build/lib:./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib DYLD_LIBRARY_PATH=./.lake/packages/autograder/.lake/build/lib:./.lake/build/lib /Users/buzzard/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean -Dlinter.unusedVariables=false -DquotPrecheck=false -DwarningAsError=false -Dpp.unicode.fun=true ./././Math2001/Homework/hw9.lean -R ././. -o ./.lake/build/lib/Math2001/Homework/hw9.olean -i ./.lake/build/lib/Math2001/Homework/hw9.ilean -c ./.lake/build/ir/Math2001/Homework/hw9.c --load-dynlib=./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib<br>\nerror: stderr:<br>\nlibc++abi: terminating due to uncaught exception of type lean::exception: error loading library, dlopen(./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib, 0x0009): tried: './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/buzzard/.elan/toolchains/leanprover--lean4---v4.3.0/lib/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/buzzard/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/usr/lib/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file, not in dyld cache), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/buzzard/crap/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS/Users/buzzard/crap/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/buzzard/crap/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag)<br>\nerror: external command <code>/Users/buzzard/.elan/toolchains/leanprover--lean4---v4.3.0/bin/lean</code> exited with code 134</p>\n</blockquote>",
        "id": 511446879,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744300083
    },
    {
        "content": "<p>It doesn't like the Autograder import, right? If you comment that out it should get rid of the error (except for all of the [@autograder _] attributes)?</p>",
        "id": 511447179,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300152
    },
    {
        "content": "<p>I tried on a mac this time. Previously I was on linux. <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> which OS were you on? And Jon?</p>",
        "id": 511447302,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744300189
    },
    {
        "content": "<p>I'm on a Mac, running Sequoia 15.4 (and recently allowed an update for this!)</p>",
        "id": 511447467,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300222
    },
    {
        "content": "<p>I'm pretty sure Jireh is on a PC...running Arch Linux (see below).</p>",
        "id": 511448170,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300383
    },
    {
        "content": "<p>I just ssh'ed into my linux machine (Ubuntu 24.04) and confirm that those commands I posted above work fine on it. The errors I'm seeing are also on Mac Sequoia 15.4.</p>",
        "id": 511448174,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744300386
    },
    {
        "content": "<p>I performed those steps, and am still getting the error on <code>hw9</code> :  </p>\n<p>error loading library, dlopen(./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib, 0x0009): tried: './.lake/packages/std/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/usr/lib/./.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file, not in dyld cache), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/packages/std/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Qq/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/aesop/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/proofwidgets/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Cli/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/mathlib/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/Duper/.lake/build/lib/libAutograderLib-1.dylib' (no such file), './.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), './.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/lean/libAutograderLib-1.dylib' (no such file), '/Users/jon/.elan/toolchains/leanprover--lean4---v4.3.0/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/LeanRepos/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag), '/System/Volumes/Preboot/Cryptexes/OS/Users/jon/LeanRepos/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (no such file), '/Users/jon/LeanRepos/math2001/.lake/packages/autograder/.lake/build/lib/libAutograderLib-1.dylib' (__DATA_CONST segment missing SG_READ_ONLY flag)</p>",
        "id": 511448404,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300445
    },
    {
        "content": "<p>I think we can escalate this to <a class=\"stream\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4\">#lean4</a> , I'll post there.</p>",
        "id": 511448637,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744300502
    },
    {
        "content": "<p>And...if I comment out <code>import AutograderLib</code> then the file works (aside from not recognizing @[autograder _])</p>",
        "id": 511448755,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300526
    },
    {
        "content": "<p>I followed the steps with Mac Sequoia 15.3 and did not get any compiler errors, only warnings about sorries.</p>",
        "id": 511448810,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1744300544
    },
    {
        "content": "<p>Huh! Maybe it was the recent update to Sequoia 15.4? This is the <em>only</em> thing I did differently between now and the last time I was teaching...so maybe there is something in the update...</p>",
        "id": 511449074,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300604
    },
    {
        "content": "<p>Warnings about <code>sorry</code>s are fine, I think the idea of the homework is to fill in them in :-)</p>",
        "id": 511449092,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744300610
    },
    {
        "content": "<p>Ah...and the students all have PCs, I think.</p>",
        "id": 511450029,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744300816
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/187764-Lean-for-teaching/topic/Issue.20with.20.60Duper.60.20in.20.60The.20Mechanics.20of.20Proof.60/near/511447302\">said</a>:</p>\n<blockquote>\n<p>I tried on a mac this time. Previously I was on linux. <span class=\"user-mention silent\" data-user-id=\"197836\">Jireh Loreaux</span> which OS were you on? And Jon?</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> Arch Linux, so this is reproducible under different systems.</p>",
        "id": 511450691,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744300946
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> Should the fact that this is reproducible under different systems appear in (<a class=\"stream-topic\" data-stream-id=\"270676\" href=\"/#narrow/channel/270676-lean4/topic/Mac.20Sequoia.2015.2E4.20regression.3F/with/511450449\">#lean4 &gt; Mac Sequoia 15.4 regression?</a>)?</p>",
        "id": 511454632,
        "sender_full_name": "Jon Bannon",
        "timestamp": 1744302068
    },
    {
        "content": "<p>I will, I'm just confirming my repro example.</p>",
        "id": 511455093,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1744302196
    },
    {
        "content": "<p>Hi, I've updated the math2001 (Mechanics of Proof) code base from v4.3.0 to v4.18.0, the changes can be found here:<br>\n<a href=\"https://github.com/drhodes/math2001/tree/v4.18.0\">https://github.com/drhodes/math2001/tree/v4.18.0</a></p>\n<p>Some things have not yet been updated:</p>\n<ul>\n<li>dependencies for duper / autograder have been commented out in the lakefile. (they might work now!)</li>\n<li>Duper imports and the <code>exhaust</code> tactic are entirely commented out, along with the ~60 examples that depend on them.</li>\n<li>The <code>numbers</code> tactic is not fully working, but <a href=\"#narrow/channel/270676-lean4/topic/.E2.9C.94.20A.20broken.20tactic.20caused.20by.20mysterious.20forces.2E\"><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>  provided a solution here on zulip</a></li>\n<li>The TruthTable widget needs work, therefore #truth_table cmds have been commented.</li>\n<li><code>addarith</code> has a hiccup, but my sense is that there is an easy fix. (three <code>addarith</code> examples have been commented)</li>\n</ul>\n<p>I also introduced TODOs when commenting something out , but always on the mathlib commit (in the lakefile) where the relevant code broke, which localizes the cause, so <code>git diff</code> on mathlib at that commit will hold some debugging clues.</p>",
        "id": 513892008,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1745419688
    },
    {
        "content": "<p>cc'ing <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span>.</p>",
        "id": 515457339,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746081965
    },
    {
        "content": "<p>I spoke to Heather about this yesterday. The correct fix really is to make the project not depend on duper any more and to write a new tactic which does the things that duper was doing. Unfortunately <code>grind</code> is too powerful! Heather said she'd spent some time last year trying to persuade other people to write the tactic she wanted but now knows enough metaprogramming to write it herself.</p>",
        "id": 515525480,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1746112716
    },
    {
        "content": "<p>Nice! I don't know if it was announced anywhere but <span class=\"user-mention\" data-user-id=\"266304\">@Siddhartha Gadgil</span> has an excellent <a href=\"https://www.youtube.com/playlist?list=PL_bVGic_CrGtMw1QVFRLRsZjcymm56mRi\">series of metaprogramming videos</a>, good for people interested in learning how to write custom tactics. (I'm working through them now).</p>",
        "id": 515527563,
        "sender_full_name": "Derek Rhodes",
        "timestamp": 1746113323
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> or <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> if there's a link available for that previous request, people might be keen (presumably despite now being an expert, Heather would still be happy if others contributed :-).</p>",
        "id": 516008710,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1746348700
    },
    {
        "content": "<p>Reviving this thread: Has anyone taken up the challenge to rewrite the <code>exhaust</code> tactic so that it doesn't depend on duper?</p>",
        "id": 571188579,
        "sender_full_name": "Kevin Cheung",
        "timestamp": 1769858787
    }
]