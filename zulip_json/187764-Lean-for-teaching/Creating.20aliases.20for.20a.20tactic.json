[
    {
        "content": "<p>Is there any easy way to do this? No change to behavior, just add a more convenient name for a tactic.</p>",
        "id": 512924621,
        "sender_full_name": "Lucas Arruda",
        "timestamp": 1744927704
    },
    {
        "content": "<p>Yes.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"trust_me\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"gr\">sorry</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">trust_me</span>\n</code></pre></div>",
        "id": 512958211,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1744944333
    },
    {
        "content": "<p>If you want parameters:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"use_function\"</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">f</span><span class=\"o\">)</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">use_function</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">le_refl</span>\n</code></pre></div>",
        "id": 512958332,
        "sender_full_name": "Siddhartha Gadgil",
        "timestamp": 1744944405
    },
    {
        "content": "<p>To be honest, it can get more complicated if the tactic has complicated parameters, or optional ones. So don’t hesitate to ask here if you can get in macro world.</p>",
        "id": 513001505,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744968507
    },
    {
        "content": "<p>I run into some problems when trying to create a macro that expands to <code>intro something</code>. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span>\n\n<span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mIntro \"</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"c1\">-- application type mismatch</span>\n<span class=\"c1\">--  h.raw</span>\n<span class=\"c1\">-- argument</span>\n<span class=\"c1\">--  h</span>\n<span class=\"c1\">-- has type</span>\n<span class=\"c1\">--  TSyntax `term : Type</span>\n<span class=\"c1\">-- but is expected to have type</span>\n<span class=\"c1\">--  TSyntax `Lean.Parser.Term.matchAlts : Type</span>\n</code></pre></div>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span>\n<span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">matchAlts</span>\n<span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mIntro \"</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Parser</span><span class=\"bp\">.</span><span class=\"n\">Term</span><span class=\"bp\">.</span><span class=\"n\">matchAlts</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"c1\">-- application type mismatch</span>\n<span class=\"c1\">--  h.raw</span>\n<span class=\"c1\">-- argument</span>\n<span class=\"c1\">--  h</span>\n<span class=\"c1\">-- has type</span>\n<span class=\"c1\">--  TSyntax `Lean.Parser.Term.matchAlts : Type</span>\n<span class=\"c1\">-- but is expected to have type</span>\n<span class=\"c1\">--  TSyntax `term : Type</span>\n</code></pre></div>",
        "id": 513029570,
        "sender_full_name": "Lucas Arruda",
        "timestamp": 1744981333
    },
    {
        "content": "<p><code>intro</code> is indeed a bit complicated since it can take several kind of arguments. Would you be happy with a version taking exactly one identifier?</p>",
        "id": 513030041,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981589
    },
    {
        "content": "<p>It would be a start, i guess. But it'd also be nice to have a version that can do exactly what intro does</p>",
        "id": 513030273,
        "sender_full_name": "Lucas Arruda",
        "timestamp": 1744981717
    },
    {
        "content": "<p>Actually having multiple ones isn’t really harder:</p>",
        "id": 513030291,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981735
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">macro</span><span class=\"w\"> </span><span class=\"s2\">\"mIntro \"</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 513030304,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981739
    },
    {
        "content": "<p>What won’t work is the pattern stuff.</p>",
        "id": 513030451,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981805
    },
    {
        "content": "<p>I mean things like <code>intro ⟨x, h⟩</code></p>",
        "id": 513030481,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981828
    },
    {
        "content": "<p>We could make it work of course, but it will require copying stuff from the core <code>intro</code> elaborator.</p>",
        "id": 513030837,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744981977
    },
    {
        "content": "<p>oh, that is already very useful! Thank you!</p>\n<p>if i want to go ahead and try copying stuff from the core <code>intro</code> elaborator, could you give me some advice?</p>",
        "id": 513031810,
        "sender_full_name": "Lucas Arruda",
        "timestamp": 1744982437
    },
    {
        "content": "<p>You can simply write <code>intro</code> in your proof and use <code>go to definition</code> to see the elaborator.</p>",
        "id": 513032718,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744982813
    },
    {
        "content": "<p>It should bring you to <a href=\"https://github.com/leanprover/lean4/blob/02b206af9b857a2bbc796394aec14fe192ab59d7/src/Lean/Elab/Tactic/BuiltinTactic.lean#L282\">https://github.com/leanprover/lean4/blob/02b206af9b857a2bbc796394aec14fe192ab59d7/src/Lean/Elab/Tactic/BuiltinTactic.lean#L282</a></p>",
        "id": 513032918,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744982887
    },
    {
        "content": "<p>If you need more help about that, I recommend switching to the <a href=\"#narrow/channel/239415-metaprogramming-.2F-tactics\">metaprogramming channel</a>  which is more suitable for technical meta-stuff.</p>",
        "id": 513033020,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744982925
    },
    {
        "content": "<p>Thank you, again!</p>",
        "id": 513033073,
        "sender_full_name": "Lucas Arruda",
        "timestamp": 1744982948
    },
    {
        "content": "<p>And zulip doesn’t want to create that link <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 513033110,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1744982967
    },
    {
        "content": "<p><a class=\"stream\" data-stream-id=\"239415\" href=\"/#narrow/channel/239415-metaprogramming-.2F-tactics\">#metaprogramming / tactics</a> </p>\n<p>I get it by <code>#metaprogr</code> and then tab and then tab again (but it still seems to link to \"last message posted in the channel\" as opposed to anything like an overview)</p>",
        "id": 513036301,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744984285
    }
]