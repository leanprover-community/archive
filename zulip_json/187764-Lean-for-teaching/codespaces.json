[
    {
        "content": "<p>As Eric pointed out <a href=\"#narrow/stream/113489-new-members/topic/Basic.20Analysis.20hangup.20in.20Lean/near/288842411\">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/Basic.20Analysis.20hangup.20in.20Lean/near/288842411</a>, GitHub Codespaces is free for educational use (currently). </p>\n<p>We are getting to the point our intro to proofs course to start lean. I had previously planned on going with GitPod but it seems that Codespaces is easier to interact with for students. (Mainly due to the integration into the GH web UI. Plus it is actually free vs almost effectively free for GitPod.) </p>\n<p>I put together a working Lean 4 Codespaces setup <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework0\">here</a>.</p>",
        "id": 297847721,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1662663877
    },
    {
        "content": "<p>TLDR for codespaces setup: make a folder <code>.devcontainer</code> folder and put in a Dockerfile and <code>devcontainer.json</code>. </p>\n<p>The ones here are based on the GitPod files for the <a href=\"https://github.com/IPDSnelting/tba-2022\">class at KIT</a>. The only complications were where to point the FROM in the Dockerfile (a good idea is to ask VS Code to make it for you start) and how to modify <code>PATH</code> for elan. </p>\n<p>I am sure my setup is far from elegant so welcome any input!</p>",
        "id": 297848551,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1662664217
    },
    {
        "content": "<p>Ah, I've just found out about codespaces. As I understand it, it's a way for students to do Lean in GitHub Classrooms using VS Code in the browser. The only problem is the installation of Lean + the VS Code extensions required each time one creates a codespace.</p>\n<p>Is the codespace set up you mention a way of automating the installation or does it do something in addition to that? I assume the GitPod stuff isn't necessary if I'm using GitHub Classroom Is that correct?</p>",
        "id": 300828800,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1664203139
    },
    {
        "content": "<p>For my current class, Codepsaces provides a consistent development environment for all the students. They should not have setup problems if they use Codespaces (but they are free to use their own machines still). GitPod serves the same role here.</p>",
        "id": 300847991,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1664208320
    },
    {
        "content": "<p>You can definitely configure codespaces to preinstall everything, just like we already do for gitpod</p>",
        "id": 300875564,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1664216691
    },
    {
        "content": "<p>How does one do this?</p>",
        "id": 301981839,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1664753103
    },
    {
        "content": "<p>Make a folder <code>.devcontainer</code> and put a Dockerfile and devcontainer.json. The <a href=\"https://github.com/leanprover-community/mathlib/blob/master/.docker/gitpod/mathlib/Dockerfile\">mathlib Dockerfile</a> should work but you will need to point the <code>FROM</code> to a standard Microsoft image like </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">ARG</span> <span class=\"n\">VARIANT</span><span class=\"bp\">=</span><span class=\"s2\">\"buster\"</span>\n<span class=\"n\">FROM</span> <span class=\"n\">mcr.microsoft.com</span><span class=\"bp\">/</span><span class=\"n\">vscode</span><span class=\"bp\">/</span><span class=\"n\">devcontainers</span><span class=\"bp\">/</span><span class=\"n\">base</span><span class=\"o\">:</span><span class=\"mi\">0</span><span class=\"bp\">-$</span><span class=\"o\">{</span><span class=\"n\">VARIANT</span><span class=\"o\">}</span>\n</code></pre></div>\n<p>For a sample <code>devcontainer.JSON</code> and an overall good example for setup is the <a href=\"https://github.com/leanprover/lean4-samples/tree/main/.devcontainer\">Lean 4 samples</a> repo. </p>\n<p>You can also see the my <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework5/blob/main/.devcontainer/devcontainer.json\">json file</a> for another example</p>",
        "id": 301984579,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1664756164
    },
    {
        "content": "<p>I think we should probably commit such a configuration to the mathlib repo, and possibly publish a codespace docker image alongside the existing gitpod one.</p>",
        "id": 301996960,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1664771378
    },
    {
        "content": "<p>Codespaces is now free for everyone for 120 \"core hours\" per month <a href=\"/user_uploads/3121/hO1oQH6wKjsJiDzm7VgO35AD/image.png\">image.png</a><br>\nWhat's even more interesting: organizations can pay for usage by memebers and outside collaborators</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/hO1oQH6wKjsJiDzm7VgO35AD/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/hO1oQH6wKjsJiDzm7VgO35AD/image.png\"></a></div>",
        "id": 309180230,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1668168878
    },
    {
        "content": "<p>Anyone having memory problems with running the Lean 3 server in vscode in GitHub Codespaces?</p>\n<p>I've given my (~260) first-year students at the University of Exeter 4 summative assessments in Lean 3 using a variant of <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span>'s GH autograder. So far (with reference to <span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span>'s earlier comment on this stream), I haven't been fired!</p>\n<p>For my next assessment, GitHub Codespaces falls over if the file contains even just <code>import data.set.basic</code>.</p>\n<p>It looks like (according to htop) my codespace is using 1.23Gb of the available 3.84Gb even before starting lean in server mode. When the lean server starts, it slowly uses all available memory then crashes.</p>\n<p><em>However</em>, if I run Lean from the terminal, it runs fine. For example, running <code>/usr/bin/time -v lean .test/test.lean</code> shows that 'maximum resident set size' is only about 430Mb.</p>\n<p>Any suggestions on how to address this issue?</p>",
        "id": 312850308,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1669730818
    },
    {
        "content": "<p>Addendum: I say that lean in the terminal 'works fine', but it takes 149s to run the above in the GitHub codepsaces terminal as opposed to 0.17s on my computer.</p>",
        "id": 312852561,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1669731479
    },
    {
        "content": "<p>Do you have the mathlib oleans downloaded to the workspace? E.g. with <code>leanproject get-mathlib-cache</code> in the project</p>",
        "id": 312853793,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1669731823
    },
    {
        "content": "<p>No, I don't have the oleans and I don't have leanproject installed in my codepsace either. Thanks. I'll try this out.</p>",
        "id": 312875631,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1669737840
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"127136\">@Alex J. Best</span>  - that worked. Now I just need to figure out how to install leanproject automatically for all my student codespaces.</p>",
        "id": 312876940,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1669738161
    },
    {
        "content": "<p>Regarding setting up Lean 4 for students, how would you compare <a href=\"https://lean.math.hhu.de/\">https://lean.math.hhu.de/</a> with Codespaces?</p>",
        "id": 339607616,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1677960462
    },
    {
        "content": "<p>codespaces / gitpod lets you work in multiple files and save your work</p>",
        "id": 339608033,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677960755
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/297847721\">said</a>:</p>\n<blockquote>\n<p>I put together a working Lean 4 Codespaces setup <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework0\">here</a>.</p>\n</blockquote>\n<p>Is it OK if I open your Codespaces and see the following?<br>\n<a href=\"/user_uploads/3121/gfS_MEv7tBBvcL5x1eBuwTfF/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/gfS_MEv7tBBvcL5x1eBuwTfF/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/gfS_MEv7tBBvcL5x1eBuwTfF/image.png\"></a></div>",
        "id": 339608501,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1677961138
    },
    {
        "content": "<p>did you open the gitpod or the codespace?</p>",
        "id": 339609536,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677961875
    },
    {
        "content": "<p>(the two are basically the same, but getting a gitpod message from codespaces is weird)</p>",
        "id": 339609558,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677961901
    },
    {
        "content": "<p>Oh sorry! It is GitPod.</p>",
        "id": 339610328,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1677962463
    },
    {
        "content": "<p>Is <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework0\">https://github.com/UofSC-Fall-2022-Math-300-H01/homework0</a> a setup for both Codespaces and GitPod?</p>",
        "id": 339610360,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1677962504
    },
    {
        "content": "<p>It looks like it, yes</p>",
        "id": 339611007,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677962962
    },
    {
        "content": "<p>Note that you get a free codespace quota for students in a class, which I don't think is the case for gitpod</p>",
        "id": 339611102,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677963012
    },
    {
        "content": "<p>What counts as a class? Can it be an online course for high school students who compete in mathematical olympiads?</p>",
        "id": 339611227,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1677963106
    },
    {
        "content": "<p><a href=\"https://education.github.com/teachers\">https://education.github.com/teachers</a></p>",
        "id": 339611309,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677963151
    },
    {
        "content": "<p><a href=\"https://docs.github.com/en/education/manage-coursework-with-github-classroom/integrate-github-classroom-with-an-ide/using-github-codespaces-with-github-classroom\">https://docs.github.com/en/education/manage-coursework-with-github-classroom/integrate-github-classroom-with-an-ide/using-github-codespaces-with-github-classroom</a></p>",
        "id": 339611393,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677963234
    },
    {
        "content": "<p>I ran my supervisor's assignment using it as a TA last year</p>",
        "id": 339611480,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1677963279
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"306577\">Matthew Ballard</span> <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/297847721\">said</a>:</p>\n<blockquote>\n<p>I put together a working Lean 4 Codespaces setup <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework0\">here</a>.</p>\n</blockquote>\n<p>How can I open it as a Codespace, as opposed to GitPod?<br>\nWould I have to be registered as a student somewhere?</p>",
        "id": 339855994,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678106331
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/keFstFwO87aAA-HmDlDiI_i8/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/keFstFwO87aAA-HmDlDiI_i8/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/keFstFwO87aAA-HmDlDiI_i8/image.png\"></a></div>",
        "id": 339949152,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678130119
    },
    {
        "content": "<p>Ah thanks! I can open it and it works for me!</p>\n<p>How is it done that I didn't have to prove that I am a student, nor did <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> have to prove that I am enrolled in his course? Can anyone with GitHub account go there and have their Codespace? Can any number of people just join and play with it as if they were students?</p>",
        "id": 339950659,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678130572
    },
    {
        "content": "<p>In that case you're using the free limit I posted about above available to anyone</p>",
        "id": 339961390,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1678134247
    },
    {
        "content": "<p>I suppose it's different if you use GitHub Classroom</p>",
        "id": 339961670,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1678134343
    },
    {
        "content": "<p>You mean a free limit of my GitHub account? Nothing to do with Matthew Ballard's course?</p>",
        "id": 339961689,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678134351
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110024\">Sebastian Ullrich</span> <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/339961670\">said</a>:</p>\n<blockquote>\n<p>I suppose it's different if you use GitHub Classroom</p>\n</blockquote>\n<p>I think I got it now! If I wanted to use the GitHub Classroom, I wouldn't be required to prove that I am a student; instead, <span class=\"user-mention\" data-user-id=\"306577\">@Matthew Ballard</span> would have to approve my account, right?</p>",
        "id": 339961997,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678134473
    },
    {
        "content": "<p>I think the free allocation is only for use for assignments with GH Classroom.</p>",
        "id": 339964001,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1678135268
    },
    {
        "content": "<p>Note: the system chokes pretty fast building Mathlib (in case you forgot <code>lake exe cache get</code>) so I suspect you will have a bad time with the GH Classroom free level also</p>",
        "id": 339964166,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1678135339
    },
    {
        "content": "<p>I am not sure I am on the same line.</p>\n<p>I opened Codespaces via the link you posted (i.e., <a href=\"https://github.com/UofSC-Fall-2022-Math-300-H01/homework0\">https://github.com/UofSC-Fall-2022-Math-300-H01/homework0</a> and then <code>&lt; &gt; Code</code> -&gt; <code>Codespaces</code>). Was I in the GH Classroom?</p>",
        "id": 339966634,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678136259
    },
    {
        "content": "<p>And if I open your repository in GitPod (using the button behind your link), do I use my free limit as well?</p>",
        "id": 339966865,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678136345
    },
    {
        "content": "<p>You can check your codespaces in settings to see if it under your account</p>",
        "id": 339968010,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1678136764
    },
    {
        "content": "<p>I can access this page under my GitHub settings:<br>\n<a href=\"/user_uploads/3121/zIyQzvzVXvLoABi-jOj1dGc5/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/zIyQzvzVXvLoABi-jOj1dGc5/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/zIyQzvzVXvLoABi-jOj1dGc5/image.png\"></a></div>",
        "id": 339968677,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678137074
    },
    {
        "content": "<p>It says something about Codespaces, but I don't see any personal limit, nor can I see anything named \"GitHub Classroom\".</p>",
        "id": 339968838,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678137138
    },
    {
        "content": "<p>Do I understand it correctly that; students don't have to prove they are students; I have to be a verified teacher and add my students' GitHub accounts to a GitHub Classroom, so that they will have an access to the Codespace with an increased CPU limit?</p>",
        "id": 340140150,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678203142
    },
    {
        "content": "<p>That sounds right to me</p>",
        "id": 340143621,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678203930
    },
    {
        "content": "<p>Though when I got my students to sign up I encouraged them to verify their student status anyway for their own benefit</p>",
        "id": 340143788,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678203965
    },
    {
        "content": "<p>My students will come from many different high schools, so it would be probably too difficult to verify their student status.</p>",
        "id": 340144035,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678204028
    },
    {
        "content": "<p>I would recommend just verifying your teacher status and making a dummy student account to see how it behaves</p>",
        "id": 340144244,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678204081
    },
    {
        "content": "<p>OK! I hope our legal department will allow me to use GitHub in the first place...</p>",
        "id": 340144585,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678204151
    },
    {
        "content": "<p>If you're not using it with students do they care?</p>",
        "id": 340145070,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678204255
    },
    {
        "content": "<p>That is, if you verify in order to evaluate the offering</p>",
        "id": 340145171,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678204280
    },
    {
        "content": "<p>Obviously you should wait for their approval before actually using it in an official capacity</p>",
        "id": 340145326,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678204318
    },
    {
        "content": "<p>However, if 60 hours per month is enough for every single student, they don't need to have a student account and I don't need to have a teacher account either, right?</p>",
        "id": 340154212,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1678206386
    },
    {
        "content": "<p>Sure, but you might find classroom useful, and you're likely going to need legal approval anyway to ask the students to sign up for github if your university already asked for approval</p>",
        "id": 340157475,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1678207231
    },
    {
        "content": "<p>I attempted to setup Codespaces in my repository:<br>\n<a href=\"https://github.com/madvorak/lean-mam\">https://github.com/madvorak/lean-mam</a></p>\n<p>Sometimes it works. Sometimes I get errors like<br>\n<a href=\"/user_uploads/3121/YB8TrVCOMRWU3FagGLbsmmmg/image.png\">image.png</a><br>\nand<br>\n<a href=\"/user_uploads/3121/_kobUpe-TnGbhZR2VFjtKP51/image.png\">image.png</a><br>\nand then it works again.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/YB8TrVCOMRWU3FagGLbsmmmg/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/YB8TrVCOMRWU3FagGLbsmmmg/image.png\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_kobUpe-TnGbhZR2VFjtKP51/image.png\" title=\"image.png\"><img src=\"/user_uploads/3121/_kobUpe-TnGbhZR2VFjtKP51/image.png\"></a></div><p>Do you know how to avoid those errors?</p>",
        "id": 353227866,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1682593265
    },
    {
        "content": "<p>PS: The problem seems to have resolved itself with switching to a different base image.</p>",
        "id": 353300442,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1682602855
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"233737\">Gihan Marasingha</span> <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/312876940\">said</a>:</p>\n<blockquote>\n<p>Thanks <span class=\"user-mention silent\" data-user-id=\"127136\">Alex J. Best</span>  - that worked. Now I just need to figure out how to install leanproject automatically for all my student codespaces.</p>\n</blockquote>\n<p>Hi <span class=\"user-mention\" data-user-id=\"233737\">@Gihan Marasingha</span> . Sorry to bother you directly, but I am having the exact same string of problems you encountered <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/312850308\">here</a> and I was wondering if you or somebody else could tell me:</p>\n<ol>\n<li>How to install <code>leanproject</code> in Codespaces.</li>\n<li>How to make sure that it is then installed automatically for the students.</li>\n</ol>\n<p>Please note that I am still using Lean 3 in my course this semester. Thank you!</p>",
        "id": 373170921,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688728398
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"127136\">Alex J. Best</span> <a href=\"#narrow/stream/187764-Lean-for-teaching/topic/codespaces/near/312853793\">said</a>:</p>\n<blockquote>\n<p>Do you have the mathlib oleans downloaded to the workspace? E.g. with <code>leanproject get-mathlib-cache</code> in the project</p>\n</blockquote>\n<p>To be clear, I don't know how to run this <em>in Codespaces</em>. Should it work automatically? Is <code>leanproject</code> supposed to be there already?</p>",
        "id": 373177825,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688729851
    },
    {
        "content": "<p>OK, I installed <code>leanproject</code> via <code>pip3 install mathlibtools</code>, but I am still missing <code>leanpkg</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Errno</span> <span class=\"mi\">2</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">such</span> <span class=\"n\">file</span> <span class=\"n\">or</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'</span><span class=\"n\">leanpkg'</span>\n</code></pre></div>",
        "id": 373182518,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688730825
    },
    {
        "content": "<p>Which installation instructions are you trying to follow?</p>",
        "id": 373185519,
        "sender_full_name": "Scott Morrison",
        "timestamp": 1688731414
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/lean3/install/windows.html\">https://leanprover-community.github.io/lean3/install/windows.html</a></p>",
        "id": 373189452,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688732227
    },
    {
        "content": "<p>And it seems that the following sequence works on Codespaces as well:</p>\n<ol>\n<li><code>curl https://raw.githubusercontent.com/leanprover/elan/master/elan-init.sh -sSf | sh</code></li>\n<li><code>pip3 install mathlibtools</code></li>\n<li><del><code>leanproject new</code></del></li>\n</ol>\n<p><strong>Edit</strong> Actually, I could not reproduce that. After installing <code>mathlibtools</code>, I get the same error as before:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Errno</span> <span class=\"mi\">2</span><span class=\"o\">]</span> <span class=\"n\">No</span> <span class=\"n\">such</span> <span class=\"n\">file</span> <span class=\"n\">or</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">'</span><span class=\"n\">leanpkg'</span>\n</code></pre></div>\n<p><del>So now it's down to the issue of making this config load automatically with Codespaces when my students use it </del> <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 373190026,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688732352
    },
    {
        "content": "<p>Does copying the docker file and devcontainer.json from the Mathlib repo not “just work”?</p>",
        "id": 373192342,
        "sender_full_name": "Matthew Ballard",
        "timestamp": 1688732826
    },
    {
        "content": "<p>Hmm, I could not make it work. But then again, I seem to be doing something wrong even setting up Lean 3 inside Codespaces.</p>",
        "id": 373212070,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688736644
    },
    {
        "content": "<p>If you search for Codespaces on this Zulip, you can find (presumably) working setups such as this one by <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span>: <a href=\"https://github.com/fpvandoorn/LogicColloquiumTutorial/tree/master/.devcontainer\">https://github.com/fpvandoorn/LogicColloquiumTutorial/tree/master/.devcontainer</a>. Which in particular sets up the mathlib4 cache, but I just remembered you're using Lean 3...</p>",
        "id": 373242961,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1688742575
    },
    {
        "content": "<p>Note the <code>ENV PATH</code> setting in the Dockerfile that should ensure that <code>leanpkg</code> exists as a command</p>",
        "id": 373244602,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1688742881
    },
    {
        "content": "<p>Thanks! Indeed I would have to adapt it for Lean 3, but I wonder if it is really worth it at this stage, given that the semester is over in three weeks <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> </p>\n<p>It's frustrating, though,  that I am not able to give the students easy access to the Lean files! The good thing is that it has made most of them want to install Lean on their own machines :-) The others just use CoCalc.</p>\n<p>Anyway, thanks everyone! The final word for today is: I can setup Lean 3 in a Codespace, but only for me and only for as long as that particular Codespace is active.</p>\n<p>The setup I used was the following sequence of command lines (which works provided that my base repo contains a <code>leanpkg.toml</code> file).</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">curl</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">raw.githubusercontent.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">master</span><span class=\"bp\">/</span><span class=\"n\">elan</span><span class=\"bp\">-</span><span class=\"n\">init.sh</span> <span class=\"bp\">-</span><span class=\"n\">sSf</span> <span class=\"bp\">|</span> <span class=\"n\">sh</span>\n<span class=\"n\">source</span> <span class=\"bp\">$</span><span class=\"n\">HOME</span><span class=\"bp\">/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">env</span>\n<span class=\"n\">pip3</span> <span class=\"n\">install</span> <span class=\"n\">mathlibtools</span>\n<span class=\"n\">source</span> <span class=\"bp\">~/.</span><span class=\"n\">profile</span>\n<span class=\"n\">leanproject</span> <span class=\"n\">new</span>\n</code></pre></div>\n<p>Then install the Lean 3 extension in VS Code and go to a Lean file to check that it works.</p>\n<p>I leave this here in case someone else is trying to make the same thing work <span aria-label=\"smiling face\" class=\"emoji emoji-263a\" role=\"img\" title=\"smiling face\">:smiling_face:</span>  At first I thought it would be possible to tell Codespaces to create an image of that configuration (once it is all set up), so that it would load automatically every time after that, but I could not figure out if this is indeed doable.</p>",
        "id": 373253085,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688744347
    },
    {
        "content": "<p>Prior art for Lean 3 is also easily found on GitHub: <a href=\"https://github.com/search?q=mathlibtools%20path%3A.devcontainer&amp;type=code\">https://github.com/search?q=mathlibtools%20path%3A.devcontainer&amp;type=code</a></p>",
        "id": 373257120,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1688745123
    },
    {
        "content": "<p>Thank you for the link! I suppose that my problem is more basic: I don't know how to create such .devcontainer files and make them work <span aria-label=\"flushed\" class=\"emoji emoji-1f633\" role=\"img\" title=\"flushed\">:flushed:</span></p>",
        "id": 373258833,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1688745428
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513540\">@Flo (Florent Schaffhauser)</span>   Sorry I didn't see this message at the time: unfortunately I had a family emergency to deal with.<br>\nHave you sorted out your issue? If not, I'm happy to help.</p>",
        "id": 389907163,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1694188070
    },
    {
        "content": "<p>Hi <span class=\"user-mention\" data-user-id=\"233737\">@Gihan Marasingha</span> <span aria-label=\"wave\" class=\"emoji emoji-1f44b\" role=\"img\" title=\"wave\">:wave:</span> Thanks for getting back to me! I could never make it work properly and it was already late in the semester, so I did not insist <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> I think I am limited by my understanding of how <code>Codespaces</code> work and how to set one up. </p>\n<p>Next time, I will want to implement a <code>Codespace</code> for my students, though! And I will do it using Lean 4, so perhaps I can use more directly the various setups that have been mentioned in this thread (thanks to everyone for their help <span aria-label=\"pray\" class=\"emoji emoji-1f64f\" role=\"img\" title=\"pray\">:pray:</span>). </p>\n<p>May I ask: are you still using <code>Codespaces</code> in your course? Do you recommend it as a tool to have students use Lean?</p>",
        "id": 390006220,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1694245018
    },
    {
        "content": "<p>Yes, I am still using Codespaces, particularly for assessment. The principal advantage is that it's a 'no installation' approach. Roughly the way it works is that you create a GitHub template repository that contains either a devcontainer.json or Dockerfile (or both). These files instruct Codespaces how to create a 'docker container' (something like a virtual machine) from a base docker 'image'.</p>\n<p>The following works for me:<br>\nCreate a .devcontainer directory in the root of your repository. Create a devcontainer.json file in this directory containing the following text:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">{</span>\n    <span class=\"s2\">\"name\"</span><span class=\"o\">:</span> <span class=\"s2\">\"Debian\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"image\"</span><span class=\"o\">:</span> <span class=\"s2\">\"mcr.microsoft.com/devcontainers/base:debian\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"onCreateCommand\"</span><span class=\"o\">:</span> <span class=\"s2\">\".devcontainer/setup.sh\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"customizations\"</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n        <span class=\"s2\">\"vscode\"</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n            <span class=\"s2\">\"extensions\"</span><span class=\"o\">:</span> <span class=\"o\">[</span>\n                <span class=\"s2\">\"leanprover.lean4\"</span>              <span class=\"bp\">//</span> <span class=\"n\">Lean</span> <span class=\"mi\">4</span> <span class=\"n\">extension</span>\n            <span class=\"o\">]</span>\n        <span class=\"o\">}</span>\n    <span class=\"o\">},</span>\n    <span class=\"s2\">\"remoteUser\"</span><span class=\"o\">:</span> <span class=\"s2\">\"vscode\"</span><span class=\"o\">,</span>\n    <span class=\"s2\">\"remoteEnv\"</span><span class=\"o\">:</span> <span class=\"o\">{</span>\n        <span class=\"s2\">\"PATH\"</span> <span class=\"o\">:</span> <span class=\"s2\">\"${containerEnv:PATH}:/home/vscode/.elan/bin:/home/vscode/.local/bin\"</span>\n    <span class=\"o\">}</span>\n<span class=\"o\">}</span>\n</code></pre></div>\n<p>This refers to another file <code>setup.sh</code> where I put the actual setup code. You could instead put the code directly into the onCreateCommand above instead. Here's my <code>setup.sh</code> file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">#!/</span><span class=\"n\">usr</span><span class=\"bp\">/</span><span class=\"n\">bin</span><span class=\"bp\">/</span><span class=\"n\">env</span> <span class=\"n\">bash</span>\n<span class=\"n\">curl</span> <span class=\"n\">https</span><span class=\"o\">:</span><span class=\"bp\">//</span><span class=\"n\">raw.githubusercontent.com</span><span class=\"bp\">/</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">master</span><span class=\"bp\">/</span><span class=\"n\">elan</span><span class=\"bp\">-</span><span class=\"n\">init.sh</span> <span class=\"bp\">-</span><span class=\"n\">sSf</span> <span class=\"bp\">\\</span>\n  <span class=\"bp\">|</span> <span class=\"n\">sh</span> <span class=\"bp\">-</span><span class=\"n\">s</span> <span class=\"c1\">-- --default-toolchain none  -y # Install the elan Lean version manager</span>\n<span class=\"kn\">export</span> <span class=\"n\">PATH</span><span class=\"bp\">=$</span><span class=\"n\">PATH</span><span class=\"o\">:</span><span class=\"bp\">~/.</span><span class=\"n\">elan</span><span class=\"bp\">/</span><span class=\"n\">bin</span>\n<span class=\"n\">lake</span> <span class=\"n\">exe</span> <span class=\"n\">cache</span> <span class=\"n\">get</span><span class=\"bp\">!</span>\n</code></pre></div>",
        "id": 390010108,
        "sender_full_name": "Gihan Marasingha",
        "timestamp": 1694248253
    },
    {
        "content": "<p>Thanks! This helps a lot, because I do not know how to create this files myself, and whenever I try to setup my own <code>Codespaces</code> environment and save it to a file like this, I run into trouble (it takes up a lot of memory space, or it simply does not work).</p>\n<p>I will try it out soon, to make sure it also works for me. Thanks again!</p>",
        "id": 390019910,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1694255622
    },
    {
        "content": "<p>Yes,  the <em>no installation</em> part is an advantage, as not all students find it interesting to install Lean without trying it out first.</p>\n<p>I wonder what you mean by assessment <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> Do you have an automatised grading procedure?</p>",
        "id": 390020237,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1694255820
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513540\">@Flo (Florent Schaffhauser)</span> Indeed, various people have set up automatic grading procedures.  You can see<br>\n<a href=\"#narrow/stream/187764-Lean-for-teaching/topic/Automatic.20grading.20of.20lean4.20codes\">https://leanprover.zulipchat.com/#narrow/stream/187764-Lean-for-teaching/topic/Automatic.20grading.20of.20lean4.20codes</a><br>\nfor a recent discussion.</p>",
        "id": 390165522,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1694366571
    },
    {
        "content": "<p>Thanks, Heather! So far I have managed to avoid this because the number of students has been 20+ and actually they were asking for more personal attention and guidance, but once I get to the point of teaching massive courses using Lean, it will be very helpful to be able to use this <span aria-label=\"blush\" class=\"emoji emoji-1f60a\" role=\"img\" title=\"blush\">:blush:</span></p>",
        "id": 390235914,
        "sender_full_name": "Flo (Florent Schaffhauser)",
        "timestamp": 1694408634
    }
]