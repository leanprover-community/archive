[
    {
        "content": "<p>Do we have a notation of bimodules? I'm aware that we could use <code>[AddCommGroup M] [Module R M] [Module S M] [SMulCommClass R S M]</code> but do we need a def for this? Moreover do we have a category of bimodule? Again I found <code>Bimod</code> in mathlib but this doesn't look quite right because it requires two monoid objects in the category of rings (<code>ℤ</code>-algebras)? Or is it the one I want?</p>",
        "id": 538058707,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757229069
    },
    {
        "content": "<p>No two typeclasses in <code>[AddCommGroup M] [Module R M] [Module S M] [SMulCommClass R S M]</code> talk about the same set of free variables, so there is no way to make it shorter except for some elaboration magic like <code>class abbrev</code></p>",
        "id": 538059841,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1757230424
    },
    {
        "content": "<p>are you suggesting that we use this way and never have a definition of the category of bimodules? Because I want a way to describe <code>BimoduleHom</code> as a type :-(</p>",
        "id": 538059918,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757230535
    },
    {
        "content": "<p>You asked about a typeclass of the form <code>Bimodule R S M</code>. I am saying this typeclass is <code>SMulCommClass R S M</code>. I haven't said anything about the category of bimodules</p>",
        "id": 538060010,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1757230645
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538060010\">said</a>:</p>\n<blockquote>\n<p>You asked about a typeclass of the form <code>Bimodule R S M</code>. I am saying this typeclass is <code>SMulCommClass R S M</code>. I haven't said anything about the category of bimodules</p>\n</blockquote>\n<p>Are you suggesting this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">BiModuleCat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">carrier</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isModuleR</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isModuleS</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isCompatible</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 538161416,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757320162
    },
    {
        "content": "<p>I don't think Yael was suggesting anything about the category of bimodules</p>",
        "id": 538166459,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757321524
    },
    {
        "content": "<p>But that looks reasonable to me</p>",
        "id": 538166482,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757321529
    },
    {
        "content": "<p>What are you going to use for the morphisms?</p>",
        "id": 538166515,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757321540
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538166515\">said</a>:</p>\n<blockquote>\n<p>What are you going to use for the morphisms?</p>\n</blockquote>\n<p>I’m thinking just map_smul for R and S actions?</p>",
        "id": 538170487,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757322574
    },
    {
        "content": "<p>So a linear map plus an extra field?</p>",
        "id": 538174672,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757323693
    },
    {
        "content": "<p>I am completely confused. Isn't an (R,S)-bimodule usually an abelian group with a left action of R and a commuting right action of S? That's not what the above code says.</p>",
        "id": 538187716,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757327574
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538187716\">said</a>:</p>\n<blockquote>\n<p>I am completely confused. Isn't an (R,S)-bimodule usually an abelian group with a left action of R and a commuting right action of S? That's not what the above code says.</p>\n</blockquote>\n<p>I was just following the instructions given in Mathlib/Algebra/Module/Bimodule <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span></p>",
        "id": 538194193,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757329483
    },
    {
        "content": "<p>But in the module docstring for that file it says</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">ᵐᵒᵖ</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">ᵐᵒᵖ</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>which is (correct and) not what you wrote.</p>",
        "id": 538194627,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757329613
    },
    {
        "content": "<p>But it also said its “preferable” to set things without opposite? I’m confused too… <span aria-label=\"smiling face with tear\" class=\"emoji emoji-1f972\" role=\"img\" title=\"smiling face with tear\">:smiling_face_with_tear:</span></p>",
        "id": 538194813,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757329673
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538194627\">said</a>:</p>\n<blockquote>\n<p>the module docstring for that file</p>\n</blockquote>\n<p>Which file?</p>",
        "id": 538195751,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757329943
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/Bimodule.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/Bimodule.html</a></p>",
        "id": 538196525,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757330170
    },
    {
        "content": "<p>For implementation of API via the tensor product trick I totally agree that we don't need the ops, but if we're defining the category of bimodules then we surely do, otherwise the definition is just wrong.</p>",
        "id": 538196803,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757330256
    },
    {
        "content": "<p>'Wrong\" or \"more general\"?</p>",
        "id": 538197453,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757330485
    },
    {
        "content": "<p>You could define</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">BiModuleCat'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">carrier</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isModuleR</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isModuleS</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">isCompatible</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SMulCommClass</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">carrier</span><span class=\"o\">]</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">BiModuleCat</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">BiModuleCat'</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"bp\">ᵐᵒᵖ</span>\n</code></pre></div>",
        "id": 538197570,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757330517
    },
    {
        "content": "<p>Probably you'd find most if not all of your results hold in the generality of the primed version</p>",
        "id": 538197668,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757330552
    },
    {
        "content": "<p>Of course, if the primed version is totally uninteresting that's not a particularly relevant observation</p>",
        "id": 538197799,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757330600
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538196803\">said</a>:</p>\n<blockquote>\n<p>For implementation of API via the tensor product trick I totally agree that we don't need the ops, but if we're defining the category of bimodules then we surely do, otherwise the definition is just wrong.</p>\n</blockquote>\n<p>persumably we also want <code>BiModuleCat R S</code> equivalent to the ModuleCat of their tensorproduct (later) but yeah I agree that we want the right definition</p>",
        "id": 538198266,
        "sender_full_name": "Edison Xie",
        "timestamp": 1757330750
    },
    {
        "content": "<p>Is <code>BiModuleCat' R S</code> not just the same as <code>BiModuleCat R Sᵐᵒᵖ</code> since <code>ᵐᵒᵖ</code> is involutive?</p>",
        "id": 538198275,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757330753
    },
    {
        "content": "<p><code>ᵐᵒᵖ</code> is not definitionally involutive, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MulOpposite#src\">src#MulOpposite</a> is a one-field structure</p>",
        "id": 538200746,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1757331490
    },
    {
        "content": "<p>what I meant is, its composition with itself is naturally isomorphic to the identity functor in the category of rings</p>",
        "id": 538212016,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1757334556
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Bimodules/near/538197453\">said</a>:</p>\n<blockquote>\n<p>'Wrong\" or \"more general\"?</p>\n</blockquote>\n<p>Wrong. That's not the category of (R,S)-bimodules,  it's the category of (R,S^{op})-bimodules, so it shouldn't be called <code>BiModuleCat R S</code>.</p>",
        "id": 538214393,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757335154
    },
    {
        "content": "<p>But just to be clear -- I agree with your <code>abbrev BiModuleCat</code> idea above (although maybe <code>BiModuleOpCat</code> or something would be a better name than <code>BiModuleCat'</code>, I am worried we'll confuse mathematicians who are just browsing).</p>",
        "id": 538215791,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757335502
    },
    {
        "content": "<p>The reason one usually works with <code>BimoduleCat</code> is that there's a \"tensor product over S\" functor <code>BiModuleCat R S -&gt; BiModuleCat S T -&gt; BiModuleCat R T</code> and this looks quite natural (R acts on the left on M and T acts on the right of N, so both act on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><msub><mo>⊗</mo><mi>S</mi></msub><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">M\\otimes_S N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mbin\">⊗</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\">S</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> acts on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> on the right and on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span> on the left), whereas doing this with tensor products would involve some some kind of contraction (totally doable, but somehow feels a lot less natural). However we also do something which mathematicians would presumably regard as unnatural when we secretly regard bilinear maps as linear maps to linear maps, and maybe this is just the same sort of thing.</p>",
        "id": 538216410,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1757335686
    }
]