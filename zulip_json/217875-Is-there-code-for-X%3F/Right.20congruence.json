[
    {
        "content": "<p>I'm introducing a notion of \"right congruence\"  over <code>Language</code> in <a href=\"https://github.com/leanprover/cslib/pull/265\">cslib#265</a>.  <span class=\"user-mention\" data-user-id=\"687698\">@Chris Henson</span> suggested that I ask here to see if anyone have any thoughts about the definitions  I made in <code>RightCongruence.lean</code>.</p>",
        "id": 568624176,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768694151
    },
    {
        "content": "<p>I think this might be similar to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CovariantClass#doc\">docs#CovariantClass</a> ?</p>",
        "id": 568624302,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1768694338
    },
    {
        "content": "<p>I do want the underlying relation to be an equivalence relation and I will form the quotient type of the equivalence relation.  But I guess I can state the <code>right_congr</code> condition using <code>CovariantClass</code>?</p>",
        "id": 568624655,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1768694712
    },
    {
        "content": "<p>To follow up on this, yes this does line up. Also, I think we would rather this be a <code>Prop</code> class rather than extend <code>Setoid</code>, which is in <code>Sort</code>? Regardless, the following are equivalent:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">RightCongruence</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">right_congr</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">huv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">++</span><span class=\"w\"> </span><span class=\"n\">w</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">RightCongruence_iff_CovariantClass</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">RightCongruence</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">CovariantClass</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">flip</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·++·</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">flip</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Covariant</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">CovariantClass</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RightCongruence</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 569410506,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769058769
    },
    {
        "content": "<p>Where is the equivalence <code>≈</code> defined?</p>",
        "id": 569417550,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1769063812
    },
    {
        "content": "<p>This is using the instance for lists, is that not what you intended?</p>",
        "id": 569417813,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769063962
    },
    {
        "content": "<p>I must be missing something.  In the class definition above, is <code>≈</code> a free variable?</p>",
        "id": 569418019,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1769064119
    },
    {
        "content": "<p>Two questions:<br>\n(1) How do I give a specific definition to <code>≈</code>, as I need to do in <a href=\"https://github.com/leanprover/cslib/pull/278\">cslib#278</a>?<br>\n(2) I do need form the quotient type of <code>≈</code>.  How do I do that if it is not a <code>Setoid</code>?</p>",
        "id": 569418289,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1769064305
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110637\">Ching-Tsun Chou</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Right.20congruence/near/569418019\">said</a>:</p>\n<blockquote>\n<p>I must be missing something.  In the class definition above, is <code>≈</code> a free variable?</p>\n</blockquote>\n<p>I think I see the confusion. The <code>Prop</code> version I used above is picking up <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.isSetoid#doc\">docs#List.isSetoid</a>. I did not realize you really needed to specify a different setoid until seeing an example. I think (but am not sure) that the <code>CovariantClass</code> is still applicable here. I'll take a closer look again at the new PR maybe tomorrow.</p>",
        "id": 569420883,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769065896
    },
    {
        "content": "<p>(in retrospect this is somewhat obvious, sorry for the noise!)</p>",
        "id": 569421397,
        "sender_full_name": "Chris Henson",
        "timestamp": 1769066204
    }
]