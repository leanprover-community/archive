[
    {
        "content": "<p>I have the goal: <code>DifferentiableOn ℝ (deriv (cos ∘ sqrt)) (Set.Ioo 0 ((π / 2) ^ 2))</code><br>\nI can't (rewrite/apply DifferentiableOn.congr) with <code>deriv_comp</code> because sqrt is not Differentiable, but I can't see an equivalent that applies chain rule on just a subset.<br>\nI can probably just brute force unfolding until I get something I can prove, but I want to know what the intended way would be.<br>\n(Also, should this be here or in the mathlib channel? The latter seems to be more for development within mathlib, but this isn't quite a \"Code for X\" query)</p>",
        "id": 554735294,
        "sender_full_name": "ohhaimark",
        "timestamp": 1762790050
    },
    {
        "content": "<p><code>deriv_comp</code> only requires <code>DifferentiableAt</code>, so why can’t you use <code>DifferentiableOn.congr</code>?</p>",
        "id": 554737001,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1762790485
    },
    {
        "content": "<p>It may help to share your question as a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a></p>",
        "id": 554737441,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1762790589
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"703970\">@Etienne Marion</span> I must have read it wrong when I looked at the definition. Just a brainfart then. Apologies.</p>",
        "id": 554741162,
        "sender_full_name": "ohhaimark",
        "timestamp": 1762791681
    },
    {
        "content": "<p>I now have a similar problem with a 2nd derivative. I can't rewrite the inner derivative because it doesn't have bounds applied to it. <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQEwCmAdnAEoFLo47oEghJwDmElcOccAFAMYQDOAfX4BHWIIAmBKMABucAFxxAAERwAHnEAQRHADKBGADoAkhAhwADNy6AB4DgB6OACYAlHAB6T5wBo4UmfN4BOEAMIjhRWFcNAF44AFp+YBJALCINBy5HOAAqOBTnZw5uDSVAXEJ8zi41QUh+RQs4AB51MsLBdHglDUabe093XoUCy0ATIl9pOW4AMwBXEgBPOCiAPlH/bj4a0PCYV1nIxRisWYLOfmgoI5xY2LgAFVQCOAhZaUp0ZlY3mDMwKCeCaiucFo9EYfCIzzUAHkiIJ1sIxO04ABhCDgghQkjFbh6QxGHg8OpcGx2FxuFyuQIbMII1wKA5HQGcVBIZ5wOFbSRjeRKVQabQ44ymQndBwuPouHx+caUkLUiLqBZxBLJVLcDLZXL7OCHS7XTgnUBgR5EdDzADaApAdEEJggPiQRAkgkNAF1dfrOIkYL8ahpKtV1K0YO6PVAAO5wM1S2SwiDgSVc2P8ADkCf88NgabkzokyeTbsZ+oA7XAJsACOgnQlwCHi2FDbXOCXMEQkDI0I24CXq2BOyWkGAwKa4AARYATCbSYgwYBILC0ACChi2nYNNcLHpbbeAHcLA6H8zBEOhgggE05/kcgiIqKIBCYtf7g+HR/RNvxj7gUAIZbvyNRM5EFMEBTPw0IGHw4DcDAdICjMciuAA/IIcDIahgh9myAGJFMO4Mnqdb7sOKJEIBwGgRB2FASBYFEKuWGkTheGYUR8yWgO/A3BAzoTsIUxYPw+hVN+oBIEwBAGOAUD0T2n7fr+DxjhOU6MXOtDgZBRpcDBURwUQCHoYZyEsc+8xKZO36qfOEkSOOFnTrO1nQjJDYbl29ZQaiw5ml6YzQO+PAFgRHqsaOdkqTOakEOBK5uU2cCheZEWObQBi2cplmRU5dFxfqsm5SWTAyI6JkHro+iSRxXE8ee/D8YJMDCQQoniZJPwueuBHdoaxreb5Mj+XigWdol4WZSl0VEJRRBFZMWpcLERLKl2rhpOqK2uJsNL5G53WeSa5rpfZVnqTCd5MDVQUevqo0ZQ5UUaXGWk6QKJjABYO3BYRplhXdJ2TWlcj0fFt3HVlqVHclD05V910eb2uUgz9SXjVFgN/eDk3AzdyNjfd1mSVMVCI3lrmw9d+Xk/FRWJBI9FPmVKP46dBixVTCW4xjE3o2DE3OSTe0I+zhXFXTBUc2V7FgJx3F2XxAlCT8zUMK1UnYz2vXmgKdUK41UgTD4lrWrahsVVaIBNS1BCm4Y5s2hAwA+By1T2o6zrgFdcOcDTJW7XAXo+gqlSJB1RpeeaAAKwAGOdgisT4ABiMw8DOqKUeAcemT4UeAzGrGe9dPti118Oa5G/XAIN+I25JxumInyep1NO4vDABB8dXcBJ0QKeV83bdQCg7cAF7SHaXeN33BjAE6+teJ23e92nmmZwertOq6nYB2YfpVEElRtJ2R7+yQXDRmsQRbRErhLOwuU8MyM0PFw0xzAsyznzKV/bHAuydqcUBzhAA\">MWE</a></p>",
        "id": 554781440,
        "sender_full_name": "ohhaimark",
        "timestamp": 1762805049
    },
    {
        "content": "<p>You should post the code here, instructions are in <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> and <a href=\"https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks\">#backticks</a>.</p>",
        "id": 554782095,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1762805224
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Real</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">goal</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">cos_sqrt_deriv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Ioo</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">sqrt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"n\">sin</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">√</span><span class=\"n\">x</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">x_pos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">x_lt</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">π</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">deriv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cos</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">sqrt</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Forgive my reading comprehension.</p>",
        "id": 554782293,
        "sender_full_name": "ohhaimark",
        "timestamp": 1762805296
    },
    {
        "content": "<p>I think you could use <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/Calculus/Deriv/Basic.html#Set.EqOn.deriv\">Set.EqOn.deriv</a>.</p>",
        "id": 554782841,
        "sender_full_name": "Etienne Marion",
        "timestamp": 1762805495
    }
]