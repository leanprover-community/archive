[
    {
        "content": "<p>I saw that a lot of matroid theory has been recently added to mathlib by <span class=\"user-mention\" data-user-id=\"329425\">@Peter Nelson</span>. Is there already a formalization of the Tutte polynomial? If not, I could try to do it, but I don't want to duplicate work if it is unnecessary.</p>",
        "id": 511348383,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1744274568
    },
    {
        "content": "<p>I haven’t done this, and it is a good idea!</p>",
        "id": 511376058,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744283017
    },
    {
        "content": "<p>As of recently, mathlib should have all the needed machinery, with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matroid.contract#doc\">docs#Matroid.contract</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Matroid.delete#doc\">docs#Matroid.delete</a> . Any applications for graphs will need graphic matroids and multigraphs, neither of which are in mathlib or my repo yet.</p>",
        "id": 511388746,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744286315
    },
    {
        "content": "<p>But plenty of the material for Tutte polynomials will work at the generality of matroids, and will specialize routinely to graphs one the matroid/graph API is there.</p>\n<p>I rode my bike past Tutte’s old house the other day!</p>",
        "id": 511389148,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744286416
    },
    {
        "content": "<p>Hmm, are you planning to add <code>Matroid.Minor.Rank</code> to mathlib soon? I think it makes sense to define the Tutte polynomial using <code>eRelRk</code>. My current attempt looks somewhat like this</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Matroid</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Matroid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">tutte</span><span class=\"bp\">.</span><span class=\"n\">summand</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">eRank</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">eRk</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">ncard</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">eRk</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">tutte</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∑ᶠ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">E</span><span class=\"bp\">.</span><span class=\"n\">powerset</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">tutte</span><span class=\"bp\">.</span><span class=\"n\">summand</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Matroid</span>\n</code></pre></div>\n<p>probably it is nicer to use</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">tutte</span><span class=\"bp\">.</span><span class=\"n\">summand</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"o\">((</span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">eRelRk</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"bp\">^</span><span class=\"o\">((</span><span class=\"n\">M</span><span class=\"bp\">✶.</span><span class=\"n\">eRk</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 511627665,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1744371156
    },
    {
        "content": "<p>I can prioritize that. It is probably better to define <code>relRk</code> as <code>(eRelRk _).toNat</code> and to wrap it with sensible API to avoid working with <code>toNat</code> directly.</p>",
        "id": 511628196,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744371331
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/23873\">#23873</a> is in review, and there might be a need for another <code>ENat</code> rank PR, but I think <code>Matroid.Minor.Rank</code> can be next after that. <span class=\"user-mention\" data-user-id=\"246273\">@Bhavik Mehta</span> , <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>  and <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span>  are being very kind with their fast reviews at the moment!</p>",
        "id": 511628801,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744371541
    },
    {
        "content": "<p>I've just made <a href=\"https://github.com/leanprover-community/mathlib4/pull/23951\">#23951</a>, which I think should contain all the <code>eRk</code> API needed to make <code>eRelRk</code> work.</p>",
        "id": 511667550,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744382143
    },
    {
        "content": "<p>I have created a WIP PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/23953\">#23953</a> that deals with the manipulation of the sums in the Tutte polynomial, with 4 <code>sorry</code> lemmas where I would need to relate the summands of the Tutte polynomial to the deletion or contraction. Feel free to have a look already. I will attack those lemmas once we have <code>eRelRk</code> in mathlib.</p>",
        "id": 511668447,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1744382356
    },
    {
        "content": "<p>Some basic sum manipulation is in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23926\">#23926</a></p>",
        "id": 511668564,
        "sender_full_name": "Bernhard Reinke",
        "timestamp": 1744382388
    },
    {
        "content": "<p>That is looking very nice already!</p>",
        "id": 511671550,
        "sender_full_name": "Peter Nelson",
        "timestamp": 1744383175
    }
]