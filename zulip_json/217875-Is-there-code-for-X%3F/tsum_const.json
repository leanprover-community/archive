[
    {
        "content": "<p>Is there code for</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">scoped</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span>\n<span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Countable</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"bp\">∞</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">∑'</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">s.encard.toENNReal</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>?</p>",
        "id": 454475467,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722089453
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=tsum_const#doc\">docs#tsum_const</a> ?</p>",
        "id": 454475604,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722089578
    },
    {
        "content": "<p>no because <code>ENNReal</code> is not a group (the <code>c</code>)</p>",
        "id": 454477268,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722090723
    },
    {
        "content": "<p>And also in that setting the sum will be treated as 0 (since the Nat.card is 0). But maybe I can split cases on whether <code>s</code> is finite or not... let me try</p>",
        "id": 454477360,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722090774
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ENNReal.tsum_const_eq#doc\">docs#ENNReal.tsum_const_eq</a> ?</p>",
        "id": 454477437,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722090800
    },
    {
        "content": "<p>A bit weird that it invokes measure theory, but I'm sure you could extract your statement from the current proof</p>",
        "id": 454477493,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722090833
    },
    {
        "content": "<p>Looks like it, might need to figure out some details but yea, thanks :D</p>",
        "id": 454477580,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722090857
    },
    {
        "content": "<p>Thank <a href=\"https://leanprover-community.github.io/mathlib4_docs\">https://leanprover-community.github.io/mathlib4_docs</a>, not me <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 454477653,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1722090883
    },
    {
        "content": "<p>Lol yeah I didn't look closely enough</p>",
        "id": 454477697,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722090906
    },
    {
        "content": "<p>there is a version of this in the <a class=\"stream\" data-stream-id=\"442935\" href=\"/#narrow/stream/442935-Carleson\">#Carleson</a>  project, i believe</p>",
        "id": 454478967,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091389
    },
    {
        "content": "<p>yup, check <a href=\"https://github.com/fpvandoorn/carleson/blob/master/Carleson/ToMathlib/Misc.lean\">this file</a></p>",
        "id": 454479180,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091444
    },
    {
        "content": "<p>minus the countable assumption, that is</p>",
        "id": 454479229,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091474
    },
    {
        "content": "<p>Amaazing, thanks! <code>ENNReal.tsum_const_eq'</code> is what I need</p>",
        "id": 454479269,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722091488
    },
    {
        "content": "<p>written by yours truly <span aria-label=\"heart\" class=\"emoji emoji-2764\" role=\"img\" title=\"heart\">:heart:</span></p>",
        "id": 454479336,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722091513
    },
    {
        "content": "<p>Please PR this to Mathlib! (either Edward or Gareth if Edward is fine with it)</p>",
        "id": 454479732,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722091676
    },
    {
        "content": "<p>sure, i'll do it</p>",
        "id": 454480976,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722092270
    },
    {
        "content": "<p>Oops, I missed the message. PR'ing would be great, thanks a lot in advance.</p>",
        "id": 454485123,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722094189
    },
    {
        "content": "<p>i can't seem to find a good file for this... <code>Data.Set.card</code> (which contains <code>Set.encard</code>) is hardly ever used, meaning that the home for these lemmas would be <code>Mathlib</code> <span aria-label=\"face with peeking eye\" class=\"emoji emoji-1fae3\" role=\"img\" title=\"face with peeking eye\">:face_with_peeking_eye:</span> ... <code>#min_imports</code> suggests <strong><em>three</em></strong> imports... </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">ENatENNReal</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Card</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Instances</span><span class=\"bp\">.</span><span class=\"n\">ENNReal</span>\n</code></pre></div>",
        "id": 454488640,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722095874
    },
    {
        "content": "<p><code>#min_imports</code> is a lower bound, <code>#find_home!</code> are upper bounds: try with that and <code>import Mathlib</code>.</p>",
        "id": 454488745,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722095942
    },
    {
        "content": "<p>that's what i was doing already...</p>",
        "id": 454488760,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722095962
    },
    {
        "content": "<blockquote>\n<p><code>Data.Set.card</code> (which contains <code>Set.encard</code>) is hardly ever used</p>\n</blockquote>\n<p>:(</p>",
        "id": 454488774,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722095982
    },
    {
        "content": "<p>when i try <code>#find_home!</code> while importing <code>Mathlib</code> it suggests <code>Mathlib</code></p>",
        "id": 454488785,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722095997
    },
    {
        "content": "<p>Ok, I misunderstood your previous comment, sorry.</p>",
        "id": 454488863,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722096020
    },
    {
        "content": "<p>In fact, <code>Mathlib.Data.Real.ENatENNReal</code> is also not imported anywhere, other than <code>Mathlib</code>.</p>",
        "id": 454488959,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722096062
    },
    {
        "content": "<p>ah, so it is...</p>",
        "id": 454489001,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096084
    },
    {
        "content": "<p>So it looks like either a new file, or adding an import.  I think that the latter would require a little bit of explaining why adding an import is preferred to a new file.</p>",
        "id": 454489267,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722096207
    },
    {
        "content": "<p>i suppose the real question would be if this lemma is even wanted in mathlib then, seeing as its requirements are scarcely or not used</p>",
        "id": 454489762,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096395
    },
    {
        "content": "<p>Yes I think it should be. If this basic lemma are not added, no one will work on using these \"scarcely used requirements\"</p>",
        "id": 454489896,
        "sender_full_name": "Gareth Ma",
        "timestamp": 1722096454
    },
    {
        "content": "<p>i mean that it is thinkable that these requirements are scarcely used because they are part of a pattern that is concidered <em>bad</em></p>",
        "id": 454490057,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096523
    },
    {
        "content": "<p>New files with new lemmas are constantly added: the review process is a good place to see if the new lemmas are wanted.  Besides, Floris already supported the lemma -- that is a big vote of confidence!</p>",
        "id": 454490171,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1722096573
    },
    {
        "content": "<p>very well. then remains the question of where to put this new file...</p>",
        "id": 454490405,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096692
    },
    {
        "content": "<p>somewhere in the <code>Mathlib.Topology.Algebra.InfiniteSum</code> folder i think?</p>",
        "id": 454490584,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096754
    },
    {
        "content": "<p>although i'm not sure that this is algebra...</p>",
        "id": 454490634,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096779
    },
    {
        "content": "<p>i'll make the file <code>Mathlib.Topology.Algebra.InfiniteSum.ENNReal</code></p>",
        "id": 454490865,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722096889
    },
    {
        "content": "<p>ok, it's at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15214\">#15214</a></p>",
        "id": 454526782,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722113300
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/tsum_const/near/454477493\">said</a>:</p>\n<blockquote>\n<p>A bit weird that it invokes measure theory, but I'm sure you could extract your statement from the current proof</p>\n</blockquote>\n<p>At the time it was added, we didn't have <code>ENat</code>s (more precisely, <code>PartENat</code>s were called <code>enat</code> and we didn't have much theory about this type).</p>",
        "id": 454560168,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722136129
    },
    {
        "content": "<p>Currently, facts about <code>tsum</code> and <code>ENNReal</code>s are in <code>Topology/Instances/ENNReal</code>. It would be nice to move them to a new file (and drop this dependency in <code>Topology/Instances/ENNReal</code>).</p>",
        "id": 454560273,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722136168
    },
    {
        "content": "<p>But this should be a separate \"move only\" PR, not the same PR that adds new lemma(s).</p>",
        "id": 454560308,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722136189
    },
    {
        "content": "<p>with regards to the current <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ENNReal.tsum_const_eq#doc\">docs#ENNReal.tsum_const_eq</a> , i think that maybe it is better replaced with a lemma saying that for [<a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/MeasurableSpace/Defs.html#MeasurableSingletonClass\">MeasurableSingletonClass</a> α], casting <code>Set.encard</code> is the same as <code>Measure.count</code> or something along those lines...</p>",
        "id": 454588643,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722157823
    },
    {
        "content": "<p>assuming that <a href=\"https://github.com/leanprover-community/mathlib4/pull/15214\">#15214</a> gets merged, that is</p>",
        "id": 454588729,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1722157855
    },
    {
        "content": "<p>PR is sent off to bors, for those interested <span aria-label=\"tada\" class=\"emoji emoji-1f389\" role=\"img\" title=\"tada\">:tada:</span></p>",
        "id": 459489719,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1723213882
    }
]