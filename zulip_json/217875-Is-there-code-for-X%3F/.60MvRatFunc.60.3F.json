[
    {
        "content": "<p>Is it a good idea to write <code>abbrev MvRatFunc := FractionRing (MvPolynomial σ F)</code>? I need a few results of it, and can't find a suitable file to put them.</p>\n<p>In mathlib <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RatFunc#doc\">docs#RatFunc</a> is a wrapped version of <code>FractionRing (Polynomial F)</code> but not an <code>abbrev</code>. It is said that</p>\n<blockquote>\n<p>To provide good API encapsulation and speed up unification problems, <code>RatFunc</code> is defined as a structure, and all operations are <code>@[irreducible] def</code>s</p>\n</blockquote>\n<p>...but it's a big work to copy these for <code>MvRatFunc</code>.</p>",
        "id": 484464450,
        "sender_full_name": "Jz Pan",
        "timestamp": 1732612292
    },
    {
        "content": "<p>If you need it locally, then an <code>abbrev</code> makes sense. For mathlib, I think that a proper <code>def</code> is better.</p>",
        "id": 485751091,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733199678
    },
    {
        "content": "<p>In fact it's needed in <a href=\"https://github.com/leanprover-community/mathlib4/pull/19527\">#19527</a>, but only one result. So far I just use <code>FractionRing (MvPolynomial σ F)</code> and not introduced <code>MvRatFunc</code> yet.</p>",
        "id": 485760594,
        "sender_full_name": "Jz Pan",
        "timestamp": 1733204575
    },
    {
        "content": "<p>This is also used in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/AlgebraicIndependent/Adjoin.html#AlgebraicIndependent.aevalEquivField\">AlgebraicIndependent.aevalEquivField</a>, and is also in plain form <code>FractionRing (MvPolynomial σ F)</code>.</p>",
        "id": 485760824,
        "sender_full_name": "Jz Pan",
        "timestamp": 1733204700
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> FractionRing (MvPolynomial _ _)</p>",
        "id": 485928815,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733252298
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/MvRatFunc/Rank.html#MvRatFunc.rank_eq_max_lift\">MvRatFunc.rank_eq_max_lift</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/AlgebraicIndependent.html#AlgebraicIndependent.aevalEquivField\">AlgebraicIndependent.aevalEquivField</a>, and <a href=\"https://loogle.lean-lang.org/?q=FractionRing%20%28MvPolynomial%20_%20_%29\">5 more</a></p>",
        "id": 485928823,
        "sender_full_name": "loogle",
        "timestamp": 1733252300
    },
    {
        "content": "<p>I'm not sure about the exact threshold for adding a <code>def</code> with API. I don't use this part of the library, so I'm going to leave this decision to someone who uses it.</p>",
        "id": 485929234,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1733252411
    },
    {
        "content": "<p>Maybe not now yet. <code>RatFunc</code> provides convenient API, e.g. <code>RatFunc.X</code> etc. I think we need to add <code>MvRatFunc</code> when we need to use <code>MvRatFunc.X</code> (instead of <code>algebraMap (MvPolynomial σ F) (FractionRing (MvPolynomial σ F)) (MvPolynomial.X ...)</code>).</p>",
        "id": 485930000,
        "sender_full_name": "Jz Pan",
        "timestamp": 1733252643
    },
    {
        "content": "<p>I'm a little surprised that <code>RatFunc</code> is a <code>def</code> and not an <code>abbrev</code>, given it (presumably?) shares all of its operations with <code>FractionRing (Polynomial R)</code></p>",
        "id": 485943769,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1733256836
    },
    {
        "content": "<p>I don't know if someone wants to try <code>abbrev RatFunc := FractionRing (Polynomial R)</code> and see what happens?</p>",
        "id": 498464597,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738986675
    },
    {
        "content": "<p>I tried this in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23640\">#23640</a> and the slowdown is 0.11%, and there's a <a href=\"https://github.com/leanprover-community/mathlib4/pull/23640/files#diff-96b6e72cf5cfbce0d9769567f865deee21ffacd9f789d12af598953a6b6da7ebR491\">IsScalarTower instance search</a> that times out. I think I'll try again after the unbundling of algebraic and order hierarchies is merged.</p>",
        "id": 510124754,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1743756318
    },
    {
        "content": "<p>Maybe we have to seal them, just like ring of integers of number field.</p>",
        "id": 510143108,
        "sender_full_name": "Jz Pan",
        "timestamp": 1743761560
    },
    {
        "content": "<p>Interestingly, <code>Mathlib.RingTheory.LaurentSeries</code> (one of the two red files in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23640\">#23640</a>) is also one of the two red files in <a href=\"https://github.com/leanprover-community/mathlib4/pull/23621\">#23621</a> (see <a href=\"https://github.com/leanprover-community/mathlib4/pull/23621#issuecomment-2775458339\">here</a> )</p>",
        "id": 510160567,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1743766771
    }
]