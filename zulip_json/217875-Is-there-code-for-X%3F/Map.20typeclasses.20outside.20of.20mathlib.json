[
    {
        "content": "<p>Apologies if this has been answered but I couldn't find it. Are there any typeclasses for things which behave like maps outside of mathlib? I want some way to specify that a type with eg. an <code>Insert</code> instance (like in <code>Init/Core.lean</code>) is well-behaved--I could write it myself, but I'm wondering if somebody already has.</p>",
        "id": 525585840,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1750795002
    },
    {
        "content": "<p>What do you mean \"behave like map\"?</p>",
        "id": 525586304,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1750795191
    },
    {
        "content": "<p>Like, it should have a typeclass for an <code>insert</code> and <code>get</code> operation, and if I <code>insert</code> and then <code>get</code> at a key it will give me the same value</p>",
        "id": 525586805,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1750795375
    },
    {
        "content": "<p>There are a few ways I could think to specify this, but it just seems like the kind of thing someone might have already done.</p>",
        "id": 525586960,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1750795439
    },
    {
        "content": "<p>but you can't do that for multisets, sets, or finsets</p>",
        "id": 525587009,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750795460
    },
    {
        "content": "<p>basically only works for List</p>",
        "id": 525587027,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1750795472
    },
    {
        "content": "<p>To be clear, I meant \"map\" as in \"key value store\". Sorry, I was unclear with my terminology.</p>",
        "id": 525587162,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1750795535
    },
    {
        "content": "<p>do you mean <code>HashMap</code>, <code>TreeMap</code>, <code>RBMap</code>, etc.? In that case, why do you want to a type class and not just use a specific type?</p>",
        "id": 525587249,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750795567
    },
    {
        "content": "<p>Because I'm writing a library with proofs that apply to all three of those (and more)</p>",
        "id": 525587340,
        "sender_full_name": "Markus de Medeiros",
        "timestamp": 1750795609
    },
    {
        "content": "<p>In that case, yeah you'd probably need to write something yourself (I'm not even certain this is in mathlib in any form)</p>",
        "id": 525587585,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750795714
    },
    {
        "content": "<p>Although maybe some of the lemmas are worth upstreaming to core?</p>",
        "id": 525587624,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750795732
    },
    {
        "content": "<p>Something like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MapLike</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">outParam</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">EmptyCollection</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Insert</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">get?_empty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"bp\">∅</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">none</span>\n<span class=\"w\">  </span><span class=\"n\">get?_insert_self</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">v</span>\n<span class=\"w\">  </span><span class=\"n\">get?_insert_of_ne</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">k'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">k'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">k</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">k'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">k'</span>\n</code></pre></div>",
        "id": 525588452,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1750796089
    },
    {
        "content": "<p>You might be interested in LeanColls</p>",
        "id": 525588940,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1750796307
    }
]