[
    {
        "content": "<p>Let's say I want to state elementary results about area in the Euclidean plane (an affine space, or an <code>AddTorsor</code>), is the following the following the right way to transfer the measure from the vector space? Do we have / plan to have code like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddTorsor</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"bp\">.</span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">-·µ•</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">arbitrary</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableAdd</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableConstVAdd</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Measure</span><span class=\"bp\">.</span><span class=\"n\">onAddTorsor</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">-·µ•</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">arbitrary</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">Œº</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Measure</span><span class=\"bp\">.</span><span class=\"n\">IsAddLeftInvariant</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">VAddInvariantMeasure</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Measure</span><span class=\"bp\">.</span><span class=\"n\">onAddTorsor</span><span class=\"w\"> </span><span class=\"n\">Œº</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 570193872,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769463655
    },
    {
        "content": "<p>Probably your want a different measurable space structure</p>",
        "id": 570194082,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769463772
    },
    {
        "content": "<p>Even if you do want the same one; you should instead have something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">MeasurableTorsor</span>\n<span class=\"w\">     </span><span class=\"o\">(</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddTorsor</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">measurableSpaceEq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"bp\">.</span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"bp\">-·µ•</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n</code></pre></div>\n<p>(it's not safe to copy the one on the module as an instance, because if you have <code>P = V</code> you're stuck in a loop)</p>",
        "id": 570194121,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769463795
    },
    {
        "content": "<p>one that's not just a copy of the one on the module</p>",
        "id": 570194197,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769463833
    },
    {
        "content": "<p>Aaron, do you have an example in mind where having compatible measure spaces is undesirable?</p>",
        "id": 570194409,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769463945
    },
    {
        "content": "<p>this reminds me of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsModuleTopology#doc\">docs#IsModuleTopology</a></p>",
        "id": 570198046,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769465541
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Measure.20on.20affine.20space/near/570194197\">said</a>:</p>\n<blockquote>\n<p>one that's not just a copy of the one on the module</p>\n</blockquote>\n<p>after thinking about it, the only reasonable choice actually is to just copy the one on the addgroup, but only if we also know that the measure on the addgroup behaves well, otherwise there is no reasonable choice</p>",
        "id": 570198780,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769465849
    },
    {
        "content": "<p>Copying is not a reasonable choice (since in any concrete setting <code>P</code> may already have a measurablespace instance), but a class that says an ambient space <em>is</em> a copy might be</p>",
        "id": 570199555,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769466243
    },
    {
        "content": "<p>As well as a class to say that the measure on a torsor agrees with the (hopefully translation-invariant) measure on the underlying <code>AddGroup</code> (nothing about this should depend on the module structure, just the group), it would be reasonable to have a <code>def</code> to copy the measure (but not an instance that copies the measure, to avoid problems for the group as a torsor for itself, as discussed above).</p>",
        "id": 570212431,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473108
    },
    {
        "content": "<p>But we've also previously discussed that Hausdorff measure might be a better way of talking about areas in a Euclidean context. It's derived from the metric, so doesn't involve any of these issues with instances. And it allows you to talk about areas when the ambient space is more than two-dimensional - which matters for such basic results as \"volume of an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-simplex = volume of face * height / <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>\", which involves both <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n-1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚àí</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>-dimensional volumes in the same statement and would otherwise require moving to a subspace in order to talk about the volume of a face of the simplex.</p>",
        "id": 570212881,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473393
    },
    {
        "content": "<p>Using Hausdorff measure for this does however require first defining a version with appropriate normalization for Euclidean space (divide the existing <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional version in mathlib by the measure it assigns a unit cuboid in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional Euclidean space), because the normalization of the current mathlib version only agrees with <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional  Lebesgue measure given the sup metric, not given the Euclidean metric.</p>",
        "id": 570213069,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473533
    },
    {
        "content": "<p>Would one define Hausdorff measure directly on the affine space? I was thinking that it would be defined on the vector space and you still need this transferring to have it on the affine space</p>",
        "id": 570213144,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769473596
    },
    {
        "content": "<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional Hausdorff measure is defined for any metric space. (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> doesn't need to be an integer.)</p>",
        "id": 570213214,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473635
    },
    {
        "content": "<p>Ah, right</p>",
        "id": 570213278,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769473658
    },
    {
        "content": "<p>How far is mathlib is this area?</p>",
        "id": 570213425,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769473742
    },
    {
        "content": "<p>Explicitly determining the scale factor between mathlib's normalization of Hausdorff measure and the Euclidean one, as an expression involving the gamma function, would be a large project (you need the isodiametric inequality; the answer is something like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> divided by the Lebesgue measure of the Euclidean <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-ball). But you don't need an explicit expression to define the Euclidean-normalized version - you just divide by the Hausdorff measure of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional Euclidean cuboid, without calculating what that measure is (just showing it's finite and nonzero).</p>",
        "id": 570213539,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473819
    },
    {
        "content": "<p>Mathlib has Hausdorff measure, and the fact that it's preserved by isometries, and the fact that it agrees with Lebesgue measure if you use the sup metric on the product space rather than the Euclidean one.</p>",
        "id": 570213669,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769473890
    },
    {
        "content": "<p>And it has bounds on how Hausdorff measure is transformed by <code>LipschitzWith</code> maps, which will give you bounds on how much it can change between the Euclidean and sup metrics (which is enough to show the unit cuboid gets finite nonzero measure, as needed for the scaling to result in a useful measure; no idea if that's the best way to go for that lemma or if there's something much simpler).</p>",
        "id": 570214194,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474203
    },
    {
        "content": "<p>(OK, we don't seem to have <code>LipschitzWith</code> lemmas for <code>ofLp</code> and <code>toLp</code>, but those will be easy to prove if you need them.)</p>",
        "id": 570214379,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474307
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Measure.20on.20affine.20space/near/570214194\">said</a>:</p>\n<blockquote>\n<p>(which is enough to show the unit cuboid gets finite nonzero measure, as needed for the scaling to result in a useful measure; no idea if that's the best way to go for that lemma or if there's something much simpler)</p>\n</blockquote>\n<p>Is it not enough that the cuboid is compact with nonempty interior? To show that its measure is finite nonzero.</p>",
        "id": 570214407,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474322
    },
    {
        "content": "<p>Do we have a suitable lemma saying that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional Hausdorff measure gives finite nonzero measure to a compact set with nonempty interior in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional space when using a metric that's not the sup metric?</p>",
        "id": 570214542,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474408
    },
    {
        "content": "<p>oh the metric</p>",
        "id": 570214633,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474472
    },
    {
        "content": "<p>uhhh</p>",
        "id": 570214636,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474474
    },
    {
        "content": "<p>it's an equivalent norm</p>",
        "id": 570214640,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474478
    },
    {
        "content": "<p>OK, that's the <code>IsAddHaarMeasure</code> measure instance, so yes.</p>",
        "id": 570214648,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474481
    },
    {
        "content": "<p>oh that's great</p>",
        "id": 570214681,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474506
    },
    {
        "content": "<p>the instance is a bit weird I think since you have a <code>Module.finrank ‚Ñù E</code> in there</p>",
        "id": 570214732,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474545
    },
    {
        "content": "<p>so it' won't apply to for example if you have a numeral in there</p>",
        "id": 570214767,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769474568
    },
    {
        "content": "<p>Fortunately, defining and using Euclidean-scaled Hausdorff measure should only require that instance to be used somewhere inside the proof of the lemma that the scale factor is finite and nonzero.</p>",
        "id": 570214831,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474615
    },
    {
        "content": "<p>(And the proofs inside that instance are indeed using the fact that the maps between different norms are Lipschitz, we just don't need to do it specifically for the Euclidean case because that instance already exists.)</p>",
        "id": 570215026,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769474739
    },
    {
        "content": "<p>Once we have material about the measure of simplices in mathlib, we should move Heron's formula from the mathlib archive into mathlib (the version in the mathlib archive uses 1/2 * a * b * sin C as its definition of area, so first we'll need to show that that does indeed equal the area, defined appropriately using measures).</p>",
        "id": 570215526,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769475128
    },
    {
        "content": "<p>Incidental note: it will probably be convenient to have a (Euclidean) definition <code>Affine.Simplex.volume</code> that gives the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional volume of an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional simplex. That should be the measure of the <code>closedInterior</code>, not the <code>interior</code>, so that it gives the right result in the 0-dimensional case (and then we can show that it's equal to the measure of <code>interior</code> as well as that of <code>closedInterior</code> in positive dimensions). The 0-dimensional case matters as the base case for volume in terms of volume of a face.</p>",
        "id": 570216365,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769475728
    },
    {
        "content": "<p>I looked at this because earlier I was looking for the lemma \"for triangle, base * height = 2S is the same for 3 points\" I soon realized I don't need the actual measure for this, but it still got me thinking the whole thing, and I also had a moment of thought \"maybe we should have a definition of <code>volume</code> just as an invariant for all vertices\"</p>",
        "id": 570216812,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769476036
    },
    {
        "content": "<p>It ought to be possible to get the sort of definitions Eric attempted in <a href=\"https://github.com/leanprover-community/mathlib4/pull/14931\">#14931</a> to work to prove such an invariant (in all dimensions) without involving measures - it's similar in spirit to the arguments used to prove that the excenter opposite a vertex of a simplex always exists (which are motivated by an argument in terms of volumes of faces and their projections, reconstructed purely in terms of algebra with heights without mentioning volume at all to avoid needing to involve measures). But it's also clear that any definition of volume ought to be linked to some kind of measure, whether by definition or by API lemma showing it's equal to something defined using measures, to justify that it corresponds to the right thing. And I think we do have enough about Hausdorff measure to use it in setting up such a definition.</p>",
        "id": 570217509,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769476573
    },
    {
        "content": "<p>Looks like you've got a nice roadmap here, <span class=\"user-mention\" data-user-id=\"266253\">@Joseph Myers</span> . Do you want to write it up in an issue so it doesn't get lost?</p>",
        "id": 570250343,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1769499547
    },
    {
        "content": "<p>I'd like to tackle this if a clear roadmap is written by an expert (or if not I'll create a not-so-great roadmap based on my own understanding...)</p>",
        "id": 570895911,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769721190
    },
    {
        "content": "<p>I've never actually used the measure theory part of mathlib, so I'm certainly not an expert here. The outline is:</p>\n<ul>\n<li>Define the scale factor to convert our form of Hausdorff measure to a Euclidean one: <code>(ŒºH[n] (WithLp.toLp 2 '' Set.Icc 0 1 : Set (EuclideanSpace ‚Ñù (Fin n))))‚Åª¬π</code> (I think).</li>\n<li>Show this is finite and nonzero, using the <code>IsAddHaarMeasure</code> instance to get that from being compact with nonempty interior (or a different argument in the 0-dimensional case when \"nonempty interior\" isn't true).</li>\n<li>Define Euclidean-scaled Hausdorff measure as our existing Hausdorff measure scaled by this value (this definition works in any metric space, it's just not expected to be interesting except for affine spaces for real inner product spaces). Give it notation, say <code>ŒºHE[n]</code>. Selectively transfer across lemmas we have about Hausdorff measure if it's sufficiently useful to have them available for the new definition without rewriting by the definition.</li>\n<li>In the case of top-dimensional measure in a finite-dimensional real inner product space, show that <code>ŒºHE[n]</code> agrees with <code>volume</code>. (Once you have this, the fact that Hausdorff measure transfers across isometries should allow applying results about <code>volume</code>, where useful, to <code>ŒºHE[n]</code> in any affine space for a real inner product space, including for non-top-dimensional measure.)</li>\n<li>Define <code>Affine.Simplex.volume</code> to be the <code>ŒºHE[n]</code> of the <code>closedInterior</code>. Show this equals volume of base * height / n (not sure if there are existing lemmas to use for this or if you need to do an integral).</li>\n<li>Show that <code>Affine.Simplex.volume</code> also equals the <code>ŒºHE[n]</code> of the <code>interior</code> except in 0 dimensions.</li>\n<li>Use volume of base * height / n to deduce the special case for triangles where \"volume of base\" is replaced by a distance between two vertices.</li>\n<li>Show also that area of a triangle = a * b * sin C / 2.</li>\n<li>Move Heron's formula from the mathlib archive to mathlib, now expressed in terms of <code>Affine.Simplex.volume</code>.</li>\n</ul>",
        "id": 570911499,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769727595
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"266253\">Joseph Myers</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Measure.20on.20affine.20space/near/570213539\">said</a>:</p>\n<blockquote>\n<p>Explicitly determining the scale factor between mathlib's normalization of Hausdorff measure and the Euclidean one, as an expression involving the gamma function, would be a large project (you need the isodiametric inequality; the answer is something like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">2^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> divided by the Lebesgue measure of the Euclidean <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-ball). But you don't need an explicit expression to define the Euclidean-normalized version - you just divide by the Hausdorff measure of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-dimensional Euclidean cuboid, without calculating what that measure is (just showing it's finite and nonzero).</p>\n</blockquote>\n<p>Could you perhaps make a tracking issue explaining why this is so hard?</p>",
        "id": 570913308,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769728688
    },
    {
        "content": "<p>It seems like things would be easier in the long term if we got this out of the way, and so I think we should only detour around it if we're sure it's a nightmare</p>",
        "id": 570913372,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1769728729
    },
    {
        "content": "<p>I don't know enough about how to prove the isodiametric inequality to give any useful explanation of the difficulties or roadmap for formalization. <a class=\"message-link\" href=\"/#narrow/channel/116395-maths/topic/Sofa.20problem.20may.20have.20been.20solved/near/486688577\">#maths &gt; Sofa problem may have been solved @ üí¨</a> says it should be done with Brunn-Minkowski which seems to be one of those things with multiple past attempts but no sign of any of them being contributed to mathlib.</p>\n<p>An explicit scale factor using the gamma function plus proof it's correct would probably increase the number of (private) imports needed, but that's probably not very significant here.</p>\n<p>(We already have the (Lebesgue) volume of a ball in terms of the gamma function.)</p>",
        "id": 570916602,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769730557
    },
    {
        "content": "<p>My prior knowledge of Hausdorff measure was only \"it can measure objects of any dimensions\" so I just started reading related materials seriously for the first time. Please excuse me if I ask trivial questions. </p>\n<p>I started by comparing the <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/Measure/Hausdorff.html#MeasureTheory.hausdorffMeasure_pi_real\">definition in mathlib</a> and the one in <a href=\"https://en.wikipedia.org/wiki/Hausdorff_measure\">wikipedia</a>. They seem to agree to each other. However, while <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/MeasureTheory/Measure/Hausdorff.html#MeasureTheory.hausdorffMeasure_pi_real\">mathlib claims it equals to Lebesgue measure</a>, wikipedia claims it needs a scaling factor even for this simple case. Is wikipedia wrong or I am reading it wrong?</p>",
        "id": 570923461,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769735448
    },
    {
        "content": "<p>Oh! it is because <code>Œπ ‚Üí ‚Ñù</code> isn't the Euclidean space</p>",
        "id": 570926525,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769737677
    },
    {
        "content": "<p>Since we don't explicitly calculate the factor, how about this definition (the name is temporary)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ŒºH</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)))</span><span class=\"bp\">.</span><span class=\"n\">IsAddHaarMeasure</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ŒºHE</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">EMetricSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BorelSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">addHaarScalarFactor</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"n\">ŒºH</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">ŒºH</span><span class=\"o\">[</span><span class=\"n\">n</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>With this I got the following in 40 lines</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ŒºHE_eq_volume</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">V</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BorelSpace</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FiniteDimensional</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ŒºHE</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">finrank</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">V</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">volume</span>\n</code></pre></div>",
        "id": 571159488,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769831358
    },
    {
        "content": "<p>I think I have derived basic properties and I am at <code>base * height / n</code> now. I couldn't find any directly applicable lemma about simplex in vector space, so I think I need to do the integral now... As part of \"Is there code for X\", please let me know if there are helpful lemma here</p>",
        "id": 571224732,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769887631
    },
    {
        "content": "<p>I have got it through more than half way to the volume formula and the remaining are just some tedious work that I am pretty sure will work out. But I also realized my first attempt has left a stream of lemma too specialized for simplex volume, so I'll need to do redo it before PR the whole thing. </p>\n<p>I have opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/34697\">#34697</a> for reviewing the basic definition. I'd like to make sure we all agree on the definition</p>",
        "id": 571317568,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1769981615
    },
    {
        "content": "<p>I hope someone familiar with the measure theory parts of mathlib can review this.</p>",
        "id": 571320966,
        "sender_full_name": "Joseph Myers",
        "timestamp": 1769985366
    },
    {
        "content": "<p>While waiting for review, I am looking further into volume measure on curves (e.g. surface area of a sphere). Here is a familiar-looking formula given in Evans, Lawrence C.; Gariepy, Ronald F. (2015), <em>Measure Theory and Fine Properties of Functions (Revised Edition)</em>:</p>\n<blockquote>\n<p>Theorem 3.8 (Area formula). Let f : <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup><mo>‚Üí</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>m</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^n \\to \\mathbb{R}^m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span></span></span></span></span></span></span> be Lipschitz continuous, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>‚â§</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">n \\le m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚â§</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>. There for each  <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"script\">L</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span>-measurable subset <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>‚äÇ</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">A \\subset \\mathbb{R}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚äÇ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span><br>\n<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>‚à´</mo><mi>A</mi></msub><mi>J</mi><mi>f</mi><mi>d</mi><mi>x</mi><mo>=</mo><msub><mo>‚à´</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>m</mi></msup></msub><msup><mi mathvariant=\"script\">H</mi><mn>0</mn></msup><mo stretchy=\"false\">(</mo><mi>A</mi><mo>‚à©</mo><msup><mi>f</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">{</mo><mi>y</mi><mo stretchy=\"false\">}</mo><mo stretchy=\"false\">)</mo><mi>d</mi><msup><mi mathvariant=\"script\">H</mi><mi>n</mi></msup><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\"> \\int_A Jf dx = \\int_{\\mathbb{R}^m} \\mathcal{H}^0(A \\cap f^{-1}\\{y\\}) d\\mathcal{H}^{n}(y) </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">‚à´</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1225em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">Jfd</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1699em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">‚à´</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1264em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5935em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">‚Äã</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚à©</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">‚àí</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">})</span><span class=\"mord mathnormal\">d</span><span class=\"mord\"><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span></p>\n</blockquote>\n<p>where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">H</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{H}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.00965em;\">H</span></span></span></span> is <code>ŒºHE</code>. <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>J</mi><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">Jf</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">Jf</span></span></span></span> is the Jacobian, but as the derivative of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> is not a square matrix, this is defined via polar decomposition <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>f</mi><mo>=</mo><mi>O</mi><mo>‚àò</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">Df = O \\circ S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">‚àò</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>J</mi><mi>f</mi><mo>=</mo><mi mathvariant=\"normal\">‚à£</mi><mi>d</mi><mi>e</mi><mi>t</mi><mi>S</mi><mi mathvariant=\"normal\">‚à£</mi></mrow><annotation encoding=\"application/x-tex\">Jf = |det S|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">Jf</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">‚à£</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">tS</span><span class=\"mord\">‚à£</span></span></span></span>, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi></mrow><annotation encoding=\"application/x-tex\">O</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span></span> is an orthogonal <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup><mo>‚Üí</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>m</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^n \\to \\mathbb{R}^m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span></span></span></span></span></span></span>, and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> is a symmetric <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup><mo>‚Üí</mo><msup><mi mathvariant=\"double-struck\">R</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{R}^n \\to \\mathbb{R}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚Üí</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span></p>\n<p>How many of the relevant definitions are in Mathlib? And for those that is not in Mathlib yet, is it the best way to define them as written here?</p>",
        "id": 573934349,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1771113108
    }
]