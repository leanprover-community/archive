[
    {
        "content": "<p>Is there a way to inspect the size of an object? Say I defined </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"mi\">2</span><span class=\"o\">,</span><span class=\"mi\">3</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>What is the “sizeof” test?</p>",
        "id": 465740465,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724846106
    },
    {
        "content": "<p>Are you referring to the size as defined via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=SizeOf#doc\">docs#SizeOf</a> ? If so, you can do </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">reduce</span><span class=\"w\"> </span><span class=\"n\">sizeOf</span><span class=\"w\"> </span><span class=\"n\">test</span>\n</code></pre></div>\n<p>which will tell you that it is <code>10</code>.</p>",
        "id": 465740827,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1724846215
    },
    {
        "content": "<p>Not really. I am talking about memory usage</p>",
        "id": 465752984,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724848664
    },
    {
        "content": "<p>In this case. A linked list with 3 Int elements  would be something like 3*(4 + 8) assuming 4 bytes to each Int and 8 bytes for a pointer to the next item.</p>",
        "id": 465753369,
        "sender_full_name": "Alexandre Rademaker",
        "timestamp": 1724848781
    },
    {
        "content": "<p>In that case you could refer to <a href=\"https://github.com/leanprover/lean4/blob/master/doc/dev/ffi.md#translating-types-from-lean-to-c\">https://github.com/leanprover/lean4/blob/master/doc/dev/ffi.md#translating-types-from-lean-to-c</a> for the details. In your case, each item of the linked list consists of an 8-byte object header, an 8-byte natural number and an 8-byte pointer to the next item. The <code>nil</code> at the end of the list does not take any additional space as its constructor index is stored in place of the pointer. So the memory usage should be 3*(8 + 8 + 8) bytes in total.</p>",
        "id": 465755286,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1724849278
    }
]