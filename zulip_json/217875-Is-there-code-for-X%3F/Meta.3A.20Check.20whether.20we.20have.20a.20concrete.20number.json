[
    {
        "content": "<p>I am writing a simproc, and want to simplify something of form <code>f n</code>, but only when <code>n</code> is a concrete number (in my case, <code>Fin N</code>). I recall there being some convenience functions for checking that, but what were they called?</p>",
        "id": 491436934,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1735674797
    },
    {
        "content": "<p>i don't know about simprocs, but...<br>\n<span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"isNatLit\"</p>",
        "id": 491437653,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1735675398
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Meta.html#Lean.Syntax.isNatLit%3F\">Lean.Syntax.isNatLit?</a></p>",
        "id": 491437654,
        "sender_full_name": "loogle",
        "timestamp": 1735675399
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"NatLit\"</p>",
        "id": 491437677,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1735675419
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Notation.html#rawNatLit\">rawNatLit</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Init/Meta.html#Lean.Syntax.decodeNatLitVal%3F\">Lean.Syntax.decodeNatLitVal?</a>, and <a href=\"https://loogle.lean-lang.org/?q=%22NatLit%22\">17 more</a></p>",
        "id": 491437678,
        "sender_full_name": "loogle",
        "timestamp": 1735675420
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"isFinLit\"</p>",
        "id": 491437777,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1735675496
    },
    {
        "content": "<p><span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span> nothing found</p>",
        "id": 491437779,
        "sender_full_name": "loogle",
        "timestamp": 1735675496
    },
    {
        "content": "<p>isNatLit? works on Syntax, thats not what you are looking for in a simproc, what you want is a function that can parse an <code>Expr</code>, for <code>Fin</code> we commonly use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.getFinValue%3F#doc\">docs#Lean.Meta.getFinValue?</a></p>",
        "id": 491439602,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1735677105
    },
    {
        "content": "<p><code>getFinValue?</code> on the following expression returns none:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">@</span><span class=\"n\">Fin</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instOfNatNat</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instOfNatNat</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">le_of_ble_eq_true</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instOfNatNat</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">OfNat</span><span class=\"bp\">.</span><span class=\"n\">ofNat</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">instOfNatNat</span><span class=\"w\"> </span><span class=\"mi\">16</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">@</span><span class=\"n\">rfl</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"bp\">.</span><span class=\"n\">true</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 491440738,
        "sender_full_name": "Max Nowak üêâ",
        "timestamp": 1735678079
    },
    {
        "content": "<p>Sure, after all the doc string says it's looking for <code>OfNat.ofNat</code> applications for <code>Fin</code>. I think for this case we might want to consider adding suppport for more means to create a <code>Fin</code>, e.g. like with <code>getBitVecValue?</code>, feel free to open an issue about it.</p>",
        "id": 491448455,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1735685002
    },
    {
        "content": "<p>I guess we could generally consider extending more literal functions to account for more ways to denote literals, not quite sure what the reason that they are as limited as they are currently is.</p>",
        "id": 491448746,
        "sender_full_name": "Henrik B√∂ving",
        "timestamp": 1735685236
    }
]