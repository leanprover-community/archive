[
    {
        "content": "<p>I would like to use  truncation of degree of multivariate power series. But the current truncation in mathlib is not about truncation of degree. I was wondering if anyone has done this. I was wondering whether this is a good way to do this. Here are my ideas. I am not sure which one is better.  Thanks in advance!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"w\"> </span><span class=\"n\">Finset</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"> `MvPowerSeries.trunc` in mathlib is defined to be truncation of some `n : σ →₀ ℕ`.</span>\n<span class=\"cm\">I would like to define a truncation of degree for multivariate power series (define it to be a</span>\n<span class=\"cm\">AddMonoidHom). -/</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"o\">]</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"bp\">.</span><span class=\"n\">truncTotalDeg_aux</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPolynomial</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">univ</span><span class=\"bp\">.</span><span class=\"n\">finsuppAntidiag</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">MvPolynomial</span><span class=\"bp\">.</span><span class=\"n\">monomial</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">coeff</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)</span>\n\n<span class=\"c\">/-</span><span class=\"cm\"> However, the homogeneous component is defined to be a multivariate power series in mathlib. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"bp\">.</span><span class=\"n\">truncTotalDeg_aux'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPowerSeries</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∑</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">homogeneousComponent</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">p</span>\n</code></pre></div>",
        "id": 567385046,
        "sender_full_name": "Wenrong Zou",
        "timestamp": 1768131185
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MvPowerSeries.trunc#doc\">docs#MvPowerSeries.trunc</a></p>",
        "id": 567396927,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1768145444
    },
    {
        "content": "<p><code>MvPowerSeries.trunc</code> is quite a specific definition. Do we actually use it for anything?</p>\n<p>As to the truncation you want, I think the specific definition does not matter as long as you can prove that its coefficients have the expected form.</p>",
        "id": 567397106,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1768145609
    },
    {
        "content": "<p>Make sense. Thanks!</p>",
        "id": 567397366,
        "sender_full_name": "Wenrong Zou",
        "timestamp": 1768145830
    }
]