[
    {
        "content": "<p>We have things which seem to me to be at least as strong as this in <code>Algebra.Module.FreeLocus</code> (see for example <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.freeLocus_eq_univ_iff#doc\">docs#Module.freeLocus_eq_univ_iff</a>  ) but do we have the simple statement that a projective module over a local ring is free?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsLocalRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Projective</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Free</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Edit: aah that theorem in the library already only works for finitely presented modules :-/ But this theorem is true in general, right? Edit: yes, it's <a href=\"https://stacks.math.columbia.edu/tag/0593\">https://stacks.math.columbia.edu/tag/0593</a></p>",
        "id": 493390079,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736784817
    },
    {
        "content": "<p>We have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.free_of_flat_of_isLocalRing#doc\">docs#Module.free_of_flat_of_isLocalRing</a>, but only with the finiteness assumption.</p>",
        "id": 493391013,
        "sender_full_name": "Christian Merten",
        "timestamp": 1736785061
    },
    {
        "content": "<p>Rather annoyingly, the module in question is finitely-generaed but assuming finite presentation is basically putting some Noetherian hypotheses on the situation which shouldn't be there because we're representing a functor (the Grassmannian) so really should be running over all rings</p>",
        "id": 493392654,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736785460
    },
    {
        "content": "<p>If a projective module is finitely generated, it is automatically finite presentation (e.g. as a direct factor of a finitely presented module). There should be a reasonable way to do this without Noetherian assumptions.</p>",
        "id": 493404962,
        "sender_full_name": "Joël Riou",
        "timestamp": 1736788753
    },
    {
        "content": "<p>Yes, there is <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/FinitePresentation.html#Module.finitePresentation_of_projective\">Module.finitePresentation_of_projective</a>. (The proof identifies the kernel with a range: <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/Submodule/Range.html#LinearMap.ker_eq_range_of_comp_eq_id\">LinearMap.ker_eq_range_of_comp_eq_id</a>.)<br>\nOr you can directly use <a href=\"https://github.com/leanprover-community/mathlib4/pull/20460\">#20460</a> :)<br>\nThe result for non-f.g. modules is due to Kaplansky and depends on the whole section <a href=\"https://stacks.math.columbia.edu/tag/058T\">stacks#058T</a>. Not aware of people working on this ...</p>",
        "id": 493411285,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1736790623
    },
    {
        "content": "<p>Oh nice! In which case we don't need the general result. Thanks a lot!</p>\n<p>[Off-topic: Matsumura's proof of the result uses ordinal induction, and until recently this was the only place I'd ever seen ordinals used outside of set theory/infinitary combinatorics. But then Conrad told me he knew a proof which avoided it. However Mathlib's proof of N\\\"obeling's theorem (used by Scholze in his work on condensed mathematics) also uses ordinal induction and I don't know a proof which avoids ordinals]</p>",
        "id": 493448750,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736802255
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"638465\">@Ivan Farabella</span> you can get away with what is already in mathlib.</p>",
        "id": 493448825,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736802286
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Projective.20module.20over.20a.20local.20ring.20is.20free/near/493448750\">said</a>:</p>\n<blockquote>\n<p>Matsumura's proof of the result uses ordinal induction, and until recently this was the only place I'd ever seen ordinals used outside of set theory/infinitary combinatorics.</p>\n</blockquote>\n<p>I think this is also using transfinite induction? <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/CardinalEmb.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/FieldTheory/CardinalEmb.html</a></p>",
        "id": 493795151,
        "sender_full_name": "Jz Pan",
        "timestamp": 1736924773
    },
    {
        "content": "<p>But this is just a counting result rather than anything \"useful\" (I can't imagine this result being used for anything else)</p>",
        "id": 493798620,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1736926535
    },
    {
        "content": "<p>As a matter of fact, you can always replace ordinal induction by Zorn's lemma. Sometimes, it's just awkward to do so (especially if you already have a proof of the other type under the eyes).</p>",
        "id": 493953813,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1736954951
    },
    {
        "content": "<p>Also : it is often sufficient to use Hartogs's lemma that given any set, there is a well ordered set that doesn't inject in it, but one doesn't need the specific model of ordinals. (This is how I prove Kaplansky's theorem in my book, Mostly commutative algebra).</p>",
        "id": 493954309,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1736955085
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Projective.20module.20over.20a.20local.20ring.20is.20free/near/493448750\">said</a>:</p>\n<blockquote>\n<p>Mathlib's proof of N\\\"obeling's theorem (used by Scholze in his work on condensed mathematics) also uses ordinal induction and I don't know a proof which avoids ordinals]</p>\n</blockquote>\n<p>The proof doesn't really need ordinals; it needs well-founded recursion, which isn't quite the same thing. In fact I've previously attempted to replace one by the other, I think the proof would be a bit cleaner that way since it avoids moving back and forth between the original order and the associated ordinals.</p>",
        "id": 493954406,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1736955109
    },
    {
        "content": "<p>Unfortunately got stuck at the very end of the refactor. I think I needed to use well-founded recursion over <code>WithTop I</code> rather than just <code>I</code>.<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/20030\">#20030</a></p>",
        "id": 493954991,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1736955254
    },
    {
        "content": "<p>As for results that need ordinals, I guess there's <a href=\"https://en.wikipedia.org/wiki/Goodstein%27s_theorem\">Goodstein's theorem</a>, though that's admittedly very artificial and very obviously trying to exploit a specific ordinal notation.</p>",
        "id": 493955860,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1736955492
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Projective.20module.20over.20a.20local.20ring.20is.20free/near/493954991\">said</a>:</p>\n<blockquote>\n<p>I think I needed to use well-founded recursion over <code>WithTop I</code> rather than just <code>I</code>.<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/20030\">#20030</a></p>\n</blockquote>\n<p>My experience is that often one needs to pick up a well ordering which has a top element.</p>",
        "id": 493955983,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1736955530
    }
]