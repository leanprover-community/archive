[
    {
        "content": "<p>I assume we have complex conjugation as an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>-algebra map on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span>? I don't know how to search for this; <code>#loogle ℂ →ₐ[ℝ] ℂ</code> gives no results (am I using it correctly?) and <code>by exact?</code> gives me the identity map. I actually want a more abstract complex conjugation but I can get it from the one on the complexes.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- is this missing?</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAlgClosure</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">isAlgClosed</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">isAlgClosed</span>\n<span class=\"w\">  </span><span class=\"n\">isAlgebraic</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">IsAlgebraic</span><span class=\"bp\">.</span><span class=\"n\">of_finite</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span>\n\n<span class=\"c1\">-- is this something to do with `star`?</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">→ₐ</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"bp\">#</span><span class=\"n\">loogle</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">→ₐ</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ℂ</span>\n\n<span class=\"c1\">-- Not hard to make this if we have the above.</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">complex_conjugation</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Gal</span><span class=\"o\">(</span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Field</span>\n\n<span class=\"c1\">-- what I actually want</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">absoluteGaloisGroup_complex_conjugation</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">absoluteGaloisGroup</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">IsAlgClosure</span><span class=\"bp\">.</span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">AlgebraicClosure</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">autCongr</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">complex_conjugation</span>\n\n<span class=\"c1\">-- I also want that it has order 2, but let's get a definition first :-)</span>\n</code></pre></div>",
        "id": 558260084,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763572024
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Complex/Module.html#Complex.conjAe\">Complex.conjAe</a></p>",
        "id": 558262721,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763572753
    },
    {
        "content": "<p>This is why I wanted a CM-field instance (that doesn't hold unfortunately) on <code>ℂ</code>.</p>",
        "id": 558263049,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763572830
    },
    {
        "content": "<p>Anyway, the point is that <code>ℂ</code> is a StarSomething</p>",
        "id": 558263655,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763572986
    },
    {
        "content": "<p>Note that we have a good API for \"complex conjugations\" as in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/NumberField/InfinitePlace/Embeddings.html#NumberField.ComplexEmbedding.IsConj\">NumberField.ComplexEmbedding.IsConj</a></p>",
        "id": 558265402,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763573354
    },
    {
        "content": "<p>Annoyingly <code>#loogle ℂ ≃ₐ[ℝ] ℂ</code> doesn't find <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Complex.conjAe#doc\">docs#Complex.conjAe</a> either :-( (and neither does <code>#loogle Gal(ℂ/ℝ)</code>). </p>\n<p>Ha ha <code>example : Gal(ℂ/ℝ) := by exact?</code> finds it :-) </p>\n<p>Thanks anyway! Yeah we have <code>IsComplexConjugate</code> but sometimes it's useful to have <code>complexConjugate</code> as well (in some stupid generality).</p>",
        "id": 558270886,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763575159
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> ⊢ ?k ≃ₐ[ℝ] ?k</p>",
        "id": 558272400,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1763575701
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/RCLike/Basic.html#RCLike.conjAe\">RCLike.conjAe</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Complex/Module.html#Complex.conjAe\">Complex.conjAe</a></p>",
        "id": 558272402,
        "sender_full_name": "loogle",
        "timestamp": 1763575702
    },
    {
        "content": "<p>I can't explain why instantiating with <code>?k</code> with <code>ℂ</code> fails.</p>",
        "id": 558272503,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1763575736
    },
    {
        "content": "<p>It looks like it's doing a syntactic match on the found instance</p>",
        "id": 558274221,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763576283
    },
    {
        "content": "<p>ouch, that seems like a big paper cut.</p>",
        "id": 558274410,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1763576345
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> @AlgEquiv ℝ ℂ ℂ</p>",
        "id": 558274574,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763576401
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Complex/Module.html#Complex.conjAe\">Complex.conjAe</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/LinearAlgebra/Complex/Module.html#Complex.conjAe_coe\">Complex.conjAe_coe</a>, and <a href=\"https://loogle.lean-lang.org/?q=%40AlgEquiv%20%E2%84%9D%20%E2%84%82%20%E2%84%82\">2 more</a></p>",
        "id": 558274576,
        "sender_full_name": "loogle",
        "timestamp": 1763576401
    },
    {
        "content": "<p>Remark: Loogle discovering <code>RCLike.conjAe</code> makes me want to comment that this is a situation where we could have the more general <code>IsROrC.conjAe</code> where we don't choose a square root of -1. I used to bang on about this a lot but I've since realised that actually I don't want <code>IsROrC</code> for Langlands, I want <code>IsC</code>, and we have this now: it's <code>IsAlgClosure \\R K</code> (which ironically we don't seem to have for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> ;-) )</p>",
        "id": 558277369,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763577284
    },
    {
        "content": "<p>I think your proposed <code>IsROrC</code> for <code>Real</code> probably ought to choose a square root of -1 (as <code>0</code> to match <code>Real.sqrt</code>)</p>",
        "id": 558277727,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1763577397
    },
    {
        "content": "<p>we only have <a href=\"https://loogle.lean-lang.org/?q=IsAlgClosure\">33 lemmas on <code>IsAlgClosure</code></a>, but we have the components already:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAlgClosure</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span>\n</code></pre></div>\n<p>(and I suppose in practice it's the components that you want to use)</p>",
        "id": 558278204,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1763577550
    },
    {
        "content": "<p>Well, I wanted to use <code>IsAlgClosure.equiv</code> (as you can see) which needed the instance.</p>",
        "id": 558278847,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763577777
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/complex.20conjugation/near/558277727\">said</a>:</p>\n<blockquote>\n<p>I think your proposed <code>IsROrC</code> for <code>Real</code> probably ought to choose a square root of -1 (as <code>0</code> to match <code>Real.sqrt</code>)</p>\n</blockquote>\n<p>The point about <code>IsROrC</code> is that it is a Prop (we used to have one which wasn't a Prop, which drove me nuts, but now it's <code>RCLike</code>). But I since realised that I only want it for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>-algebras and actually I know exactly when they're <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span> and when they're isomorphic to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> which is why <code>IsAlgClosure</code> is perfect (I really just want <code>IsR</code> and <code>IsC</code> so that they can be applied to completions of number fields).</p>",
        "id": 558279133,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763577883
    }
]