[
    {
        "content": "<p>How to define complex conjugation as an element of <code>Field.absoluteGaloisGroup ℝ</code>?<br>\nI tried showing that the algebraic closure of <code>ℝ</code> is isomorphic to <code>ℂ</code> by using<br>\n<code>example : AlgebraicClosure ℝ ≃ₐ[ℝ] ℂ := by exact?</code><br>\nbut didn't get any results</p>",
        "id": 555412941,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1763053629
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">IsAlgClosed</span><span class=\"bp\">.</span><span class=\"n\">AlgebraicClosure</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsAlgClosure</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">isAlgClosed</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n<span class=\"w\">  </span><span class=\"n\">isAlgebraic</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">AlgebraicClosure</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">≃ₐ</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsAlgClosure</span><span class=\"bp\">.</span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>",
        "id": 555419996,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1763055334
    },
    {
        "content": "<p>Maybe we can generalize <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/NumberField/CMField.html#NumberField.IsCMField\">NumberField.IsCMField</a> to consider the complex numbers. <span class=\"user-mention\" data-user-id=\"488648\">@Xavier Roblot</span> what do you think? Of couse at some point one has to work with number fields, but maybe the very basic theory works in general</p>",
        "id": 555421780,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763055883
    },
    {
        "content": "<p>I am not sure how much of it would work if we remove the <code>NumberField</code> assumption but I can have a look.</p>",
        "id": 555422504,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763056105
    },
    {
        "content": "<p><code>CharZero</code> is surely OK</p>",
        "id": 555422814,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763056203
    },
    {
        "content": "<p>I mean, it's ok to assume it</p>",
        "id": 555422839,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763056210
    },
    {
        "content": "<p>Some naming inconsistency between <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgEquiv.autCongr#doc\">docs#AlgEquiv.autCongr</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearEquiv.conj#doc\">docs#LinearEquiv.conj</a> ... (had trouble finding the first one)</p>",
        "id": 555422921,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1763056239
    },
    {
        "content": "<p>Looks like the <code>NumberField</code> assumptions can be removed at some places. I'll have a closer look tomorrow</p>",
        "id": 555424425,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763056756
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Complex.20conjugation.20in.20the.20absolute.20Galois.20group/near/555421780\">said</a>:</p>\n<blockquote>\n<p>Maybe we can generalize <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/NumberField/CMField.html#NumberField.IsCMField\">NumberField.IsCMField</a> to consider the complex numbers. <span class=\"user-mention silent\" data-user-id=\"488648\">Xavier Roblot</span> what do you think? Of couse at some point one has to work with number fields, but maybe the very basic theory works in general</p>\n</blockquote>\n<p>My ultimate goal was to define a complex conjugation as an element of the absolute Galois group of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span>, by doing this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">complexConjugationReal</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">complexConjugation</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Γ</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Field</span><span class=\"bp\">.</span><span class=\"n\">absoluteGaloisGroup</span><span class=\"bp\">.</span><span class=\"n\">mapAux</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Rat</span><span class=\"bp\">.</span><span class=\"n\">castHom</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">complexConjugationReal</span>\n</code></pre></div>\n<p>Are you proposing that mathlib should know <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"true\">‾</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\overline{\\mathbb{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0556em;vertical-align:-0.1667em;\"></span><span class=\"mord overline\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8889em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">Q</span></span></span><span style=\"top:-3.8089em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1667em;\"><span></span></span></span></span></span></span></span></span> is a CM-field in some generalised sense and therefore should have a complex conjugation?</p>",
        "id": 555431656,
        "sender_full_name": "Stepan Nesterov",
        "timestamp": 1763059159
    },
    {
        "content": "<p>I am just saying that trivially the complex numbers are a quadratic extension of their maximal real subfield (the reals!), and yes, the same is true for the algebraic numbers, so in this sense they are a \"CM field\", but it's just an observation, nothing really deep.</p>",
        "id": 555438185,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763061207
    },
    {
        "content": "<p>It would be reasonable to make <code>algebraicClosure ℚ ℂ</code> into a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=StarSubalgebra#doc\">docs#StarSubalgebra</a>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Analysis</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Polynomial</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">AlgebraicClosure</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">IsAlgClosed</span><span class=\"bp\">.</span><span class=\"n\">AlgebraicClosure</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">algebraicClosure</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"n\">ℂ</span><span class=\"w\"> </span><span class=\"bp\">≃ₐ</span><span class=\"o\">[</span><span class=\"n\">ℚ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">AlgebraicClosure</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">IsAlgClosure</span><span class=\"bp\">.</span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n</code></pre></div>",
        "id": 555439356,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1763061571
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Complex.20conjugation.20in.20the.20absolute.20Galois.20group/near/555438185\">said</a>:</p>\n<blockquote>\n<p>I am just saying that trivially the complex numbers are a quadratic extension of their maximal real subfield (the reals!), and yes, the same is true for the algebraic numbers, so in this sense they are a \"CM field\", but it's just an observation, nothing really deep.</p>\n</blockquote>\n<p>There is a problem though because, if I am not mistaken, I do not think that <code>ℝ</code> is totally real according to our definition. Recall that this mean that all <code>φ : ℝ →+* ℂ</code> are contained in the image of <code>ℝ</code> in <code>ℂ</code> and I don't think that it's true if you don't assume in addition that <code>φ</code> is continuous. </p>\n<p>Proving that the algebraic closure of <code>ℚ</code> is CM should be possible though.</p>",
        "id": 555523042,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763106708
    },
    {
        "content": "<p>Ouch</p>",
        "id": 555526711,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763108134
    },
    {
        "content": "<p>Your 100% right, the reals are not totally real</p>",
        "id": 555526886,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763108201
    },
    {
        "content": "<p>And the algebraic closure of Q should surely not be CM, the point about CM fields is that there's a unique sensible notion of complex conjugation, and this is far from true in Qbar.</p>",
        "id": 555533353,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763110372
    },
    {
        "content": "<p>Yes, indeed. Sorry, I was thinking about <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mover accent=\"true\"><mi mathvariant=\"double-struck\">Q</mi><mo>ˉ</mo></mover><mrow><mi>a</mi><mi>b</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\bar{\\mathbb{Q}}^{ab}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0158em;vertical-align:-0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8257em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbb\">Q</span></span><span style=\"top:-3.2579em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">ˉ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1667em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ab</span></span></span></span></span></span></span></span></span></span></span></span></p>",
        "id": 555534164,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763110586
    },
    {
        "content": "<p><del>(Wait, why is math mode  not working here?)</del></p>",
        "id": 555534449,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763110658
    },
    {
        "content": "<p>I assume <span class=\"tex-error\">$$\\bar$$</span></p>",
        "id": 555536232,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1763111190
    },
    {
        "content": "<p>Indeed, thanks. I fixed it.</p>",
        "id": 555536446,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763111251
    },
    {
        "content": "<p>Well, maybe it's just not worth it</p>",
        "id": 555541277,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763112692
    },
    {
        "content": "<p>Well, I have already started to work on it so let's see how far I can get</p>",
        "id": 555586915,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763126831
    },
    {
        "content": "<p>Ok, so this is what I can prove</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CharZero</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hS</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsCyclotomicExtension</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">IsCMField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>",
        "id": 555658448,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763147157
    },
    {
        "content": "<p>(I guess that doesn't help Stepan at all <span aria-label=\"sweat smile\" class=\"emoji emoji-1f605\" role=\"img\" title=\"sweat smile\">:sweat_smile:</span> )</p>",
        "id": 555659185,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1763147413
    },
    {
        "content": "<p>Well, free to open a PR for that! We already have a weak version in flt-regular, but this is surely a reasonable instance</p>",
        "id": 555731326,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1763199754
    },
    {
        "content": "<p>It's not an instance because of hS. </p>\n<p>Taylor likes the predicate \"totally real or CM\" (which AFAIK we don't have), which is equivalent to \"well-defined complex conjugation\", and it could be an instance for that.</p>",
        "id": 556605870,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763213554
    },
    {
        "content": "<p>(Taylor calls it \"CM field\" but this is not a standard use of the term)</p>",
        "id": 556605918,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763213605
    }
]