[
    {
        "content": "<p>The following should be some fact about pi types (i.e., I would prove this first at that level, and then for <code>PiLp</code>): does mathlib really not have this yet? </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"bp\">.</span><span class=\"n\">prod</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"n\">Î²</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"n\">Î²</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"bp\">âŠ•</span><span class=\"w\"> </span><span class=\"n\">Î²</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>(I'm interested in the corollary with <code>Î± = Fin n</code> and <code>Î² = Fin m</code>.)</p>",
        "id": 500124944,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1739783804
    },
    {
        "content": "<p>Isn't this <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Equiv.sumArrowEquivProdArrow#doc\">docs#Equiv.sumArrowEquivProdArrow</a> up to defeq? The Pi-version is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Equiv.sumPiEquivProdPi#doc\">docs#Equiv.sumPiEquivProdPi</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Equiv.prodPiEquivSumPi#doc\">docs#Equiv.prodPiEquivSumPi</a></p>",
        "id": 500125809,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739784025
    },
    {
        "content": "<p>Found with</p>",
        "id": 500125844,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739784035
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Prod, Equiv, Sum</p>",
        "id": 500125857,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739784039
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Logic/Equiv/Basic.html#Equiv.boolProdEquivSum\">Equiv.boolProdEquivSum</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Logic/Equiv/Basic.html#Equiv.sumArrowEquivProdArrow\">Equiv.sumArrowEquivProdArrow</a>, and <a href=\"https://loogle.lean-lang.org/?q=Prod%2C%20Equiv%2C%20Sum\">61 more</a></p>",
        "id": 500125861,
        "sender_full_name": "loogle",
        "timestamp": 1739784040
    },
    {
        "content": "<p>(it's not easy to search for Pi-types in Loogle, I think)</p>",
        "id": 500125938,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739784060
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousLinearEquiv.sumPiEquivProdPi#doc\">docs#ContinuousLinearEquiv.sumPiEquivProdPi</a> might also be relevant.</p>",
        "id": 500126355,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739784154
    },
    {
        "content": "<p>Thanks, the first one did the trick!</p>",
        "id": 500127773,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1739784488
    },
    {
        "content": "<p>I would guess you want WithLp on the LHS?</p>",
        "id": 500147863,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739789233
    },
    {
        "content": "<p>I do in fact want a homeomorphism between these spaces, so I guess WithLp does help.</p>",
        "id": 500173402,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1739795754
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearIsometryEquiv.piLpCurry#doc\">docs#LinearIsometryEquiv.piLpCurry</a> may also be of interest</p>",
        "id": 500174536,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739796027
    },
    {
        "content": "<p>I was just looking for that: this looks helpful, thanks!</p>",
        "id": 500174747,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1739796081
    },
    {
        "content": "<p>Probably we should have <code>LinearIsometryEquiv.sumPiLpEquivProdPiLp</code> for the version you asked for</p>",
        "id": 500174829,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1739796100
    },
    {
        "content": "<p>That sounds exactly like what I need, indeed!</p>",
        "id": 500175148,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1739796180
    },
    {
        "content": "<p>Linking <a href=\"https://github.com/leanprover-community/mathlib4/pull/22973\">#22973</a> for posterity</p>",
        "id": 505981209,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1742148656
    },
    {
        "content": "<p>Whoops, I'd forgotten that this is the second time this has been asked for</p>",
        "id": 506000835,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1742162387
    },
    {
        "content": "<p>I've marked it \"please adopt\", since in the other thread about it I delegated filling the final two <code>sorry</code>s</p>",
        "id": 506001027,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1742162498
    },
    {
        "content": "<p>The full proof has now been committed to <a href=\"https://github.com/leanprover-community/mathlib4/pull/22973\">#22973</a> !</p>",
        "id": 506025796,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1742177910
    },
    {
        "content": "<p>The dependencies of that PR are now all resolved. Thanks for filling in the gaps, <span class=\"user-mention\" data-user-id=\"574112\">@Jihoon Hyun</span>!</p>",
        "id": 507510288,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1742692263
    },
    {
        "content": "<p>I just came across this thread because I needed the exact thing Michael asked about - a continuous linear equivalence between <code>EuclideanSpace ğ•œ (Fin (n + m))</code> and <code>EuclideanSpace ğ•œ (Fin n) Ã— EuclideanSpace ğ•œ (Fin m)</code>. Using the equivalence from <a href=\"https://github.com/leanprover-community/mathlib4/pull/22973\">#22973</a>, this is what I ended up with:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"bp\">.</span><span class=\"n\">sumEquivProd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"n\">Îº</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">Îº</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">Â  Â  </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"bp\">âŠ•</span><span class=\"w\"> </span><span class=\"n\">Îº</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">Îº</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">Â  </span><span class=\"o\">(</span><span class=\"n\">PiLp</span><span class=\"bp\">.</span><span class=\"n\">sumPiLpEquivProdLpPiLp</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toContinuousLinearEquiv</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">Â  Â  </span><span class=\"n\">WithLp</span><span class=\"bp\">.</span><span class=\"n\">prodContinuousLinearEquiv</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"bp\">.</span><span class=\"n\">finAddEquivProd</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„•</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">Â  Â  </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">Ã—</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">Â  </span><span class=\"o\">(</span><span class=\"n\">LinearIsometryEquiv</span><span class=\"bp\">.</span><span class=\"n\">piLpCongrLeft</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">finSumFinEquiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toContinuousLinearEquiv</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span>\n<span class=\"w\">Â  Â  </span><span class=\"n\">sumEquivProd</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>\n<p>Would it be a good idea to PR these two as well? They're not too hard to obtain from what's already there, but since this seems to be a relatively common scenario, maybe it's good to have them nonetheless</p>",
        "id": 515976964,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746322617
    },
    {
        "content": "<p>I think I'd claim these are more useful in the isometry forms we already somewhat have</p>",
        "id": 515980277,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746324738
    },
    {
        "content": "<p>Do we have the pieces to get the second one as an isometry?</p>",
        "id": 515980734,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746325138
    },
    {
        "content": "<p>The second one isn't an isometry because binary products carry the supremum norm, just like arbitrary products do</p>",
        "id": 515980852,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746325233
    },
    {
        "content": "<p>neither is the first</p>",
        "id": 515980861,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746325249
    },
    {
        "content": "<p>For what I'm doing continuity suffices because all continuous linear maps between normed spaces are smooth - I assume that's the reason Michael needed continuity as well</p>",
        "id": 515981152,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746325481
    },
    {
        "content": "<p>They are also measurable equivalent, so I was planning to add that version of <a href=\"https://github.com/leanprover-community/mathlib4/pull/22973\">#22973</a>  in the near future.</p>",
        "id": 515981947,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746326196
    },
    {
        "content": "<p>I'm aware that they're only isometries with an extra WithLp</p>",
        "id": 515984195,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1746327924
    },
    {
        "content": "<p>Right, sorry. I misinterpreted your question there</p>",
        "id": 515986184,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746329509
    },
    {
        "content": "<p>It should be easy to get that second lemma as an isometry with an extra <code>WithLp</code> on the rhs - though the other form is more useful to me</p>",
        "id": 515986304,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1746329615
    },
    {
        "content": "<p>Cross-linking some discussion <a href=\"#narrow/channel/224796-Geographic-locality/topic/London.2C.20England/with/522156122\">here</a></p>",
        "id": 522158805,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1748965275
    }
]