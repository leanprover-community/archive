[
    {
        "content": "<p>I'm interested in developing some API for linearly ordered vector spaces, in order to easily handle manipulations of asymptotic orders of magnitude (such as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mn>2</mn></msup><msup><mrow><mi>log</mi><mo>‚Å°</mo></mrow><mn>3</mn></msup><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^2 \\log^3 N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1484em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8984em;\"><span style=\"top:-3.1473em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>) which can be viewed as belonging to such spaces (with the \"logarithmic scale\" interpretation of multiplication as addition, and exponentiation as scalar multiplication, while addition becomes \"max\" in the obvious ordering).  For this I would like the ability to use a <code>linarith</code> type tool to immediately settle implications such as the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">OrderedSMul</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">calc</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"o\">:</span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">h1</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">OrderedSMul</span><span class=\"bp\">.</span><span class=\"n\">smul_lt_smul_of_pos</span><span class=\"w\"> </span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">norm_num</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I have two questions:</p>\n<ol>\n<li>Is there a better spelling for linearly ordered vector spaces than this?  <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OrderedSMul#doc\">docs#OrderedSMul</a> has very minimal API and states \"This file is now mostly useless. We should try deleting¬†<code>OrderedSMul</code>\", but it is not clear what the replacement would be.  There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ConvexCone#doc\">docs#ConvexCone</a> , which has more API, but does not have much in the way of identifying this cone with the order structure.</li>\n<li>How difficult would it be to extend <code>linarith</code> to be able to cover these sorts of use cases?</li>\n</ol>",
        "id": 515789490,
        "sender_full_name": "Terence Tao",
        "timestamp": 1746216385
    },
    {
        "content": "<p>Oh apologies, the TODO should say that the replacement is the definitions in <code>Mathlib.Algebra.Order.Module.Defs</code>, ie <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosSMulMono#doc\">docs#PosSMulMono</a> and friends</p>",
        "id": 515789709,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1746216485
    },
    {
        "content": "<p>Amusingly, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PosSMulMono#doc\">docs#PosSMulMono</a> states \"You should usually not use this very granular typeclass directly, but rather a typeclass like¬†<code>OrderedSMul</code>.\"</p>",
        "id": 515789851,
        "sender_full_name": "Terence Tao",
        "timestamp": 1746216546
    },
    {
        "content": "<p>Time has passed :-)</p>",
        "id": 515790004,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1746216609
    },
    {
        "content": "<p>Wait, so is the recommendation to continue using <code>OrderedSMul</code>, but look to <code>docs#PosSMulMono</code> and friends for all the actual API?</p>",
        "id": 515790409,
        "sender_full_name": "Terence Tao",
        "timestamp": 1746216797
    },
    {
        "content": "<p>No, the recommendation is to avoid using <code>OrderedSMul</code> as much as possible, although it is currently the most convenient option. The history is that:</p>\n<ol>\n<li>I encountered some use case which <code>OrderedSMul</code> didn't cover</li>\n<li>I added <code>PosSMulMono</code> and friends, with the docstring that probably you should use <code>OrderedSMul</code> instead</li>\n<li>I noticed that actually all <code>OrderedSMul</code> could do, <code>PosSMulMono</code> and friends could do better</li>\n<li>I generalised the <code>OrderedSMul</code> API to <code>PosSMulMono</code> and friends, and added that TODO to delete <code>OrderedSMul</code></li>\n<li>The uses of <code>OrderedSMul</code> outside its immediate API still survive to this day, and you get confused by reading a confusing set of docstrings</li>\n</ol>",
        "id": 515792118,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1746217471
    },
    {
        "content": "<p>Of course, step 5 should have been \"<code>OrderedSMul</code> is fully deprecated\", but we all know how long my TODO list is <span aria-label=\"see no evil\" class=\"emoji emoji-1f648\" role=\"img\" title=\"see no evil\">:see_no_evil:</span></p>",
        "id": 515792227,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1746217517
    },
    {
        "content": "<p>Step 4.5: update the docs</p>",
        "id": 515808822,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1746224949
    },
    {
        "content": "<p><code>grind</code> can now prove some results about linearly ordered vector space (and give counterexamples).</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Grind</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IntModule</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IntModule</span><span class=\"bp\">.</span><span class=\"n\">IsOrdered</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">grind</span><span class=\"w\"> </span><span class=\"c1\">-- üéâ</span>\n</code></pre></div>\n<p>We'll be hooking this up to Mathlib's typeclasses in the next few weeks.</p>",
        "id": 524644068,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1750231393
    }
]