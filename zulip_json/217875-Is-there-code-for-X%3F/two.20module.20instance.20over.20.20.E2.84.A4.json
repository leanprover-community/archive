[
    {
        "content": "<p>Do we have a solution to this? Or more specifically, for a isomorphism between cohomology group, how do I get the <code>AddEquiv</code> version of that without causing error like below?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eq_inst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ModuleCat</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">isModule</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">AddCommGroup</span><span class=\"bp\">.</span><span class=\"n\">toIntModule</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">isAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 504298195,
        "sender_full_name": "Edison Xie",
        "timestamp": 1741454308
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ModuleCat.isModule#doc\">docs#ModuleCat.isModule</a></p>",
        "id": 504300892,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741456235
    },
    {
        "content": "<p>If you just want a proof then take everything apart; there's only one way Z can act on an additive group. Are you sure you want this though? What's the application?</p>",
        "id": 504301171,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741456458
    },
    {
        "content": "<p>I don't think it is possible to make this defeq</p>",
        "id": 504307650,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741461450
    },
    {
        "content": "<p><code>Subsingleton.elim _ _</code> should prove the theorem though</p>",
        "id": 504307671,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741461479
    },
    {
        "content": "<p>a quick glance suggests there is no <code>Subsingleton</code> instance here, though...</p>",
        "id": 504310439,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463415
    },
    {
        "content": "<p>this should do it</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">allEq</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"w\"> </span><span class=\"n\">inst2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"o\">,</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 504310478,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463443
    },
    {
        "content": "<p>see also:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eq_inst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ModuleCat</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">isModule</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">AddCommGroup</span><span class=\"bp\">.</span><span class=\"n\">toIntModule</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">isAddCommGroup</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"bp\">.</span><span class=\"n\">isModule</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 504310638,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463541
    },
    {
        "content": "<p>Should that be <code>AddCommMonoid M</code>, or is that not a useful generalization?</p>",
        "id": 504310658,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741463561
    },
    {
        "content": "<p>i don't think so? i believe the whole point is that you get <code>-1 • x = -x</code></p>",
        "id": 504310699,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463597
    },
    {
        "content": "<p>so you need additive inverses</p>",
        "id": 504310721,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463616
    },
    {
        "content": "<p>Then you need to derive <code>AddCommGroup M</code> if you don't have it already</p>",
        "id": 504310837,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741463696
    },
    {
        "content": "<p>from <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.addCommMonoidToAddCommGroup#doc\">docs#Module.addCommMonoidToAddCommGroup</a></p>",
        "id": 504310921,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741463750
    },
    {
        "content": "<p><span aria-label=\"hmm\" class=\"emoji emoji-1f928\" role=\"img\" title=\"hmm\">:hmm:</span></p>",
        "id": 504310929,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463756
    },
    {
        "content": "<p>it does seem unidiomatic, but i guess it might work?</p>",
        "id": 504311017,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463784
    },
    {
        "content": "<p>as in, the extra cases where this would apply are unidiomatic, but it's fair to make it work then nonetheless</p>",
        "id": 504311170,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463859
    },
    {
        "content": "<p>Also, you might not have any actual <code>Module ℤ M</code> instance yet, for example when using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quotient.recOnSubsingleton#doc\">docs#Quotient.recOnSubsingleton</a> or similar</p>",
        "id": 504311189,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1741463873
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">allEq</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"w\"> </span><span class=\"n\">inst2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">addCommMonoidToAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"o\">,</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 504311445,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1741463990
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/two.20module.20instance.20over.20.20.E2.84.A4/near/504301171\">said</a>:</p>\n<blockquote>\n<p>If you just want a proof then take everything apart; there's only one way Z can act on an additive group. Are you sure you want this though? What's the application?</p>\n</blockquote>\n<p>I'm trying to convert <code>groupCohomology.isoH2</code> into an <code>AddEquiv</code></p>",
        "id": 504317326,
        "sender_full_name": "Edison Xie",
        "timestamp": 1741467849
    },
    {
        "content": "<p>Thanks everyone!</p>",
        "id": 504317351,
        "sender_full_name": "Edison Xie",
        "timestamp": 1741467869
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=groupCohomology.isoH2#doc\">docs#groupCohomology.isoH2</a></p>",
        "id": 504317379,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741467899
    },
    {
        "content": "<p>Convert it into an AlgEquiv instead</p>",
        "id": 504317455,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741467956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/two.20module.20instance.20over.20.20.E2.84.A4/near/504317455\">said</a>:</p>\n<blockquote>\n<p>Convert it into an AlgEquiv instead</p>\n</blockquote>\n<p>Ah but it's an equivalence in <code>ModuleCat</code>?</p>",
        "id": 504317765,
        "sender_full_name": "Edison Xie",
        "timestamp": 1741468173
    },
    {
        "content": "<p>Yes so hopefully there will be something in mathlib saying that this is the same thing as an algEquiv</p>",
        "id": 504318029,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741468345
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/two.20module.20instance.20over.20.20.E2.84.A4/near/504310439\">said</a>:</p>\n<blockquote>\n<p>a quick glance suggests there is no <code>Subsingleton</code> instance here, though...</p>\n</blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AddCommGroup.uniqueIntModule#doc\">docs#AddCommGroup.uniqueIntModule</a></p>",
        "id": 504325420,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741474176
    },
    {
        "content": "<p>So the <code>Unique</code> isn't an instance for <code>AddCommGroup</code> and the docstring makes it clear why, but is there any argument against making the <code>Subsingleton</code> instance for <code>AddCommMonoid</code>? Part of me wonders whether it will lead typeclass inference on a merry dance but I think it won't because I'm guessing <code>R = Int</code> will be quick to fail.</p>",
        "id": 504326468,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1741475010
    },
    {
        "content": "<p>I guess let's try it and see</p>",
        "id": 504331342,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1741479097
    }
]