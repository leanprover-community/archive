[
    {
        "content": "<p>We have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.ofFn#doc\">docs#List.ofFn</a> that can turn <code>Fin n → α</code> into <code>List α</code>, but is there an easy way to go in the other direction that is, from a <code>List α</code> to construct a <code>Fin n → α</code> either by truncating the list if it is too long or by appending, say, copies of a fixed element of <code>α</code>, if it's too short.</p>\n<p>For my application , <code>α</code> would be <code>ℕ</code>, all the lists I consider are of length <code>≤ n</code> and I'd like to<br>\nappend some <code>0</code>'s to turn them into <code>Fin n → ℕ</code>. To <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a>, I need to do computations with digits of some natural numbers in base <code>b</code>. We have for that the very nice <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.digits#doc\">docs#Nat.digits</a> but my life would be a lot easier if the list of digits where all of the same (fixed) length.</p>",
        "id": 554357307,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1762531331
    },
    {
        "content": "<p>This isn't quite what you're looking for, but <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.get#doc\">docs#List.get</a> is worth knowing about. It requires you have the right length (ie not too short or too long), but still might be helpful.</p>",
        "id": 554357802,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1762531474
    },
    {
        "content": "<p>It would be easier for everyone if you could include <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>, so that someone who knows the solution can fill in the blank very easily without having to write the whole thing from scratch:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">get</span>\n</code></pre></div>",
        "id": 554358047,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762531534
    },
    {
        "content": "<p>In combination with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin.take#doc\">docs#Fin.take</a>, actually this covers the \"too long\" case, see eg <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin.ofFn_take_get#doc\">docs#Fin.ofFn_take_get</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Fin.get_take_ofFn_eq_take_comp_cast#doc\">docs#Fin.get_take_ofFn_eq_take_comp_cast</a></p>",
        "id": 554358143,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1762531560
    },
    {
        "content": "<p>In other words, if you had included the following in your question:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>then I would have been able to answer your question in 10 seconds.</p>",
        "id": 554358150,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762531563
    },
    {
        "content": "<p>or rather,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"bp\">?.</span><span class=\"n\">getD</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n</code></pre></div>\n<p>(again, importance of including code so I don't have to guess)</p>",
        "id": 554358638,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1762531685
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488648\">Xavier Roblot</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Inverse.20direction.20of.20.60List.2EofFn.60/near/554357307\">said</a>:</p>\n<blockquote>\n<p>To <a href=\"https://en.wikipedia.org/wiki/XY_problem\">#xy</a>, I need to do computations with digits of some natural numbers in base <code>b</code>. We have for that the very nice <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.digits#doc\">docs#Nat.digits</a> but my life would be a lot easier if the list of digits where all of the same (fixed) length.</p>\n</blockquote>\n<p>It may be useful to look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Combinatorics/Additive/AP/Three/Behrend.html#Behrend.map_apply\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Combinatorics/Additive/AP/Three/Behrend.html#Behrend.map_apply</a>, which is also about computations with digits of natural numbers in an arbitrary base. But perhaps your application is different enough that this isn't useful</p>",
        "id": 554358769,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1762531717
    },
    {
        "content": "<p>Bhavik et Kenny, thanks for the answers. I'll have a look at <code>Mathlib.Combinatorics.Additive.AP.Three.Behrend</code> which may provide an easy solution for my problem, otherwise I'll try Kenny's solution.</p>",
        "id": 554359774,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1762531947
    },
    {
        "content": "<p>I don't think my example will completely solve your problem, to be clear! It was designed to be for this specific proof (where the idea is specifically to think about the digits of a natural), rather than be a general API for digits.</p>",
        "id": 554360169,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1762532020
    },
    {
        "content": "<p>Well, in the end, I used Kenny's suggestion to create a <code>Fin</code> version of <code>Nat.digits</code> and use that to prove the result I need: <a href=\"https://github.com/leanprover-community/mathlib4/pull/31468\">#31468</a></p>",
        "id": 554706029,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1762782824
    }
]