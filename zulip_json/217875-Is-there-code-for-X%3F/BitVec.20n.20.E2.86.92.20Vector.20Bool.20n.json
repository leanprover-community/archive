[
    {
        "content": "<p>Is there a function for converting a bit vector to a list of bools?</p>",
        "id": 565551894,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766905261
    },
    {
        "content": "<p>The closest thing I can find is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"bp\">.</span><span class=\"n\">toVector</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BitVec</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"bp\">.</span><span class=\"n\">toNat</span><span class=\"bp\">.</span><span class=\"n\">bits</span><span class=\"bp\">.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">toVector</span>\n</code></pre></div>\n<p>But it will not work as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Nat.bits#doc\">docs#Nat.bits</a> will not have leading zeros.</p>",
        "id": 565551941,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766905366
    },
    {
        "content": "<p>I am not sure if I am missing something trivial from mathlib.</p>",
        "id": 565551971,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766905417
    },
    {
        "content": "<p>I think you should be able to get what you need by using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.ofFn#doc\">docs#List.ofFn</a> along with either <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BitVec.getLsb#doc\">docs#BitVec.getLsb</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BitVec.getMsb#doc\">docs#BitVec.getMsb</a> (depending on the ordering you'd like)</p>",
        "id": 565552270,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766905846
    },
    {
        "content": "<p>you know, something like <code>fun bv =&gt; List.ofFn bv.getLsb</code> or whatnot</p>",
        "id": 565552443,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906058
    },
    {
        "content": "<p>Yes, I am trying the function. The tricky part is now the dependent type.</p>",
        "id": 565552542,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906222
    },
    {
        "content": "<p>what trouble are you running into?</p>",
        "id": 565552581,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906298
    },
    {
        "content": "<p>Classic trouble of dependent type</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">mismatch</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">ofFn</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"bp\">.</span><span class=\"n\">getMsb</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">toVector</span>\n<span class=\"n\">has</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">ofFn</span><span class=\"w\"> </span><span class=\"n\">bv</span><span class=\"bp\">.</span><span class=\"n\">getMsb</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">toArray</span><span class=\"bp\">.</span><span class=\"n\">size</span>\n<span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">expected</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">type</span>\n<span class=\"w\">  </span><span class=\"n\">Vector</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"n\">n</span>\n</code></pre></div>",
        "id": 565552620,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906349
    },
    {
        "content": "<p>oh, I didn't realize you wanted a vector, you said list (realizing now I should've read the post title more carefully)</p>",
        "id": 565552632,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906371
    },
    {
        "content": "<p>just use <code>Vector.ofFn</code> then</p>",
        "id": 565552636,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906385
    },
    {
        "content": "<p>Nice!</p>",
        "id": 565552688,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906441
    },
    {
        "content": "<p>Thanks!</p>",
        "id": 565552701,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906450
    },
    {
        "content": "<p>no problem!</p>",
        "id": 565552703,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906460
    },
    {
        "content": "<p>I guess there is also an inverse function as well?</p>",
        "id": 565552815,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906645
    },
    {
        "content": "<p>I am looking up relevant APIs.</p>",
        "id": 565552825,
        "sender_full_name": "Ka Wing Li",
        "timestamp": 1766906657
    },
    {
        "content": "<p>yes, it looks like you can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BitVec.ofFnLE#doc\">docs#BitVec.ofFnLE</a> (little endian) or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BitVec.ofFnBE#doc\">docs#BitVec.ofFnBE</a> (big endian) along with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Vector.get#doc\">docs#Vector.get</a> to go in the other direction</p>",
        "id": 565552968,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766906839
    },
    {
        "content": "<p>these lemmas should be useful for proving that these transformations are inverse to each other:</p>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Batteries/Data/BitVec/Lemmas.html\">https://leanprover-community.github.io/mathlib4_docs/Batteries/Data/BitVec/Lemmas.html</a></p>\n<p>along with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Vector.get_ofFn#doc\">docs#Vector.get_ofFn</a></p>",
        "id": 565553445,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1766907364
    }
]