[
    {
        "content": "<p>Is there a tool to derive the parametricity translation of a structure or a typeclass?</p>",
        "id": 553698536,
        "sender_full_name": "Patrick Nicodemus",
        "timestamp": 1762285044
    },
    {
        "content": "<p>What is parametricity translation?</p>",
        "id": 553703659,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762286947
    },
    {
        "content": "<p>The parametricity translation is a map from definitions to definitions. It has been worked out on paper for dependent type theories which are pure type systems, it should be possible to handle some reasonable fragment of Lean and fail if it encounters some aspect of the language which it doesn't know how to handle.</p>\n<p>it is easier to show some simple examples:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">abc</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">a</span>\n</code></pre></div>\n<p>would be translated to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">abc_param</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"bp\">-&gt;</span><span class=\"n\">B</span><span class=\"bp\">-&gt;</span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>\n<p>So the translation sends type variables to pairs of type variables with a binary relation between them, and elements of types to related pairs of elements of types.</p>\n<p>If D is the definition of an algebraic structure, say the type Widget, then the parametricity translation applied to D should return a function Widget -&gt; Widget -&gt; Type which associates to two widgets S, S' the type of spans <code>S &lt;- W -&gt; S'</code> in the category of widgets and widget homomorphisms.</p>\n<p>For example, in theory it should be possible to plug in, say, the definition of a category, and get out a definition which sends two categories C, C' to the type of spans between them in the category Cat.</p>",
        "id": 553721925,
        "sender_full_name": "Patrick Nicodemus",
        "timestamp": 1762292449
    },
    {
        "content": "<p>sounds like a lot of metaprogramming might get you a good approximation</p>",
        "id": 553722253,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762292602
    },
    {
        "content": "<p>I believe that <span class=\"user-mention\" data-user-id=\"693714\">@Vincent Kuhlmann</span> is working on this.</p>",
        "id": 553780485,
        "sender_full_name": "Markus Himmel",
        "timestamp": 1762327278
    },
    {
        "content": "<p>Yes that is correct. Thanks for noticing Markus! It will be finished in a month or two :)</p>",
        "id": 553780932,
        "sender_full_name": "Vincent Kuhlmann",
        "timestamp": 1762327503
    }
]