[
    {
        "content": "<p>Do we have this in mathlib and is this the right generality?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">compatible</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">IsScalarTower</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">compHom</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">CompatibleSMul</span><span class=\"w\"> </span><span class=\"n\">M1</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">letI</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">compHom</span><span class=\"w\"> </span><span class=\"n\">M2</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">algebra_compatible_smul</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_smul</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n</code></pre></div>",
        "id": 558758793,
        "sender_full_name": "Edison Xie",
        "timestamp": 1763762984
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"699016\">Edison Xie</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/LinearMap.2ECompatibleSMul.20instance/near/558758793\">said</a>:</p>\n<blockquote>\n<p>is this the right generality</p>\n</blockquote>\n<p>surely they can be semirings</p>",
        "id": 558760147,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1763763640
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.compHom#doc\">docs#Module.compHom</a></p>",
        "id": 558821381,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763824343
    },
    {
        "content": "<p>Why not just ask for <code>[Module k M2] [IsScalarTower k A M2]</code>? In situations where <code>Module k M2</code> already exists and is not defeq to <code>Module.compHom</code> you might be in trouble with this instance as it stands</p>",
        "id": 558821484,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763824472
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsScalarTower.compatibleSMul#doc\">docs#IsScalarTower.compatibleSMul</a></p>",
        "id": 558822177,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1763825230
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/LinearMap.2ECompatibleSMul.20instance/near/558821484\">said</a>:</p>\n<blockquote>\n<p>Why not just ask for <code>[Module k M2] [IsScalarTower k A M2]</code>? In situations where <code>Module k M2</code> already exists and is not defeq to <code>Module.compHom</code> you might be in trouble with this instance as it stands</p>\n</blockquote>\n<p>the context is that I'm trying to cleanup some old proofs from my brauer group repo to try and PR them, since none of the rings in there is commutative and I often have to \"choose\" a simple module over a simple ring it's not at all trivial to me that it may satisfy \"IsScalarTower\" :-(</p>",
        "id": 558824379,
        "sender_full_name": "Edison Xie",
        "timestamp": 1763827066
    },
    {
        "content": "<p>but after some work I proved <code>IsScalarTower</code> instance so thanks for the suggestion :-)</p>",
        "id": 558824465,
        "sender_full_name": "Edison Xie",
        "timestamp": 1763827133
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"439483\">Andrew Yang</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/LinearMap.2ECompatibleSMul.20instance/near/558822177\">said</a>:</p>\n<blockquote>\n<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsScalarTower.compatibleSMul#doc\">docs#IsScalarTower.compatibleSMul</a></p>\n</blockquote>\n<p>do you mean <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearMap.IsScalarTower.compatibleSMul#doc\">docs#LinearMap.IsScalarTower.compatibleSMul</a> ?</p>",
        "id": 558824662,
        "sender_full_name": "Edison Xie",
        "timestamp": 1763827283
    },
    {
        "content": "<p>The is scalar tower instance should be <code>.of_algebraMap_smul fun _ _ =&gt; rfl</code></p>",
        "id": 558838839,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1763840331
    }
]