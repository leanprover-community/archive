[
    {
        "content": "<p>Hey! I stumbled upon this code, used for using a smaller logic inside of Lean 3, such that you define some axioms and inference rules, and instead of  proving  a goal of the form \"Using inference rules, from the axioms Gamma you can infer sentence phi\", you just assume Gamma and prove phi. But I'm unable to find documentation for this feature (begin [modal]) and I'm unsure if it even exists in Lean 4. Do you know how it's called and if it's available in Lean 4?<br>\n<a href=\"/user_uploads/3121/mUXLRSVJAeQbWaOCtpCq-1dp/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/ceYW1uRgYWUAYl3Bn8rX6XAL/image.png\">image.png</a><br>\n these are from this presentation:  <a href=\"https://lean-forward.github.io/lean-together/2019/slides/hudon.pdf\">https://lean-forward.github.io/lean-together/2019/slides/hudon.pdf</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mUXLRSVJAeQbWaOCtpCq-1dp/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"565x250\" src=\"/user_uploads/thumbnail/3121/mUXLRSVJAeQbWaOCtpCq-1dp/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ceYW1uRgYWUAYl3Bn8rX6XAL/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"746x566\" src=\"/user_uploads/thumbnail/3121/ceYW1uRgYWUAYl3Bn8rX6XAL/image.png/840x560.webp\"></a></div>",
        "id": 520007161,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1747992175
    },
    {
        "content": "<p>I think this may be part of a library? At least not core lean</p>",
        "id": 520075360,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1748012910
    },
    {
        "content": "<p>Not sure whether it has been ported to lean 4</p>",
        "id": 520076130,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1748013140
    },
    {
        "content": "<p>Cool! I will be happy to try porting it if you have any pointers where's the original documentation for this syntax</p>",
        "id": 520079375,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1748014147
    },
    {
        "content": "<p>It's a Lean 3 feature that doesn't exist in Lean 4.</p>\n<p>The way Lean 3's tactics work is namespace-based. I think <code>begin ... end</code> is the same as <code>begin [tactic] ... end</code> (maybe I got <code>tactic</code> itself wrong), and then the main tactic parser looked in that namespace for tactic definitions. This let you create, for example, a namespace of <code>temporal</code> tactics. Every tactic you see there as a <code>temporal</code> equivalent, or at least it's the corresponding <code>tactic</code> tactic redeclared in the <code>temporal</code> namespace.</p>\n<p>One of the main uses of this was conv mode, if I remember correctly.</p>\n<p>There's no direct equivalent in Lean 4. You could make a <code>by_temporal</code> syntax with a custom <code>temporalTactic</code> syntax category, and then build a custom tactic executor. It could be that <code>temporal =&gt; ...</code> is the <code>tactic</code> that goes into \"temporal mode\". You could model the whole thing on how <code>conv =&gt; ...</code> works. There's no framework for doing this, but all the metaprogramming API is there to make it possible.</p>\n<p>Probably easier is to make tactics for temporal reasoning and use them as normal tactics.</p>",
        "id": 520080619,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1748014531
    },
    {
        "content": "<p>NNG3 used <code>begin [natnumgame]</code> internally to cripple <code>rw</code>.</p>",
        "id": 520089119,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1748017402
    },
    {
        "content": "<p>nowadays you can use syntax overrides for that</p>",
        "id": 520092943,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1748018834
    },
    {
        "content": "<blockquote>\n<p>One of the main uses of this was conv mode, if I remember correctly.</p>\n</blockquote>\n<p>I don't think conv mode was using this feature, although it did bear some other similarities to \"tactic namespaces\". The main tactic namespace used in lean 3 was <code>[smt]</code> (and it wasn't used at all <span aria-label=\"skull\" class=\"emoji emoji-1f480\" role=\"img\" title=\"skull\">:skull:</span> )</p>",
        "id": 520093194,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1748018929
    },
    {
        "content": "<p>Thank you for the informative answer <span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> ! Do I understand correctly that defining a new syntactic category also enables you to prevent the \"user\" from using tactics from outside of the pre-defined set? This is actually the most important to me; to guarantee to the reader that a proof does not use anything except a couple \"easy\" tactics</p>",
        "id": 520099817,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1748021497
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/begin.20.5Bobject_logic.5D/near/520093194\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>One of the main uses of this was conv mode, if I remember correctly.</p>\n</blockquote>\n<p>I don't think conv mode was using this feature, although it did bear some other similarities to \"tactic namespaces\". The main tactic namespace used in lean 3 was <code>[smt]</code> (and it wasn't used at all <span aria-label=\"skull\" class=\"emoji emoji-1f480\" role=\"img\" title=\"skull\">:skull:</span> )</p>\n</blockquote>\n<p>oh nice! i just saw a paper about using a smt-solver for lean proofs from may 21 (<a href=\"https://arxiv.org/pdf/2505.15796\">https://arxiv.org/pdf/2505.15796</a> ) - it's not relevant to my work though</p>",
        "id": 520100139,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1748021614
    },
    {
        "content": "<p>Yes, you can definitely make your own tactic language using your own syntax category.</p>\n<p>Maybe easiest is to implement it using macros that expand your locked-down language to the \"real\" tactics. (On my phone, otherwise I'd make you a simple example.)</p>",
        "id": 520141586,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1748042323
    },
    {
        "content": "<p>Okay, I managed to write some code for it and it looks really promising! I run into an issue I'm not sure how to fix though. First, what I did:</p>\n<ul>\n<li>I defined 2 new syntactic categories: 1) to express logical formulas (theorem statements) in my small logic 2) to express proofs in my proof system</li>\n<li>I added elaboration rules for them</li>\n<li>\n<p>I have a nice working example: <br>\n<a href=\"/user_uploads/3121/8a0n0ZnvVkbHqqAnb55bDKHK/image.png\">image.png</a><br>\n<a href=\"/user_uploads/3121/orTO1bN9ufVrvMcOzdkhBf80/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/8a0n0ZnvVkbHqqAnb55bDKHK/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"625x176\" src=\"/user_uploads/thumbnail/3121/8a0n0ZnvVkbHqqAnb55bDKHK/image.png/840x560.webp\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/3121/orTO1bN9ufVrvMcOzdkhBf80/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"426x466\" src=\"/user_uploads/thumbnail/3121/orTO1bN9ufVrvMcOzdkhBf80/image.png/840x560.webp\"></a></div></li>\n<li>\n<p>the whole code is here:  <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAGQKYEMB2AoDExLY1fAUQBsUAjOAFRQGMZhbqkoQ4BZJGFOAZQE803AB5YA9AFoMcPjCRg4ARgBccACJIAZsDRI4tAK4BnGBDZHBIuJuhwQO0ChJwSEAOaMMEsVgAmSWjIoJAB9CyEUYRDaFHhXD1oQpGEwKCxwqwAiQBKiTJl8gsKigtV4xiSUtIzIuEzAUqI84qam0vdy5NSMauEXNsSOqFq4QHIiIbL+yrhWhIrO7t6ZgaHACiIxvtnB6fbKrssa8Y2hwCTCNcXJrYm5vZ7gfyFmh/yLjd2InsyACjyDpcyASjyzwG6WutQA2gg+gAfU7bVK1AC6gLgclY4ikMl4cgUACZVOw6FAIHAOugjMAIPhTAR0AByIxwHSotBOBaebxYJBkcghKAGEhIBmqVEgaRwGEAAw+EOhcGyCL+cAAvAA+ODBGAGKD4EAAawAwpSTHAJRKqHykGLJdLIQkYXUFcq1RqtTqDUb4KaAGJOIyWmTWmV2uAfAAkYD+jtVcF8xK5FCoLDYH0ACYQmm2y8MKxVoSl6CQSOAAJQCWr91lsYBQwSEAAtBYKremg4wYeHlD9JqNQwBHDvrAZRtWxsUFAVxWsMtPx8iJ1ghtNSlu0NtgbNwXO6Uf5cfqydwafcufJxcZ4O99eb/2FPUAQTAYHYJolt7QvjgAGIwSRJwAaPdGAiTZLrarZwO2nbwqsvb9mcqRDjGEDbjIu4/lOJJHkmC7NqBK7gWufw5nmyEuFwAEHhhCZYamOGZj2l7EUUd4Pk+poAPKDF+aH/lAk5AQGtHnmAsFwoMJwwZBUAISORSofuh5UfONEgZmBFEVuslkbx6Ezse2Eqee9GERujE3rqt5QESADuLj7tpwFnmBobAMotx4DAQ4kbp1F6gAknc8DAAAdG4XD+eploYP4gTVqE3TRLEdgONw9CePMmQoEYRgGCAeh5G59zInkIqPKVqj2GgwApQwtCvFkTJEjw+UBaVrXNOVyV0DVdU1JkDUQL4Bi0HlKJYW140yB1lXVWloIZQ+JD8EMBXwBNa1TEl01dbNby1MkXXLS160TVNVXbbV6VGGAJBVY0x33RtFVnalF1zQKmgwHdD3HadM2vbtmRQMAbi1p9333b9509e8MR+gyzXueDZWbc93XpbGuhfUj42Qy9IIA+QSAeGgIQVUMHxPX9fwAFSTSiUOctyvL8oKG1/Q5f0woTxOkzo4FgqGKVGMolPnQi1OKtGMmFLuIAGPAKUIMAxqqBZUAoEtHxUAIu0SlTUxKp+YL8YUNiDClAByA16HzQuISRKFkboVk0Ewqja6CevnRRICxLQtb07QVv+HAVlVbWDv5NaosvTCmXZbl4G1q5LWqIL/CS2qUqc3AtYoAAbnooYB2nMBLcohtGNAUAZ5HAlSjHNUwv1PDFyn7mKkU0bZ+dzdCEScAoH8dfiumjdgf1g3DUnygip3hTdx8Of9TPc8j9HnWx4PC1LW3K3zwUi85ygO9J8PDwb1tW/7fQM/78UR+9ySwgHcX5/NJfqNgVdN0wAfpWPy3rQD0fJ6DQHfk0T+Od3p/zWoApu29rpLQ4kFHQJAIHFCgU/IGINYHjXgWBE+SC4AoJ0FADBRQCyjwbpvBBsNWZ7wCv/GQBC8L0IZG/deY9aFgQxkgZhjxWFxyyjlMADBKQUMKDCEIToUS1mskQSytgQAAEJMgAFU0DZQfNAOQ74nqBxqqoAA3pba2ABfTIkdFbK3gBXQOSsTBBTAMYAOztXaRyQPnJwrsaobiQC7OgJEqG7j9D2HWVh7HIHQEFPUwc9ASmiWgIKAAFasfooBBV8YwIKf1eBIB7A42xwTCxeJ8d7MJETIichfuAAUIYUlwAAIobRSUSCMG1lwwkaScD4LSTgpMjAbOA5B+Bim5joXmmACiTyGnoMA25ZnTx7BgIAA\">live.lean-lang.org/..</a></p>\n</li>\n</ul>\n<p>But what's problematic is that currently the whole block inside <code>begin_min</code> is evaluated at once. Namely, I have implemented the <code>begin_min</code> block like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">elab_rules</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">begin_min</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">tacs</span><span class=\"o\">:</span><span class=\"n\">minitactic</span><span class=\"o\">]</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">tacList</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`tactic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">      </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">tacNode</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">tacs</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">newTac</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`tactic</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">tacNode</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">introduce</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">)</span><span class=\"w\">       </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">)</span>\n<span class=\"o\">[</span><span class=\"bp\">...</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>which seems to make the whole block a single tactic; the proof state changes with adding / removing <code>minitactics</code> from the block, but it doesn't change when traversing the proof interactively (just using keyboard arrows to go up/down). For now, I don't see how to fix that without moving into the open world of  <code>tactic</code> syntactic category, but maybe a solution would be to 'break' the proof state by changing the goal which is not provable from anything except my <code>minitactics</code>? then redefine my <code>minitactics</code> into normal tactics from the <code>tactic</code> category. Do you have any idea how to make it more interactive? :)</p>\n<p>Btw, I think it would be really nice to have such embeddings for popular logics (modal, minimal, linear, classical) inside mathlib:  Mathlib.ProofTheory, complementary to Mathlib.ModelTheory</p>",
        "id": 520196509,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1748092442
    },
    {
        "content": "<p>You should output the state at points inside the <code>begin_min</code> block</p>",
        "id": 520197304,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1748093058
    },
    {
        "content": "<p>The <code>rw</code> tactic does it using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Elab.Tactic.withTacticInfoContext#doc\">docs#Lean.Elab.Tactic.withTacticInfoContext</a></p>",
        "id": 520197407,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1748093162
    },
    {
        "content": "<p>Wow thanks <span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> ! Now it really is interactive :) </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">declare_syntax_cat</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"assume \"</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"s2\">\" : \"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\">                       </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"introa \"</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\">                                  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"introduce \"</span><span class=\"w\"> </span><span class=\"n\">term</span><span class=\"w\">                                </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"apply \"</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\">                                   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"exact \"</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\">                                   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"split\"</span><span class=\"w\">                                          </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"left\"</span><span class=\"w\">                                           </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"right\"</span><span class=\"w\">                                          </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"cases \"</span><span class=\"w\"> </span><span class=\"n\">ident</span><span class=\"w\">                                   </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"done\"</span><span class=\"w\">                                           </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">minitactic</span>\n\n<span class=\"kn\">syntax</span><span class=\"w\"> </span><span class=\"s2\">\"begin_min \"</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"o\">)</span><span class=\"bp\">*</span><span class=\"w\">  </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span>\n\n\n<span class=\"n\">elab_rules</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">begin_min</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"o\">[</span><span class=\"bp\">$</span><span class=\"n\">tacs</span><span class=\"o\">:</span><span class=\"n\">minitactic</span><span class=\"o\">]</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">mut</span><span class=\"w\"> </span><span class=\"n\">tacList</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Array</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`tactic</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">#</span><span class=\"o\">[]</span>\n<span class=\"w\">      </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"n\">tacNode</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">tacs</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">        </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">newTac</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TSyntax</span><span class=\"w\"> </span><span class=\"ss\">`tactic</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">tacNode</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"k\">assume</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">ty</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">ty</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">introa</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">)</span><span class=\"w\">       </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">introduce</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">)</span><span class=\"w\">       </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">term</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">)</span><span class=\"w\">       </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"n\">ident</span><span class=\"o\">)</span><span class=\"w\">       </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">split</span><span class=\"o\">)</span><span class=\"w\">                </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">constructor</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">left</span><span class=\"o\">)</span><span class=\"w\">                 </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">right</span><span class=\"o\">)</span><span class=\"w\">                </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Or</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"c1\">-- | `(minitactic| cases $h:ident)       =&gt; `(tactic| cases $h)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">minitactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"o\">)</span><span class=\"w\">                 </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">assumption</span><span class=\"o\">)</span>\n<span class=\"w\">          </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"n\">m!</span><span class=\"s2\">\"Unsupported mini tactic: {tacNode}\"</span>\n<span class=\"w\">        </span><span class=\"n\">tacList</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">tacList</span><span class=\"bp\">.</span><span class=\"n\">push</span><span class=\"w\"> </span><span class=\"n\">newTac</span>\n<span class=\"w\">        </span><span class=\"n\">withTacticInfoContext</span><span class=\"w\"> </span><span class=\"n\">tacNode</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">          </span><span class=\"n\">evalTactic</span><span class=\"w\"> </span><span class=\"n\">newTac</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Logic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">begin_min</span>\n<span class=\"w\">    </span><span class=\"n\">introduce</span><span class=\"w\"> </span><span class=\"n\">p</span>\n<span class=\"w\">    </span><span class=\"n\">introduce</span><span class=\"w\"> </span><span class=\"n\">q</span>\n</code></pre></div>",
        "id": 520197823,
        "sender_full_name": "Paweł Balawender",
        "timestamp": 1748093512
    }
]