[
    {
        "content": "<p>I am trying to show that the series <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow></msub><mo stretchy=\"false\">(</mo><mi>n</mi><msqrt><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></msqrt><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\sum_{n = 0} (n \\sqrt{\\log n})^{-1} </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1347em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.835em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-2.795em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.205em;\"><span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> (where the summand is defined to be zero for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>∈</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">n  \\in \\{0,1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>) is not summable. My strategy was to use the condensation test given by <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/PSeries.html#summable_condensed_iff_of_nonneg\">summable_condensed_iff_of_nonneg</a>.</p>\n<p>The problem is that the summand is only antitone for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">n \\geq 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span> (instead of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">n \\geq 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>, as is required by <code>summable_condensed_iff_nonneg</code>). I could shift my summation index using <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Algebra/InfiniteSum/NatInt.html#summable_nat_add_iff\">summable_nat_add_iff</a>, but then the transformed series is not so nice to work with.</p>\n<p>My question is the following: is there a way to efficiently work around <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Analysis/PSeries.html#summable_condensed_iff_of_nonneg\">summable_condensed_iff_of_nonneg</a> so that the monotonicity/positivity hypotheses are only required for sufficiently large <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>?</p>",
        "id": 572330642,
        "sender_full_name": "Joris van Winden",
        "timestamp": 1770370631
    },
    {
        "content": "<p>I would prove a corollary of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=summable_condensed_iff_of_nonneg#doc\">docs#summable_condensed_iff_of_nonneg</a> that only assumes eventual mononicity/positivity. One needs to rewrite the series as the sum of the first <code>a</code> terms plus the translated series to which that lemma would apply.</p>",
        "id": 572399350,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1770390262
    },
    {
        "content": "<p>In particular, I would prove that <code>f(n+a)</code> is monotone under the assumption that <code>f(n) &lt;= f(m)</code> as soon as <code>a&lt;=n&lt;=m</code>, and the latter will be reasonably clear in your case.</p>",
        "id": 572399741,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1770390354
    },
    {
        "content": "<p>It may also be feasible to generalise <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=summable_condensed_iff_of_nonneg#doc\">docs#summable_condensed_iff_of_nonneg</a> in mathlib to only assume eventual things, then the current version can be deduced from that</p>",
        "id": 572400180,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1770390454
    },
    {
        "content": "<p>Indeed. What would be the best design principle for mathlib?</p>",
        "id": 572400408,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1770390508
    },
    {
        "content": "<p>I fear that one would have to introduce <code>Function.eventuallyMonotone</code>, and then proves <code>Function.monotone.eventuallyMonotone_zero</code>…</p>",
        "id": 572400775,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1770390583
    },
    {
        "content": "<p>I expect a predicate <code>EventuallyMonotone</code> could be useful more generally.</p>",
        "id": 572401161,
        "sender_full_name": "Joris van Winden",
        "timestamp": 1770390670
    },
    {
        "content": "<p>Perhaps h_nonneg being <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Filter.EventuallyLE#doc\">docs#Filter.EventuallyLE</a> while h_mono becomes <code>∃ k, ∀ m n : ℕ, k &lt; m → m ≤ n → f n ≤ f m</code> may be enough for now; equivalently <code>∃ k, AntitoneOn f (Set.Ioi k)</code></p>",
        "id": 572401470,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1770390742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130609\">Antoine Chambert-Loir</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/eventual.20monotonicity.20for.20summable_condensed_iff/near/572399350\">said</a>:</p>\n<blockquote>\n<p>I would prove a corollary of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=summable_condensed_iff_of_nonneg#doc\">docs#summable_condensed_iff_of_nonneg</a> that only assumes eventual mononicity/positivity. One needs to rewrite the series as the sum of the first <code>a</code> terms plus the translated series to which that lemma would apply.</p>\n</blockquote>\n<p>There is the issue that 'condensing' the series does not commute with shifting the index. So maybe instead it is more convenient to set the first <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> terms equal to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f (m)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span>, assuming that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> is monotone starting from <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>.</p>",
        "id": 572402011,
        "sender_full_name": "Joris van Winden",
        "timestamp": 1770390886
    },
    {
        "content": "<p>Yeah, I tried to prove it earlier, but didn't get far. Maybe because I didn't think through the maths first</p>",
        "id": 572402372,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1770390991
    },
    {
        "content": "<p>I think I found a nice proof! </p>\n<p>Let <code>m</code> be such that <code>n =&gt; f n</code> is antitone and nonnegative for <code>m ≤ n</code>. Then apply <code>summable_condensed_iff_of_nonneg</code> to <code>n =&gt; f (max n m)</code>, and use <code>summable_congr_atTop</code> to conclude that <code>f</code> is summable.</p>",
        "id": 572523922,
        "sender_full_name": "Joris van Winden",
        "timestamp": 1770465741
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/34985\">#34985</a></p>",
        "id": 572632348,
        "sender_full_name": "Joris van Winden",
        "timestamp": 1770567810
    },
    {
        "content": "<p>nice trick.</p>",
        "id": 572721450,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1770629682
    }
]