[
    {
        "content": "<p>Is there code for topological manifolds?<br>\n(topological spaces where every point has a neighborhood homeomorphic to euclidean space)<br>\nThere's <code>Mathlib/Geometry/Manifold/*</code> but I'm not sure how that relates to the topological definition.<br>\nI'm looking for something similar to this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Manifold</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">neighborhood</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"w\">  </span><span class=\"n\">is_open</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">neighborhood</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">is_homeomorphic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">neighborhood</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚âÉ‚Çú</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>and possible the same with a diffeomorphism instead of an homeomorphism for a smooth manifold.</p>",
        "id": 528415159,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1752274595
    },
    {
        "content": "<p>If you want <code>M</code> to be a finite-dimensional real or complex manifold, the <code>Mathlib.Geometry.Manifold</code>API can accomplish that like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Manifold</span><span class=\"w\"> </span><span class=\"n\">ContDiff</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ChartedSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">IsManifold</span><span class=\"w\"> </span><span class=\"n\">ùìò</span><span class=\"o\">(</span><span class=\"n\">ùïú</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">EuclideanSpace</span><span class=\"w\"> </span><span class=\"n\">ùïú</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚àû</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>The <code>ChartedSpace</code> instance here means that <code>M</code> is equipped with an atlas of partial homeomorphisms to <code>EuclideanSpace ùïú (Fin n)</code> as well as a canonical choice of chart at each point, and <code>IsManifold ùìò(ùïú, EuclideanSpace ùïú (Fin n)) ‚àû M</code> asks that these charts are smoothly compatible so it's not just a topological manifold but in fact a smooth one<br>\nDepending on what exactly you want to do, it might also be a good idea to replace <code>EuclideanSpace ùïú (Fin n)</code> in that snippet with some arbitrary finite-dimensional vector space over <code>ùïú</code></p>",
        "id": 528416447,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1752275756
    },
    {
        "content": "<p>Mathlib already has the concept you want (topological and smooth manifolds), and the <code>Geometry/Manifold</code> directory is indeed where to look.</p>\n<p>The way this is stated is a bit different though, to allow more generality: mathlib's definition also allows</p>\n<ul>\n<li>manifolds with boundary (where they locally look like the upper half of a ball) and corners (which you get when you take products of manifolds with boundary)</li>\n<li>infinite-dimensional manifolds (say, modelled on a Banach space --- or not even a Banach space)</li>\n<li>p-adic manifolds</li>\n</ul>",
        "id": 528416494,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1752275804
    },
    {
        "content": "<p>In a nutshell, mathlib's notion of manifolds is split in two concept.<br>\nThe first one is a notion \"<code>X</code> is a topological space which locally looks like an open subset in some space <code>Y</code>\". Mathlib calls such a situation \"X is a charted space modelled on Y\", or <code>ChartedSpace Y X</code>. (If <code>Y</code> is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">k</mi><mi>n</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{k}^n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span></span> for <code>k</code> the real or complex numbers, this recovers your definition.)<br>\nThe second part allows manifolds with boundary, by taking a <em>model with corners</em>. Think of the inclusion of the upper half-space in Euclidean space, when you want to model a n-dimensional real manifold with boundary: you say your manifold is modelled on open sets of the upper half-space <code>H</code>; composing with the inclusion of <code>H</code> into $$$\\mathbb{R}^n$$ gives you a map into Euclidean space (so you can talk about derivatives and smooth manifolds).</p>",
        "id": 528416500,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1752275808
    },
    {
        "content": "<p>... and now I realise that Ben and I said very much the same thing, in different words. I hope having two different perspectives is useful :-)</p>",
        "id": 528416520,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1752275833
    },
    {
        "content": "<p>The other thing I wanted to add is that afaik, there is no property like <code>IsTopologicalManifold</code> in mathlib yet - <code>ChartedSpace</code> can sort of accomplish that but carries data, while being a topological manifold is of course really just a property topological spaces can have</p>",
        "id": 528416733,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1752276051
    },
    {
        "content": "<p>but since your example class <code>Manifold</code> carries data too, I'm guessing that's not a problem to you</p>",
        "id": 528416782,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1752276094
    },
    {
        "content": "<p>Speaking of which: Patrick Massot were thinking of compiling a differential geometry \"cheat sheet\" or \"phrase book\" --- something like a dictionary between mathematical statements like \"let M be a finite-dimensional real or complex manifold\" and Lean statements.</p>",
        "id": 528416797,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1752276112
    },
    {
        "content": "<p>The current version is <a href=\"https://github.com/leanprover-community/mathlib4/blob/d6635d90188260a67da263b8db08ec7f55faafb3/Mathlib/Geometry/Manifold/CheatSheet.md\">here</a> --- suggestions for which other things to include are welcome. (It's not particularly polished yet. That will come over time.)</p>",
        "id": 528416875,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1752276183
    },
    {
        "content": "<p>Cool, <code>ChartedSpace</code> looks similar to what I had in mind, thanks!<br>\nRegarding the cheat-sheet: I expected something like \"let X be an n dimensional manifold\" to be mapped to this <code>ChartedSpace</code> definition. Does it make sense?</p>",
        "id": 528417280,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1752276627
    },
    {
        "content": "<p>Oh I see, when the cheat-sheet says C^k it means C for continuously differentiable, and not <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{C}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> for complex numbers. That's why it isn't just <code>ChartedSpace</code></p>",
        "id": 528417445,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1752276801
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"933054\">Snir</span> has marked this topic as resolved.</p>",
        "id": 528417521,
        "sender_full_name": "Notification Bot",
        "timestamp": 1752276894
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"634338\">Michael Rothgang</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/.E2.9C.94.20Topological.20Manifolds/near/528416875\">said</a>:</p>\n<blockquote>\n<p>The current version is <a href=\"https://github.com/leanprover-community/mathlib4/blob/d6635d90188260a67da263b8db08ec7f55faafb3/Mathlib/Geometry/Manifold/CheatSheet.md\">here</a> --- suggestions for which other things to include are welcome. (It's not particularly polished yet. That will come over time.)</p>\n</blockquote>\n<p>Minor nitpick: it might be good to mention that <code>open ContDiff</code> is required for the notation <code>‚àû</code> in the second example to work - I think that's less obvious than that you need to open the namespaces <code>ChartedSpace</code> etc are in</p>",
        "id": 528417605,
        "sender_full_name": "Ben Eltschig",
        "timestamp": 1752276978
    }
]