[
    {
        "content": "<p>It looks like there isn't anything from this branch of logic in mathlib:</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Transseries\">https://en.wikipedia.org/wiki/Transseries</a></p>\n<p>I was also looking for some docs on how one would start to formalize an object like this. More precisely, given a commutative ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span>, i want to define the structure <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>R</mi><mo separator=\"true\">,</mo><mo>+</mo><mo separator=\"true\">,</mo><mo>×</mo><mo separator=\"true\">,</mo><mo>&lt;</mo><mo separator=\"true\">,</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(R, +, \\times, &lt;, \\exp)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">+</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">×</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">exp</span><span class=\"mclose\">)</span></span></span></span> in Lean. I tried writing an inductive type starting from a base ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>R</mi></mrow><annotation encoding=\"application/x-tex\">R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span></span> and then adding exponential fields \"operations\" so <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>+</mo></mrow><annotation encoding=\"application/x-tex\">+</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">+</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>×</mo></mrow><annotation encoding=\"application/x-tex\">\\times</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">×</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>exp</mi><mo>⁡</mo></mrow><annotation encoding=\"application/x-tex\">\\exp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mop\">exp</span></span></span></span>, but that only encodes \"terms\" of the structure and I loose all algebraic structure (i.e. I have to re-prove commutativity).</p>\n<p>On the other hand, if I use the \"type-class\" approach I can easily define exponential fields in the axiomatic way, but then I lose the ability to match over term structure.</p>\n<p>Is there an idiomatic way of doing this kind of things in Lean?</p>\n<p>P.S. I don't know if this is the correct channel for this type of questions, in that case please tell me were I should move it</p>",
        "id": 498825617,
        "sender_full_name": "Antonio De Lucreziis",
        "timestamp": 1739210029
    },
    {
        "content": "<p>What’s wrong with building on top of what is currently in mathlib’s model theory library?</p>",
        "id": 498977955,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739270429
    },
    {
        "content": "<p>You can define that as a language expanding the language of rings (the latter being already there)</p>",
        "id": 498978159,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739270504
    },
    {
        "content": "<p>There’s generic ordered structures but not ordered rings, but again you can combine the two (and add the appropriate compatibility axioms to the theory)</p>",
        "id": 498978393,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739270563
    },
    {
        "content": "<p>see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FirstOrder.Language.ring#doc\">docs#FirstOrder.Language.ring</a></p>",
        "id": 498978534,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739270605
    },
    {
        "content": "<p>The docs there also explain how to make this work alongside the standard <code>Ring</code> typeclass</p>",
        "id": 498979040,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739270767
    },
    {
        "content": "<p>(the TLDR is: <span class=\"user-mention\" data-user-id=\"110044\">@Chris Hughes</span> has already done the nasty part of setting this up for you, so you might as well reap the benefits instead of doing it from scratch)</p>",
        "id": 498980525,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1739271264
    },
    {
        "content": "<p>I think the answer is different depending on what you want to do with this structure.</p>\n<p>I think what it you actually want is to just define one particular type which is the type of formal transeries which is not a particularly easy type to define by the looks of it. You're best bet is to look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=HahnSeries#doc\">docs#HahnSeries</a> and I suspect it's a special case of this by the looks of the wikipedia article (I don't know what a Transseries or a Hahn Series is so I'm not an expert here)</p>",
        "id": 498982374,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1739271838
    },
    {
        "content": "<p>It's unlikely that anything to do with model theory is what you want. I wouldn't recommend using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=FirstOrder.Language.ring#doc\">docs#FirstOrder.Language.ring</a></p>",
        "id": 498982514,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1739271874
    },
    {
        "content": "<p>What you want is probably <code>HahnSeries _ ℝ</code> and I haven't quite figured out what goes in the placeholder for the <code>_</code>. It'll be some ordered abelian group, but I haven't quite worked out which one from the wikipedia article yet.</p>",
        "id": 498983255,
        "sender_full_name": "Chris Hughes",
        "timestamp": 1739272104
    },
    {
        "content": "<p>Chris, I don't think this can be a Hahn series, since you can have a transseries as an exponent in another transseries</p>",
        "id": 498984015,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1739272361
    },
    {
        "content": "<p>You can however reuse <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=HahnSeries#doc\">docs#HahnSeries</a> by following this construction: <a href=\"https://en.wikipedia.org/wiki/Transseries#Log-free_transseries\">https://en.wikipedia.org/wiki/Transseries#Log-free_transseries</a></p>",
        "id": 498984777,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1739272617
    },
    {
        "content": "<p>The construction from surreal numbers might be the easiest one given the work we have on <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Surreal#doc\">docs#Surreal</a>: <a href=\"https://en.wikipedia.org/wiki/Transseries#Using_surreal_numbers\">https://en.wikipedia.org/wiki/Transseries#Using_surreal_numbers</a></p>",
        "id": 498985007,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1739272698
    },
    {
        "content": "<p>Thank you all. I already saw the Surreal numbers definition and I also think it is the one with the most similar construction. I'll let you know if me and my colleague make some progress on this!</p>",
        "id": 499052288,
        "sender_full_name": "Antonio De Lucreziis",
        "timestamp": 1739292221
    },
    {
        "content": "<p>I've been thinking about this, precisely because of my work on surreal numbers. I do wonder if it's perhaps easier to define transseries as an iterated Hahn series construction, however. The fact that some subfield of the nimbers happens to be canonically isomorphic seems to me like more of a theorem than a definition.</p>",
        "id": 564531505,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766082212
    },
    {
        "content": "<p>Moreover, it should be possible to characterize equality of transseries in a way that isn't dependent on the equality of surreal numbers.</p>",
        "id": 564532422,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766082525
    },
    {
        "content": "<p>(Is there perhaps some notion of transseries built from fields other than ℝ? That would be another argument for not using <code>Surreal</code> in the definition)</p>",
        "id": 564532507,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766082552
    },
    {
        "content": "<p>I think the general notion is that of a 'field of exponential-logarithmic series' over a given field. (<a href=\"https://arxiv.org/pdf/1509.02588#appendix.A\">See Appendix A of Aschenbrenner, van den Dries, and van der Hoeven.</a>) It seems like the word 'transseries' is conventionally reserved specifically for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">T</mi><mo>=</mo><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msup><mi>x</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mrow><mi mathvariant=\"normal\">L</mi><mi mathvariant=\"normal\">E</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbb{T} = \\mathbb{R}((x^{-1}))^{\\mathrm{LE}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">T</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">((</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">LE</span></span></span></span></span></span></span></span></span></span></span></span></span>. (Although Aschenbrenner, van den Dries, and van der Hoeven mention that the terminology has been used differently in the literature.)</p>",
        "id": 564554051,
        "sender_full_name": "James E Hanson",
        "timestamp": 1766089808
    },
    {
        "content": "<p>Thanks for the reference! I was having trouble finding a transparent explanation for what transseries were.</p>",
        "id": 564582977,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766099146
    },
    {
        "content": "<p>This all seems well within the grasp of Mathlib. A good starting project would be to define <code>ExpTransSeries R Γ</code> as the directed union starting with <code>R⟦Γ⟧</code>, according to the construction on pp. 611-612.</p>",
        "id": 564584140,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766099659
    },
    {
        "content": "<p>I might try this in a few days if no one else does</p>",
        "id": 564664220,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1766140498
    },
    {
        "content": "<p>I'm starting work on this and I already ran into an issue. The linked paper gives a construction to extend a pre-exponential ordered field, and it describes taking a multiplicative copy exp(A) of an ordered additive group A, so to then define the field of Hahn series E⟦exp(A)⟧. The thing is, isn't the value group in a Hahn series supposed to be additive? <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/HahnSeries/Summable.html#HahnSeries.instField\"><code>HahnSeries.instField</code></a> makes no mention of a multiplicative stucture on Γ.<br>\n<a href=\"/user_uploads/3121/C2oW2yNzv-HjVVRTTvYhoXFX/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/C2oW2yNzv-HjVVRTTvYhoXFX/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1029x258\" src=\"/user_uploads/thumbnail/3121/C2oW2yNzv-HjVVRTTvYhoXFX/image.png/840x560.webp\"></a></div>",
        "id": 566246414,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767556793
    },
    {
        "content": "<p>I think I have seen literature where HahnSeries' Γ is treated as a multiplicative group. Not sure if it is just a difference in convention here.</p>",
        "id": 566246675,
        "sender_full_name": "Weiyi Wang",
        "timestamp": 1767556991
    },
    {
        "content": "<p>Oh yeah, I think what they mean is that exp(A) is the multiplicative group of <strong>monomials</strong>.</p>",
        "id": 566246841,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767557173
    },
    {
        "content": "<p>So the exponents themselves are still additive. Ah, mathematicians with their notation.</p>",
        "id": 566246854,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767557188
    },
    {
        "content": "<p>Ok, I think I get it. Might as well give an example.</p>",
        "id": 566247795,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767558268
    },
    {
        "content": "<p>Let's start with the field E₀ = ℝ⟦ℤ⟧ of Laurent series. We can \"formally\" take exponentials on elements of positive valuation (degree, order, whatever), and we can extend this to zero valuation by taking exp(r) equal to the standard real exponential. In order to take exponentials of elements with negative valuation, we create a new field E₁ = ℝ⟦ℤ⟧⟦ℝ⟦ℤ⟧^≺1⟧ ≃ ℝ⟦ℝ⟦ℤ⟧^≺1 ×ₗ ℤ⟧, so that exp(x) is identified with its monomial x for x ≺ 1. In this new field we can take exponentials of elements with non-negative valuation, and to address the remainder we create a new field E₂ = E₁⟦E₁^≺1⟧. And so on.</p>\n<p>All of these fields Eₙ can be identified with Hahn series over ℝ. Their directed union (taken in the obvious way) will be the field of exponential transseries.</p>",
        "id": 566248436,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767558814
    },
    {
        "content": "<p>I think a good first step might be to define a function <code>HahnSeries.exp : ℝ⟦Γ⟧ → ℝ⟦Γ⟧</code>. It'd be well-behaved on elements of non-negative valuation, and we could show that in this domain it is an additive character, strictly monotonic, and invertible. Then we could use this to \"seed\" the construction of transseries.</p>",
        "id": 566249012,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767559413
    },
    {
        "content": "<p>Ok, so I've started writing code, and it turns out there's a lot of auxiliary definitions in the way of even having a definition of transseries. So here's my current design, at the moment only going as far to define exponential transseries.</p>\n<p>Let <code>Γ</code> be a linearly ordered commutative (additive) group. We use mutual induction to define linearly ordered fields <code>stepField Γ n</code> and linearly ordered commutative groups <code>stepGroup Γ n</code> so that:</p>\n<ul>\n<li><code>stepField Γ 0 = ULift ℝ</code>, <code>stepGroup Γ 0 = Γ</code> (the <code>ULift</code> is there for universe reasons)</li>\n<li><code>stepField Γ (n + 1) = Lex (stepField Γ n)⟦stepGroup Γ n⟧</code>, <code>stepGroup Γ (n + 1) = Lex (stepField Γ n)⟦{x : stepGroup Γ n // x &lt; 0}⟧</code>.</li>\n</ul>\n<p>We also define the linearly ordered groups <code>stepMonomial Γ n</code> inductively, so that (there's gotta be a better way to do this):</p>\n<ul>\n<li><code>stepMonomial Γ 0 = Γ</code></li>\n<li><code>stepMonomial Γ (n + 1) = stepGroup Γ (n + 1) ×ₗ stepMonomial Γ n</code></li>\n</ul>\n<p>Then, <code>step Γ n = Lex (stepField Γ n)⟦stepGroup Γ n⟧</code> is the linearly ordered field of exponential transseries with exponential depth at most <code>n</code>, and we can prove it isomorphic to <code>Lex ℝ⟦stepMonomial Γ n⟧</code>.</p>\n<p>Let <code>monomial Γ</code> be the direct limit of (the obvious system with) <code>stepMonomial Γ n</code> (again, there's probably a better way to do this). This direct system induces a direct system on <code>Lex ℝ⟦stepMonomial Γ⟧</code>, and its limit is <code>ExpTransSeries Γ</code>, which will embed (strictly) into <code>Lex ℝ⟦monomial Γ⟧</code>.</p>",
        "id": 566284863,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767596107
    },
    {
        "content": "<p>Some questions:<br>\na) Is this the correct definition?<br>\nb) Is there any better naming for all the definitions I've been prefixing with step?<br>\nc) Can the stuff with <code>stepMonomial</code> be simplified? (I don't think we currently have any sort of order instance on <code>DirectSum</code>, which is basically what I want).<br>\nd) Should these auxiliary definitions even be public API? Or should we just laser focus on defining transseries in their greatest generality?</p>",
        "id": 566285056,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767596283
    },
    {
        "content": "<p>Also, sorry to be blunt, but is there anyone else interested/knowledgeable in this topic? Basically I'd like to know if I should use this topic to discuss my ideas or whether I should keep to my own until I have a PR ready. (Or is this too niche for Mathlib, even?)</p>",
        "id": 566304659,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1767604283
    }
]