[
    {
        "content": "<p>This is a pretty roundabout way to construct this quite intuitive OrderIso:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Birkhoff</span><span class=\"w\"> </span><span class=\"c1\">-- 460 imports</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">UpperSet</span><span class=\"bp\">.</span><span class=\"n\">orderIsoWithTopOfFinite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">UpperSet</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">WithTop</span><span class=\"bp\">.</span><span class=\"n\">subtypeOrderIso</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">withTopCongr</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">setCongr</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"bp\">âŠ¤</span><span class=\"o\">}</span><span class=\"bp\">á¶œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">setOf</span><span class=\"w\"> </span><span class=\"n\">InfIrred</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">infIrredUpperSet</span>\n</code></pre></div>\n<p>The following is more straightforward and imports less (though not a subset of the implementation above):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">Max</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">UpperLower</span><span class=\"bp\">.</span><span class=\"n\">Principal</span>\n<span class=\"bp\">#</span><span class=\"n\">trans_imports</span><span class=\"w\"> </span><span class=\"s2\">\"Mathlib.\"</span><span class=\"w\"> </span><span class=\"c1\">-- 394 imports</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">UpperSet</span><span class=\"bp\">.</span><span class=\"n\">equivWithTopOfFinite</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Î±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearOrder</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">UpperSet</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"bp\">â‰ƒ</span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">toFinite</span><span class=\"bp\">.</span><span class=\"n\">toFinset</span><span class=\"bp\">.</span><span class=\"n\">min</span>\n<span class=\"w\">  </span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">recTopCoe</span><span class=\"w\"> </span><span class=\"bp\">âŠ¤</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">Ici</span>\n<span class=\"w\">  </span><span class=\"n\">left_inv</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">right_inv</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">recTopCoe</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">â†¦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">min_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">antisymm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">map_rel_iff'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>If there is no better suggestion I'd stick with the first implementation.</p>",
        "id": 554416406,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1762549921
    },
    {
        "content": "<p>I don't like <code>UpperSet</code>. Why are you using <code>UpperSet</code>?</p>",
        "id": 554416765,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762550111
    },
    {
        "content": "<p>Do you like LowerSet better? See <a class=\"message-link\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2325140.20Hahn.20embedding.20theorem/near/548187885\">#PR reviews &gt; #25140 Hahn embedding theorem @ ðŸ’¬</a>  for the motivation.</p>",
        "id": 554416861,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1762550167
    },
    {
        "content": "<p>well <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=upperSetIsoLowerSet#doc\">docs#upperSetIsoLowerSet</a>, which is exactly why I don't like them (which one do you pick? there's no canonical choice)</p>",
        "id": 554416989,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762550257
    },
    {
        "content": "<p>would be better if they were paired</p>",
        "id": 554417032,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762550282
    },
    {
        "content": "<p>This is interesting, UpperSet Î± and LowerSet Î± are canonically isomorphic, but the embedding of Î± into them are not the same ...</p>",
        "id": 554419010,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1762551260
    },
    {
        "content": "<p>maybe we can find out which one to use by thinking about what happens in a nonlinear order</p>",
        "id": 554420978,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1762552258
    }
]