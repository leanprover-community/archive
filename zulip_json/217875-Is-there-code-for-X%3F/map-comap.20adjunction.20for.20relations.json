[
    {
        "content": "<p>I am looking for the way to comap a relation by two functions, that gives a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=GaloisConnection#doc\">docs#GaloisConnection</a> between <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Relation.Map#doc\">docs#Relation.Map</a> and the relation comap, for each pair of functions. It should be defeq to <code>fun x y =&gt; r (f x) (g y)</code> for comapping the relation <code>r</code> by the two functions <code>f</code> and <code>g</code>.</p>",
        "id": 558657472,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763731203
    },
    {
        "content": "<p>We have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Setoid.comap#doc\">docs#Setoid.comap</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Function.onFun#doc\">docs#Function.onFun</a>, but no Galois connection in sight :(</p>",
        "id": 558659784,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1763731839
    },
    {
        "content": "<p>I have these proofs</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"c1\">-- import Mathlib.Order.GaloisConnection.Defs</span>\n<span class=\"c1\">-- I don't think it should go in GaloisConnection/Defs</span>\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">gc_map_comap</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">γ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">δ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">GaloisConnection</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">Map</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">not_iff_not</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">le_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">map_apply</span><span class=\"o\">]</span>\n\n<span class=\"c1\">-- import Mathlib.Data.Setoid.Basic</span>\n<span class=\"c1\">-- probably fine to go in Setoid/Basic</span>\n<span class=\"bp\">#</span><span class=\"n\">min_imports</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">gc_map_comap</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">GaloisConnection</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">gi</span><span class=\"bp\">.</span><span class=\"n\">gc</span><span class=\"bp\">.</span><span class=\"n\">le_iff_le</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">gc_map_comap</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">le_iff_le</span>\n</code></pre></div>\n<p>Are these theorems good to go into mathlib as-is? Which file should they go in?</p>",
        "id": 558780831,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763782302
    },
    {
        "content": "<p>Is there a <code>Mathlib.Order.GaloisConnection.Basic</code>?</p>",
        "id": 558821233,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763824183
    },
    {
        "content": "<p><a href=\"https://tqft.net/mathlib4files/Order/GaloisConnection/Basic\">file#Order/GaloisConnection/Basic</a></p>",
        "id": 558821987,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763825026
    },
    {
        "content": "<p>looks like it exists</p>",
        "id": 558822024,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763825061
    },
    {
        "content": "<p>I think the rule is: if it could go in defs, put it in basic.</p>",
        "id": 558824154,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1763826891
    },
    {
        "content": "<p>I don't think it should go in there either</p>",
        "id": 558824238,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763826960
    },
    {
        "content": "<p>there's nothing about <code>Relation.foo</code> in GaloisConnection/Basic</p>",
        "id": 558824267,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1763826983
    }
]