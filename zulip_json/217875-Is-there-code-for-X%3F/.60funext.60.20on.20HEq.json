[
    {
        "content": "<p>Trying to solve a very nasty HEq over two dependent functions, is there code for funext on this?</p>",
        "id": 532771439,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329407
    },
    {
        "content": "<p>Something like this would be v nice:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">hfunext</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>",
        "id": 532771714,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329527
    },
    {
        "content": "<p>How did you get to the HEq in the first place?</p>",
        "id": 532771943,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1754329631
    },
    {
        "content": "<p>Im proving some higher-universe stuff on PFunctor.Multivariate</p>",
        "id": 532772038,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329679
    },
    {
        "content": "<p>Things sort of started to break, i added a cast and i cant seem to escape this in any way</p>",
        "id": 532772096,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329703
    },
    {
        "content": "<p>the context of the problem at hand:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MvPFunctor</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TypeVec</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span>\n<span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">↑</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span>\n<span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span>\n<span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">uLift_down</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">Arrow</span><span class=\"bp\">.</span><span class=\"n\">uLift_up</span><span class=\"w\"> </span><span class=\"bp\">⊚</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Arrow</span><span class=\"bp\">.</span><span class=\"n\">uLift_down</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">ULift</span><span class=\"bp\">.</span><span class=\"n\">down</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">&lt;$$&gt;</span><span class=\"w\"> </span><span class=\"n\">gen_fn</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">TypeVec</span><span class=\"bp\">.</span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;$$&gt;</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 532772346,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329805
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Function.hfunext#doc\">docs#Function.hfunext</a></p>",
        "id": 532772621,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754329916
    },
    {
        "content": "<p>it exists</p>",
        "id": 532772649,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754329927
    },
    {
        "content": "<p>Lovely thanks so much</p>",
        "id": 532772700,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329941
    },
    {
        "content": "<p>have a great timezone</p>",
        "id": 532772741,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329957
    },
    {
        "content": "<p>but you also need <code>α₁ = α₂</code></p>",
        "id": 532772743,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754329959
    },
    {
        "content": "<p>this should be fine</p>",
        "id": 532772784,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754329974
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"736115\">William Sørensen</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/.60funext.60.20on.20HEq/near/532772741\">said</a>:</p>\n<blockquote>\n<p>have a great timezone</p>\n</blockquote>\n<p>you have a great timezone too</p>",
        "id": 532772797,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754329979
    },
    {
        "content": "<p>It's even false without that assumption:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">hfunext</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">g</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">False</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">hfunext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">true</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x₁</span><span class=\"w\"> </span><span class=\"n\">x₂</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">              </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">type_eq_of_heq</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">              </span><span class=\"n\">exfalso</span>\n<span class=\"w\">              </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">congr</span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">this</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">type_eq_of_heq</span><span class=\"w\"> </span><span class=\"n\">this</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">congr</span><span class=\"o\">(</span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"bp\">$</span><span class=\"n\">this</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">this</span>\n</code></pre></div>",
        "id": 532773240,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754330114
    },
    {
        "content": "<p>damn that was fast and yeah i was wondering if it was</p>",
        "id": 532773326,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754330160
    },
    {
        "content": "<p>didnt feel quite right</p>",
        "id": 532773336,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754330163
    },
    {
        "content": "<p>oh I thought that was pretty obvious</p>",
        "id": 532775686,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754331309
    },
    {
        "content": "<p>if <code>α₁ ≠ α₂</code> then <code>x₁ ≍ x₂</code> is always false so the hypothesis <code>h</code> is vacuously true so you can conclude <code>f ≍ g</code> from <code>α₁ ≠ α₂</code></p>",
        "id": 532775870,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754331395
    },
    {
        "content": "<p>which is very strong</p>",
        "id": 532775903,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754331411
    },
    {
        "content": "<p>Yeah, that's the motivation for the proof I gave, and the cardinality argument is playing the role of the type disequality</p>",
        "id": 532776250,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754331582
    },
    {
        "content": "<p>Damn yeah fair enough. I think heq stuff just fries my brain anyway</p>",
        "id": 532776447,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754331667
    },
    {
        "content": "<p>Like I reach for things like congr and funext and kind of just get lost</p>",
        "id": 532776511,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754331702
    },
    {
        "content": "<p>It's nice to use tactics when possible for these. For example, <code>congr!</code>/<code>convert</code>/<code>convert_to</code> try to piece together congruence arguments for you. The <code>congr!</code> tactic also knows about <code>hfunext</code></p>\n<p>You can use <code>convert_to</code> to do one transformation step at a time, getting the proof obligations you need to do the rewrite. Don't forget you can do <code>convert_to e using n</code> for various <code>n</code> to adjust how aggressively it visits the expression, and if it's too low for some of the obligations, you can use <code>congr!</code> for them to keep going.</p>",
        "id": 532777041,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754331966
    },
    {
        "content": "<p>Thanks so much I’ll look into these!</p>",
        "id": 532777140,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754332006
    },
    {
        "content": "<p>Yeah I have these congruences everywhere that became a pain to work with my usual patterns of just applys and so on</p>",
        "id": 532777256,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754332055
    },
    {
        "content": "<p>It's not perfect, but it frequently can tear apart expressions into the differing subexpressions. Please report examples where they can't make progress!</p>\n<p>In the code block above, you might have noticed <code>congr(...)</code> as well. It's a way to generate iffs/eqs/heqs from iffs/eqs/heqs embedded into an expression using <code>$</code> prefixes, where the rest of the expression is used as a pattern for the LHS and RHS. You can use it instead of needing to build things up with congr/congrArg/congrFun, and it handles cases that these three can't handle. You can replace the proof term <code>congr hf hx</code> with <code>congr($hf $hx)</code>, etc.</p>",
        "id": 532777536,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754332174
    },
    {
        "content": "<p>Im trying to solve something of this form:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">⋯</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">uLift_up</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)))</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fz</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">down</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">⋯</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">uLift_up</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fz</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">down</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>should congr! catch this? Im having trouble doing it through other means</p>",
        "id": 532954944,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754413007
    },
    {
        "content": "<p>Would you mind trying to make a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> so I can try to see what's stuck?</p>",
        "id": 532955489,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754413248
    },
    {
        "content": "<p>Ok I will try my best... TypeVecs are such a pain to work with</p>",
        "id": 532955551,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754413275
    },
    {
        "content": "<p>Maybe I'll mention that <code>congr!</code> also has some options, take a look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Congr%21#doc\">docs#Congr!</a>.Config</p>",
        "id": 532955621,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754413306
    },
    {
        "content": "<p>If you do <code>congr! +typeEqs</code>, then it will turn off a heuristic that prevents it from considering equating types that aren't plausibly equal. Maybe that's stopping you in this case?</p>",
        "id": 532955715,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754413353
    },
    {
        "content": "<p>Maybe if you do <code>generalize_proofs</code> to get the proofs out of the <code>cast</code>s, you'll find some useful facts that will help remove some dependencies? Sometimes there's an equality with a variable that you can <code>subst</code>, which then causes the <code>cast</code>s to become able to be eliminated</p>",
        "id": 532956000,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754413485
    },
    {
        "content": "<p>oki ill try all of these and try to make a mwe as well. Thanks for all this already, ive been stuck on these for a few days now</p>",
        "id": 532956235,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754413579
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"736115\">William Sørensen</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/.60funext.60.20on.20HEq/near/532954944\">said</a>:</p>\n<blockquote>\n<p>Im trying to solve something of this form:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">⊢</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">⋯</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">uLift_up</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)))</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fz</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">down</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">cast</span><span class=\"w\"> </span><span class=\"bp\">⋯</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">P</span><span class=\"bp\">.</span><span class=\"n\">uLift_up</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"n\">Fin2</span><span class=\"bp\">.</span><span class=\"n\">fz</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">down</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>should congr! catch this? Im having trouble doing it through other means</p>\n</blockquote>\n<p>You can try the <code>rewrite!</code> tactic that made it into mathlib recently</p>",
        "id": 532956368,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754413625
    },
    {
        "content": "<p>rewrite the casts away</p>",
        "id": 532956462,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754413660
    },
    {
        "content": "<p>(<a href=\"https://tqft.net/mathlib4files/Tactic/DepRewrite\">file#Tactic/DepRewrite</a>)</p>",
        "id": 532956510,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754413686
    },
    {
        "content": "<p>oh this sounds very exciting! Ive needed something like this for so long omg</p>",
        "id": 532956879,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754413846
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 532956903,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754413858
    },
    {
        "content": "<p>Hi is this HEq lemma upstream? Found myself needing it a lot</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dcongr_heq</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hargs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">hat</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">eq_of_heq</span><span class=\"w\"> </span><span class=\"n\">hargs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eq_of_heq</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rfl</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 533351511,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754594821
    },
    {
        "content": "<p>I don't believe so.</p>\n<p>It seems like something <code>congr!</code> could try, in some form. That tactic currently only knows how to make progress if the functions involved have definitionally equal types.</p>",
        "id": 533355008,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754596531
    },
    {
        "content": "<p>Yeah congr! Failed a lot with dependent stuff. Making MWEs for these is really scary though. Should I try to push this up either to Init or mathlib? Where do you think it should go?</p>",
        "id": 533355395,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754596727
    },
    {
        "content": "<p>Can this lemma be added to congr! ? Is that how it works? Or is it like congr whwre the proofs are not really human readable</p>",
        "id": 533356534,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754597204
    },
    {
        "content": "<p>It's unclear where it should go. (Usually if you need something like this you've made a wrong turn somewhere <span aria-label=\"wink\" class=\"emoji emoji-1f609\" role=\"img\" title=\"wink\">:wink:</span> Sometimes powering through HEqs is alright, but it's really worth considering if you're missing some theory that would make things easier to express.)</p>\n<p>I'm working on some congruence things right now for core and I'll think about it.</p>",
        "id": 533356902,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754597325
    },
    {
        "content": "<p>Adding the lemma to <code>congr!</code> means to modify the metaprogram to detect when it should be applied and how it should be applied. It's just like <code>congr</code>, but improved in a number of ways.</p>",
        "id": 533357055,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754597386
    },
    {
        "content": "<p>Ok veey fairs. I might PR this into mathlib then for now because I need it for my PR on PFunctor.corec anyway</p>",
        "id": 533357270,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754597495
    },
    {
        "content": "<p>A UI issue is that you don't want to use this <code>dcongr_heq</code> if it would lead to a lot of implausible type equalities. The <code>congr!</code> tactic avoids implausble type equalities (and it has a <code>+typeEqs</code> option to turn off the heuristic)</p>",
        "id": 533357369,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754597546
    },
    {
        "content": "<p>Yeah I had a few moments during my proof when congr! did some crazy stuff but congr was fine for reasons like this I think. I should try to extract some stuff out of this but typevecs are just truly pain to work with</p>",
        "id": 533357626,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754597690
    },
    {
        "content": "<p>Why is the <code>hf</code> argument given the beta equality? That's not necessary since it follows from <code>ht</code>. Maybe you're doing this because it's convenient to have that fact when proving the functions are equal?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dcongr_heq</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hargs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">subst_vars</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">hf</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 533357628,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754597690
    },
    {
        "content": "<p>I guess this is supposed to be a more convenient variant of  this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hβ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">ha</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">hβ</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">hf</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 533357738,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1754597760
    },
    {
        "content": "<p>Yup it was just convenient. The signature of the equality was something like 6 lines due to typevec hell so I just avoided it</p>",
        "id": 533357757,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754597766
    },
    {
        "content": "<p>And yeah it would be more convenient  <span class=\"user-mention\" data-user-id=\"873547\">@Robin Arnez</span>, I’ll change this in the impl</p>",
        "id": 533357970,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754597887
    },
    {
        "content": "<p>I guess I'm wondering why is it only passing the beta equality if it's for convenience, since it could pass all the relevant equalities. The <code>hat</code> argument is also an immediate consequence of <code>hargs</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dcongr_heq</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Sort</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hargs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"bp\">≍</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">hargs</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 533358401,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754598131
    },
    {
        "content": "<p>Oh nice. Yeah I agree</p>",
        "id": 533361746,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754599759
    },
    {
        "content": "<p>Ok great. I’ll make a PR in the morning and put you as coauthor for all of the help you’ve provided me.</p>",
        "id": 533361959,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754599822
    },
    {
        "content": "<p>Looking at this I cant see any real place to put this in <code>mathlib</code>, should i PR Core with it then? does this require extra steps?</p>",
        "id": 533408238,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754636634
    },
    {
        "content": "<p>It does feel apt if this were to go next to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Function.hfunext#doc\">docs#Function.hfunext</a></p>",
        "id": 533429667,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1754645229
    },
    {
        "content": "<p>So I think it can go in mathlib</p>",
        "id": 533429776,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1754645270
    },
    {
        "content": "<p>So put it under Function?</p>",
        "id": 533430398,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754645488
    },
    {
        "content": "<p>Yeah I’ll do this later maybe depending on how much time I have</p>",
        "id": 533430481,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754645523
    },
    {
        "content": "<p>Next to <code>congr_heq</code> and <code>congr_arg_heq</code> in Mathlib.Logic.Basic could be reasonable</p>",
        "id": 533470119,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1754661654
    },
    {
        "content": "<p>I just opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/27937\">#27937</a> that inserts a new lemma in between these two.</p>",
        "id": 533470483,
        "sender_full_name": "Martin Dvořák",
        "timestamp": 1754661771
    },
    {
        "content": "<p>I feel it would still be useful to have the single argument version as well</p>",
        "id": 533472375,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754662416
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> made a small <a href=\"https://github.com/leanprover-community/mathlib4/pull/28149\">pr</a> do you think there’s anything you want to add before I post in the review channel ?</p>",
        "id": 533601791,
        "sender_full_name": "William Sørensen",
        "timestamp": 1754773775
    }
]