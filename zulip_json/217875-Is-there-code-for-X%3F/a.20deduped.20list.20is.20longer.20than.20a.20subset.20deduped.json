[
    {
        "content": "<p>i was trying to prove this, but i couldnt figure out how to do it</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Dedup</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dedup_length</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">Subset</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\">  </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 493141745,
        "sender_full_name": "Jared green",
        "timestamp": 1736643836
    },
    {
        "content": "<p>Please try to make <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>'s work: you are missing a typeclass. You can click the button in the top right of the code block to open your code in the sandbox to verify that it is what you intended.</p>",
        "id": 493141987,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644030
    },
    {
        "content": "<p>try again</p>",
        "id": 493142006,
        "sender_full_name": "Jared green",
        "timestamp": 1736644061
    },
    {
        "content": "<p>Do you know how <code>Subset</code> is defined? Perhaps try inducting on <code>l1</code> and unfolding the definition of Subset.</p>",
        "id": 493142068,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644100
    },
    {
        "content": "<p>i tried that</p>",
        "id": 493142077,
        "sender_full_name": "Jared green",
        "timestamp": 1736644116
    },
    {
        "content": "<p>Can you show what you got to, then?</p>",
        "id": 493142090,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644136
    },
    {
        "content": "<p>(It's important to avoid \"low effort\" sorries; if you've already tried something, show that in your question! If you have an idea for how the proof should working <em>informally</em>, explain that in text.)</p>",
        "id": 493142119,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644183
    },
    {
        "content": "<p>but i didnt know what to do next</p>",
        "id": 493142211,
        "sender_full_name": "Jared green",
        "timestamp": 1736644278
    },
    {
        "content": "<p>Yes, that's why I'm asking you to show what you <em>have</em> done, so someone can help you work out what to do <em>next</em>.</p>",
        "id": 493142281,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644340
    },
    {
        "content": "<p>To be blunt, asking \"low effort\" sorries is just asking for someone to do your work for you, rather than asking to learn.</p>",
        "id": 493142328,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736644411
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Dedup</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dedup_length</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">Subset</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\">  </span><span class=\"bp\">≤</span><span class=\"w\">  </span><span class=\"n\">l2</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Subset</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">hh</span><span class=\"w\"> </span><span class=\"n\">hhh</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">hhhh</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">dedup</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">pwFilter</span>\n<span class=\"w\">    </span><span class=\"c1\">--here</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 493142632,
        "sender_full_name": "Jared green",
        "timestamp": 1736644784
    },
    {
        "content": "<p>Hm, yeah, <code>List.dedup</code> as defined in Mathlib has pretty terrible properties, because it keeps the last occurrence of each element, making it very hard to do inductive arguments about it.</p>",
        "id": 493143297,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645475
    },
    {
        "content": "<p><code>List.eraseDups</code> in Lean keeps the first occurrence, so you should be able to prove a useful theorem <code>eraseDups_cons</code> which isn't really possible for <code>dedup_cons</code>.</p>",
        "id": 493143321,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645510
    },
    {
        "content": "<p>I guess you can do cases splits and then use <code>dedup_cons_of_mem</code> and <code>`dedup_cons_of_not_mem</code>.</p>",
        "id": 493143395,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645578
    },
    {
        "content": "<p>Maybe this is out of scope for what you're trying to do, but changing the definition of <code>List.dedup</code> might be sane. :-)</p>",
        "id": 493143494,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645684
    },
    {
        "content": "<p>case split on what?</p>",
        "id": 493143776,
        "sender_full_name": "Jared green",
        "timestamp": 1736645976
    },
    {
        "content": "<p>btw, things will be much happier if you write <code>l1 ⊆ l2</code> rather than <code>l1.Subset l2</code>, because simp lemmas will actually fire. Why did you start using <code>.Subset</code> to begin with?</p>",
        "id": 493143777,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645979
    },
    {
        "content": "<p>case splits on <code>hd ∈ tl</code>.</p>",
        "id": 493143785,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736645990
    },
    {
        "content": "<p>e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Dedup</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">List</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dedup_length</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">w₁</span><span class=\"w\"> </span><span class=\"n\">w₂</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">tl</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp_all</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp_all</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>gets you to the right goal. It's still tricky from there!</p>",
        "id": 493144001,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736646200
    },
    {
        "content": "<p>Maybe there's a short-cut, but the brute force way is to deduce from <code>w₁</code> that <code>l2 = xs ++ hd :: ys</code> (there's a lemma saying that), and then deduce from <code>w₂</code> and <code>h</code> that <code>tl ⊆ xs ++ ys</code>, and then use lemmas about dedup/append.</p>",
        "id": 493144095,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736646291
    },
    {
        "content": "<p>of course i had a similar problem, i had to also induct on the second list, but in doing so the proof seemed to repeat itself</p>",
        "id": 493145536,
        "sender_full_name": "Jared green",
        "timestamp": 1736647723
    },
    {
        "content": "<p>how about this?(still not done)</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">Dedup</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">]</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dedup_length</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">l2</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\">  </span><span class=\"bp\">≤</span><span class=\"w\">  </span><span class=\"n\">l2</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"n\">l1</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">l3</span><span class=\"w\"> </span><span class=\"n\">hh</span><span class=\"w\"> </span><span class=\"n\">hhh</span>\n<span class=\"w\">  </span><span class=\"n\">cases'</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">em</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hd</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">hl</span><span class=\"w\"> </span><span class=\"n\">hr</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">dedup_cons_of_mem</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">ih</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hhh</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hl</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">dedup_cons_of_not_mem</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">htl2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tl</span><span class=\"w\"> </span><span class=\"bp\">⊆</span><span class=\"w\"> </span><span class=\"n\">l3</span><span class=\"bp\">.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">mem_filter</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hhh</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">by_contra</span><span class=\"w\"> </span><span class=\"n\">hhd</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hr</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hhd</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hx</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h3</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l3</span><span class=\"bp\">.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"n\">htl2</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">h4</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">l3</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l3</span><span class=\"bp\">.</span><span class=\"n\">filter</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">hd</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">dedup</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h4</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ne_eq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">add_le_add_iff_right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ge_iff_le</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h3</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">hr</span>\n</code></pre></div>",
        "id": 493147053,
        "sender_full_name": "Jared green",
        "timestamp": 1736649319
    },
    {
        "content": "<p>You should write structured proofs! Whenever there are multiple goals, using focusing dots, etc. It's pretty unreadable otherwise. :-)</p>",
        "id": 493147829,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736650157
    },
    {
        "content": "<p>Also, I'm still curious, where did the <code>.Subset</code> come from in your original formulation?</p>",
        "id": 493147841,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736650174
    },
    {
        "content": "<p>i hadnt bothered typing in the subset symbol before</p>",
        "id": 493147922,
        "sender_full_name": "Jared green",
        "timestamp": 1736650230
    },
    {
        "content": "<p>here it is:</p>\n<div class=\"codehilite\" data-code-language=\"import\"><pre><span></span><code>variable (a : Type) [h : DecidableEq a]\n\ntheorem nin_filter (b : a) (l : List a): b ∉ l -&gt; l = l.filter (fun x =&gt; b ≠ x) :=\n\n  by\n\n  intro hb\n\n  induction' l with hd tl ih\n\n  simp\n\n  rw [List.filter_cons]\n\n  rw [if_pos]\n\n  simp at hb\n\n  have i2 := ih hb.2\n\n  rw [i2]\n\n  simp\n\n  simp\n\n  simp at hb\n\n  exact hb.1\n\ntheorem dedup_filter_length : ∀ l : List a,∀ b ∈ l, l.dedup.length = (l.filter (fun x =&gt; b ≠ x) ).dedup.length + 1 :=\n\n  by\n\n  intro l b hb\n\n  induction' l with hd tl ih\n\n  simp\n\n  contradiction\n\n  cases' Classical.em (hd ∈ tl) with hl hr\n\n  rw [List.dedup_cons_of_mem]\n\n  cases' Classical.em (b = hd) with hlb hbr\n\n  rw [← hlb]\n\n  simp\n\n  simp only [decide_not] at ih\n\n  apply ih\n\n  rw [hlb]\n\n  exact hl\n\n  cases hb\n\n  contradiction\n\n  rw [List.filter_cons]\n\n  simp\n\n  rw [if_neg]\n\n  rw [List.dedup_cons_of_mem']\n\n  simp only [decide_not] at ih\n\n  apply ih\n\n  assumption\n\n  rw [List.mem_dedup]\n\n  rw [List.mem_filter]\n\n  constructor\n\n  exact hl\n\n  simp\n\n  exact hbr\n\n  exact hbr\n\n  exact hl\n\n  rw [List.dedup_cons_of_not_mem hr]\n\n  cases' Classical.em (b = hd) with hbl hbr\n\n  simp\n\n  rw [List.filter_cons]\n\n  rw [if_neg]\n\n  rw [← hbl] at hr\n\n  clear ih\n\n  have ht : tl = tl.filter (fun x =&gt; b ≠ x) := by {\n\n    apply nin_filter\n\n    exact hr\n\n  }\n\n  simp at ht\n\n  nth_rewrite 1 [ht]\n\n  rfl\n\n  simp\n\n  exact hbl\n\n  cases' hb\n\n  contradiction\n\n  rw [List.filter_cons]\n\n  rw [if_pos]\n\n  rw [List.dedup_cons_of_not_mem]\n\n  simp\n\n  simp only [decide_not] at ih\n\n  apply ih\n\n  assumption\n\n  rw [List.mem_filter]\n\n  simp\n\n  contrapose\n\n  intro _\n\n  exact hr\n\n  simp\n\n  exact hbr\n\ntheorem dedup_length (l1 : List a) : ∀ l2 : List a, l1 ⊆ l2 -&gt; l1.dedup.length  ≤  l2.dedup.length :=\n\n  by\n\n  induction' l1 with hd tl ih\n\n  simp\n\n  simp\n\n  intro l3 hh hhh\n\n  cases' Classical.em (hd ∈ tl) with hl hr\n\n  rw [List.dedup_cons_of_mem]\n\n  apply ih\n\n  exact hhh\n\n  exact hl\n\n  rw [List.dedup_cons_of_not_mem]\n\n  simp\n\n  have htl2 : tl ⊆ l3.filter (fun x =&gt; hd ≠ x) := by {\n\n    intro x hx\n\n    rw [List.mem_filter]\n\n    constructor\n\n    exact hhh hx\n\n    simp\n\n    by_contra hhd\n\n    apply hr\n\n    rw [ hhd]\n\n    exact hx\n\n  }\n\n  have h3 := ih (l3.filter (fun x =&gt; hd ≠ x)) htl2\n\n  have h4 : l3.dedup.length = (l3.filter (fun x =&gt; hd ≠ x)).dedup.length + 1 := by {\n\n    apply dedup_filter_length\n\n    exact hh\n\n  }\n\n  rw [h4]\n\n  simp only [ne_eq, Nat.add_le_add_iff_right, ge_iff_le]\n\n  exact h3\n\n  exact hr\n</code></pre></div>",
        "id": 493152133,
        "sender_full_name": "Jared green",
        "timestamp": 1736654539
    },
    {
        "content": "<p>Nice, well done! Clean it up a bit (e.g. structured proofs) and PR to Mathlib! :-)</p>",
        "id": 493159601,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736661371
    },
    {
        "content": "<p>surely there must be some other way to control the inductive hypotheses when doing induction multiple times, right?</p>",
        "id": 493190506,
        "sender_full_name": "Jared green",
        "timestamp": 1736689257
    },
    {
        "content": "<p>Maybe the theorem we actually want is that <code>l₁ ⊆ l₂ ↔ l₁.dedup.Subperm l₂.dedup</code>?</p>",
        "id": 493198960,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1736696458
    },
    {
        "content": "<p>A good midway point would be the <code>Iff</code> version of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.Nodup.subperm#doc\">docs#List.Nodup.subperm</a></p>",
        "id": 493199100,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1736696587
    },
    {
        "content": "<p>And similar for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.subset_dedup#doc\">docs#List.subset_dedup</a></p>",
        "id": 493200321,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1736697587
    },
    {
        "content": "<p>i am using this to prove termination of a recursive function that makes some lists longer but is limited by a list that may get shorter</p>",
        "id": 493213636,
        "sender_full_name": "Jared green",
        "timestamp": 1736708808
    },
    {
        "content": "<p>Eric's suggestions seem good to me. They will prove your result out of simpler components.</p>",
        "id": 493225380,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1736718947
    }
]