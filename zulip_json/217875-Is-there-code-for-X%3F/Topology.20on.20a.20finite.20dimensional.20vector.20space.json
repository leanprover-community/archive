[
    {
        "content": "<p>Say I have a real finite dimensional vector space <code>E</code> and Bhavik insistently wants to apply the Krein-Milman lemma (<a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsCompact.extremePoints_nonempty#doc\">docs#IsCompact.extremePoints_nonempty</a>) in it, how do I give <em>any</em> topology on <code>E</code> so that <code>[TopologicalSpace E] [T2Space E] [TopologicalAddGroup E] [ContinuousSMul ℝ E] [LocallyConvexSpace ℝ E]</code> and Bhavik leaves me alone?</p>",
        "id": 469687218,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726150233
    },
    {
        "content": "<p>Are those the only conditions? I think the discrete topology would work, in that case...</p>",
        "id": 469691490,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726151256
    },
    {
        "content": "<p>Aah wait, that isn't <code>ContinuousSMul</code></p>",
        "id": 469691698,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726151303
    },
    {
        "content": "<p>Well, then you'll need the famous theorem that a findim vect space over a complete normed field has a unique vector space topology</p>",
        "id": 469691885,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726151342
    },
    {
        "content": "<p>And I think this has been discussed many times on zulip, but I'm not sure it was every formalized.</p>",
        "id": 469691970,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726151363
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/469691698\">said</a>:</p>\n<blockquote>\n<p>Aah wait, that isn't <code>ContinuousSMul</code></p>\n</blockquote>\n<p>Hmm, is it not?</p>",
        "id": 469692259,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726151418
    },
    {
        "content": "<p>Oh, it's only <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousConstSMul#doc\">docs#ContinuousConstSMul</a>, or something?</p>",
        "id": 469692419,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726151452
    },
    {
        "content": "<p>I will try to see whether Krein-Milman can be weakened to <code>ContinuousConstSMul</code>...</p>",
        "id": 469696117,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726152268
    },
    {
        "content": "<p>Here is my best attempt so far:</p>\n<ol>\n<li>Notice that basically any reasonable topology will do</li>\n<li>Remember from my functional analysis lectures that the weak*-topology is such a reasonable topology</li>\n<li>Find <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WeakBilin#doc\">docs#WeakBilin</a></li>\n<li>Find <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearMap#doc\">docs#LinearMap</a>.applyₗ</li>\n<li>Write the following where needed:</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">applyₗ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))))</span>\n<span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TopologicalAddGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">TopologicalAddGroup</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">applyₗ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))))</span>\n<span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">applyₗ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))))</span>\n<span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LocallyConvexSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LocallyConvexSpace</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">applyₗ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))))</span>\n<span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeakBilin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">applyₗ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))))</span>\n</code></pre></div>\n<ol start=\"6\">\n<li>Be sad that the last line doesn't work <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></li>\n</ol>",
        "id": 469696361,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726152318
    },
    {
        "content": "<p>Are you looking for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousLinearEquiv.ofFinrankEq#doc\">docs#ContinuousLinearEquiv.ofFinrankEq</a> ?</p>",
        "id": 469705903,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1726154439
    },
    {
        "content": "<p>As in:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FiniteDimensional</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalAddGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ContinuousSMul</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">FiniteDimensional</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">finrank</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ContinuousLinearEquiv</span><span class=\"bp\">.</span><span class=\"n\">ofFinrankEq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 469705918,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1726154447
    },
    {
        "content": "<p>Can you take a basis, and then pull back the topology from the corresponding product space (which has the sup norm and everything)?</p>",
        "id": 469709882,
        "sender_full_name": "Sébastien Gouëzel",
        "timestamp": 1726155283
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"240862\">Oliver Nash</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/469705903\">said</a>:</p>\n<blockquote>\n<p>Are you looking for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousLinearEquiv.ofFinrankEq#doc\">docs#ContinuousLinearEquiv.ofFinrankEq</a> ?</p>\n</blockquote>\n<p>No! I don't have a topology on <code>E</code> yet</p>",
        "id": 469716479,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726156722
    },
    {
        "content": "<p>As Sébastien says, I could use the <code>LinearEquiv</code> version of this and transfer the topology along, but I would like (understand: Bhavik would like) there to be no explicit identification needed. The dream would be to have a (semi)automatic procedure (a tactic?) to endow <code>E</code> with the right topology</p>",
        "id": 469717046,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726156848
    },
    {
        "content": "<p>You could use <a href=\"https://github.com/ImperialCollegeLondon/FLT/blob/main/FLT/ForMathlib/ActionTopology.lean\">this</a> (from the FLT project). I haven't PRed it yet because I wanted to check it was OK in my use case, but most of the theorems are there. The idea is that you either do <code>let _ : TopologicalSpace E := actionTopology \\R E</code> and then <code>have _ : IsActionTopology \\R E := \\&lt;rfl\\&gt;</code> and typeclass inference should do everything for you. Alternatively you do <code>[TopologicalSpace E] [IsActionTopology \\R E]</code> because the predicate typeclass uniquely determines the top space.</p>",
        "id": 469726109,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726159219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/469691490\">said</a>:</p>\n<blockquote>\n<p>Are those the only conditions? I think the discrete topology would work, in that case...</p>\n</blockquote>\n<p>Just to confirm: this approach can't work since the proof of KM requires neighborhoods of the origin being absorbent</p>",
        "id": 469726915,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1726159442
    },
    {
        "content": "<p>Yes, this came up in a teaching context, and among other things I was trying to make the point that \"for any finite dimensional real vector space\" is a better way of phrasing a theorem than \"for R^d\". But then having the library only help me if I do pick a basis makes this super awkward, especially since the topology is invariant (admittedly not definitionally) under basis change. If the identification is hidden under something else, like a good API or a tactic, then I'd be happy too.</p>",
        "id": 469736977,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726162322
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/469726109\">said</a>:</p>\n<blockquote>\n<p>You could use <a href=\"https://github.com/ImperialCollegeLondon/FLT/blob/main/FLT/ForMathlib/ActionTopology.lean\">this</a> (from the FLT project). I haven't PRed it yet because I wanted to check it was OK in my use case, but most of the theorems are there. The idea is that you either do <code>let _ : TopologicalSpace E := actionTopology \\R E</code> and then <code>have _ : IsActionTopology \\R E := \\&lt;rfl\\&gt;</code> and typeclass inference should do everything for you. Alternatively you do <code>[TopologicalSpace E] [IsActionTopology \\R E]</code> because the predicate typeclass uniquely determines the top space.</p>\n</blockquote>\n<p>Unfortunately it doesn't look like it has all the typeclasses I need - ContinuousSMul and T2Space are missing</p>",
        "id": 469737628,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726162536
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/469691490\">said</a>:</p>\n<blockquote>\n<p>Are those the only conditions? I think the discrete topology would work, in that case...</p>\n</blockquote>\n<p>This was exactly my thought too, although you were much faster at noticing ContinuousSMul breaks than I was!</p>",
        "id": 469737687,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1726162557
    },
    {
        "content": "<p>ContinuousSMul should be there and T2Space will be easy to add if typeclass inference can find <code>Module.Finite</code>, <code>Module.Free</code> and <code>T2Space R</code>.</p>",
        "id": 469947330,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726228888
    },
    {
        "content": "<p>3 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"441057\" href=\"/#narrow/stream/441057-junk/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space\">#junk &gt; Topology on a finite dimensional vector space</a> by <span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span>.</p>",
        "id": 471020427,
        "sender_full_name": "Notification Bot",
        "timestamp": 1726587639
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/16895\">#16895</a> for the definition of the topology.</p>",
        "id": 471020669,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726587692
    },
    {
        "content": "<p>You'll want a copyright header</p>",
        "id": 471022152,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726587990
    },
    {
        "content": "<p>Can you remind me of the keyboard shortcut?</p>\n<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Topology.20on.20a.20finite.20dimensional.20vector.20space/near/471022152\">said</a>:</p>\n<blockquote>\n<p>You'll want a copyright header</p>\n</blockquote>\n<p>I'm surprised the PR passed CI! I've added one.</p>",
        "id": 471036614,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726591571
    },
    {
        "content": "<p>Uh, that's no good. Will try to look later if I can find out why it didn't fail</p>",
        "id": 471037534,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726591850
    },
    {
        "content": "<p>I suspect this is something that might already have been fixed: the text-based linters have changed recently and there was some later fix that was merged and is maybe not part of the commit of master from which this PR originated.</p>\n<p>CC <span class=\"user-mention\" data-user-id=\"634338\">@Michael Rothgang</span> <span class=\"user-mention\" data-user-id=\"123965\">@Bryan Gin-ge Chen</span></p>",
        "id": 471038669,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1726592196
    },
    {
        "content": "<p>This was based on b755dda4cc224e363581d92a4d0b470d28742d4c from this morning</p>",
        "id": 471046028,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726594307
    },
    {
        "content": "<p>Seems like the linter didn't even run on the new file</p>",
        "id": 471046688,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726594498
    },
    {
        "content": "<p>Oh, that's because it also wasn't added to Mathlib.lean</p>",
        "id": 471047119,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726594632
    },
    {
        "content": "<p>Incidentally, that's <em>also</em> not being caught in CI</p>",
        "id": 471047350,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726594690
    },
    {
        "content": "<p>(<a href=\"https://github.com/leanprover-community/mathlib4/pull/16896\">#16896</a>)</p>",
        "id": 471048055,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1726594913
    }
]