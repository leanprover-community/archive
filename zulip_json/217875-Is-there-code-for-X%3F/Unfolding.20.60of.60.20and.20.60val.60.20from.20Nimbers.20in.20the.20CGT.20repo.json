[
    {
        "content": "<p>I'm not quite sure how to handle the <code>of</code> and <code>val</code> aliases used in nimbers. It seems we have to use dance around them using<code>forall_moves_nim_ofNat</code> and <code>mem_moves_nim_of_lt</code>, but I can't seem to avoid it when proving equality of games.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">CombinatorialGames</span><span class=\"bp\">.</span><span class=\"n\">Game</span><span class=\"bp\">.</span><span class=\"n\">Specific</span><span class=\"bp\">.</span><span class=\"n\">Nim</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nimber</span><span class=\"w\"> </span><span class=\"n\">IGame</span>\n\n<span class=\"c1\">-- prove equivalence, ok</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"n\">nim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∗</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">game_cmp</span>\n\n<span class=\"c1\">-- prove equality</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">nim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∗</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">  </span><span class=\"n\">all_goals</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"n\">rcases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">nim_zero</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">0</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- 0 &lt; of 2</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">nim_one</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"c1\">-- 1 &lt; of 2</span>\n<span class=\"w\">    </span><span class=\"n\">revert</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">forall_moves_nim_ofNat</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">    </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 569272237,
        "sender_full_name": "SaNoy SaKnoi",
        "timestamp": 1769006468
    },
    {
        "content": "<p>Does <code>game_cmp</code> not help you here too</p>",
        "id": 569309717,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769015398
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"459227\">@Violeta Hernández</span></p>",
        "id": 569309770,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1769015406
    },
    {
        "content": "<p><a class=\"stream\" data-stream-id=\"518132\" href=\"/#narrow/channel/518132-combinatorial-games\">#combinatorial-games</a> might be a more appropriate channel for this</p>",
        "id": 569337492,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769023500
    },
    {
        "content": "<p>As for your question, you should be able to do something like this. <code>nim 2</code> has <code>Iio (of 2)</code> as its left/right moves, which is equal to <code>of '' Iio 2</code>, which is equal to <code>of '' natCast '' Iio 2</code>. And then hopefully Mathlib has some easy way to show <code>Iio 2 = {0, 1}</code> on the naturals. <code>simp</code> should take care of the rest.</p>",
        "id": 569338378,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769023791
    },
    {
        "content": "<p>Or if you simply want to solve your subgoals, you can turn <code>0 &lt; of 2</code> into <code>of 0 &lt; of 2</code> and then <code>0 &lt; 2</code> in the ordinals, which hopefully <code>simp</code> should be able to solve.</p>",
        "id": 569338557,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769023850
    },
    {
        "content": "<p>Here's a proof of your theorem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">CombinatorialGames</span><span class=\"bp\">.</span><span class=\"n\">Game</span><span class=\"bp\">.</span><span class=\"n\">Specific</span><span class=\"bp\">.</span><span class=\"n\">Nim</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nimber</span><span class=\"w\"> </span><span class=\"n\">IGame</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">!</span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">nim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∗</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ofSets_eq_ofSets_cases</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⋆</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"bp\">⟨⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">nim_def</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">congr!</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Iio</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"n\">succ_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Iio_succ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"n\">le_one_iff</span><span class=\"o\">])</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">of_image_Iio</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image_pair</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 569346808,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769026477
    },
    {
        "content": "<p>Thanks! It seems I can also use <code>change</code> to turn <code>of n</code> into <code>(n : Ordinal)</code> as well.</p>",
        "id": 569397290,
        "sender_full_name": "SaNoy SaKnoi",
        "timestamp": 1769049728
    },
    {
        "content": "<p>You can, but you really shouldn't. <code>of</code> and <code>val</code> exist as an API barrier.</p>",
        "id": 569429282,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769069767
    },
    {
        "content": "<p>It's an analogous situation with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OrderDual#doc\">docs#OrderDual</a>.</p>",
        "id": 569429324,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1769069787
    }
]