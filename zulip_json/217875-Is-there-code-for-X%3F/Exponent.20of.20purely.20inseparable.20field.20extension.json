[
    {
        "content": "<p>I can't find a definition of the exponent of a purely inseparable field extension (see for example <a href=\"https://encyclopediaofmath.org/wiki/Purely_inseparable_extension\">here</a>)? I'm aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=isPurelyInseparable_iff_pow_mem#doc\">docs#isPurelyInseparable_iff_pow_mem</a> and co. If we don't have the exponent definition, I'd like to add it and once it's there I'd like to add also the following:<br>\nFor a purely inseparable field extension <code>L/K</code> with exponent <code>e</code>, the iterated Frobenius map <code>x ↦ x ^ p ^ s</code> (with <code>s ≥ e</code>) on <code>L</code> has range contained in <code>(algebraMap K L).range</code> so one can define both the ring homomorphism <code>L →+* K</code> and the semilinear map <code>L →ₛₗ[iterateFrobenius F p s] K</code> (for any subfield <code>F</code> of <code>K</code>) acting via <code>x ↦ x ^ p ^ s</code>.</p>\n<p><a href=\"https://github.com/mistarro/local-rings/blob/main/LocalRings/Utils/PurelyInseparable.lean\">Here</a> is my attempt in my private project.</p>",
        "id": 496963937,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738316005
    },
    {
        "content": "<p>I don't think this is in mathlib yet, although we have some dicsussions. Let me find.</p>",
        "id": 497146930,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738400999
    },
    {
        "content": "<p>No we don't have this yet. I think we even don't have the following: if <code>L/K</code> is a finite purely inseparable extension of exponential characteristic <code>p</code>, then there exists a natural number <code>n</code> such that <code>[L:K]=p^n</code>.</p>\n<p>I think such <code>n</code> is not the same as the exponent you mentioned, is it?</p>",
        "id": 497147342,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738401338
    },
    {
        "content": "<p>When I was developing the theory of separable degree and purely inseparable extensions, I followed the Wikipedia article. So I'm not aware of the definition of exponent of purely inseparable extensions.</p>",
        "id": 497147551,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738401519
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/496963937\">said</a>:</p>\n<blockquote>\n<p>... I'd like to add also the following:<br>\nFor a purely inseparable field extension <code>L/K</code> with exponent <code>e</code>, the iterated Frobenius map <code>x ↦ x ^ p ^ s</code> (with <code>s ≥ e</code>) on <code>L</code> has range contained in <code>(algebraMap K L).range</code> so one can define both the ring homomorphism <code>L →+* K</code> and the semilinear map <code>L →ₛₗ[iterateFrobenius F p s] K</code> (for any subfield <code>F</code> of <code>K</code>) acting via <code>x ↦ x ^ p ^ s</code>.</p>\n</blockquote>\n<p>But in order to define this, you don't need to define the exponent. You only require that <code>s</code> is such that <code>L^(p^s)</code> is contained in <code>K</code>. Just put it as a requirement in your definition, and I think it's OK.</p>",
        "id": 497148391,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738402234
    },
    {
        "content": "<p>... and is it the same to say that for any <code>x</code> in <code>L</code>, <code>x^(p^s)</code> is in <code>K</code>?</p>",
        "id": 497148477,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738402314
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"366779\">@Jz Pan</span> Thanks for the answer!</p>\n<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497147342\">said</a>:</p>\n<blockquote>\n<p>No we don't have this yet. I think we even don't have the following: if <code>L/K</code> is a finite purely inseparable extension of exponential characteristic <code>p</code>, then there exists a natural number <code>n</code> such that <code>[L:K]=p^n</code>.</p>\n<p>I think such <code>n</code> is not the same as the exponent you mentioned, is it?</p>\n</blockquote>\n<p>It's not the exponent but it's a tight upper bound. I actually do have a proof that <code>[L:K]=p^n</code> for inseparable extensions so I might contribute it.</p>\n<p>Talking about the exponent, I was thinking to define it this way:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">PurelyInseparable</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A predicate class on a purely inseparable extension saying that there is a natural number</span>\n<span class=\"sd\">    `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- The *exponent* of a purely inseparable extension, i.e., the smallest</span>\n<span class=\"sd\">    natural number `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"bp\">‹</span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">›.</span><span class=\"n\">exp</span>\n</code></pre></div>\n<p>Or should <code>IsPurelyInseparable K L</code> be bundled? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 497148597,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738402402
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148391\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/496963937\">said</a>:</p>\n<blockquote>\n<p>... I'd like to add also the following:<br>\nFor a purely inseparable field extension <code>L/K</code> with exponent <code>e</code>, the iterated Frobenius map <code>x ↦ x ^ p ^ s</code> (with <code>s ≥ e</code>) on <code>L</code> has range contained in <code>(algebraMap K L).range</code> so one can define both the ring homomorphism <code>L →+* K</code> and the semilinear map <code>L →ₛₗ[iterateFrobenius F p s] K</code> (for any subfield <code>F</code> of <code>K</code>) acting via <code>x ↦ x ^ p ^ s</code>.</p>\n</blockquote>\n<p>But in order to define this, you don't need to define the exponent. You only require that <code>s</code> is such that <code>L^(p^s)</code> is contained in <code>K</code>. Just put it as a requirement in your definition, and I think it's OK.</p>\n</blockquote>\n<p>This was my first approach but It's less general so I thought maybe adding definition of the exponent and make it more general would be of greater value. But I can start simply. The thing is, I do have proofs already, it's only to shape them correctly and add.</p>",
        "id": 497148868,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738402613
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148477\">said</a>:</p>\n<blockquote>\n<p>... and is it the same to say that for any <code>x</code> in <code>L</code>, <code>x^(p^s)</code> is in <code>K</code>?</p>\n</blockquote>\n<p>Yes, only that <code>s</code> has to be universal.<br>\nBTW, existence of such an <code>s</code> means that the exponent exists, see my proposed definition <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 497149051,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738402751
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148597\">said</a>:</p>\n<blockquote>\n<p>Talking about the exponent, I was thinking to define it this way:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">PurelyInseparable</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A predicate class on a purely inseparable extension saying that there is a natural number</span>\n<span class=\"sd\">    `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"n\">exp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- The *exponent* of a purely inseparable extension, i.e., the smallest</span>\n<span class=\"sd\">    natural number `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"bp\">‹</span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">›.</span><span class=\"n\">exp</span>\n</code></pre></div>\n<p>Or should <code>IsPurelyInseparable K L</code> be bundled? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>\n</blockquote>\n<p>Personally I'd like to do the API design similar to <code>Polynomial.IsSeparableContraction</code>, <code>Polynomial.HasSeparableContraction</code> (both of them are only <code>Prop</code> but not class), and <code>Polynomial.HasSeparableContraction.degree</code>, in the file <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/SeparableDegree.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Polynomial/SeparableDegree.html</a>. But it's only my personal opinion. (<span class=\"user-mention\" data-user-id=\"224323\">@Junyan Xu</span>  what do you think?) The final decision is up to you.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148868\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148391\">said</a>:</p>\n<blockquote>\n<p>... But in order to define this, you don't need to define the exponent. You only require that <code>s</code> is such that <code>L^(p^s)</code> is contained in <code>K</code>. Just put it as a requirement in your definition, and I think it's OK.</p>\n</blockquote>\n<p>This was my first approach but It's less general so I thought maybe adding definition of the exponent and make it more general would be of greater value. But I can start simply. The thing is, I do have proofs already, it's only to shape them correctly and add.</p>\n</blockquote>\n<p>I think use <code>L^(p^s)</code> contained in <code>K</code> approach you need fewer additional definition to define your maps. Of course we can also have an <code>iff</code> theorem to convert this assumption to/from <code>s ≥ e</code>. Personally I think this is better.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497149051\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"366779\">Jz Pan</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497148477\">said</a>:</p>\n<blockquote>\n<p>... and is it the same to say that for any <code>x</code> in <code>L</code>, <code>x^(p^s)</code> is in <code>K</code>?</p>\n</blockquote>\n<p>Yes, only that <code>s</code> has to be universal.<br>\nBTW, existence of such an <code>s</code> means that the exponent exists, see my proposed definition <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>\n</blockquote>\n<p>Thanks for the clarification. So we can have another <code>iff</code> theorem to give the exponent another characterization.</p>",
        "id": 497149619,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738403229
    },
    {
        "content": "<p>More precisely, I think we can have <code>IsPurelyInseparable.IsExponent</code>, <code>IsPurelyInseparable.HasExponent</code> and <code>IsPurelyInseparable.HasExponent.exponent</code>.</p>\n<p>Also, do you look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsPRadical#doc\">docs#IsPRadical</a> which generalizes purely inseparable to non-field case? Do you think we should also define exponent for it?</p>",
        "id": 497149850,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738403414
    },
    {
        "content": "<p>I was thinking to go analogously to exponent of a monoid <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Monoid.exponent#doc\">docs#Monoid.exponent</a>, they first define similar predicate (but non-class). Do you mean you would avoid defining predicate class? Maybe better would be:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">FieldTheory</span><span class=\"bp\">.</span><span class=\"n\">PurelyInseparable</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A predicate class on a purely inseparable extension saying that there is a natural number</span>\n<span class=\"sd\">    `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">WithExponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">isPurelyInseparable</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span>\n<span class=\"w\">  </span><span class=\"n\">hasExponent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- The *exponent* of a purely inseparable extension, i.e., the smallest</span>\n<span class=\"sd\">    natural number `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"bp\">.</span><span class=\"n\">WithExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">find</span><span class=\"w\"> </span><span class=\"bp\">‹</span><span class=\"n\">Exponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">›.</span><span class=\"n\">hasExponent</span>\n</code></pre></div>\n<p>I think it is quite similar to <code>Algebra.IsAlgebraic R A</code> (but <code>Algebra R A</code> is not bundled). I have a feeling that it should be a class but no idea if <code>IsPurelyInseparable</code> should be bundled or not.</p>",
        "id": 497152358,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738405509
    },
    {
        "content": "<p>As for <code>IsPRadical</code>, it seems that the number is not universal? But once the exponent is defined for purely inseparable extensions, we could think to generalize.</p>",
        "id": 497152467,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738405608
    },
    {
        "content": "<p>If <code>IsPRadical</code> is generalization of <code>IsPurelyInseparable</code>, do we have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPRadical</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>?</p>",
        "id": 497158422,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738410917
    },
    {
        "content": "<p>I think an unbundled version is better (just like your previous <code>Exponent</code>). If it is me, I'll call it <code>HasExponent</code> and make it just a <code>def</code>.</p>\n<p>As for your second question, yes we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=IsPurelyInseparable.isPRadical#doc\">docs#IsPurelyInseparable.isPRadical</a>.</p>\n<p>Currently <code>IsPRadical</code> is not used in elsewhere. So if you think you don't need it,  it's OK to just stick to <code>IsPurelyInseparable</code>.</p>",
        "id": 497162049,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738413946
    },
    {
        "content": "<p>Thanks, I think having an exponent is a property of a purely inseparable extension (just like having exp-char <code>p</code>), which is a typeclass parameter. In case of polynomials, it's different as polynomial parameters are not typeclass. That's why my feeling is it should be typeclass parameter. The only question is if we should write</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>or</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">WithExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>because for <code>WithExponent</code> we need <code>IsPurelyInseparable</code> (for example in a similar way <code>IsPurelyInseparable</code> requires <code>Algebra.IsIntegral</code> and this one is bundled). But I'm not sure.</p>",
        "id": 497163435,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738415185
    },
    {
        "content": "<p>I prefer this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.FieldTheory.PurelyInseparable</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A predicate class on a purely inseparable extension saying that there is a natural number</span>\n<span class=\"sd\">    `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kd\">class</span><span class=\"w\"> </span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hasExponent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n\n<span class=\"c1\">-- Note that `HasExponent` automatically implies `IsPurelyInseparable`, here we need an instance states it</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- The *exponent* of a purely inseparable extension, i.e., the smallest</span>\n<span class=\"sd\">    natural number `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kd\">noncomputable</span><span class=\"w\"> </span><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsPurelyInseparable.HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat.find</span><span class=\"w\"> </span><span class=\"o\">‹</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">›</span><span class=\"bp\">.</span><span class=\"n\">hasExponent</span>\n</code></pre></div>\n<p>Since you already assume that both of them are fields, the assumption of <code>HasExponent</code> automatically implies <code>IsPurelyInseparable</code> (via <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=isPurelyInseparable_iff_pow_mem#doc\">docs#isPurelyInseparable_iff_pow_mem</a>), so I don't think we need to bundle <code>IsPurelyInseparable</code> into it.</p>\n<p>Also, I think we can eliminate the <code>p</code> in the definition of <code>HasExponent</code>, just like in the definition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=perfectClosure#doc\">docs#perfectClosure</a>, just use <code>ringExpChar F</code> to replace <code>p</code>.</p>",
        "id": 497166098,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738417697
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 497166254,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738417867
    },
    {
        "content": "<p>How <code>HasExponent K L p</code> implies <code>IsPurelyInseparable K L</code> in your code?</p>\n<p>About <code>[ExpChar K p]</code>, I think it might be necessary to have some defeqs maybe? If we can get rid of it, why is it necessary in other places?</p>",
        "id": 497167279,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738418784
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497167279\">said</a>:</p>\n<blockquote>\n<p>How <code>HasExponent K L p</code> implies <code>IsPurelyInseparable K L</code> in your code?</p>\n</blockquote>\n<p>What about this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib.FieldTheory.PurelyInseparable</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Ring</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"sd\">/-- A predicate class on a ring extension saying that there is a natural number</span>\n<span class=\"sd\">    `e` such that `a ^ ringExpChar K ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kd\">class</span><span class=\"w\"> </span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">hasExponent'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">ringExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span>\n\n<span class=\"kd\">theorem</span><span class=\"w\"> </span><span class=\"n\">HasExponent.hasExponent</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">ExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">algebraMap</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ringExpChar.eq</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">hasExponent'</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"sd\">/-- The *exponent* of a purely inseparable extension, i.e., the smallest</span>\n<span class=\"sd\">    natural number `e` such that `a ^ p ^ e ∈ K` for all `a ∈ L`. -/</span>\n<span class=\"kd\">noncomputable</span><span class=\"w\"> </span><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">exponent</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Nat.find</span><span class=\"w\"> </span><span class=\"o\">‹</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">›</span><span class=\"bp\">.</span><span class=\"n\">hasExponent'</span>\n\n<span class=\"kd\">end</span><span class=\"w\"> </span><span class=\"n\">Ring</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">FieldAndDomain</span>\n\n<span class=\"kd\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsDomain</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsPurelyInseparable</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">  </span><span class=\"n\">obtain</span><span class=\"w\"> </span><span class=\"o\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">‹</span><span class=\"n\">HasExponent</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">L</span><span class=\"o\">›</span><span class=\"bp\">.</span><span class=\"n\">hasExponent'</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">isPurelyInseparable_iff_pow_mem</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ringExpChar</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">⟩</span>\n\n<span class=\"kd\">end</span><span class=\"w\"> </span><span class=\"n\">FieldAndDomain</span>\n</code></pre></div>\n<blockquote>\n<p>About <code>[ExpChar K p]</code>, I think it might be necessary to have some defeqs maybe? If we can get rid of it, why is it necessary in other places?</p>\n</blockquote>\n<p>No, we don't need <code>ExpChar</code> in the definition of <code>IsPurelyInseparable</code> and <code>perfectClosure</code>. It only used in <code>IsPRadical</code>. We use <code>ringExpChar</code> in <code>perfectClosure</code>, so yes, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=mem_perfectClosure_iff#doc\">docs#mem_perfectClosure_iff</a> is rfl while <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=mem_perfectClosure_iff_pow_mem#doc\">docs#mem_perfectClosure_iff_pow_mem</a> is not rfl. But I think it's not harmful.</p>",
        "id": 497168671,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738420078
    },
    {
        "content": "<p>Thanks, will follow this path then. Will prepare a PR with some basic results as well, and let's discuss it further then.</p>",
        "id": 497172902,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738423467
    },
    {
        "content": "<p>BTW, <code>Mathlib.FieldTheory.PurelyInseparable</code> is quite big already, should we split it? I'm thinking about <code>Separability</code> directory and all the related files inside, but could be also <code>Separable</code> and <code>PurelyInseparable</code> separately (thos a lot of results about separable extensions are in <code>Mathlib.FieldTheory.PurelyInseparable</code> now). Any suggestions?</p>",
        "id": 497174055,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738424291
    },
    {
        "content": "<p>I'd like to made a correction: <code>hasExponent[']</code> should be <code>has_exponent[']</code> (since its type has type <code>Prop</code>) or <code>exists_exponent[']</code> if strictly following naming convention.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497174055\">said</a>:</p>\n<blockquote>\n<p>BTW, <code>Mathlib.FieldTheory.PurelyInseparable</code> is quite big already, should we split it? I'm thinking about <code>Separability</code> directory and all the related files inside, but could be also <code>Separable</code> and <code>PurelyInseparable</code> separately (thos a lot of results about separable extensions are in <code>Mathlib.FieldTheory.PurelyInseparable</code> now). Any suggestions?</p>\n</blockquote>\n<p>I think it's reasonable. A possible approach is <code>PurelyInseparable/(Basic,RelPerfectClosure,InsepDegree)</code>? And your results could go <code>PurelyInseparable/Exponent</code>.</p>",
        "id": 497174422,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738424630
    },
    {
        "content": "<p>So you think that common <code>Separability</code> directory is not a good idea?</p>",
        "id": 497174568,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738424738
    },
    {
        "content": "<p>there is already:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Separable</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">SeparableClosure</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">SeparableDegree</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n<span class=\"n\">IsSepClosed</span><span class=\"bp\">.</span><span class=\"n\">lean</span>\n</code></pre></div>",
        "id": 497174723,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738424842
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497174568\">said</a>:</p>\n<blockquote>\n<p>So you think that common <code>Separability</code> directory is not a good idea?</p>\n</blockquote>\n<p>I have no idea on this. The definition of <code>Separable</code> is in mathlib long before my work on <code>SeparableDegree</code> (which contains some important properties of <code>Separable</code>).</p>",
        "id": 497174724,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738424844
    },
    {
        "content": "<p>Maybe some maintainer could comment here?</p>",
        "id": 497174986,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738425054
    },
    {
        "content": "<p>A <code>Separable</code> directory looks reasonable, but the PR that makes it should probably do nothing but move the files around without adding or removing any theorems or definitions.</p>",
        "id": 497175201,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738425241
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> that's clear, but how about <code>PurelyInseparable</code>? I was thinking that maybe <code>Separability</code> would be a common name for both, but if you think that <code>Separable</code> is ok, I could proceed with that.</p>",
        "id": 497175958,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738425749
    },
    {
        "content": "<p>Ok, I think I'll split just <code>PurelyInseparable</code>.</p>",
        "id": 497177747,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738427173
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"366779\">@Jz Pan</span> Some seemingly basic results (for example <code>IntermediateField.isPurelyInseparable_adjoin[_simple]_iff_pow_mem</code>) use <code>le_perfectClosure_iff</code> which requires <code>perfectClosure</code>. Do you think there is proof not using <code>perfectClosure</code>?</p>",
        "id": 497186266,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738434103
    },
    {
        "content": "<p>Why do you want to avoid perfectClosure? Wouldn't you need to repeat the same proofs in the construction of perfectClosure if you want to prove isPurelyInseparable_adjoin[_simple]_iff_pow_mem directly?</p>",
        "id": 497200823,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1738446078
    },
    {
        "content": "<p>If you want <code>Separable</code> and <code>PurelyInseparable</code> directories this sounds fine -- the more files and directories we have, the more modular the library is, and I think modularity is a good thing, especially here where we're splitting at concepts which are mathematically meaningful</p>",
        "id": 497204446,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1738449221
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497186266\">said</a>:</p>\n<blockquote>\n<p>Some seemingly basic results (for example <code>IntermediateField.isPurelyInseparable_adjoin[_simple]_iff_pow_mem</code>) use <code>le_perfectClosure_iff</code> which requires <code>perfectClosure</code>. Do you think there is proof not using <code>perfectClosure</code>?</p>\n</blockquote>\n<p>No, at least I'm not aware of.</p>",
        "id": 497220103,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738465254
    },
    {
        "content": "<p>Also, the docstring of <code>perfectClosure</code> says \"It is also the maximal purely inseparable subextension\", so I think it's closely related to <code>IsPurelyInseparable</code>.</p>",
        "id": 497220320,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738465488
    },
    {
        "content": "<p>Alright, shall I keep it in <code>Basic</code> then?</p>",
        "id": 497243193,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738488649
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"759408\">Michał Staromiejski</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Exponent.20of.20purely.20inseparable.20field.20extension/near/497243193\">said</a>:</p>\n<blockquote>\n<p>Alright, shall I keep it in <code>Basic</code> then?</p>\n</blockquote>\n<p>Sure.</p>",
        "id": 497244213,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738489747
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/21343\">#21343</a> is ready, I split as initially suggested, with some results in <code>RelPerfectClosure</code>.</p>",
        "id": 497253081,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738498115
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"224323\">@Junyan Xu</span>  Would you like to have a look at PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/21343\">#21343</a>? I think it's good to go.</p>",
        "id": 497264649,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738508289
    },
    {
        "content": "<p>Created PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/21372\">#21372</a> introducing definitions and basic facts about exponent. <span class=\"user-mention\" data-user-id=\"366779\">@Jz Pan</span> please have a look.</p>\n<p>A remark from my side: the definition of the exponent for an element now is meaningful only when <code>ringExpChar &gt; 1</code> (so it is prime). In all the application I encountered that is enough but maybe we need to extend the definition to <code>ringExpChar = 1</code> by setting the exponent of the element to <code>0</code>. The question is how to do it in the cleanest possible way? Naive option is to just introduce <code>if</code> but is it the best option?</p>",
        "id": 497419005,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738585342
    },
    {
        "content": "<p>More general question: when working with exponential characteristic, is there any guideline as when to use instance parameter <code>[ExpChar K p]</code> and have <code>p</code>, and when to use <code>ringExpChar K</code>? It seems that with [ExpChar K p] the API is a bit more complicated (extra explicit parameter <code>p</code>) but OTOH, one can use <code>rcases ‹ExpChar K p› with _ | ⟨hp⟩</code> and there is no need to constantly use <code>ringExpChar.eq K p</code>.</p>",
        "id": 497421163,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738585910
    },
    {
        "content": "<p>Created separate PR topic: <a class=\"stream-topic\" data-stream-id=\"144837\" href=\"/#narrow/channel/144837-PR-reviews/topic/.2321372.20Exponent.20for.20.28purely.20inseparable.29.20field.20extensions\">#PR reviews &gt; #21372 Exponent for (purely inseparable) field extensions</a></p>",
        "id": 497422681,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738586313
    },
    {
        "content": "<p>I would advise to use <code>ExpChar K p</code> almost always. It works much better when working with field extensions.</p>",
        "id": 497473796,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738598208
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"366779\">@Jz Pan</span> could you comment here? I guess your opinion is not to use it. I stated most results in terms of <code>ringExpChar K</code> without much trouble and overuse of <code>ringExpChar.eq K p</code> and actually not having this <code>p</code> everywhere seems better. But I think we need some guideline...</p>\n<p><span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span> I just want to understand in which sense it works better? I mean, there are pros and cons of course but maybe someone with more experience in formalizing results that make use of <code>ringExpChar</code> might guide here...</p>",
        "id": 497477049,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738598894
    },
    {
        "content": "<p>If you have a type like <code>ZMod p</code>, then it depends on the term <code>p</code>. If you have a field extension <code>[Algebra K L]</code>, and <code>K</code> and <code>L</code> are both fields of characteristic <code>p</code>, then you might want to talk about their prime fields.<br>\nWe now have 4 candidates:</p>\n<ul>\n<li><code>ZMod (ringChar K)</code></li>\n<li><code>ZMod (ringChar L)</code></li>\n<li><code>ZMod (ringExpChar K)</code></li>\n<li><code>ZMod (ringExpChar L)</code></li>\n</ul>\n<p>However, if we use <code>[CharP K p]</code> and <code>[CharP L p]</code> (or the <code>ExpChar</code> variants), then all of those prime fields collapse into <code>ZMod p</code>.</p>\n<p>We indeed have lemmas like <code>ringExpChar.eq</code>. But rewriting with those in types like <code>ZMod _</code> will very often lead to problems with dependent types. (Motive is not type correct error, or heterogeneous equalities, etc)</p>",
        "id": 497609079,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738658609
    },
    {
        "content": "<p>Thanks a lot <span class=\"user-mention\" data-user-id=\"112680\">@Johan Commelin</span>. And I guess there is no smart way to get rid of this extra explicit parameter <code>p</code>, so that I write for example <code>exponent K L</code> and not <code>exponent K L p</code>?</p>",
        "id": 497610647,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738659136
    },
    {
        "content": "<p>It very much depends on what you want to do. I think if you are making a new definition, then you might want to use <code>ringExpChar</code>. But in the API lemmas for the definition, you want to use <code>[ExpChar K p]</code>.</p>",
        "id": 497610880,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738659223
    },
    {
        "content": "<p>I guess there is a more refined rule: if the statement doesn't need <code>p</code>, then it is fine to avoid it. In proofs you can start with <code>let p :=</code> and then set up the instances <code>[ExpChar K p]</code> local to the proof.<br>\nBut if a statement refers to the characteristic in any form, then it should be as a variable <code>p</code>, and not as <code>ringExpChar K</code>.</p>",
        "id": 497611302,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1738659358
    },
    {
        "content": "<p>Thanks, that makes sense.</p>",
        "id": 497612467,
        "sender_full_name": "Michał Staromiejski",
        "timestamp": 1738659695
    },
    {
        "content": "<p>I agree with Johan's comments.</p>",
        "id": 497699523,
        "sender_full_name": "Jz Pan",
        "timestamp": 1738684344
    }
]