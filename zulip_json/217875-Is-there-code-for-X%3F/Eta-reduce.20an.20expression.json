[
    {
        "content": "<p>Feel free to move this to the #lean4 stream; this is a metaprogramming question.</p>\n<p>Is there code to eta-reduce a given <code>Lean.Expr</code>? I know about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Expr.beta#doc\">docs#Lean.Expr.beta</a> (which does beta reduction), there's also zeta reduction, but no eta.</p>",
        "id": 547043428,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1761384504
    },
    {
        "content": "<p>I'd also be happy with an elaborator (is that the word) I can apply in the source to tell Lean \"take this term, but eta-reduce it\", as in</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">id</span>\n<span class=\"c1\">-- Instead of this,</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"c1\">-- I'd like to do this (syntax invented)</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">g'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">eta</span><span class=\"bp\">%</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"c1\">-- to have `g'` be exactly `f`.</span>\n</code></pre></div>",
        "id": 547043563,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1761384647
    },
    {
        "content": "<p>Doesn't <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Expr.eta#doc\">docs#Lean.Expr.eta</a> do eta-reduction?</p>",
        "id": 547043598,
        "sender_full_name": "Robin Arnez",
        "timestamp": 1761384679
    },
    {
        "content": "<p>Huh, that's great! No idea why my loogling did not find that. Thank you!</p>",
        "id": 547043639,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1761384703
    },
    {
        "content": "<p>(Found that out now: I was searching for the string <code>etaReduce</code>, but <code>eta</code> would have found it. Lesson learned!)</p>",
        "id": 547043850,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1761384953
    }
]