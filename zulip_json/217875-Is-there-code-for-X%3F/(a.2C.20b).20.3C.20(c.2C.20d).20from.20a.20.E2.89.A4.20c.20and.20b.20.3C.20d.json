[
    {
        "content": "<p>I hope I'm not going crazy, because I don't think we actually have this theorem for <code>Prod.Lex</code></p>",
        "id": 463525051,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105153
    },
    {
        "content": "<p>That's the relation <code>termination_by (a, b)</code> uses by default, so the lack of this result is a large annoyance</p>",
        "id": 463525250,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105245
    },
    {
        "content": "<p>This for instance doesn't work</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">recursion</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">recursion</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"c1\">-- failed to prove termination</span>\n<span class=\"n\">termination_by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 463525416,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105315
    },
    {
        "content": "<p>Oddly enough, we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Prod.Lex.right%27#doc\">docs#Prod.Lex.right'</a>, but only when the first argument is a natural</p>",
        "id": 463525531,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105374
    },
    {
        "content": "<p>On a related note, is there any way to tell <code>termination_by</code> to just use the product order instead?</p>",
        "id": 463525862,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105524
    },
    {
        "content": "<p>Do we not have <code>(a, b) &lt; (c, d) → Prod.Lex _ _ (a, b) (c, d)</code> either?</p>",
        "id": 463526498,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724105855
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/.28a.2C.20b.29.20.3C.20.28c.2C.20d.29.20from.20a.20.E2.89.A4.20c.20and.20b.20.3C.20d/near/463526498\">said</a>:</p>\n<blockquote>\n<p>Do we not have <code>(a, b) &lt; (c, d) → Prod.Lex _ _ (a, b) (c, d)</code> either?</p>\n</blockquote>\n<p>There's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Prod.Lex.toLex_strictMono#doc\">docs#Prod.Lex.toLex_strictMono</a></p>",
        "id": 463582129,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1724126407
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/.28a.2C.20b.29.20.3C.20.28c.2C.20d.29.20from.20a.20.E2.89.A4.20c.20and.20b.20.3C.20d/near/463525862\">said</a>:</p>\n<blockquote>\n<p>On a related note, is there any way to tell <code>termination_by</code> to just use the product order instead?</p>\n</blockquote>\n<p>With <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WellFounded.wrap#doc\">docs#WellFounded.wrap</a> you can specify a different order</p>",
        "id": 463611759,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1724137330
    },
    {
        "content": "<p>I guess I should mention my actual use case. I can't get <a href=\"https://github.com/leanprover-community/mathlib4/blob/1c9b303da5aa27023f415c865159241990ed2f1f/Mathlib/SetTheory/Ordinal/NaturalOps.lean#L720\">this</a> proof to work without the <code>termination_by</code> syntax.</p>",
        "id": 463622354,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724140340
    },
    {
        "content": "<p>Without it, four of the five recursive applications work, but the fifth one (which has the form of the title) doesn't</p>",
        "id": 463622436,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1724140356
    },
    {
        "content": "<p>This might be due to the default <code>decreasing_tactic</code> only trying <code>Prod.lex.left</code> and <code>Prod.lex.right</code> but not <code>Prod.lex.right'</code>. Also see <a href=\"https://github.com/leanprover/lean4/issues/3906\">https://github.com/leanprover/lean4/issues/3906</a>. Maybe just use <code>termination_by</code> and move on :)</p>",
        "id": 463623366,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1724140549
    }
]