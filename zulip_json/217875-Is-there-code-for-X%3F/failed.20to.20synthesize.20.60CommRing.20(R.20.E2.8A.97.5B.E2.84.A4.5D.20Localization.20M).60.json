[
    {
        "content": "<p>ok, here's the Y of the problem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚äó</span><span class=\"o\">[</span><span class=\"n\">‚Ñ§</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Localization</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">inferInstance</span>\n<span class=\"c\">/-</span>\n<span class=\"cm\">failed to synthesize</span>\n<span class=\"cm\">  CommRing (R ‚äó[‚Ñ§] Localization M)</span>\n<span class=\"cm\">-/</span>\n</code></pre></div>",
        "id": 523379516,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749593907
    },
    {
        "content": "<p><a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/failed.20to.20synthesize.20.60CommRing.20.28R.20.E2.8A.97.5B.E2.84.A4.5D.20Localization.20M.29.60/near/523379516\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/unique.20Z-module.20structure.20on.20any.20AddCommGroup/with/523378411\">#Is there code for X? &gt; unique Z-module structure on any AddCommGroup</a> by <span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span>.</p>",
        "id": 523379576,
        "sender_full_name": "Notification Bot",
        "timestamp": 1749593945
    },
    {
        "content": "<p>in the code I see reference to <a href=\"https://github.com/leanprover-community/mathlib4/issues/10906\">https://github.com/leanprover-community/mathlib4/issues/10906</a> , maybe that is relevant?</p>",
        "id": 523380357,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749594371
    },
    {
        "content": "<p>right, i should add that the relevant instance is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Algebra.TensorProduct.instCommRing#doc\">docs#Algebra.TensorProduct.instCommRing</a></p>",
        "id": 523380379,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749594388
    },
    {
        "content": "<p>(misleading post deleted because I made a crucial typo)</p>",
        "id": 523380846,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749594676
    },
    {
        "content": "<p><code>Localization S</code> should be <code>Localization M</code></p>",
        "id": 523381149,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749594902
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/lBBA0oqwaiD0o1yxFEmj3not/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/lBBA0oqwaiD0o1yxFEmj3not/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"848x202\" src=\"/user_uploads/thumbnail/3121/lBBA0oqwaiD0o1yxFEmj3not/image.png/840x560.webp\"></a></div>",
        "id": 523381300,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595004
    },
    {
        "content": "<p>I changed it to <code>by convert Algebra.TensorProduct.instCommRing</code> and got universe problems</p>",
        "id": 523381385,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595050
    },
    {
        "content": "<p>so I changed it to <code>by convert Algebra.TensorProduct.instCommRing.{0, u, u}</code> and got two new subgoals</p>",
        "id": 523381420,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595073
    },
    {
        "content": "<p>I closed the second goal with <code>infer_instance</code> and so I'm left with the first goal:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">‚ä¢</span><span class=\"w\"> </span><span class=\"n\">AddCommGroup</span><span class=\"bp\">.</span><span class=\"n\">toIntModule</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Localization</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">toModule</span>\n</code></pre></div>",
        "id": 523381490,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595124
    },
    {
        "content": "<p>so i'm now suspecting that something went wrong with Localization specifically</p>",
        "id": 523381510,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595139
    },
    {
        "content": "<p>I've had trouble with localizations before, see <a href=\"#narrow/channel/287929-mathlib4/topic/Instance.20diamond.20in.20.60OreLocalization.60\">#mathlib4 &gt; Instance diamond in &#96;OreLocalization&#96;</a></p>",
        "id": 523381727,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749595265
    },
    {
        "content": "<p>I see, so 4 months ago Kevin Buzzard made a WIP PR that would have fixed this...</p>",
        "id": 523382140,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595522
    },
    {
        "content": "<p>oh, except that Andrew said there that it wouldn't have solved the problem</p>",
        "id": 523382204,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595553
    },
    {
        "content": "<p>hmm</p>",
        "id": 523382207,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595554
    },
    {
        "content": "<p>I mean, I don't want to reinvent the wheel, does someone have retained memory from 4 months ago?</p>",
        "id": 523382261,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749595577
    },
    {
        "content": "<p>ok so I've reinvented the wheel and I've traced the definitions to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">instAlgebra</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">instModuleOfIsScalarTower</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">instDistribMulActionOfIsScalarTower</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">instMulActionOfIsScalarTower</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">instSMulOfIsScalarTower</span>\n<span class=\"bp\">#</span><span class=\"n\">check</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">hsmul</span>\n<span class=\"sd\">/-- Scalar multiplication in a monoid localization. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">to_additive</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">attr</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">irreducible</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s2\">\"Vector addition in an additive monoid localization.\"</span><span class=\"kd\">]</span>\n<span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">hsmul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">X</span><span class=\"o\">[</span><span class=\"n\">S</span><span class=\"bp\">‚Åª¬π</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">[</span><span class=\"n\">S</span><span class=\"bp\">‚Åª¬π</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">liftExpand</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">oreNum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">/‚Çí</span><span class=\"w\"> </span><span class=\"n\">oreDenom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"n\">only</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">oreDenom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">oreDiv_smul_oreDiv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">oreDenom</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">‚Ä¢</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">oreDiv_smul_oreDiv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">‚Üê</span><span class=\"w\"> </span><span class=\"n\">OreLocalization</span><span class=\"bp\">.</span><span class=\"n\">expand</span><span class=\"o\">])</span>\n</code></pre></div>",
        "id": 523383366,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749596248
    },
    {
        "content": "<p>so now I can see why there are defeq problems for <code>R := ‚Ñ§</code></p>",
        "id": 523383388,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749596261
    },
    {
        "content": "<p>Yeah. There are no good solution now. One choice is to <code>attribute [-instance] AddCommGroup.toIntModule</code>, and another is to not talk about <code>‚Ñ§</code>.</p>",
        "id": 523388470,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1749599042
    },
    {
        "content": "<p>Andrew and I were indirectly looking at this earlier today</p>",
        "id": 523390579,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1749600368
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/21344\">#21344</a> is inactive, I didn't want to close it because it should be some kind of issue but I'm not working on it and Andrew's comment made me realise I didn't know what I was doing. I've changed the label from <code>awaiting-author</code> to <code>please-adopt</code>.</p>",
        "id": 523391093,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749600757
    },
    {
        "content": "<p>I'm surprised we don't have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Did I just miss it?</p>",
        "id": 523391919,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749601436
    },
    {
        "content": "<p><a class=\"message-link\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/two.20module.20instance.20over.20.20.E2.84.A4/near/504311445\">#Is there code for X? &gt; two module instance over  ‚Ñ§ @ üí¨</a></p>",
        "id": 523392004,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749601509
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">allEq</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"w\"> </span><span class=\"n\">inst2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">addCommMonoidToAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">‚Ñ§</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"n\">m</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"o\">,</span><span class=\"n\">int_smul_eq_zsmul</span><span class=\"o\">]</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span>\n\n<span class=\"kn\">variable</span><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚äó</span><span class=\"o\">[</span><span class=\"n\">‚Ñ§</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Localization</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">convert</span><span class=\"w\"> </span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">TensorProduct</span><span class=\"bp\">.</span><span class=\"n\">instCommRing</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"n\">u</span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"n\">infer_instance</span>\n</code></pre></div>",
        "id": 523392094,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749601584
    },
    {
        "content": "<p>well it works</p>",
        "id": 523392617,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1749601905
    },
    {
        "content": "<p>yes, it works there but it fails in later applications because they're still not defeq</p>",
        "id": 523392648,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749601933
    },
    {
        "content": "<p>I should add that I didn't fill in the sorrys in <a href=\"https://github.com/leanprover-community/mathlib4/pull/21344\">#21344</a> because I couldn't figure them out quickly and wanted people's opinions about whether the approach was good in general. </p>\n<p>I merged master into the PR and it does seem to solve your problem:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">TensorProduct</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">RingTheory</span><span class=\"bp\">.</span><span class=\"n\">Localization</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">TensorProduct</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">in</span>\n\n<span class=\"bp\">#</span><span class=\"n\">synth</span><span class=\"w\"> </span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"bp\">‚äó</span><span class=\"o\">[</span><span class=\"n\">‚Ñ§</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Localization</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- works</span>\n</code></pre></div>",
        "id": 523393536,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749602800
    },
    {
        "content": "<p>I wonder if that approach would create problems down the line since there are technically now two instances of Z-module on Localization M</p>",
        "id": 523527570,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749637274
    },
    {
        "content": "<p>like perhaps someone would prove some theorem about the R-module structure on Localization M, and then specialise that theorem to R=Z, and now the problem would be moved to that point</p>",
        "id": 523527661,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1749637306
    },
    {
        "content": "<p>Yeah presumably that's what Andrew is saying on the PR. I don't have the bandwidth to understand the problem properly but maybe someone like Eric or Andrew or you can come up with some amazing solution which involves some massive refactor or something</p>",
        "id": 523548240,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1749644360
    }
]