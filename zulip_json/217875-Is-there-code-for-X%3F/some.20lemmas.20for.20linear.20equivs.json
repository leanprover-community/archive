[
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"n\">w</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M₁</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M₁</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M₂</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M₂</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">e₁₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M₁</span><span class=\"w\"> </span><span class=\"bp\">≃ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e₂₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M₂</span><span class=\"w\"> </span><span class=\"bp\">≃ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">M₁</span><span class=\"o\">)</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">LinearEquiv</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">symm_eq_iff_trans_eq_refl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">e₁₂</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e₂₁</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">e₂₁</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">e₁₂</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M₂</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LinearEquiv</span><span class=\"bp\">.</span><span class=\"n\">symm_apply_eq</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">congr</span><span class=\"o\">(</span><span class=\"bp\">$</span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">symm_eq_iff_trans_eq_refl'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">e₁₂</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">e₂₁</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">e₁₂</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">e₂₁</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M₁</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">trans_refl</span><span class=\"w\"> </span><span class=\"n\">e₁₂</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">trans_assoc</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">symm_trans_self</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">refl_trans</span><span class=\"o\">]</span><span class=\"bp\">⟩</span>\n\n<span class=\"c1\">-- For comparison:</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">inv_eq_iff_eq_inv</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">eq_comm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inv_eq_iff_mul_eq_one</span><span class=\"o\">]</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Group</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⁻¹</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inv_eq_iff_mul_eq_one</span>\n</code></pre></div>",
        "id": 528734723,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752524826
    },
    {
        "content": "<p>am I correct that these two lemmas about linear equivs are missing?</p>",
        "id": 528734750,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752524835
    },
    {
        "content": "<p>namely the <code>symm_eq_iff_trans_eq_refl</code> and <code>symm_eq_iff_trans_eq_refl'</code> above</p>",
        "id": 528734790,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752524852
    },
    {
        "content": "<p>I think it would also be useful to have <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/Equiv/Defs.html#LinearEquiv.eq_comp_symm\">LinearEquiv.eq_comp_symm</a> <code>f = g ∘ ⇑e₁₂.symm ↔ f ∘ ⇑e₁₂ = g</code> but not coerced to functions</p>",
        "id": 528735108,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752524979
    },
    {
        "content": "<p>We already have one version for equivs which is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Equiv.symm_eq_iff_trans_eq_refl#doc\">docs#Equiv.symm_eq_iff_trans_eq_refl</a></p>",
        "id": 528735585,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752525170
    },
    {
        "content": "<p>so I think you should swap the primed and unprimed versions</p>",
        "id": 528735626,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752525188
    },
    {
        "content": "<p>What's more unfortunate in this situation is that <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Module/Equiv/Defs.html#LinearEquiv.coe_injective\">LinearEquiv.coe_injective</a> is stated using the wrong coe, <code>CoeFun.coe</code> should be replaced with <code>DFunLike.coe</code></p>",
        "id": 528737477,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752525962
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/27146\">#27146</a></p>",
        "id": 528737779,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752526087
    },
    {
        "content": "<p>and when i try to use Equiv instead i discover that there is no <code>toEquiv_trans</code> lemma...</p>",
        "id": 528738231,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752526262
    },
    {
        "content": "<p>edit: looks like it might be smoother to coerce to LinearMap first</p>",
        "id": 528741096,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752527448
    },
    {
        "content": "<p>oh no, the other direction is <code>simp</code> instead, lol</p>",
        "id": 528741447,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752527610
    },
    {
        "content": "<p>@[simp]<br>\ntheorem <a href=\"\">LinearEquiv.comp_coe</a> :<br>\n<code>↑f' ∘ₗ ↑f = ↑(f ≪≫ₗ f')</code></p>",
        "id": 528741478,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752527630
    },
    {
        "content": "<p>update: I think LinearMap is helpful for the x^-1 y = z iff y = xz, but not for the lemmas above</p>",
        "id": 528741725,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752527739
    },
    {
        "content": "<p>more update: maybe x^-1 y = z iff y = xz is all we need anyway since x^-1 = y by itself might not show up without being rfl..</p>",
        "id": 528742436,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1752528022
    }
]