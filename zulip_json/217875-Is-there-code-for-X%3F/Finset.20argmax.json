[
    {
        "content": "<p>I have a nonempty <code>Finset (Finset (Fin 31))</code>, and I want to get the largest set in it (I don't care how ties are broken, but I want it to be computable). What's the best way to do that? I could map them to lists using <code>Finset.sort</code>, give them the shortlex order and then take the maximum, for instance, but that seems really unwieldy</p>",
        "id": 472036347,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727001270
    },
    {
        "content": "<p>What about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.argmax#doc\">docs#List.argmax</a> of <code>Finset.sort</code>?</p>",
        "id": 472037473,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727002535
    },
    {
        "content": "<p>What about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.argmax#doc\">docs#List.argmax</a> of <code>Finset.sort</code>?</p>",
        "id": 472037538,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727002615
    },
    {
        "content": "<p>If you don't care about safety, you can instead unquot the finset and feed it to <code>argmax</code></p>",
        "id": 472037539,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1727002616
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Finset.20argmax/near/472037538\">said</a>:</p>\n<blockquote>\n<p>What about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.argmax#doc\">docs#List.argmax</a> of <code>Finset.sort</code>?</p>\n</blockquote>\n<p>Hmm, it requires a total order on <code>Finset (Fin 31)</code>, but it is better</p>",
        "id": 472037626,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727002685
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Finset.20argmax/near/472037539\">said</a>:</p>\n<blockquote>\n<p>If you don't care about safety, you can instead unquot the finset and feed it to <code>argmax</code></p>\n</blockquote>\n<p>I need safety, sadly</p>",
        "id": 472037647,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727002704
    },
    {
        "content": "<p>In order for this operation to be computable, you need a definite way to break ties. I think your approach of using the shortlex order is probably the best one.</p>",
        "id": 472043899,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727008928
    },
    {
        "content": "<p>I've ran into this issue of \"needing literally any computable linear order\" before. It'd be nice if there were some tactic to automatically generate one.</p>",
        "id": 472044284,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727009254
    },
    {
        "content": "<p>Perhaps there could be an instance</p>",
        "id": 472045457,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727010227
    },
    {
        "content": "<p>But there's already a partial order defined on <code>Finset (Fin 31)</code>, and the linear order wouldn't be compatible with it</p>",
        "id": 472047539,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727012238
    },
    {
        "content": "<p>It doesn't have to extend <code>LE</code>, it can just be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">HasLinearOrder</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"n\">linear</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsLinearOrder</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">r</span>\n</code></pre></div>",
        "id": 472047680,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727012370
    },
    {
        "content": "<p>That'd be nice. You can then have a tactic for deriving this relation for simple inductive types, and combine that with some other mechanism to turn it into a <code>LinearOrder</code> proper.</p>",
        "id": 472047997,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727012654
    },
    {
        "content": "<p>You'd get a diamond</p>",
        "id": 472054414,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1727018679
    },
    {
        "content": "<p>I settled on <code>((p.image (fun a ↦ toLex (a.card, Finset.Colex.toColex a))).max' sorry).2.ofColex</code>, I think that's good enough</p>",
        "id": 472054552,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727018771
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Finset.20argmax/near/472044284\">said</a>:</p>\n<blockquote>\n<p>I've ran into this issue of \"needing literally any computable linear order\" before. It'd be nice if there were some tactic to automatically generate one.</p>\n</blockquote>\n<p>I claim we should use the <code>Ord</code> typeclass for this (or rather, a strengthened version of it that says ≤ is weaker than it)</p>",
        "id": 472059426,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727022406
    },
    {
        "content": "<p>This would also solve the <code>Repr Multiset</code> problem computably</p>",
        "id": 472059470,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727022454
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 472059567,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1727022535
    }
]