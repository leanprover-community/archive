[
    {
        "content": "<p>I'm wondering if I can use coq like inductive notation as follows for <code>aevalR</code>. I'm trying to find a way that allows me to use <code>==&gt;</code> within the definition of <code>aevalR</code> inductive</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ANum</span><span class=\"w\">   </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"c1\">-- set_option quotPrecheck false in</span>\n<span class=\"c1\">-- notation:90 e:90 \"==&gt;\" n:89 =&gt; aevalR e n</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">E_Anum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ANum</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">==&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"s2\">\"==&gt;\"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\">  </span><span class=\"c1\">-- this won't work of course</span>\n\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n</code></pre></div>",
        "id": 455379856,
        "sender_full_name": "Zhuanhao Wu",
        "timestamp": 1722433861
    },
    {
        "content": "<p>Maybe this helps: <a href=\"#narrow/stream/113488-general/topic/Does.20.60set_option.20hygiene.20false.60.20not.20work.20with.20.60notation3.60.3F/near/455228084\">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Does.20.60set_option.20hygiene.20false.60.20not.20work.20with.20.60notation3.60.3F/near/455228084</a></p>",
        "id": 455397895,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1722438513
    },
    {
        "content": "<p>Thank you, I think it is the one I'm looking for, and the following works for me</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ANum</span><span class=\"w\">   </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">hygiene</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"c1\">-- set_option quotPrecheck false in</span>\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"s2\">\"==&gt;\"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"mi\">89</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">E_Anum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">ANum</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">==&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"c1\">-- where e \"==&gt;\" n := aevalR e n</span>\n\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n</code></pre></div>",
        "id": 455407299,
        "sender_full_name": "Zhuanhao Wu",
        "timestamp": 1722440115
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ANum</span><span class=\"w\">   </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span>\n\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">Temp</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">hygiene</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"c1\">-- set_option quotPrecheck false in</span>\n<span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"s2\">\"==&gt;\"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"mi\">89</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">aexp</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">E_Anum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">ANum</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">==&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"c1\">-- where e \"==&gt;\" n := aevalR e n</span>\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Temp</span>\n\n<span class=\"kn\">notation</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"o\">:</span><span class=\"mi\">90</span><span class=\"w\"> </span><span class=\"s2\">\"==&gt;\"</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"mi\">89</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">aevalR</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">n</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">AExp</span>\n</code></pre></div>",
        "id": 455408843,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1722440401
    },
    {
        "content": "<p>This way you also get unexpanders for your notation</p>",
        "id": 455408982,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1722440420
    },
    {
        "content": "<p>Nice, thanks for the info</p>",
        "id": 455420804,
        "sender_full_name": "Zhuanhao Wu",
        "timestamp": 1722442625
    },
    {
        "content": "<p>It's also how you can make sure <code>==&gt;</code> will always refer to the correct <code>aevalR</code>, even if another <code>aevalR</code> is in scope. This is what <code>hygiene</code> is for.</p>",
        "id": 455467680,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1722454400
    }
]