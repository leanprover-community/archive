[
    {
        "content": "<p>Does mathlib have a \"contravariant functor\" class (outside <code>CategoryTheory</code>), akin to Haskell's <a href=\"https://hackage.haskell.org/package/base-4.21.0.0/docs/Data-Functor-Contravariant.html\">Contravariant</a>? That is, something like:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">ContravariantFunctor</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">contramap</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">α</span>\n</code></pre></div>",
        "id": 495368016,
        "sender_full_name": "Léo Lessa",
        "timestamp": 1737577704
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> \"contravariant\"</p>",
        "id": 495383422,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737584077
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/Monoid/Unbundled/Defs.html#Contravariant\">Contravariant</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/Monoid/Unbundled/Defs.html#ContravariantClass\">ContravariantClass</a>, and <a href=\"https://loogle.lean-lang.org/?q=%22contravariant%22\">42 more</a></p>",
        "id": 495383425,
        "sender_full_name": "loogle",
        "timestamp": 1737584078
    },
    {
        "content": "<p>I don’t think we have this</p>",
        "id": 495383564,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1737584147
    },
    {
        "content": "<p>From the looks of it, we don't, no. We only seem to have contravariant relations(?)</p>",
        "id": 495383820,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1737584277
    },
    {
        "content": "<p>What's your use case for the class? If it's composing comparison functions, you might be interested in <code>onFun</code></p>",
        "id": 495384978,
        "sender_full_name": "Chris Wong",
        "timestamp": 1737584814
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> onFun</p>",
        "id": 495385003,
        "sender_full_name": "Chris Wong",
        "timestamp": 1737584825
    },
    {
        "content": "<p><span aria-label=\"exclamation\" class=\"emoji emoji-2757\" role=\"img\" title=\"exclamation\">:exclamation:</span> unknown identifier 'onFun'<br>\nDid you mean <a href=\"https://loogle.lean-lang.org/?q=%22onFun%22\"><code>\"onFun\"</code></a>, <a href=\"https://loogle.lean-lang.org/?q=Function.onFun\"><code>Function.onFun</code></a>, or <a href=\"https://loogle.lean-lang.org/?q=onFun\">something else</a>?</p>",
        "id": 495385008,
        "sender_full_name": "loogle",
        "timestamp": 1737584825
    },
    {
        "content": "<p>A generic use case could be to characterize classes <code>Class (i : Type u)</code> whose methods functorially depend on a type <code>i</code> as input. For example, the class</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">ExampleClass</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">method1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span>\n<span class=\"w\">  </span><span class=\"bp\">...</span>\n</code></pre></div>\n<p>could be an instance of <code>ContravariantFunctor</code> as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ContravariantFunctor</span><span class=\"w\"> </span><span class=\"n\">ExampleClass</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">contramap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">ej</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">method1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">ej</span><span class=\"bp\">.</span><span class=\"n\">method1</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">...</span><span class=\"o\">}</span>\n</code></pre></div>\n<p>I personally encountered a case just like the one above when defining a <code>congr</code> theorem <a href=\"https://github.com/Timeroot/Lean-QuantumInfo/commit/048e7b96b86223e1e79e518887100fe5c57a6ef3\">here</a>. In that case, it should have followed that, if <code>f</code> is a contravariant functor, then <code>α ≃ β</code> implies <code>f α ≃ f β</code>, which would be the contravariant version of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Logic/Equiv/Functor.html#Functor.mapEquiv\"><code>Functor.mapEquiv</code></a>. Instead, I had to write it by hand.</p>",
        "id": 495393478,
        "sender_full_name": "Léo Lessa",
        "timestamp": 1737589334
    }
]