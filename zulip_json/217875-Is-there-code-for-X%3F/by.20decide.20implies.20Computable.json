[
    {
        "content": "<p>[The suggestion below is wrong as pointed out downthread by Daniel Weber, however a modified version is still open, see below...]</p>\n<p>Would this be a suitable additional axiom for Lean in the context where we do not <code>open Classical</code>?<br>\nBy \"suitable\" I mean, nobody is likely to be able to prove it or disprove it, but it is presumably true in the intended model of Lean.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span>\n\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidablePred</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span>\n</code></pre></div>\n<p>For example, this is how one then proves that <code>x =&gt; 2*x</code> is computable:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Try</span><span class=\"w\"> </span><span class=\"n\">this</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">k</span>\n</code></pre></div>",
        "id": 470775264,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726530270
    },
    {
        "content": "<p>I think the fact that <code>Classical</code> exists causes this to not be true?</p>",
        "id": 470883053,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1726554963
    },
    {
        "content": "<p>You mean if we don't have <code>Classical.choice</code> as an axiom?</p>",
        "id": 470887068,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726556244
    },
    {
        "content": "<p>Yes... or is there a way to express  \"Decidable in a such a way that <code>by decide</code> will actually decide it\"?</p>",
        "id": 470888307,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726556523
    },
    {
        "content": "<p>Note that equality on <code>ℕ</code> is always decidable, so your axiom is just that every function is computable</p>",
        "id": 470888649,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726556645
    },
    {
        "content": "<p>I don't know much constructive logic, but that should still be false there</p>",
        "id": 470888689,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726556666
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Decidable.20implies.20Computable/near/470888649\">said</a>:</p>\n<blockquote>\n<p>Note that equality on <code>ℕ</code> is always decidable, so your axiom is just that every function is computable</p>\n</blockquote>\n<p><del>Not true since you also need to find the value of <code>f</code>.</del> There are uncountably many <code>f</code> and only countably many algorithms...</p>",
        "id": 470889880,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726557079
    },
    {
        "content": "<p>What do you mean?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span>\n\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidablePred</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">all_computable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"c1\">-- or equivalently</span>\n<span class=\"c1\">-- lemma all_computable (f : ℕ → ℕ) : Computable f := @church_turing f (fun x ↦ instDecidableEqNat (f (x 0)) (x 1))</span>\n\n<span class=\"c1\">-- 'all_computable' depends on axioms: [church_turing, propext, Quot.sound]</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">all_computable</span>\n</code></pre></div>",
        "id": 470890481,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726557317
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/Decidable.20implies.20Computable/near/470890481\">said</a>:</p>\n<blockquote>\n<p>What do you mean?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span>\n\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidablePred</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">all_computable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">church_turing</span><span class=\"w\"> </span><span class=\"n\">f</span>\n<span class=\"c1\">-- or equivalently</span>\n<span class=\"c1\">-- lemma all_computable (f : ℕ → ℕ) : Computable f := @church_turing f (fun x ↦ instDecidableEqNat (f (x 0)) (x 1))</span>\n\n<span class=\"c1\">-- 'all_computable' depends on axioms: [church_turing, propext, Quot.sound]</span>\n<span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">all_computable</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Thanks, that's surprising! Okay but my question remains about predicates for which <code>by decide</code> or <code>#eval</code> can be used ... do they have a name?</p>",
        "id": 470894615,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726558487
    },
    {
        "content": "<p>You mean functions which are/aren't marked <code>noncomputable</code>? Note that you can't talk about that in Lean itself, because that's a property of the implementation, not the function.</p>",
        "id": 470895601,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726558677
    },
    {
        "content": "<p>Well we do talk about it in some sense when we write <code>by decide</code>...</p>",
        "id": 470897297,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726559084
    },
    {
        "content": "<p><code>by decide</code> is equivalent to <code>exact of_decide_eq_true rfl</code>, it just takes a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Decidable#doc\">docs#Decidable</a> and checks if it's defeq to true. However, defeq-ness is not a mathematical property, it just a property of Lean's implementation.</p>",
        "id": 470898692,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726559498
    },
    {
        "content": "<p>Ah but then isn't it a subclass of the computable functions,  even if <em>exactly which</em> subclass it is depends on implementation? If so, it could make sense to postulate that these functions are in fact <code>Computable</code></p>",
        "id": 470901325,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726560124
    },
    {
        "content": "<p>It's also not just a property of the function, it's also a property of the implementation:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Prime</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"o\">)</span>\n\n<span class=\"kn\">section</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">propDecidable</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c\">/-</span>\n<span class=\"cm\">  tactic 'decide' failed for proposition</span>\n<span class=\"cm\">  obviously_true</span>\n<span class=\"cm\">  -/</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">section</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">obvious</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">inst2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Decidable</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">isTrue</span><span class=\"w\"> </span><span class=\"n\">obvious</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">obviously_true</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">decide</span>\n\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">inst1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">inst2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>",
        "id": 470901945,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726560232
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"444411\">@Yannick Forster</span> can probably give some advice here. He gave a talk in Bonn about (amongst other things) a synthetic approach to (un)decidability. But I don't feel confident commenting about details.</p>",
        "id": 470903213,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726560426
    },
    {
        "content": "<p>Similar comment: I’ve heard people talk about how “all functions are computable” holds in the internal language of the so-called effective topos. I’m not quite sure how Lean’s type theory precisely relates to the internal language of toposes (with universes perhaps?), but people seem to treat them as if they were essentially the same. Cf. Johan’s “condensed type theory”. So by that intuition your axiom should be consistent to add.</p>",
        "id": 471065587,
        "sender_full_name": "Benedikt Peterseim",
        "timestamp": 1726599213
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626609\">@Benedikt Peterseim</span> Here's a sense in which not \"all functions are computable\":</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Halting</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"bp\">.</span><span class=\"n\">Code</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"bp\">@</span><span class=\"n\">ComputablePred</span><span class=\"bp\">.</span><span class=\"n\">halting_problem</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n<span class=\"w\">  </span><span class=\"n\">contrapose</span><span class=\"w\"> </span><span class=\"n\">Q</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp_all</span>\n<span class=\"w\">  </span><span class=\"n\">unfold</span><span class=\"w\"> </span><span class=\"n\">ComputablePred</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">decPred</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Q</span>\n</code></pre></div>",
        "id": 471071173,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726600561
    },
    {
        "content": "<p>That proof relies on classical axioms.</p>",
        "id": 471071704,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726600741
    },
    {
        "content": "<p>OK... well, the question is whether there is a way to have<br>\n\"not all functions are <code>Computable</code>\"<br>\nand at the same time postulate<br>\n\"all functions decided by <code>of_decide_eq_true rfl</code> are <code>Computable</code>.\"</p>",
        "id": 471072738,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726601066
    },
    {
        "content": "<p>I think that might be possible with a tactic.</p>",
        "id": 471073453,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726601286
    },
    {
        "content": "<p>But I'm not capable of writing it.</p>",
        "id": 471073485,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1726601298
    },
    {
        "content": "<p>I don't mean to <em>prove</em><br>\n\"all functions decided by <code>of_decide_eq_true rfl</code> are <code>Computable</code>\"<br>\njust to be able to state it in Lean?</p>",
        "id": 471073930,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726601433
    },
    {
        "content": "<p>no you can't state that, this is a quantified definitional equality hypothesis, which doesn't exist in lean</p>",
        "id": 471074844,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726601708
    },
    {
        "content": "<p>what you could prove by a tactic is \"all functions expressible as closed terms are <code>Computable</code>\"</p>",
        "id": 471074969,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726601755
    },
    {
        "content": "<p>How do you state<br>\n\"all functions expressible as closed terms are <code>Computable</code>\"?</p>",
        "id": 471075701,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726601998
    },
    {
        "content": "<p>you can't</p>",
        "id": 471075806,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726602024
    },
    {
        "content": "<p>you can state \"Function <code>f</code> is <code>Computable</code>\" where <code>f</code> is a concrete function given to the tactic as an <code>Expr</code></p>",
        "id": 471075876,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726602052
    },
    {
        "content": "<p>If such a tactic were available, would it give a way to automatically prove e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p>(without having to mess with the specifics of how <code>Computable</code> is defined)?</p>",
        "id": 471076598,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726602256
    },
    {
        "content": "<p>yes</p>",
        "id": 471076636,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726602267
    },
    {
        "content": "<p>writing such a tactic would be very challenging though</p>",
        "id": 471076741,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726602289
    },
    {
        "content": "<p>because you basically have to compile all of lean down to turing machines or partial recursive functions or something</p>",
        "id": 471076873,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726602322
    },
    {
        "content": "<p>#goals</p>",
        "id": 471078409,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726602712
    },
    {
        "content": "<p>A simpler approach is just to show that certain large classes of functions are computable, and that computability is closed under certain wide ranges of operations. \"Every primitive recursive function is computable\" should already get you a lot of the way.</p>",
        "id": 471103359,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1726609787
    },
    {
        "content": "<p>True although when proving e.g. that if <code>f</code> is <code>Computable</code> then <code>`fun k : ℕ =&gt; f k + 1</code> is <code>Computable</code> we are already beyond primitive recursive functions in a way.</p>",
        "id": 471114784,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726614083
    },
    {
        "content": "<p>Would the fact that there are only countably many computable functions be worth adding to Mathlib? Here's my proof of it:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">PartrecCode</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Countable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→.</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"bp\">.</span><span class=\"n\">Code</span><span class=\"bp\">.</span><span class=\"n\">exists_code</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"bp\">@</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Injective</span><span class=\"bp\">.</span><span class=\"n\">countable</span>\n<span class=\"w\">    </span><span class=\"o\">({</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"bp\">.</span><span class=\"n\">Code</span><span class=\"bp\">.</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"bp\">.</span><span class=\"n\">Code</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choose</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">SetCoe</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choose_spec</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">tauto</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Countable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">@</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">Injective</span><span class=\"bp\">.</span><span class=\"n\">countable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→.</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">Partrec</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Partrec</span><span class=\"bp\">.</span><span class=\"n\">nat_iff</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">⟩</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">SetCoe</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">PFun</span><span class=\"bp\">.</span><span class=\"n\">lift_injective</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"bp\">.</span><span class=\"n\">injEq</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>",
        "id": 471136138,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726622392
    },
    {
        "content": "<p>Yes! If we have some way to state there's only countably many computable numbers, that would be great too.</p>",
        "id": 471156368,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1726631082
    },
    {
        "content": "<p>Would need to define \"computable real number\" first, it seems... <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 471177165,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726640120
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/470903213\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"444411\">Yannick Forster</span> can probably give some advice here. He gave a talk in Bonn about (amongst other things) a synthetic approach to (un)decidability. But I don't feel confident commenting about details.</p>\n</blockquote>\n<p>I'm a bit late to the party. In Lean without classical axioms, \"all functions are computable\" is a fine axiom. In Coq, we at some point worked towards a tactic doing computability proofs automatically. <a href=\"https://drops.dagstuhl.de/entities/document/10.4230/LIPIcs.ITP.2019.17\">https://drops.dagstuhl.de/entities/document/10.4230/LIPIcs.ITP.2019.17</a> it worked well-ish. In principle, it should be possible to do something similar if not better for Lean, if somebody wants to chat about that I'd be happy to -- but it would be a major project</p>",
        "id": 471208598,
        "sender_full_name": "Yannick Forster",
        "timestamp": 1726650621
    },
    {
        "content": "<p>Related: Martin Hairer once pointed out to me that without AC it's consistent that all functions are measurable, so there could in theory be a measurability tactic which just checks that the function was defined constructively and then says yes :-) However I would imagine that <code>fun_prop</code> deals with this situation more effectively.</p>",
        "id": 471212764,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726651730
    },
    {
        "content": "<p>I'm not sure how useful that observation is, given that almost anything involving the real numbers is not constructive in Mathlib.</p>",
        "id": 471213270,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1726651868
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/471212764\">said</a>:</p>\n<blockquote>\n<p>Related: Martin Hairer once pointed out to me that without AC it's consistent that all functions are measurable, so there could in theory be a measurability tactic which just checks that the function was defined constructively and then says yes :-) However I would imagine that <code>fun_prop</code> deals with this situation more effectively.</p>\n</blockquote>\n<p>Probably one could even write a tactic which given any constructively defined function constructs a proof of measurability -- for the same reason why one can write one that gives computability proofs</p>",
        "id": 471213745,
        "sender_full_name": "Yannick Forster",
        "timestamp": 1726651995
    },
    {
        "content": "<p>His actual observation was that you could also assume countable dependent choice and still have a model with all functions measurable</p>",
        "id": 471213808,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726652016
    },
    {
        "content": "<p>This just implies that you can't construct a function which is provably immeasurable, I don't see why it implies that all functions you can construct are provably measurable</p>",
        "id": 471218412,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726653417
    },
    {
        "content": "<p>Yes I guess you're right. I'll tell Hairer that his papers have holes in.</p>",
        "id": 471218936,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1726653566
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/471156368\">said</a>:</p>\n<blockquote>\n<p>Yes! If we have some way to state there's only countably many computable numbers, that would be great too.</p>\n</blockquote>\n<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/16935\">https://github.com/leanprover-community/mathlib4/pull/16935</a></p>",
        "id": 471374565,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726707605
    },
    {
        "content": "<p>Talking about computable numbers, I guess there's a negative to the division by zero convention—it means that the field structure on the computable numbers isn't computable</p>",
        "id": 471387466,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726715184
    },
    {
        "content": "<p>What can be done computability for them? <code>NormedCommRing</code> and <code>StrictOrderedCommRing</code>?</p>",
        "id": 471388571,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726715831
    },
    {
        "content": "<p>Would you define a computable real number as the equivalence class of a computable Cauchy sequence with a computable modulus of convergence?</p>",
        "id": 471390292,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726716811
    },
    {
        "content": "<p>That sounds reasonable, yes</p>",
        "id": 471391160,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726717261
    },
    {
        "content": "<p>Another option is to define an <code>Real.IsComputable</code> predicate</p>",
        "id": 471391825,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726717617
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"690858\">Daniel Weber</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/471387466\">said</a>:</p>\n<blockquote>\n<p>Talking about computable numbers, I guess there's a negative to the division by zero convention—it means that the field structure on the computable numbers isn't computable</p>\n</blockquote>\n<p>But the set of computable reals is still a field!</p>",
        "id": 471932347,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1726919562
    },
    {
        "content": "<p>that depends on what you mean by \"field\"</p>",
        "id": 471932602,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726919711
    },
    {
        "content": "<p>it's only closed under division by values apart from 0</p>",
        "id": 471932615,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726919726
    },
    {
        "content": "<p>Given a turing machine M, define a real number as <code>2^-n</code> if M halts in n steps, and <code>0</code> if it does not halt. This is a computable real number because you can get an n-digit approximation of it by running M for n steps. But the inverse of this real number is not computable unless you can decide the halting problem for M.</p>",
        "id": 471933106,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726920029
    },
    {
        "content": "<p>Assuming em either M halts (and then you can compute this number), or it doesn't, and then the number is 0 which is computable, so the inverse is always computable</p>",
        "id": 471933299,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726920126
    },
    {
        "content": "<p>in this example you don't actually know whether it is even legal to take the inverse unless you solve the halting problem for M. If I tell you it is not equal to 0, then classically we can say that the inverse is well defined and there exists a turing machine outputting the integral value but we don't know what it is</p>",
        "id": 471933431,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726920218
    },
    {
        "content": "<p>The inverse is computable if you're promised that the input number is non-zero, i.e. the function <code>inv : (x : Computable) -&gt; x ≠ 0 -&gt; Computable</code> is computable, but there's no computable function <code>inv0 : Computable -&gt; Computable</code> which agrees with it</p>",
        "id": 471933954,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726920568
    },
    {
        "content": "<p>Just compute the number with increasing accuracy until you separate it from zero and then it's fairly simple</p>",
        "id": 471934122,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726920683
    },
    {
        "content": "<p>you still need em for that argument</p>",
        "id": 471934907,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726921254
    },
    {
        "content": "<p>the proper intuitionistic version uses \"apart from 0\" instead of \"not equal to 0\"</p>",
        "id": 471934945,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726921279
    },
    {
        "content": "<p>i.e. there exists an <code>n</code> such that <code>|x| &gt;= 2^-n</code></p>",
        "id": 471934971,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726921297
    },
    {
        "content": "<p>but assuming em, there is a lean-computable function <code>Computable -&gt; x != 0 -&gt; Computable</code></p>",
        "id": 471935060,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726921338
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/471934907\">said</a>:</p>\n<blockquote>\n<p>you still need em for that argument</p>\n</blockquote>\n<p>Only for the termination proof, not the computation</p>",
        "id": 471935061,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726921338
    },
    {
        "content": "<p>By the way, I noticed that <code>Computable.ite</code> is missing in <code>Partrec.lean</code>, maybe worth adding?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ite</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span>\n<span class=\"w\">     </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"bp\">.</span><span class=\"n\">of_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Computable</span><span class=\"bp\">.</span><span class=\"n\">cond</span><span class=\"w\"> </span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">hg</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Bool</span><span class=\"bp\">.</span><span class=\"n\">cond_eq_ite_iff</span><span class=\"o\">])</span>\n</code></pre></div>",
        "id": 471963663,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726942812
    },
    {
        "content": "<p>it's basically the same as <code>cond</code> though with that spelling</p>",
        "id": 471964089,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726943191
    },
    {
        "content": "<p>which btw can be written as <code>bif a then b else c</code></p>",
        "id": 471964099,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726943206
    },
    {
        "content": "<p>Right. I just noticed there's <code>Primrec.ite</code> so then I expected to find <code>Computable.ite</code> as well... but had to prove it instead</p>",
        "id": 471964492,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726943548
    },
    {
        "content": "<p>I mean that you are not taking a propositional argument so there is no advantage to using <code>if</code> there, you can just use <code>bif</code> instead</p>",
        "id": 471964724,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1726943781
    },
    {
        "content": "<p>Ah, I see. How about this one instead: <a href=\"https://github.com/leanprover-community/mathlib4/pull/17039\">#17039</a></p>",
        "id": 471965452,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1726944420
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/471932602\">said</a>:</p>\n<blockquote>\n<p>that depends on what you mean by \"field\"</p>\n</blockquote>\n<p>Well, the set is closed under all the operations, isn't it? It's just that you can't necessarily decide what they evaluate as</p>",
        "id": 472001619,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1726976975
    },
    {
        "content": "<p>I think Mario's point is that constructively it's only closed to division by values apart from zero, not by values not equal to it</p>",
        "id": 472002027,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726977276
    },
    {
        "content": "<p>That makes sense. But \"the computable numbers are a field\" is a claim I've definitely seen before.</p>",
        "id": 472453276,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727171989
    },
    {
        "content": "<p>Like, the function <code>ℕ → ℝ</code> where <code>f n = 0</code> if the nth turing machine (under some enumeration) halts and <code>f n = 1</code> otherwise, only takes on computable values, even if it's not itself computable.</p>",
        "id": 472453681,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727172076
    },
    {
        "content": "<p>Something similar should happen for division of computable numbers</p>",
        "id": 472453724,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727172087
    },
    {
        "content": "<p>And that's a result I think would be worth having in Mathlib.</p>",
        "id": 472453795,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1727172101
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/472453681\">said</a>:</p>\n<blockquote>\n<p>Like, the function <code>ℕ → ℝ</code> where <code>f n = 0</code> if the nth turing machine (under some enumeration) halts and <code>f n = 1</code> otherwise, only takes on computable values, even if it's not itself computable.</p>\n</blockquote>\n<p>In this analogy I think what happens is that constructively you can't prove that</p>",
        "id": 472455116,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1727172410
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/472453276\">said</a>:</p>\n<blockquote>\n<p>That makes sense. But \"the computable numbers are a field\" is a claim I've definitely seen before.</p>\n</blockquote>\n<p>Because paper math <code>Field</code> allows to leave division by zero undefined, unlike lean</p>",
        "id": 472460545,
        "sender_full_name": "Luigi Massacci",
        "timestamp": 1727174273
    },
    {
        "content": "<p>I think the result of the discussion above is that the computable reals are a field, but the computable reals are not a computable field unless you make some subtle tweaks to the definition</p>",
        "id": 472478860,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727179968
    },
    {
        "content": "<p>You also run into the problem that given a program/code <code>c</code> it is quite hard to tell whether it represents a Cauchy sequence with computable modulus of convergence (something like second iteration of the halting problem, 0'').<br>\n<a href=\"https://link.springer.com/article/10.1007/s10469-017-9419-8\">Apparently</a> the characterization is that you need a high Turing degree,</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msub><mo>≥</mo><mi>T</mi></msub><msup><mn>0</mn><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">a&#x27;\\ge_T 0&#x27;&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9519em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\">≥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>(By the way I wrote a whole file about many-one reducibility only to finally discover <span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> 's <code>reduce.lean</code>...<br>\nlooking forward to checking that out though.)</p>",
        "id": 472582395,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727216668
    },
    {
        "content": "<p>did I write something on reducibility?</p>",
        "id": 472584869,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727218323
    },
    {
        "content": "<p><a href=\"https://tqft.net/mathlib4files/Computability/Reduce\">file#Computability/Reduce</a> seems that way</p>",
        "id": 472584946,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727218397
    },
    {
        "content": "<p>I guess you're the second author. <a href=\"https://github.com/leanprover-community/mathlib4/blob/b479ce63ba159bc287f99242ed9fb313ea7668da/Mathlib/Computability/Reduce.lean#L37-L38\">File</a></p>",
        "id": 472584947,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727218397
    },
    {
        "content": "<p>I think I reviewed this but did not write most of it</p>",
        "id": 472584965,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727218414
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"347475\">Bjørn Kjos-Hanssen ☀️</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/472582395\">said</a>:</p>\n<blockquote>\n<p>You also run into the problem that given a program/code <code>c</code> it is quite hard to tell whether it represents a Cauchy sequence with computable modulus of convergence</p>\n</blockquote>\n<p>But generally you won't be asked to determine this in the first place. Obviously determining whether a given real is computable is also hard</p>",
        "id": 472585071,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727218504
    },
    {
        "content": "<p>I think you would just bake into the definition that a computable real is one for which there is a turing machine which spits out approximations with a fixed modulus of convergence (e.g. <code>2^-n</code>)</p>",
        "id": 472585132,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727218561
    },
    {
        "content": "<p><a href=\"https://math.hawaii.edu/home/talks/csima_talk.pdf\">Usually</a> in computability theory we say a structure A is computable if it has domain Nat and all functions and relations on A are computable.</p>",
        "id": 472586796,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727219606
    },
    {
        "content": "<p>There's no computable structure with operations +, * (of course, not the usual such operations on Nat) that's isomorphic to the computable reals (by the paper I linked to)</p>",
        "id": 472587331,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727219994
    },
    {
        "content": "<p>isomorphic to the computable reals sounds like it is asking for too much, in particular it will be a surjection onto the computable reals and not a bijection because equality is not decidable</p>",
        "id": 472591467,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727223233
    },
    {
        "content": "<p>but also having domain Nat sounds like too much to ask for, this is a total function between subtypes of Nat</p>",
        "id": 472591578,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727223313
    },
    {
        "content": "<p>i.e. it is only required to have sensible behavior on inputs satisfying a condition, not necessarily decidable, but all such inputs have to produce elements in the target satisfying the condition</p>",
        "id": 472591673,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727223376
    },
    {
        "content": "<p>This is the natural notion you get out of the type theoretic reading of computability</p>",
        "id": 472591706,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727223423
    },
    {
        "content": "<p>I think I basically disagree with the definition in that presentation, or at least, it's not sufficiently considering what it means to have computable functions on types that are not Nat</p>",
        "id": 472591984,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727223671
    },
    {
        "content": "<p>Maybe we can call your notion \"computable relative to the domain\" or \"given the domain\"</p>",
        "id": 472592108,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727223767
    },
    {
        "content": "<p>what would it mean for a function to be computable not relative to its own domain?</p>",
        "id": 472592516,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224134
    },
    {
        "content": "<p>This is just like the observation that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mi mathvariant=\"double-struck\">R</mi><mo>∖</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo><mo>↦</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>x</mi><mo>:</mo><mi mathvariant=\"double-struck\">R</mi><mo>∖</mo><mo stretchy=\"false\">{</mo><mn>0</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">x\\in\\mathbb{R}\\setminus\\{0\\}\\mapsto 1/x : \\mathbb{R}\\setminus\\{0\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∖</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">↦</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∖</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mclose\">}</span></span></span></span> is a continuous function</p>",
        "id": 472592633,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224215
    },
    {
        "content": "<p>I mean, the indicator function for the halting set, restricted to the halting set, is computable given its domain, i.e., it is the constant function 1 on its domain. But its graph is not computable in the ambient space.</p>",
        "id": 472592726,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727224286
    },
    {
        "content": "<p>relative to a larger domain, it is a partial function and therefore not computable but partial recursive, but that's a different function we're talking about</p>",
        "id": 472592750,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224308
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"347475\">Bjørn Kjos-Hanssen ☀️</span> <a href=\"#narrow/stream/217875-Is-there-code-for-X.3F/topic/by.20decide.20implies.20Computable/near/472592726\">said</a>:</p>\n<blockquote>\n<p>I mean, the indicator function for the halting set, restricted to the halting set, is computable given its domain, i.e., it is the constant function 1 on its domain. But its graph is not computable in the ambient space.</p>\n</blockquote>\n<p>I think it is fair to say that the halting problem is decidable when restricted to turing machines that halt</p>",
        "id": 472592868,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224402
    },
    {
        "content": "<p>For a computable field we should (acc. to common definition) be able to write down multiplication and addition tables showing how the elements interact... but for the computable reals you don't know what the elements are and you can't.</p>",
        "id": 472592997,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727224539
    },
    {
        "content": "<p>For addition and multiplication I fail to see the issue?</p>",
        "id": 472593201,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224718
    },
    {
        "content": "<p>You can calculate approximations within any given precision given TMs for the inputs which provide approximations within any given precision</p>",
        "id": 472593256,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224777
    },
    {
        "content": "<p>I mean it's not really a <em>table</em> so much as a functional program but you can write it down</p>",
        "id": 472593351,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224843
    },
    {
        "content": "<p>this is how exact real arithmetic libraries work</p>",
        "id": 472593370,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727224863
    },
    {
        "content": "<p>Suppose I wanted to know if there's a square root of 2 in a given field. In a computable field I can fix my 1 and then 2=1+1 and then check all the x's one at a time. If there's an x with x^2=2 I eventually find it.<br>\nIn a field where I don't know the domain, I can't do that [of course in the computable reals we know sqrt(2) exists but I think you see my point]</p>",
        "id": 472593490,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727224960
    },
    {
        "content": "<p>no I don't think I do see your point. Enumeration is not the way to construct computable reals</p>",
        "id": 472593613,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727225051
    },
    {
        "content": "<p>because it implies that \"checking\" is even a thing you can do</p>",
        "id": 472593627,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727225068
    },
    {
        "content": "<p>What you are showing is that a particular bad algorithm doesn't work, that doesn't show that no algorithm exists</p>",
        "id": 472593676,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727225113
    },
    {
        "content": "<p>and indeed one does exist, you can implement square root on computable reals too</p>",
        "id": 472593692,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727225134
    },
    {
        "content": "<p>Okay how about this.... the structure <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi><mo>:</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"double-struck\">Q</mi><mo separator=\"true\">,</mo><mo>+</mo><mo separator=\"true\">,</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q := (\\mathbb Q,+,\\cdot)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbb\">Q</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">+</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">⋅</span><span class=\"mclose\">)</span></span></span></span> is computable in the sense that <em>there exist computable functions <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span> on <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>Q</mi></mrow><annotation encoding=\"application/x-tex\">Q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">Q</span></span></span></span> is isomorphic to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"double-struck\">N</mi><mo separator=\"true\">,</mo><mi>f</mi><mo separator=\"true\">,</mo><mi>g</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbb N,f,g)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbb\">N</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mclose\">)</span></span></span></span></em>. In that same sense, the structure <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mtext>ComputableReals</mtext><mo separator=\"true\">,</mo><mo>+</mo><mo separator=\"true\">,</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\text{ComputableReals},+,\\cdot)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">ComputableReals</span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">+</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">⋅</span><span class=\"mclose\">)</span></span></span></span> is not computable. That's an interesting difference (to some people, part of the time...) but what you want to call it is of course a sociological question.</p>",
        "id": 472595731,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727226768
    },
    {
        "content": "<p>(<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">N</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">N</span></span></span></span> could be replaced by <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">}</mo><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\{0,1\\}^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">}</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span> (finite strings) or your favorite nice discrete type here)</p>",
        "id": 472596432,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727227266
    },
    {
        "content": "<p>that definition explicitly excludes any type <code>Q</code> which is not bijective with <code>Nat</code>, and even for those that are denumerable it doesn't allow for types that have complex well formedness conditions and/or have no natural bijection to <code>Nat</code></p>",
        "id": 472712088,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727274812
    },
    {
        "content": "<p>There are plenty of examples like \"the strings accepted by regular language <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>\" which, even if they are denumerable, would result in a bijection so complex that the asymptotic complexity of basic operations is thrown completely off</p>",
        "id": 472712756,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727274969
    },
    {
        "content": "<p>which is why I argue that this is the wrong definition</p>",
        "id": 472712988,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727275035
    },
    {
        "content": "<p>How hard would it currently be to prove this kind of thing, i.e., basic computability facts in non-Nat types?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">PartrecCode</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Halting</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Computability</span><span class=\"bp\">.</span><span class=\"n\">Primrec</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">get_part</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">σ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Part</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">σ</span><span class=\"bp\">.</span><span class=\"n\">get?</span><span class=\"w\"> </span><span class=\"n\">k</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Partrec₂</span><span class=\"w\"> </span><span class=\"n\">get_part</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 473381741,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727554281
    },
    {
        "content": "<p>There are plenty of such proofs in Computability.Partrec</p>",
        "id": 473382906,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727555287
    },
    {
        "content": "<p>Note that your function is actually the composition of a primitive recursive function yielding <code>Option Bool</code> and the coercion from <code>Option A</code> to <code>Part A</code>, which is probably proved in there although I forget</p>",
        "id": 473383012,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727555413
    },
    {
        "content": "<p>I'm pretty sure <code>get?</code> is proved primrec</p>",
        "id": 473383025,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727555424
    },
    {
        "content": "<p>oh yes this is the composition of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Computable.ofOption#doc\">docs#Computable.ofOption</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Primrec.list_get%3F#doc\">docs#Primrec.list_get?</a></p>",
        "id": 473383089,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1727555510
    },
    {
        "content": "<p>Thanks! Sometimes, I search but I don't read...</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Partrec₂</span><span class=\"w\"> </span><span class=\"n\">get_part</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"bp\">.</span><span class=\"n\">ofOption</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Computable</span><span class=\"bp\">.</span><span class=\"n\">list_get?</span>\n</code></pre></div>",
        "id": 473384864,
        "sender_full_name": "Bjørn Kjos-Hanssen",
        "timestamp": 1727557138
    }
]