[
    {
        "content": "<p>I don't want the solution to this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cpos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cinvpos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|⁻¹</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|⁻¹</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"c1\">--linarith --failed, it's not linear</span>\n<span class=\"w\">  </span><span class=\"c1\">--nlinarith --failed</span>\n<span class=\"w\">  </span><span class=\"c1\">--simp? [h] -- made no progress</span>\n<span class=\"w\">  </span><span class=\"c1\">-- field_simp at h -- does nothing, it's not an equality</span>\n<span class=\"w\">  </span><span class=\"c1\">-- bound -- failed</span>\n<span class=\"w\">  </span><span class=\"c1\">-- grind -- failed</span>\n<span class=\"w\">  </span><span class=\"c1\">-- aesop -- failed</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">lt_div_iff₀'</span><span class=\"w\"> </span><span class=\"n\">cpos</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mp</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>to be <code>exact (lt_div_iff₀' cpos).mp h</code>. There should be some simple general tactic that can convert <code>h</code> into the goal, and I shouldn't have to quote a theorem like <code>lt_div_iff₀'</code>. Help please? Thank you!</p>",
        "id": 537619152,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1756975130
    },
    {
        "content": "<p>it would be <code>grw [h]; field_simp</code> after their proposed modification to change <code>&lt;</code> to <code>≤</code>, but alas the change hasn't happened yet so now you get <code>ε &lt; ε</code> <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 537620292,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1756975469
    },
    {
        "content": "<p>I think <code>field_simp at h</code> would ideally solve it. Not sure if that's feasible now with <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span> 's rewrite</p>",
        "id": 537621213,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1756975731
    },
    {
        "content": "<p>right now, <code>field_simp at h</code> just changes <code>h</code> to: <code>|a| &lt; ε / |c|</code> <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 537621979,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1756975978
    },
    {
        "content": "<p>Hence \"ideally\" :)</p>",
        "id": 537623451,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1756976441
    },
    {
        "content": "<p>Making <code>field_simp</code> handle inequalities is the next thing on the roadmap, but we didn't do it yet. (The new <code>field_simp</code> implementation is designed to support this.)  \"Handle inequalities\" precisely means that <code>field_simp</code> would perform <code>lt_div_iff₀' (by positivity)</code> (and friends).</p>",
        "id": 537666438,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1756990749
    },
    {
        "content": "<p>Thanks Heather, that's great! If I may ask, hopefully without putting you on the spot too much: what are the chances that it'll get done by next Fri? (Which is when I have in mind to assign a certain problem...) I'm guessing I should change the problem, and circle back around to this one... Actually an awful lot of what I have in mind to cover in the Real Analysis Game will be very much helped by this improved <code>field_simp</code> behavior.... :) Thanks again for your work on it, I really appreciate it!!</p>",
        "id": 537678617,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1756994138
    },
    {
        "content": "<p>You might be able to copy the code from the branch, even if it's not merged by then. But that assumes it's finished by then.</p>",
        "id": 537774121,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1757031436
    },
    {
        "content": "<p>Oh, good point! I can add custom tactics... (Well, I can ask <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span> very nicely and maybe he'll help <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span> ...) <span class=\"user-mention\" data-user-id=\"260507\">@Heather Macbeth</span>: How hard would it be to just jerry-rig an imperfect <code>field_simp</code> that can handle this inequality, so I don't have to wait for the \"official\" version to make it into Mathlib...? Thank you!</p>",
        "id": 537776906,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1757033961
    },
    {
        "content": "<p>I can copy working code from a PR into your game if such a PR works and compiles (and isn't too huge). I can also copy-paste other tactic code into your game and change the syntax slightly, for example some easy changes like \"<code>field_simp</code> should always execute <code>field_simp; another_tactic</code> instead\".</p>\n<p>I haven't looked at the <code>field_simp</code> code but if it requires deeper (new) changes within to make it work for inequalities, it's probably too much effort to do that just for the game.</p>\n<p>If you want a \"nicer\" solution, maybe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hc</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cpos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cinvpos</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|⁻¹</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|⁻¹</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"n\">c</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">mul_lt_mul_left</span><span class=\"w\"> </span><span class=\"n\">cpos</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">field_simp</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">h</span>\n</code></pre></div>\n<p>could be conceptually nicer to do?</p>",
        "id": 537804485,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1757055475
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"252920\">Alex Kontorovich</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Tactic.20for.20stupid.20inequality/near/537678617\">said</a>:</p>\n<blockquote>\n<p>Thanks Heather, that's great! If I may ask, hopefully without putting you on the spot too much: what are the chances that it'll get done by next Fri?</p>\n</blockquote>\n<p>OK I wrote this :-) <a href=\"https://github.com/leanprover-community/mathlib4/pull/29364\">#29364</a></p>",
        "id": 537834444,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1757066154
    },
    {
        "content": "<p>I'm not sure whether it handles all the edge cases, and I'm sure mathlib review will improve the code, but this may already be good enough for your purposes. Can you base your game off this mathlib branch?</p>",
        "id": 537834650,
        "sender_full_name": "Heather Macbeth",
        "timestamp": 1757066239
    },
    {
        "content": "<p>Oh that's fantastic, thank you!! <span class=\"user-mention\" data-user-id=\"385895\">@Jon Eugster</span>, is it possible to extract from this PR something that I can upload to my game and experiment with it? Thank you!!</p>",
        "id": 537869231,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1757078402
    },
    {
        "content": "<p>Continuing these ideas: Any suggestions for how to get this to work? I'm willing to quote the theorem <code>Nat.le_ceil</code>, but I don't want to quote more than that... Thanks!!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hε</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"bp\">⌈</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"n\">ε</span><span class=\"bp\">⌉₊</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"bp\">⌈</span><span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"n\">ε</span><span class=\"bp\">⌉₊</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">le_ceil</span>\n<span class=\"c\">/-</span><span class=\"cm\"> Goal state is now:</span>\n<span class=\"cm\">ε : ℝ</span>\n<span class=\"cm\">hε : 0 &lt; ε</span>\n<span class=\"cm\">this : 1 / ε ≤ ↑⌈1 / ε⌉₊</span>\n<span class=\"cm\">⊢ 1 / ε &lt; ↑(⌈1 / ε⌉₊ + 1)</span>\n<span class=\"cm\">-/</span>\n<span class=\"w\">  </span><span class=\"n\">norm_cast</span>\n<span class=\"c\">/-</span><span class=\"cm\"> Did not change</span>\n<span class=\"cm\">**⊢ 1 / ε &lt; ↑(⌈1 / ε⌉₊ + 1)**</span>\n<span class=\"cm\">to</span>\n<span class=\"cm\">**⊢ 1 / ε &lt; ↑(⌈1 / ε⌉₊) + 1**</span>\n<span class=\"cm\">and therefore</span>\n<span class=\"cm\">-/</span>\n<span class=\"w\">  </span><span class=\"n\">linarith</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>",
        "id": 537876141,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1757080427
    },
    {
        "content": "<p>Try <code>push_cast</code> in place of <code>norm_cast</code>.</p>",
        "id": 537879043,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1757081165
    },
    {
        "content": "<p>(<code>push_cast</code> pushes coercions inwards, which is what you want here.)</p>",
        "id": 537879192,
        "sender_full_name": "Michael Stoll",
        "timestamp": 1757081201
    },
    {
        "content": "<p>Thanks, that's what I was missing here...</p>",
        "id": 537888448,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1757083913
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"252920\">Alex Kontorovich</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Tactic.20for.20stupid.20inequality/near/537869231\">said</a>:</p>\n<blockquote>\n<p>Oh that's fantastic, thank you!! <span class=\"user-mention silent\" data-user-id=\"385895\">Jon Eugster</span>, is it possible to extract from this PR something that I can upload to my game and experiment with it? Thank you!!</p>\n</blockquote>\n<p><a href=\"https://github.com/AlexKontorovich/RealAnalysisGame/pull/7\">https://github.com/AlexKontorovich/RealAnalysisGame/pull/7</a> should do the trick. I've bumped lean4game to v4.23-rc2 and imported that in your game. I didn't test anything though, didn't even check if CI passes <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span> </p>\n<p>I guess whenever Heather pushes to her branch, you can run <code>lake update -R mathlib</code> to get that newest version. (At least as long as neither the Lean version nor the Batteries commit used in that branch changes.)</p>",
        "id": 537912281,
        "sender_full_name": "Jon Eugster",
        "timestamp": 1757091875
    },
    {
        "content": "<p>Thank you!! I'll try it out...</p>",
        "id": 537933027,
        "sender_full_name": "Alex Kontorovich",
        "timestamp": 1757099818
    }
]