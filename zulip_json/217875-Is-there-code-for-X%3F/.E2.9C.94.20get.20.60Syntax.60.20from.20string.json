[
    {
        "content": "<p>how to get a term of <code>Syntax</code> from a <code>String</code>?</p>\n<p>for example, how to get corresponding Syntax term from <code>1 + 1</code></p>",
        "id": 482783058,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731774137
    },
    {
        "content": "<p>from the looks of it, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Parser/Extension.html#Lean.Parser.runParserCategory\">Lean.Parser.runParserCategory</a> might be of use... it doesn't seem to be intended for this purpose though...</p>",
        "id": 482783513,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1731774507
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Lean.Parser -&gt; String -&gt; _</p>",
        "id": 482789114,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731779267
    },
    {
        "content": "<p><span aria-label=\"exclamation\" class=\"emoji emoji-2757\" role=\"img\" title=\"exclamation\">:exclamation:</span> unknown identifier 'Lean.Parser'</p>",
        "id": 482789116,
        "sender_full_name": "loogle",
        "timestamp": 1731779268
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> Lean.Parser.Parser -&gt; String -&gt; _</p>",
        "id": 482789171,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1731779301
    },
    {
        "content": "<p><span aria-label=\"search\" class=\"emoji emoji-1f50d\" role=\"img\" title=\"search\">:search:</span> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Parser/Basic.html#Lean.Parser.dbgTraceState\">Lean.Parser.dbgTraceState</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Parser/Basic.html#Lean.Parser.notFollowedBy\">Lean.Parser.notFollowedBy</a>, and <a href=\"https://loogle.lean-lang.org/?q=Lean.Parser.Parser%20-%3E%20String%20-%3E%20_\">7 more</a></p>",
        "id": 482789172,
        "sender_full_name": "loogle",
        "timestamp": 1731779301
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"684366\">@Edward van de Meent</span> That's what that function is for.</p>",
        "id": 482789677,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731779774
    },
    {
        "content": "<p>the docs say it's only for testing</p>",
        "id": 482789696,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1731779799
    },
    {
        "content": "<p>Speaking of loogle, it has a variant of it for running arbitrary parsers, not just parser categories: <a href=\"https://github.com/nomeata/loogle/blob/4e1aab07fa10f263a2110787180f8f5db93ee650/Loogle.lean#L16-L27\">https://github.com/nomeata/loogle/blob/4e1aab07fa10f263a2110787180f8f5db93ee650/Loogle.lean#L16-L27</a></p>",
        "id": 482789711,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731779819
    },
    {
        "content": "<p>nice!</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Parser</span>\n\n<span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Syntax</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ok</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">runParserCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getEnv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">  </span><span class=\"n\">return</span><span class=\"w\"> </span><span class=\"n\">s</span>\n\n<span class=\"sd\">/-- info: (Command.eval \"#eval\" (str \"\\\"hello\\\"\")) -/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"w\">  </span><span class=\"n\">run_meta</span><span class=\"w\"> </span><span class=\"n\">IO.println</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"ss\">`command</span><span class=\"w\"> </span><span class=\"s2\">\"#eval </span><span class=\"se\">\\\"</span><span class=\"s2\">hello</span><span class=\"se\">\\\"</span><span class=\"s2\">\"</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 482789726,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731779836
    },
    {
        "content": "<p>It says it's for testing, but I'm pretty sure that's because most applications will use the interfaces it uses directly — generally you want to read from a file, not parse a string. For example, the Lean frontend uses <code>mkInputContext</code> and then repeatedly runs the <code>command</code> parser on it (with some error recovery features — in particular if <code>command</code> fails, it will read tokens one at a time and retry)</p>",
        "id": 482789818,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731779926
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"626349\">@Asei Inoue</span> I think you might like <code>ofExcept</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Name</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">String</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MetaM</span><span class=\"w\"> </span><span class=\"n\">Syntax</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"n\">ofExcept</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">runParserCategory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getEnv</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">cat</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>",
        "id": 482789933,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1731780022
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"306601\">@Kyle Miller</span> Thanks.</p>",
        "id": 482790221,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1731780258
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626349\">Asei Inoue</span> has marked this topic as resolved.</p>",
        "id": 482879591,
        "sender_full_name": "Notification Bot",
        "timestamp": 1731863785
    }
]