[
    {
        "content": "<p>Is there a tactic that can only be proved if the ‘really’ goal is a = a?</p>\n<p>it should be able to prove <code>1 = 1</code> but not able to prove  <code>2 = 1 + 1</code></p>",
        "id": 471752790,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1726843976
    },
    {
        "content": "<p>You can try <code>with_reducible rfl</code> (that is able to prove <code>1+1=2</code> though)</p>",
        "id": 471754106,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1726844254
    },
    {
        "content": "<p>You can write something that checks for syntactical equality before applying <code>rfl</code></p>",
        "id": 471754425,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1726844306
    },
    {
        "content": "<p>This is a possible approach:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"bp\">.</span><span class=\"n\">Elab</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Lean</span><span class=\"w\"> </span><span class=\"n\">Elab</span><span class=\"w\"> </span><span class=\"n\">Tactic</span>\n\n<span class=\"kn\">elab</span><span class=\"w\"> </span><span class=\"s2\">\"real_rfl\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"k\">do</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">lhs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rhs</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">getMainTarget</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">eq?</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">throwError</span><span class=\"w\"> </span><span class=\"s2\">\"Not an equality goal\"</span>\n<span class=\"w\">  </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">lhs</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">rhs</span><span class=\"w\"> </span><span class=\"k\">then</span>\n<span class=\"w\">    </span><span class=\"n\">evalTactic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"bp\">`</span><span class=\"o\">(</span><span class=\"n\">tactic</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"k\">else</span>\n<span class=\"w\">    </span><span class=\"n\">logWarning</span><span class=\"w\"> </span><span class=\"s2\">\"Not a 'real' equality\"</span>\n\n<span class=\"sd\">/-- error: Not an equality goal -/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">True</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">real_rfl</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">warning: Not a 'real' equality</span>\n<span class=\"sd\">-/</span>\n<span class=\"bp\">#</span><span class=\"n\">guard_msgs</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">real_rfl</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">real_rfl</span>\n</code></pre></div>",
        "id": 471758229,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1726845094
    },
    {
        "content": "<p>You can take a look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Std.Tactic.Lint.synTaut#src\">src#Std.Tactic.Lint.synTaut</a>, the syntactic tautology linter.</p>",
        "id": 471758433,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1726845129
    },
    {
        "content": "<p>It looks like the syntactic tautology also handles <code>iff</code>.</p>",
        "id": 471759069,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1726845290
    },
    {
        "content": "<p>(and introduces the telescopes)</p>",
        "id": 471759299,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1726845344
    },
    {
        "content": "<p>Thank you !!!</p>",
        "id": 471760800,
        "sender_full_name": "Asei Inoue",
        "timestamp": 1726845740
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"626349\">Asei Inoue</span> has marked this topic as resolved.</p>",
        "id": 471760809,
        "sender_full_name": "Notification Bot",
        "timestamp": 1726845742
    }
]