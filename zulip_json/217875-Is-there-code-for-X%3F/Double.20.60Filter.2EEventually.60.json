[
    {
        "content": "<p>I'm trying to prove the following:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span>\n\n<span class=\"kn\">example</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">≃ᵐ</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"bp\">≃ᵐ</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀ᵐ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">a₁</span><span class=\"w\"> </span><span class=\"n\">a₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∀ᵐ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e₁</span><span class=\"w\"> </span><span class=\"n\">b₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e₂</span><span class=\"w\"> </span><span class=\"n\">b₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>Is there a nice theorem which can handle double 'almost everywhere' easily?<br>\nAlso, this would easily come up with another version with a doubly nested <code>Filter.Eventually</code> (<code>∀ᶠ</code>). Do we have a tool to prove that as well?</p>",
        "id": 517281103,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746901428
    },
    {
        "content": "<p>Why do you have both <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.MeasurableSpace#doc\">docs#MeasureTheory.MeasurableSpace</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.MeasureSpace#doc\">docs#MeasureTheory.MeasureSpace</a></p>",
        "id": 517282099,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746902297
    },
    {
        "content": "<p>This will cause problems</p>",
        "id": 517282116,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746902318
    },
    {
        "content": "<p>I'm pretty sure to prove this you have to assume that <code>e₁</code> and <code>e₂</code> are <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Measure.QuasiMeasurePreserving#doc\">docs#MeasureTheory.Measure.QuasiMeasurePreserving</a></p>",
        "id": 517282699,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746902795
    },
    {
        "content": "<blockquote>\n<p>Why do you have both..</p>\n</blockquote>\n<p>Thanks, this is now fixed in the example.</p>\n<blockquote>\n<p>I'm pretty sure to prove this you have to assume that e₁ and e₂ are <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Measure.QuasiMeasurePreserving#doc\">docs#MeasureTheory.Measure.QuasiMeasurePreserving</a></p>\n</blockquote>\n<p>According to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasurableEquiv.quasiMeasurePreserving_symm#doc\">docs#MeasurableEquiv.quasiMeasurePreserving_symm</a> , they are already <code>QuasiMeasurePreserving</code>. </p>\n<p>Still, is there a nice way to deal with inner <code>∀ᵐ</code> or <code>∀ᶠ</code>s? I don't think there is a nice lemma dealing with these.</p>",
        "id": 517364527,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746972854
    },
    {
        "content": "<p>Nothing in your assumptions say that <code>e₁</code> or <code>e₂</code> play nicely with the measures.</p>",
        "id": 517364779,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1746973048
    },
    {
        "content": "<p>You only assume that they're measurable with measurable inverses.</p>",
        "id": 517364806,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1746973066
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"574112\">Jihoon Hyun</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Double.20.60Filter.2EEventually.60/near/517364527\">said</a>:</p>\n<blockquote>\n<p>According to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasurableEquiv.quasiMeasurePreserving_symm#doc\">docs#MeasurableEquiv.quasiMeasurePreserving_symm</a> , they are already <code>QuasiMeasurePreserving</code>. </p>\n</blockquote>\n<p>This says they are <code>QuasiMeasurePreserving</code> from <code>MeasureTheory.Measure.map (⇑e) volume</code> to <code>volume</code>, but I need it to be <code>QuasiMeasurePreserving</code> from <code>volume</code> to <code>volume</code>.</p>",
        "id": 517364814,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746973074
    },
    {
        "content": "<p>If you add <code>(h₁ : QuasiMeasurePreserving e₁)</code> and similarly for <code>e₂</code>, then you can <code>filter_upwards [h₁.ae h] with a ha using h₂.ae ha</code></p>",
        "id": 517365130,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1746973284
    },
    {
        "content": "<p>(not tested)</p>",
        "id": 517365133,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1746973288
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Double.20.60Filter.2EEventually.60/near/517365130\">said</a>:</p>\n<blockquote>\n<p><code>filter_upwards [h₁.ae h] with a ha using h₂.ae ha</code></p>\n</blockquote>\n<p>This does work</p>",
        "id": 517365286,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1746973386
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Double.20.60Filter.2EEventually.60/near/517365286\">말함</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/217875-Is-there-code-for-X.3F/topic/Double.20.60Filter.2EEventually.60/near/517365130\">said</a>:</p>\n<blockquote>\n<p><code>filter_upwards [h₁.ae h] with a ha using h₂.ae ha</code></p>\n</blockquote>\n<p>This does work</p>\n</blockquote>\n<p>Now I wonder why this works..</p>",
        "id": 517365307,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746973417
    },
    {
        "content": "<p>I only know that <code>filter_upwards</code> converts <code>∀ᵐ</code> into <code>∀</code>, but how does this work here?</p>",
        "id": 517365399,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746973481
    },
    {
        "content": "<p>You can hover over it to find out what it actually does (it's cleverer than just turning <code>∀ᵐ</code> into <code>∀</code>)</p>",
        "id": 517365456,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1746973531
    },
    {
        "content": "<p>Thanks, it should take some time for me to digest..</p>",
        "id": 517365578,
        "sender_full_name": "Jihoon Hyun",
        "timestamp": 1746973623
    },
    {
        "content": "<p>If you unfold everything, you get <code>(h₁.ae h).mono fun a ha =&gt; h₂.ae ha</code></p>",
        "id": 517379559,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1746983717
    }
]