[
    {
        "content": "<p>Hi, do you now if we have something like this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">RCLike</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fintype</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">InnerProductSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">FiniteDimensional</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">trace_eq_sum_inner_app_base_base_of_card_eq_finrank</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">â†’â‚—</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Orthonormal</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">card_eq</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fintype</span><span class=\"bp\">.</span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">finrank</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">trace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">âˆ‘</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Î¹</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inner</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I was not able to find it, and it does not seem easy to probe</p>",
        "id": 520444852,
        "sender_full_name": "IvÃ¡n Renison",
        "timestamp": 1748263944
    },
    {
        "content": "<p>I think the intermediate step should be to show that <code>b</code> forms an <code>OrthogonalBasis</code></p>",
        "id": 520446845,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748264453
    },
    {
        "content": "<p>What exactly do you mean?</p>",
        "id": 520448126,
        "sender_full_name": "IvÃ¡n Renison",
        "timestamp": 1748264788
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"644391\">@loogle</span> OrthogonalBasis</p>",
        "id": 520448132,
        "sender_full_name": "IvÃ¡n Renison",
        "timestamp": 1748264790
    },
    {
        "content": "<p><span aria-label=\"exclamation\" class=\"emoji emoji-2757\" role=\"img\" title=\"exclamation\">:exclamation:</span> unknown identifier 'OrthogonalBasis'<br>\nDid you mean <a href=\"https://loogle.lean-lang.org/?q=%22OrthogonalBasis%22\"><code>\"OrthogonalBasis\"</code></a>?</p>",
        "id": 520448137,
        "sender_full_name": "loogle",
        "timestamp": 1748264790
    },
    {
        "content": "<p>Whoops, I mean <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OrthonormalBasis#doc\">docs#OrthonormalBasis</a></p>",
        "id": 520451833,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748265717
    },
    {
        "content": "<p>But <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=basisOfOrthonormalOfCardEqFinrank#doc\">docs#basisOfOrthonormalOfCardEqFinrank</a> is more direct for what you need anywy</p>",
        "id": 520451894,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748265726
    },
    {
        "content": "<p>With that I can convert <code>trace ğ•œ E T</code> to <code>((toMatrix ba ba) T).trace</code>and then to <code>âˆ‘ i, toMatrix ba ba T i i</code>, but I don't now how that helps</p>",
        "id": 520455827,
        "sender_full_name": "IvÃ¡n Renison",
        "timestamp": 1748266723
    },
    {
        "content": "<p>I would hope you can then simplify away <code>toMatrix</code> somehow</p>",
        "id": 520456190,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748266817
    },
    {
        "content": "<p>I would guess to something like <code>(b i).coord (T (b i)</code>, and then there'll be a lemma soemwhere that says that's the inner product</p>",
        "id": 520456372,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748266874
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearMap.toMatrix_apply#doc\">docs#LinearMap.toMatrix_apply</a> is progress</p>",
        "id": 520456651,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748266948
    },
    {
        "content": "<p>And <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=OrthonormalBasis.repr_apply_apply#doc\">docs#OrthonormalBasis.repr_apply_apply</a> is the other piece</p>",
        "id": 520456820,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748266995
    },
    {
        "content": "<p>So I guess you do need an orthonormal basis after all, I suspect you can just find a version of <code>basisOfOrthonormalOfCardEqFinrank</code> for that</p>",
        "id": 520456910,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1748267021
    },
    {
        "content": "<p>With this I was able to prove it, thanks</p>",
        "id": 520461872,
        "sender_full_name": "IvÃ¡n Renison",
        "timestamp": 1748268299
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"646655\">IvÃ¡n Renison</span> has marked this topic as resolved.</p>",
        "id": 520464465,
        "sender_full_name": "Notification Bot",
        "timestamp": 1748268941
    }
]