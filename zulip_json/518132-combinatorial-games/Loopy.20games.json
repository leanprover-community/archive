[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/113488-general/topic/Combinatorial.20game.20theory.20repository/near/530923780\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"662714\">Django Peeters</span> <a href=\"#narrow/stream/113488-general/topic/Combinatorial.20game.20theory.20repository/near/530923501\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/113488-general/topic/Combinatorial.20game.20theory.20repository/near/530875200\">said</a>:</p>\n<blockquote>\n<p>(something similar applies to loopy games, we'll eventually have to define a new data type to represent those as well!)</p>\n</blockquote>\n<p>How about a pointed, directed graph where the directed edges can only have 1 of 2 colours, where the chosen point is a vertex representing the starting position.</p>\n</blockquote>\n<p>I have a work in progress definition of loopy games as a subquotient of countably deep u-small branching trees</p>\n</blockquote>",
        "id": 531041627,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753582149
    },
    {
        "content": "<p>Do you have any Lean code? I'm interested to see how this looks.</p>",
        "id": 531041686,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753582179
    },
    {
        "content": "<p>I have some code</p>",
        "id": 531041709,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753582185
    },
    {
        "content": "<p>It's only on my local device at the moment</p>",
        "id": 531041765,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753582206
    },
    {
        "content": "<p>Since the class field theory workshop is over now I can start working on this again</p>",
        "id": 531041846,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753582242
    },
    {
        "content": "<p>So after <code>IGame</code> is constructed there is some API, some of which I will list out here</p>\n<ul>\n<li><code>IGame.leftMoves</code></li>\n<li><code>IGame.rightMoves</code></li>\n<li><code>IGame.ext</code></li>\n<li><code>IGame.IsOption</code></li>\n<li><code>IGame.IsOption.of_mem_leftMoves</code></li>\n<li><code>IGame.IsOption.of_mem_rightMoves</code></li>\n<li><code>IGame.instSmallSubtypeIsOption</code></li>\n<li><code>IGame.isOption_wf</code></li>\n<li><code>IGame.ofSets</code></li>\n<li><code>IGame.leftMoves_ofSets</code></li>\n<li><code>IGame.rightMoves_ofSets</code></li>\n</ul>\n<p>This list of API is sufficient to characterize <code>IGame</code>, so that you never have to touch <code>PGame</code> ever again. This is because between any two types which both implement this API there exists a unique API-preserving isomorphism between them.</p>",
        "id": 531126257,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753617555
    },
    {
        "content": "<p>So after I make loopy games, what API should I provide which uniquely characterizes them? I'm thinking of providing a destructor and some corecursion, but this is not sufficient since you can prove an isomorphism but not the fact that it's unique.</p>",
        "id": 531126499,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753617647
    },
    {
        "content": "<p>I'm still having a hard time figuring out what a loopy game even is, as a mathematical structure.</p>",
        "id": 531129729,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753618837
    },
    {
        "content": "<p>The literature seems to define them in terms of graphs, but I can get not wanting to do that since it leads to some degenerate cases, such as a game 0 -&gt; 1 -&gt; ... -&gt; infty where the last node isn't even accessible in finitely many moves</p>",
        "id": 531130043,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753618954
    },
    {
        "content": "<p>It's like a game but coinductive, right?</p>",
        "id": 531130058,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753618964
    },
    {
        "content": "<p>I think so, but I don't really know how that translates in Lean</p>",
        "id": 531130105,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753618983
    },
    {
        "content": "<p>However it translates into Lean doesn't matter as long as you have all the API</p>",
        "id": 531130193,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619013
    },
    {
        "content": "<p>The question is, what should the API be?</p>",
        "id": 531130218,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619022
    },
    {
        "content": "<p>Well, I presume we should still have left and right move sets, which should still be small, and should still satisfy extentionality</p>",
        "id": 531130570,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753619165
    },
    {
        "content": "<p>I presume we would also have an <code>ofSets</code> constructor</p>",
        "id": 531130635,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753619189
    },
    {
        "content": "<p>But we'd also need some other way to construct games which are subsequent to themselves</p>",
        "id": 531130671,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753619202
    },
    {
        "content": "<p>some sort of fixpoint combinator, then?</p>",
        "id": 531130764,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619236
    },
    {
        "content": "<p>or corecursion like I mentioned</p>",
        "id": 531130799,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619249
    },
    {
        "content": "<p>I still don't quite understand how to construct terms in a coinductive type</p>",
        "id": 531130920,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753619299
    },
    {
        "content": "<p>you do it with corecursion</p>",
        "id": 531130979,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619324
    },
    {
        "content": "<p>in mathlib for example we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Computation.corec#doc\">docs#Computation.corec</a> <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Stream%27.corec%27#doc\">docs#Stream'.corec'</a> <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Stream%27.Seq.corec#doc\">docs#Stream'.Seq.corec</a> <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PFunctor.M.corec#doc\">docs#PFunctor.M.corec</a></p>",
        "id": 531131153,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619396
    },
    {
        "content": "<p>oh if this is a polynomial functor then we can use what's in mathlib already</p>",
        "id": 531131246,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619424
    },
    {
        "content": "<p>I'll go take a look at that, Wikipedia really isn't helping me much</p>",
        "id": 531131254,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753619427
    },
    {
        "content": "<p>hold on I'm unpacking what it means to be a final coalgebra</p>",
        "id": 531132102,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619731
    },
    {
        "content": "<p>maybe if this is correct we can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PFunctor.M#doc\">docs#PFunctor.M</a></p>",
        "id": 531132133,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619745
    },
    {
        "content": "<p>I think what we actually need is M-types for quotients of polynomial functors</p>",
        "id": 531132528,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753619900
    },
    {
        "content": "<p>oh it's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QPF.Cofix#doc\">docs#QPF.Cofix</a></p>",
        "id": 531132943,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753620067
    },
    {
        "content": "<p>amazing</p>",
        "id": 531132985,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753620084
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531130043\">said</a>:</p>\n<blockquote>\n<p>The literature seems to define them in terms of graphs, but I can get not wanting to do that since it leads to some degenerate cases, such as a game 0 -&gt; 1 -&gt; ... -&gt; infty where the last node isn't even accessible in finitely many moves</p>\n</blockquote>\n<p>How does it lead to that degenerate case?</p>",
        "id": 531167022,
        "sender_full_name": "Django Peeters",
        "timestamp": 1753632483
    },
    {
        "content": "<p>Well, the graph I describe is simple enough to define.</p>",
        "id": 531199797,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753645089
    },
    {
        "content": "<p>you have to quotient to get the right notion of equality</p>",
        "id": 531199967,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753645165
    },
    {
        "content": "<p>I have a half-working definition using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QPF.Cofix#doc\">docs#QPF.Cofix</a></p>\n<div class=\"spoiler-block\"><div class=\"spoiler-header\">\n<p>here it is</p>\n</div><div class=\"spoiler-content\" aria-hidden=\"true\">\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"c\">/-</span>\n<span class=\"cm\">Copyright (c) 2025 Aaron Liu. All rights reserved.</span>\n<span class=\"cm\">Released under Apache 2.0 license as described in the file LICENSE.</span>\n<span class=\"cm\">Authors: Aaron Liu</span>\n<span class=\"cm\">-/</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Univariate</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Logic</span><span class=\"bp\">.</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"n\">Set</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">Defs</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Loopy Games</span>\n\n<span class=\"cm\">We define loopy games and prove some basic properties.</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">v</span>\n\n<span class=\"c1\">-- mathlib4 PR #27541</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_plift</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">PLift</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">small_map</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">plift</span>\n\n<span class=\"c1\">-- mathlib4 PR #27546</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_quot</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quot</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">small_of_surjective</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">mk_surjective</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_quotient</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">small_of_surjective</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">mk_surjective</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_succ'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">small_lift</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span>\n\n<span class=\"kn\">section</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"n\">out</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"o\">)),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">repr</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Shrink</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Shrink</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">sumArrowEquivProdArrow</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">outMkEquiv</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">down</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:),</span>\n<span class=\"w\">    </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">outMkEquiv</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">down</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:))</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">abs_repr</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"o\">((((</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">plift</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">outMkEquiv</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">range_coe</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">((((</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">plift</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">Cardinal</span><span class=\"bp\">.</span><span class=\"n\">outMkEquiv</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">surjective</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">range_coe</span><span class=\"o\">))</span>\n<span class=\"w\">  </span><span class=\"n\">abs_map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"o\">)))</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">LGame</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_leftMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_rightMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eq_of_bisim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≃</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"bp\">.</span><span class=\"n\">bisim</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">el</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hel</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">er</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">her</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">el</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">hel</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">er</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">her</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">⟩</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_def</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">el</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">er</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span>\n<span class=\"w\">      </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">]</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">ext</span><span class=\"kd\">]</span>\n<span class=\"kn\">protected</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">eq_of_bisim</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hij</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">hij</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩⟩</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">hij</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">hij</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"w\"> </span><span class=\"bp\">▸</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩⟩</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">section</span><span class=\"w\"> </span><span class=\"n\">corec</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">init</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofLeftMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">ofRightMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_reachable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Sigma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">induction</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">zero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">suffices</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Subsingleton</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Sigma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span>\n<span class=\"w\">    </span><span class=\"n\">constructor</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">la</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ra</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">lb</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rb</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">ra</span>\n<span class=\"w\">    </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">rb</span>\n<span class=\"w\">    </span><span class=\"n\">rfl</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">succ</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">ih</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">suffices</span><span class=\"w\"> </span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sigma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">≃</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sigma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">×</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">small_map</span><span class=\"w\"> </span><span class=\"n\">equiv</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">      </span><span class=\"n\">toFun</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofLeftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofRightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">      </span><span class=\"n\">invFun</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofLeftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofRightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span>\n<span class=\"w\">      </span><span class=\"n\">left_inv</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofLeftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofRightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">      </span><span class=\"n\">right_inv</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">      </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">⟩⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n<span class=\"w\">    </span><span class=\"o\">}</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">suffices</span><span class=\"w\"> </span><span class=\"n\">equiv</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"bp\">≃</span>\n<span class=\"w\">    </span><span class=\"bp\">@</span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Sigma</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">))</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">comap</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"bp\">.</span><span class=\"n\">fst</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">⊥</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">small_map</span><span class=\"w\"> </span><span class=\"n\">equiv</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">comapQuotientEquiv</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">⊥</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">setCongr</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range_comp</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">mk''</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">symm</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">mk''</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">exact</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">subtypeEquivRight</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">)</span>\n\n<span class=\"kn\">section</span>\n<span class=\"n\">omit</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">left_map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"n\">ofLeftMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"bp\">⟩⟩</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">right_map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hi</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"bp\">.</span><span class=\"n\">elim</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span>\n<span class=\"w\">      </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨.</span><span class=\"n\">ofRightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">hi</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"bp\">⟩⟩</span>\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T_coeval</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Shrink</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Shrink</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">left_map</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">''</span>\n<span class=\"w\">      </span><span class=\"bp\">@</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">right_map</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">''</span>\n<span class=\"w\">      </span><span class=\"bp\">@</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">univ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)))),</span>\n<span class=\"w\">    </span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Shrink</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">i</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">r</span><span class=\"bp\">⟩⟩</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T_init</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Shrink</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">init</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Shrink</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"bp\">.</span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_coeval</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">i</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_init</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">coreci_initi_irrel</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">      </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">eq_of_bisim</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">reachable</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">      </span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">coreci</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_initi</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">coreci</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">coreci</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span>\n<span class=\"w\">      </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"bp\">.</span><span class=\"n\">dest_corec</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"bp\">.</span><span class=\"n\">dest_corec</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">dsimp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n</div></div>",
        "id": 531200160,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753645245
    },
    {
        "content": "<p>I'm still struggling to understand what a \"polynomial functor\" is</p>",
        "id": 531201835,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753645952
    },
    {
        "content": "<p>it's a sum of products</p>",
        "id": 531201893,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753645974
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531199967\">said</a>:</p>\n<blockquote>\n<p>you have to quotient to get the right notion of equality</p>\n</blockquote>\n<p>Oh you're right, the graph I describe would just be equivalent to the game x = {x | x}, right? I think the magic word is bisimulation?</p>",
        "id": 531201956,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753645997
    },
    {
        "content": "<p>yes that's the word</p>",
        "id": 531201989,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646013
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531201835\">said</a>:</p>\n<blockquote>\n<p>I'm still struggling to understand what a \"polynomial functor\" is</p>\n</blockquote>\n<p>The example I gave to <span class=\"user-mention silent\" data-user-id=\"479299\">Jovan Gerbscheid</span> is the list functor, it looks like <code>() ⊕ α ⊕ α × α ⊕ α × α × α ⊕ ...</code> where the <code>n</code>th component of the sum is <code>n</code>-length lists</p>",
        "id": 531202226,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646116
    },
    {
        "content": "<p>this is the same as <code>Fin 0 → α ⊕ Fin 1 → α ⊕ Fin 2 → α ⊕ ...</code>, which is <code>(n : Nat) × (Fin n → α)</code></p>",
        "id": 531202359,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646176
    },
    {
        "content": "<p>polynomial functors are ones that look like <code>P α = (a : A) × (B a → α)</code></p>",
        "id": 531202449,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646219
    },
    {
        "content": "<p>for lists you have <code>A := Nat</code> and <code>B := Fin</code></p>",
        "id": 531202530,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646254
    },
    {
        "content": "<p>Well, in that case, I think the simplest way to construct an arbitrary loopy game is something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMoves_mk</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">rightMoves_mk</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 531202548,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753646263
    },
    {
        "content": "<p>90% sure this allows you to construct the loopy game with options all loopy games not subsequent to themselves</p>",
        "id": 531203028,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646455
    },
    {
        "content": "<p><code>LGame.{u} : Type (u + 1)</code> so there shouldn't be any Bertrand nonsense</p>",
        "id": 531203110,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753646491
    },
    {
        "content": "<p>oh you're taking <code>a : Type u</code></p>",
        "id": 531203240,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646540
    },
    {
        "content": "<p>not sure that's a good idea but it does make everything a lot simpler</p>",
        "id": 531203275,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646555
    },
    {
        "content": "<p>I think the correct thing to do is take <code>Small.{u} a</code></p>",
        "id": 531203335,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753646575
    },
    {
        "content": "<p>that also works</p>",
        "id": 531203375,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646593
    },
    {
        "content": "<p>neither of those lets you define <code>ofSets</code> very easily though</p>",
        "id": 531203492,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646630
    },
    {
        "content": "<p>I'm trying to do a version where you have</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 531203596,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646677
    },
    {
        "content": "<p>it's a bit tricky</p>",
        "id": 531203669,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646706
    },
    {
        "content": "<p>I think the problem is not enough stuff in mathlib</p>",
        "id": 531204041,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646863
    },
    {
        "content": "<p>Take two small sets, build the sigma type of subpositions, and I think that should work?</p>",
        "id": 531204056,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753646870
    },
    {
        "content": "<p>explain \"the sigma type of subpositions\"</p>",
        "id": 531204316,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753646981
    },
    {
        "content": "<p>Not a sigma type, sorry. Let me write this down.</p>",
        "id": 531204947,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753647233
    },
    {
        "content": "<p>good luck</p>",
        "id": 531205011,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753647261
    },
    {
        "content": "<p>Take <code>s</code> and <code>t</code> small. The type <code>Option (Subpositions s U Subpositions t)</code> is small, and you can define left move and right move relations on <code>some x</code> in the obvious way, and on <code>none</code> so that it relates to the games in <code>s</code> and <code>t</code>. Then <code>mk l r none</code> should be what you want.</p>",
        "id": 531205027,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753647266
    },
    {
        "content": "<p>you will have to be a bit more explicit than that</p>",
        "id": 531205170,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753647324
    },
    {
        "content": "<p>how do I get <code>s</code> and <code>t</code></p>",
        "id": 531205182,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753647332
    },
    {
        "content": "<p>how do I prove the left and right moves of this is correct</p>",
        "id": 531205235,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753647353
    },
    {
        "content": "<p>Those are the sets you input into <code>ofSets</code></p>",
        "id": 531205245,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753647359
    },
    {
        "content": "<p>I'm struggling to write on my cellphone, let me go to my laptop</p>",
        "id": 531205328,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753647397
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531199797\">said</a>:</p>\n<blockquote>\n<p>Well, the graph I describe is simple enough to define.</p>\n</blockquote>\n<p>I'm not sure how to make a graph from this. What game do you mean?</p>",
        "id": 531205811,
        "sender_full_name": "Django Peeters",
        "timestamp": 1753647608
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531130043\">said</a>:</p>\n<blockquote>\n<p>The literature seems to define them in terms of graphs, but I can get not wanting to do that since it leads to some degenerate cases, such as a game 0 -&gt; 1 -&gt; ... -&gt; infty where the last node isn't even accessible in finitely many moves</p>\n</blockquote>\n<p>I think <code>infty</code> is actually isolated here</p>",
        "id": 531206036,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753647703
    },
    {
        "content": "<p>Also, do you mean degenerate because a normal game is also a loopy game? Or do we want those to be disjoint?</p>",
        "id": 531206080,
        "sender_full_name": "Django Peeters",
        "timestamp": 1753647718
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⋃₀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">False</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">False</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span>\n<span class=\"w\">  </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">none</span>\n</code></pre></div>",
        "id": 531206585,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753647923
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531206036\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531130043\">said</a>:</p>\n<blockquote>\n<p>The literature seems to define them in terms of graphs, but I can get not wanting to do that since it leads to some degenerate cases, such as a game 0 -&gt; 1 -&gt; ... -&gt; infty where the last node isn't even accessible in finitely many moves</p>\n</blockquote>\n<p>I think <code>infty</code> is actually isolated here</p>\n</blockquote>\n<p>You're right, it is. I should be more careful with notation!</p>",
        "id": 531206803,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648013
    },
    {
        "content": "<p>Or in other words, the directed graph on <code>ENat</code> relating <code>n</code> with <code>n + 1</code> for <code>n : ℕ</code> has no incoming edges on <code>⊤</code>.</p>",
        "id": 531206940,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648061
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531206585\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">insert</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">}</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⋃₀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Subpositions</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">False</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span>\n<span class=\"w\">  </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">False</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">none</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">some</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span>\n<span class=\"w\">  </span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">none</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>this looks like it might actually work</p>",
        "id": 531207103,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648129
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531203596\">said</a>:</p>\n<blockquote>\n<p>I'm trying to do a version where you have</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">init</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>This is a generalization of what I'm doing, but I'm a bit skeptical that we'll ever have a situation where we want to construct a small game tree out of a type that isn't.</p>",
        "id": 531207594,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648333
    },
    {
        "content": "<p>I will use it to define <code>mk</code></p>",
        "id": 531207713,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648376
    },
    {
        "content": "<p>and <code>ofSets</code></p>",
        "id": 531207720,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648382
    },
    {
        "content": "<p>I think you might be able to do it the other way around</p>",
        "id": 531207860,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648438
    },
    {
        "content": "<p>Given these functions, you can construct the set of all games accessible from <code>init</code> from <code>leftMoves</code> and <code>rightMoves</code>, and it should be <code>Small</code></p>",
        "id": 531207942,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648472
    },
    {
        "content": "<p>Then you can just use <code>mk</code> on that subtype</p>",
        "id": 531207987,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648488
    },
    {
        "content": "<p>yes but I haven't defined <code>mk</code> yet so I'm using to corecursor directly</p>",
        "id": 531208049,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648514
    },
    {
        "content": "<p>now I'm thinking maybe not the best idea</p>",
        "id": 531208080,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648526
    },
    {
        "content": "<p>I was thinking <code>mk</code> might be a bit easier to define than your map</p>",
        "id": 531208123,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648543
    },
    {
        "content": "<p>but I can still see the same problem</p>",
        "id": 531208140,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648547
    },
    {
        "content": "<p>that is proving that <code>mk</code> on the subtype corresponds to <code>mk</code> on the other subtype</p>",
        "id": 531208183,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648566
    },
    {
        "content": "<p>What do you mean?</p>",
        "id": 531208474,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648679
    },
    {
        "content": "<p>when you do the thing where you restrict to the subtype of games accessible from <code>init</code></p>",
        "id": 531208579,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648722
    },
    {
        "content": "<p>you would like to prove that <code>mk</code> on the subtype of elements accessible from <code>init</code> fed with a <code>l</code> is the same as <code>mk</code> on the subtype of elements accessible from <code>l</code> fed with a <code>l</code></p>",
        "id": 531208780,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648800
    },
    {
        "content": "<p>I'm currently trying to figure out the best generality to state this in that makes it the easiest to prove</p>",
        "id": 531208894,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753648850
    },
    {
        "content": "<p>I don't think you actually need to prove that?</p>",
        "id": 531209210,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648976
    },
    {
        "content": "<p>You should have extensionality on <code>LGame</code></p>",
        "id": 531209235,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753648985
    },
    {
        "content": "<p>the extensionality is stated in terms of bisimulation</p>",
        "id": 531209309,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649014
    },
    {
        "content": "<p>If <code>x.leftMoves = y.leftMoves</code> and <code>x.rightMoves = y.rightMoves</code> then <code>x = y</code></p>",
        "id": 531209341,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649028
    },
    {
        "content": "<p>I mean, this is true, as is the bisimulation thing</p>",
        "id": 531209370,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649038
    },
    {
        "content": "<p>I do have that version</p>",
        "id": 531209379,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649041
    },
    {
        "content": "<p>but you can't prove <code>x.leftMoves = y.leftMoves</code></p>",
        "id": 531209416,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649054
    },
    {
        "content": "<p>unless you have a way?</p>",
        "id": 531209481,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649078
    },
    {
        "content": "<p>So if you can prove <code>leftMoves (ofSets s t) = s</code> and <code>rightMoves (ofSets s t) = t</code> then that should be enough to prove the definition is correct</p>",
        "id": 531209583,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649116
    },
    {
        "content": "<p>Or do I misunderstand the issue?</p>",
        "id": 531209599,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649121
    },
    {
        "content": "<p>the issue is that you can't use <code>ofSets</code> to construct loopy games that are subpositions of themselves</p>",
        "id": 531209885,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649236
    },
    {
        "content": "<p>you need another constructor</p>",
        "id": 531209897,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649240
    },
    {
        "content": "<p>Oh yeah, I know that</p>",
        "id": 531209925,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649249
    },
    {
        "content": "<p>These are two separate constructors</p>",
        "id": 531209947,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649259
    },
    {
        "content": "<p>what's the other constructor</p>",
        "id": 531210024,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649285
    },
    {
        "content": "<p>Either (or both!) versions of <code>mk</code></p>",
        "id": 531210105,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649317
    },
    {
        "content": "<p>the issue is proving the defining equations for <code>mk</code></p>",
        "id": 531210129,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649329
    },
    {
        "content": "<p><code>ofSets</code> is a convenience constructor built on top of it</p>",
        "id": 531210132,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649330
    },
    {
        "content": "<p>In practice I imagine <code>ofSets</code> as well as <code>dud</code>, <code>on</code>, <code>off</code> can already describe most games of interest</p>",
        "id": 531210161,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649342
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531210129\">said</a>:</p>\n<blockquote>\n<p>the issue is proving the defining equations for <code>mk</code></p>\n</blockquote>\n<p>I think there's two different types at play here. We should first define some auxiliary type (<code>PLGame</code>?) as the coinductive type with constructor <code>mk (a : Type u) (f : a -&gt; PLGame) : PLGame</code>. Then you can quotient over identity to get <code>LGame</code>, which should satisfy extentionality as well as a coinduction principle.</p>",
        "id": 531210608,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649527
    },
    {
        "content": "<p>that's a bad idea</p>",
        "id": 531210644,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649543
    },
    {
        "content": "<p>well, not a bad idea but inefficient since I can directly go to <code>LGame</code> without having to pass through <code>PLGame</code></p>",
        "id": 531210699,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649567
    },
    {
        "content": "<p>and I've proved extensionality and bisimulation but coinduction is tricky</p>",
        "id": 531210787,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649599
    },
    {
        "content": "<p>and it won't get any easier if I go to <code>PLGame</code> since I don't get anything new there</p>",
        "id": 531210867,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649631
    },
    {
        "content": "<p>How did you define <code>LGame</code> without <code>PLGame</code>?</p>",
        "id": 531210920,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649654
    },
    {
        "content": "<p>Using <code>QPF.Cofix</code></p>",
        "id": 531210951,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649663
    },
    {
        "content": "<p>Huh, now I'm wondering if there's some way to define <code>IGame</code> without <code>PGame</code> using functor shenanigans</p>",
        "id": 531211045,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649700
    },
    {
        "content": "<p>I prove that <code>fun X =&gt; { s : Set X × Set X // Small.{u} s.1 ∧ Small.{u} s.2 }</code> with the obvious map is the quotient of a polynomial functor</p>",
        "id": 531211057,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649705
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531211045\">said</a>:</p>\n<blockquote>\n<p>Huh, now I'm wondering if there's some way to define <code>IGame</code> without <code>PGame</code> using functor shenanigans</p>\n</blockquote>\n<p>it's almost certainly just the dual (fixpoint instead of cofixpoint)</p>",
        "id": 531211106,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649725
    },
    {
        "content": "<p>Add that to do the TODO list!</p>",
        "id": 531211142,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649743
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531211057\">said</a>:</p>\n<blockquote>\n<p>I prove that <code>fun X =&gt; { s : Set X × Set X // Small.{u} s.1 ∧ Small.{u} s.2 }</code> with the obvious map is the quotient of a polynomial functor</p>\n</blockquote>\n<p>Does quotient here mean the type has the extensional form of equality?</p>",
        "id": 531211216,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753649774
    },
    {
        "content": "<p>actually not quite</p>",
        "id": 531211271,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649794
    },
    {
        "content": "<p>the polynomial functor in question is <code>(c : Cardinal.{u} × Cardinal.{u}) × ((PLift c.1.out ⊕ PLift c.2.out) → α)</code> with the obvious map</p>",
        "id": 531211473,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649880
    },
    {
        "content": "<p>and the quotient part mean that tuples are identified when they have all the same entries, and you ignore the order and multiplicity of the entries</p>",
        "id": 531211623,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649944
    },
    {
        "content": "<p>it does turn out to give you the correct extensionality</p>",
        "id": 531211682,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753649967
    },
    {
        "content": "<p>Interesting!</p>",
        "id": 531212005,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650090
    },
    {
        "content": "<p>it has occurred to me that I could do this without <code>Cardinal</code></p>",
        "id": 531212159,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650156
    },
    {
        "content": "<p>and just use types</p>",
        "id": 531212176,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650165
    },
    {
        "content": "<p>and then the polynomial functor will be the same as the one defining <code>PGame</code> and the quotient will be the same as <code>PGame.Identical</code></p>",
        "id": 531212279,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650208
    },
    {
        "content": "<p>So just to conceptualize this, the functor <code>Finset</code> would be the quotient of the polynomial functor <code>(a : Nat) x Fin a</code>, right?</p>",
        "id": 531212422,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650269
    },
    {
        "content": "<p>that's not a functor</p>",
        "id": 531212492,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650301
    },
    {
        "content": "<p>that's just a type</p>",
        "id": 531212508,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650306
    },
    {
        "content": "<p>I've been making my types into functors by abstracting over <code>α</code> in a covariant way</p>",
        "id": 531212597,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650344
    },
    {
        "content": "<p>you don't have an <code>α</code></p>",
        "id": 531212634,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650360
    },
    {
        "content": "<p>Oh yeah would it be <code>(n : Nat) x Fin n -&gt; a</code> then</p>",
        "id": 531212756,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650408
    },
    {
        "content": "<p>yes that's correct</p>",
        "id": 531212785,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650424
    },
    {
        "content": "<p>it's a quotient of lists by the relation \"contains all the same elements\"</p>",
        "id": 531212831,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650443
    },
    {
        "content": "<p>so you've built lists</p>",
        "id": 531212840,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650447
    },
    {
        "content": "<p>Isn't it finsets, rather?</p>",
        "id": 531212923,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650477
    },
    {
        "content": "<p>well <code>fun α =&gt; (n : ℕ) × (Fin n → α)</code> looks like the list functor to me</p>",
        "id": 531213131,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650560
    },
    {
        "content": "<p>Oh yeah, I mean that lists quotiented by containing the same elements are what finsets are</p>",
        "id": 531213311,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650637
    },
    {
        "content": "<p>yes that's correct</p>",
        "id": 531213328,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650645
    },
    {
        "content": "<p>Interesting! So then you can define inductive and coinductive types from this polynomial functor, right?</p>",
        "id": 531213432,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650686
    },
    {
        "content": "<p>if you take the fixpoint you get hereditarily finite sets</p>",
        "id": 531213467,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650703
    },
    {
        "content": "<p>And the cofixpoint would be... hereditarily finite non-well-founded sets?</p>",
        "id": 531213534,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650726
    },
    {
        "content": "<p>I guess that's one way to think about it</p>",
        "id": 531213600,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650755
    },
    {
        "content": "<p>they're not really finite anymore</p>",
        "id": 531213635,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650770
    },
    {
        "content": "<p>they're finitely branching</p>",
        "id": 531213657,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650779
    },
    {
        "content": "<p>I think they should still be finite, though</p>",
        "id": 531213749,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650819
    },
    {
        "content": "<p>they be related to infinitely many distinct elements under the relation \"transitive closure of membership\"</p>",
        "id": 531213861,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650861
    },
    {
        "content": "<p>A quine a = {a} would only be related to itself</p>",
        "id": 531213915,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650890
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 531214014,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650920
    },
    {
        "content": "<p>use <code>a = {0, {1, {2, {3, {4, {5, ...</code></p>",
        "id": 531214029,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650927
    },
    {
        "content": "<p>a tower of pairs</p>",
        "id": 531214092,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650953
    },
    {
        "content": "<p>but all distinct</p>",
        "id": 531214134,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753650966
    },
    {
        "content": "<p>Whoa</p>",
        "id": 531214205,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753650994
    },
    {
        "content": "<p>Wait, follow-up question</p>",
        "id": 531214428,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651095
    },
    {
        "content": "<p>Say you defined the coinductive type of the functor <code>fun a =&gt; (n : ENat) x (toType n -&gt; a)</code> where <code>ENat.toType</code> is <code>Fin n</code> for a natural and <code>Nat</code> for <code>top</code></p>",
        "id": 531214610,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651173
    },
    {
        "content": "<p>Would it be correct to call these sets hereditarily countable?</p>",
        "id": 531214642,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651187
    },
    {
        "content": "<p>Or do you run into the same issue?</p>",
        "id": 531214663,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651195
    },
    {
        "content": "<p>since the cofinality of <code>ℵ₁</code> is <code>ω₁</code> which is uncountable</p>",
        "id": 531214809,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753651252
    },
    {
        "content": "<p>I think these are \"hereditarily countable\"</p>",
        "id": 531214827,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753651259
    },
    {
        "content": "<p>Basically I'm just trying to tune my intuition for the case <code>fun a =&gt; (b : Type u) x (b -&gt; a)</code></p>",
        "id": 531214919,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651299
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531206940\">said</a>:</p>\n<blockquote>\n<p>Or in other words, the directed graph on <code>ENat</code> relating <code>n</code> with <code>n + 1</code> for <code>n : ℕ</code> has no incoming edges on <code>⊤</code>.</p>\n</blockquote>\n<p>Thank you very much! That is indeed a clear degenerate case... I'm gonna try to refine my definition.</p>",
        "id": 531214940,
        "sender_full_name": "Django Peeters",
        "timestamp": 1753651305
    },
    {
        "content": "<p>have you seen <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=WType#doc\">docs#WType</a></p>",
        "id": 531214998,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753651331
    },
    {
        "content": "<p>And by extension <code>fun a =&gt; (b c : Type u) x (b -&gt; c -&gt; a)</code> which is I think what games are</p>",
        "id": 531215004,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651334
    },
    {
        "content": "<p>I've worked with W-types, yes</p>",
        "id": 531215028,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651344
    },
    {
        "content": "<p>I haven't worked with the dual M types though</p>",
        "id": 531215045,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651350
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"662714\">Django Peeters</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531214940\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531206940\">said</a>:</p>\n<blockquote>\n<p>Or in other words, the directed graph on <code>ENat</code> relating <code>n</code> with <code>n + 1</code> for <code>n : ℕ</code> has no incoming edges on <code>⊤</code>.</p>\n</blockquote>\n<p>Thank you very much! That is indeed a clear degenerate case... I'm gonna try to regine my definition.</p>\n</blockquote>\n<p>I'm pretty sure the game I describe is equivalent (through bisimulation) to the game where <code>top</code> doesn't exist at all</p>",
        "id": 531215163,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651402
    },
    {
        "content": "<p>So it's not really a degenerate case at all</p>",
        "id": 531215183,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651409
    },
    {
        "content": "<p>I might be getting ahead of myself, but I'd love to see a <code>Functor</code> file in the repository, where we prove that <code>fun α ↦ {s : Set α × Set α // Small.{u} s.1 ∧ Small.{u} s.2}</code> is a QPF. Then we could define <code>IGame := QPF.fix</code> and <code>LGame := QPF.cofix</code> and hopefully skip a lot of setup in both cases!</p>",
        "id": 531215973,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651747
    },
    {
        "content": "<p>we could try that</p>",
        "id": 531216029,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753651771
    },
    {
        "content": "<p>(I imagine a similar approach might be helpful for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ZFSet#doc\">docs#ZFSet</a> but I also imagine there are other computability concerns in that case)</p>",
        "id": 531216096,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753651802
    },
    {
        "content": "<p>I'll try to reprove <code>QPF F</code> as a bit of a personal excercise</p>",
        "id": 531217605,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753652427
    },
    {
        "content": "<p>How's this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">}</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span>\n\n<span class=\"kd\">@[</span><span class=\"n\">ext</span><span class=\"kd\">]</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Subtype</span><span class=\"bp\">.</span><span class=\"n\">ext</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Functor</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">⟩</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩⟩</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">⊕</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inl</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">inr</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">PLift</span><span class=\"bp\">.</span><span class=\"n\">up</span><span class=\"o\">)</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"n\">inferInstance</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">  </span><span class=\"n\">repr</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨⟨</span><span class=\"n\">Shrink</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Shrink</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">⟩</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Sum</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">abs_repr</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">equivShrink</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">exists_congr_right</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">abs_map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">⟩;</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">PFunctor</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">__</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">instFunctor</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">GameFunctor</span>\n</code></pre></div>",
        "id": 531224551,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753655337
    },
    {
        "content": "<p>I think this golfs your code a bit <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 531224704,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753655404
    },
    {
        "content": "<p>It golfs it quite a lot</p>",
        "id": 531226737,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753656281
    },
    {
        "content": "<p>never mind it's barely shorter</p>",
        "id": 531226808,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753656312
    },
    {
        "content": "<p>since you made it structured</p>",
        "id": 531226846,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753656328
    },
    {
        "content": "<p>I would not like to see this written down using only angle brackets</p>",
        "id": 531226899,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753656354
    },
    {
        "content": "<p>A few thoughts in my head:</p>\n<ul>\n<li>It would be nice if someone went through the <code>QPF</code> file and added <code>private</code> to everything that isn't the inductive/coinductive principles, it would really cut down on noise.</li>\n<li>Apparently the notion of a <code>QPF</code> was introduced by members of the Zulip at a conference in 2019? That's awesome.</li>\n</ul>",
        "id": 531227287,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753656517
    },
    {
        "content": "<p>I'll give this a read: <a href=\"https://drops.dagstuhl.de/entities/document/10.4230/LIPIcs.ITP.2019.6\">https://drops.dagstuhl.de/entities/document/10.4230/LIPIcs.ITP.2019.6</a></p>",
        "id": 531227632,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753656658
    },
    {
        "content": "<p>You never never in a million years would I have guessed that I'd be reading category theory in order to formalize game theory of all things</p>",
        "id": 531230580,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753657910
    },
    {
        "content": "<p>it's the initial and final algebras</p>",
        "id": 531230899,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753658043
    },
    {
        "content": "<p>I'm flabbergasted to learn that inductive types boil down to a commutative square</p>",
        "id": 531231549,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753658328
    },
    {
        "content": "<p>I've been staring at commutative diagrams for about half an hour I think I finally get this</p>",
        "id": 531232925,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753658922
    },
    {
        "content": "<p>So <code>IGame</code> is the initial algebra of the functor <code>F(α) = SmallSet α × SmallSet α</code> and <code>LGame</code> is the terminal coalgebra of the same functor</p>",
        "id": 531233147,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753659007
    },
    {
        "content": "<p>The QPF machinery is really only there to guarantee that these algebras/coalgebras exist and to construct them</p>",
        "id": 531233331,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753659084
    },
    {
        "content": "<p>On a related note, surely <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PFunctor.Approx.Agree.continu#doc\">docs#PFunctor.Approx.Agree.continu</a> is a typo</p>",
        "id": 531234018,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753659383
    },
    {
        "content": "<p>Well I've proved the left and right moves of <code>corec</code> are correct</p>",
        "id": 531235729,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753660108
    },
    {
        "content": "<p>now I guess I build <code>ofSets</code>?</p>",
        "id": 531235915,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753660194
    },
    {
        "content": "<p>That makes sense</p>",
        "id": 531237578,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753660885
    },
    {
        "content": "<p>ok <code>ofSets</code> is done</p>",
        "id": 531240369,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753661984
    },
    {
        "content": "<p>is there anything else I might be missing</p>",
        "id": 531240384,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753661991
    },
    {
        "content": "<p>Did you manage to build anything similar to the <code>mk</code> graph constructor from earlier?</p>",
        "id": 531240479,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753662025
    },
    {
        "content": "<p>yeah</p>",
        "id": 531240590,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753662070
    },
    {
        "content": "<p>it's <code>corec</code></p>",
        "id": 531240598,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753662073
    },
    {
        "content": "<p>if you abuse the defeq between <code>Set X</code> and <code>X → Prop</code></p>",
        "id": 531240674,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753662097
    },
    {
        "content": "<p>We should maybe not do that</p>",
        "id": 531241283,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753662336
    },
    {
        "content": "<p>But if you have some version of that then it's fine</p>",
        "id": 531241359,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753662367
    },
    {
        "content": "<p>Btw, I'm currently working on redefining <code>IGame</code> as a <code>QPF.Fix</code>. I think we could start there, then PR the definition of <code>LGame</code> as <code>QPF.Cofix</code>.</p>",
        "id": 531241512,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753662427
    },
    {
        "content": "<p>It would inform the API a bit better</p>",
        "id": 531241528,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753662434
    },
    {
        "content": "<p>I made <a href=\"https://github.com/vihdzp/combinatorial-games/pull/156\">vihdzp/combinatorial-games#156</a> so you can see my code</p>",
        "id": 531242485,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753662824
    },
    {
        "content": "<p>Something I find peculiar is that the recursor for <code>IGame</code> seems... not very useful? This is what you get if you directly use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QPF.Fix.rec#doc\">docs#QPF.Fix.rec</a></p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">],</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Fix</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n</code></pre></div>\n<p>The fact that <code>α</code> is limited to <code>Type (u + 1)</code> really limits what you can do with this. I found it easier to instead go the long way around and prove <code>WellFounded IsOption</code>, at which point well-founded recursion gives you a much better recursor.</p>",
        "id": 531246585,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753664520
    },
    {
        "content": "<p>yeah I'm pretty sure those can be generalized to arbitrary universes</p>",
        "id": 531246684,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753664556
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531242485\">said</a>:</p>\n<blockquote>\n<p>I made <a href=\"https://github.com/vihdzp/combinatorial-games/pull/156\">vihdzp/combinatorial-games#156</a> so you can see my code</p>\n</blockquote>\n<p>I just opened <a href=\"https://github.com/vihdzp/combinatorial-games/pull/157\">https://github.com/vihdzp/combinatorial-games/pull/157</a> which defines <code>GameFunctor</code> and uses it to completely get rid of <code>PGame</code>.</p>",
        "id": 531251939,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753666664
    },
    {
        "content": "<p>I think you should merge my PR into yours</p>",
        "id": 531252330,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753666812
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Is there ever a circumstance where you'd use <code>eq_of_bisim</code> over the extensionality principle? Like, what kind of a relation <code>r</code> could you put into the theorem that isn't just equality?</p>",
        "id": 531254414,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753667605
    },
    {
        "content": "<p>I might be misunderstanding how bisimulations are used</p>",
        "id": 531254450,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753667622
    },
    {
        "content": "<p>How would you prove that forall <code>f : α → α</code> and <code>x : α</code>, <code>corec (fun i =&gt; {f i}) (fun i =&gt; {f i}) x</code> is equal to <code>corec (fun _ =&gt; {()}) (fun _ =&gt; {()}) ()</code></p>",
        "id": 531254921,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753667794
    },
    {
        "content": "<p>Oh I see, extensionality alone doesn't cut it</p>",
        "id": 531255108,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753667864
    },
    {
        "content": "<p>Wait, let me translate into plaintext. Does that mean that the game x = {x | x} is equal to every game yᵢ where yᵢ = {y₁, ... yₙ | y₁, ... yₙ}?</p>",
        "id": 531255526,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753668019
    },
    {
        "content": "<p>I am 70% sure that out of the two theorems <code>eq_of_bisim</code> and <code>hom_unique</code> in my PR, they are both enough for extensionality and you can prove either one from the other</p>",
        "id": 531255528,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753668019
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531255526\">said</a>:</p>\n<blockquote>\n<p>Wait, let me translate into plaintext. Does that mean that the game x = {x | x} is equal to every game yᵢ where yᵢ = {y₁, ... yₙ | y₁, ... yₙ}?</p>\n</blockquote>\n<p>I think so? If I'm understanding what you mean correctly</p>",
        "id": 531255682,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753668073
    },
    {
        "content": "<p>both of those play out as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">d</mi><mi mathvariant=\"bold\">u</mi><mi mathvariant=\"bold\">d</mi></mrow><annotation encoding=\"application/x-tex\">\\bold{dud}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">dud</span></span></span></span></span></p>",
        "id": 531255796,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753668110
    },
    {
        "content": "<p>Yeah, and if you tried to prove it with extensionality you'd get the exact same result you're trying to prove!</p>",
        "id": 531255858,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753668127
    },
    {
        "content": "<p>But how do you prove this using a bisimulation?</p>",
        "id": 531255966,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753668171
    },
    {
        "content": "<p>you have to encode \"this game is dud\" into a relation</p>",
        "id": 531256217,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753668265
    },
    {
        "content": "<p>Let me try</p>",
        "id": 531256776,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753668487
    },
    {
        "content": "<p>Wait</p>",
        "id": 531258192,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753669090
    },
    {
        "content": "<p>If you assume yᵢ = {y₁, ... yₙ | y₁, ... yₙ} for all i then yᵢ = yⱼ by extensionality</p>",
        "id": 531258257,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753669131
    },
    {
        "content": "<p>yes</p>",
        "id": 531258279,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753669139
    },
    {
        "content": "<p>So really all you're trying to prove is that any two games with x = {x | x} are equal</p>",
        "id": 531258283,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753669142
    },
    {
        "content": "<p>yes</p>",
        "id": 531258316,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753669158
    },
    {
        "content": "<p>But I can see how <em>that</em> can't be proven by extensionality</p>",
        "id": 531258331,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753669164
    },
    {
        "content": "<p>I still don't quite see how to prove it by bisimulation, though.</p>",
        "id": 531258431,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753669222
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dud_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">eq_of_bisim</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">j</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">j</span><span class=\"o\">})</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">hx</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves_ofSets</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves_ofSets</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves_ofSets</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves_ofSets</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n</code></pre></div>",
        "id": 531259025,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753669533
    },
    {
        "content": "<p>tada</p>",
        "id": 531259030,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753669536
    },
    {
        "content": "<p>bisimulation</p>",
        "id": 531259035,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753669541
    },
    {
        "content": "<p>Ohhh wait I get my confusion</p>",
        "id": 531260036,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753670130
    },
    {
        "content": "<p>I was reading the definition of coinduction rather than bisimulation</p>",
        "id": 531260051,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753670140
    },
    {
        "content": "<p>No wonder I was confused</p>",
        "id": 531260057,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753670144
    },
    {
        "content": "<p>So bisimulation for loopy games tells you that if you have a relation on loopy games such that when <code>x</code> and <code>y</code> are related... There's a pairing between left options of x and left options of y so that every pair is related, and likewise for right options? Then <code>r x y</code> implies x = y.</p>",
        "id": 531260341,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753670309
    },
    {
        "content": "<p>I guess one way to think about this is that the existence of such a relation allows you to build an isomorphism between game trees</p>",
        "id": 531269952,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753675831
    },
    {
        "content": "<p>If <code>r x y</code> then there's a pairing between options of <code>x</code> and <code>y</code>, which means the game trees up to depth one are isomorphic. Then there must also be a pairing between the corresponding options of those options, which means the game tree up to depth two are isomorphic. And so on.</p>",
        "id": 531270527,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753676283
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531259025\">said</a>:</p>\n<blockquote>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">dud_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">eq_of_bisim</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">i</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">ofSets</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">j</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">j</span><span class=\"o\">})</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">hx</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves_ofSets</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">leftMoves_ofSets</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">left</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hxy</span><span class=\"bp\">.</span><span class=\"n\">right</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves_ofSets</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"n\">rightMoves_ofSets</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"mi\">0</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">    </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">i</span>\n<span class=\"w\">    </span><span class=\"n\">simpa</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">singleton</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"kn\">using</span><span class=\"w\"> </span><span class=\"n\">hxy</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Can't you do this more directly by defining <code>r a b</code> as <code>a = x</code> and <code>b = y</code>?</p>",
        "id": 531270597,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753676332
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> I think all the stuff you did with <code>reachable</code> can be done much more simply using <code>Relation.ReflTransGen</code>.</p>",
        "id": 531318307,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753694737
    },
    {
        "content": "<p>I just PR'd the theorem that subpositions of an <code>IGame</code> are a small set in <a href=\"https://github.com/vihdzp/combinatorial-games/pull/159\">#159</a>. As a corollary, we can do this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">v</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">Relation</span><span class=\"bp\">.</span><span class=\"n\">ReflTransGen</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">}</span>\n\n<span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">local</span><span class=\"w\"> </span><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">small_T</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">init</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">small_setOf_reflTransGen'</span><span class=\"w\"> </span><span class=\"bp\">..</span>\n</code></pre></div>",
        "id": 531318531,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753694789
    },
    {
        "content": "<p>I'll rebuild the coinduction principle with this, I think it should be quite a bit easier</p>",
        "id": 531320335,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753695316
    },
    {
        "content": "<p>This is going well. I'll continue golfing tomorrow.</p>",
        "id": 531353394,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753704892
    },
    {
        "content": "<p>are you done for today?</p>",
        "id": 531353529,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753704921
    },
    {
        "content": "<p>Yeah</p>",
        "id": 531355394,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753705428
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Hi! Just finished refactoring your PR. I think I did a pretty decent job at cleaning up the definition of corecursion; I also added some basic results on <code>on</code>, <code>off</code>, and <code>dud</code> to test out our new definitions.</p>\n<p><a href=\"https://github.com/vihdzp/combinatorial-games/pull/160\">https://github.com/vihdzp/combinatorial-games/pull/160</a></p>",
        "id": 531480113,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753745371
    },
    {
        "content": "<p>I guess if you do it for me then I don't have to do it myself</p>",
        "id": 531480280,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745453
    },
    {
        "content": "<p>thanks</p>",
        "id": 531480282,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745455
    },
    {
        "content": "<p>it feels like my PRs are only there so you can golf them and open another one</p>",
        "id": 531480348,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745490
    },
    {
        "content": "<p>I think we make a good team</p>",
        "id": 531480380,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753745506
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531126499\">said</a>:</p>\n<blockquote>\n<p>So after I make loopy games, what API should I provide which uniquely characterizes them? I'm thinking of providing a destructor and some corecursion, but this is not sufficient since you can prove an isomorphism but not the fact that it's unique.</p>\n</blockquote>\n<p>It's a bit late, but I think I have an answer to this:</p>\n<ul>\n<li><code>LGame.leftMoves</code></li>\n<li><code>LGame.rightMoves</code></li>\n<li><code>LGame.instSmallLeftMoves</code></li>\n<li><code>LGame.instSmallRightMoves</code></li>\n<li><code>LGame.ofSets</code></li>\n<li><code>LGame.leftMoves_ofSets</code></li>\n<li><code>LGame.rightMoves_ofSets</code></li>\n<li><code>LGame.eq_of_bisim</code></li>\n<li><code>LGame.corec</code></li>\n<li><code>LGame.leftMoves_corec</code></li>\n<li><code>LGame.rightMoves_corec</code></li>\n</ul>",
        "id": 531480722,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753745689
    },
    {
        "content": "<p>And perhaps <code>LGame.hom_unique</code> too, I'm not sure if it can be proven from the others</p>",
        "id": 531480845,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753745764
    },
    {
        "content": "<p>It can probably be proved by bisimulation</p>",
        "id": 531480870,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745779
    },
    {
        "content": "<p>bisimulation is what you get from constructing approximations that agree and <code>hom_unique</code> is what category theory says you should get for a final coalgebra</p>",
        "id": 531480953,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745840
    },
    {
        "content": "<p>the <code>hom</code> in the theorem name refers to coalgebra homomorphisms</p>",
        "id": 531481202,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753745956
    },
    {
        "content": "<p>I figured as much, as soon as I saw the compositions in the theorem statement I knew there was some commutative diagram at play</p>",
        "id": 531481251,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753745991
    },
    {
        "content": "<p>I considered making them the applied version but decided against it</p>",
        "id": 531481359,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753746031
    },
    {
        "content": "<p>I like the unapplied version better, aesthetically speaking</p>",
        "id": 531481433,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753746081
    },
    {
        "content": "<p>If we need the applied version we can add it later</p>",
        "id": 531481456,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753746093
    },
    {
        "content": "<p>Well, we've discussed a lot about the implementation details of loopy games, but what about their actual theory? What can we do with our new toy?</p>",
        "id": 531482193,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753746506
    },
    {
        "content": "<p>we can start by defining addition corecursively</p>",
        "id": 531482399,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753746636
    },
    {
        "content": "<p>or maybe the map from games to loopy games</p>",
        "id": 531482410,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753746647
    },
    {
        "content": "<p>show that they commute</p>",
        "id": 531482434,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753746658
    },
    {
        "content": "<p>Here's a rough to-do from things I have in mind</p>\n<ul>\n<li>Define other basic games like <code>0</code> and <code>1</code></li>\n<li>Define the embedding <code>IGame ↪ LGame</code></li>\n<li>Define negation and addition of loopy games</li>\n<li>Define... multiplication? Can you do that? Does it satisfy anything interesting?</li>\n<li>Define outcome classes</li>\n<li>Build some \"real life\" games like Tic-tac-toe or chess; you can't really define them within <code>IGame</code> because there's ties, but I hear <code>dud</code> can be used to represent a tied state?</li>\n</ul>",
        "id": 531482518,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753746720
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> I think the bisimulation principle you defined might not be the most general one. What do you think about this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eq_of_bisim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">),</span>\n<span class=\"w\">      </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">fst</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">snd</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hxy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 531496051,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753755135
    },
    {
        "content": "<p>This generalizes the principle stated with equivalences, since the pairings specified by <code>s</code> and <code>t</code> are not a priori one to one. For instance, to prove that <code>a + dud = dud</code>, you need to use the bisimulation <code>r x y ↔ (∃ b, x = b + dud) ∧ y = dud</code>. Then assuming <code>r x y</code>, the set <code>s</code> is <code>x.leftMoves ×ˢ {dud}</code> and the set <code>t</code> is <code>x.rightMoves ×ˢ {dud}</code>. You don't know that these are singleton sets until you prove the theorem!</p>",
        "id": 531496343,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753755329
    },
    {
        "content": "<p>Oh and also we don't have to deal with equivalences on subtypes, thank goodness</p>",
        "id": 531502258,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753759074
    },
    {
        "content": "<p><code>PGame</code> PTSD</p>",
        "id": 531502270,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753759081
    },
    {
        "content": "<p>I replaced the old form of bisimulation by this. I'm not a fan of having complicated theorems that end up being weaker than other theorems in nontrivial ways. (Not fun being halfway through a proof when you realize you're using the wrong result!)</p>",
        "id": 531502663,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753759365
    },
    {
        "content": "<p>I feel like working on loopy arithmetic</p>",
        "id": 531504941,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753760731
    },
    {
        "content": "<p>I find this immensely satisfying:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Neg</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">neg</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span>\n</code></pre></div>",
        "id": 531504947,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753760738
    },
    {
        "content": "<p>Hmm, I think I've hit somewhat of a wall. How do you prove this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Add</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">corec</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">corec_add_corec</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">initα</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">initβ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">initα</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">initβ</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">corec</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">initα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">initβ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 531514386,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753766193
    },
    {
        "content": "<p>The analogous theorem on negation was really easy, it was an immediate application of <code>corec_comp_hom</code></p>",
        "id": 531514539,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753766257
    },
    {
        "content": "<p>I'm not really sure how to do this one, though</p>",
        "id": 531514559,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753766264
    },
    {
        "content": "<p>It's probably doable with a bisimulation but I'd love if there was a more direct argument through the universal property</p>",
        "id": 531516117,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753767041
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531496343\">said</a>:</p>\n<blockquote>\n<p>This generalizes the principle stated with equivalences, since the pairings specified by <code>s</code> and <code>t</code> are not a priori one to one. For instance, to prove that <code>a + dud = dud</code>, you need to use the bisimulation <code>r x y ↔ (∃ b, x = b + dud) ∧ y = dud</code>. Then assuming <code>r x y</code>, the set <code>s</code> is <code>x.leftMoves ×ˢ {dud}</code> and the set <code>t</code> is <code>x.rightMoves ×ˢ {dud}</code>. You don't know that these are singleton sets until you prove the theorem!</p>\n</blockquote>\n<p>This is great but I was having trouble proving this version</p>",
        "id": 531565714,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753783280
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531514559\">said</a>:</p>\n<blockquote>\n<p>I'm not really sure how to do this one, though</p>\n</blockquote>\n<p>Just ext, their left and right moves are the same</p>",
        "id": 531566053,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753783369
    },
    {
        "content": "<p>Hmm I'm not actually 100% sure that that works</p>",
        "id": 531567064,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753783675
    },
    {
        "content": "<p>oh I think this is a case of <code>corec_comp_hom</code> where you set <code>(f := Prod.map (corec leftMovesα rightMovesα) (corec leftMovesβ rightMovesβ))</code></p>",
        "id": 531569358,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753784350
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">corec_add_corec</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Small</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">initα</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">initβ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">initα</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">initβ</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">corec</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">initα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">initβ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">congrFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">corec_comp_hom</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">corec</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">initα</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">initβ</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image_image</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image_union</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leftMoves_corec</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image_image</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image_union</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rightMoves_corec</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 531571567,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753785021
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531565714\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531496343\">said</a>:</p>\n<blockquote>\n<p>This generalizes the principle stated with equivalences, since the pairings specified by <code>s</code> and <code>t</code> are not a priori one to one. For instance, to prove that <code>a + dud = dud</code>, you need to use the bisimulation <code>r x y ↔ (∃ b, x = b + dud) ∧ y = dud</code>. Then assuming <code>r x y</code>, the set <code>s</code> is <code>x.leftMoves ×ˢ {dud}</code> and the set <code>t</code> is <code>x.rightMoves ×ˢ {dud}</code>. You don't know that these are singleton sets until you prove the theorem!</p>\n</blockquote>\n<p>This is great but I was having trouble proving this version</p>\n</blockquote>\n<p>I just realized it's actually very easy to prove this version and I was just being stupid</p>",
        "id": 531572671,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753785365
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531565714\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/531496343\">said</a>:</p>\n<blockquote>\n<p>This generalizes the principle stated with equivalences, since the pairings specified by <code>s</code> and <code>t</code> are not a priori one to one. For instance, to prove that <code>a + dud = dud</code>, you need to use the bisimulation <code>r x y ↔ (∃ b, x = b + dud) ∧ y = dud</code>. Then assuming <code>r x y</code>, the set <code>s</code> is <code>x.leftMoves ×ˢ {dud}</code> and the set <code>t</code> is <code>x.rightMoves ×ˢ {dud}</code>. You don't know that these are singleton sets until you prove the theorem!</p>\n</blockquote>\n<p>This is great but I was having trouble proving this version</p>\n</blockquote>\n<p>You can prove the equivalence version in terms of the more general principle I gave, the sets <code>s</code> and <code>t</code> you take are <code>range fun x =&gt; (x, el x)</code> and <code>range fun x =&gt; (x, er x)</code></p>",
        "id": 531572808,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753785406
    },
    {
        "content": "<p>But given how much I was able to golf using the non-equiv version I really doubt we want the equiv version</p>",
        "id": 531572895,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753785432
    },
    {
        "content": "<p>The reason I didn't use the non-equiv version is that I thought it was very hard to prove</p>",
        "id": 531573021,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753785472
    },
    {
        "content": "<p>it turns out it's just not hard at all</p>",
        "id": 531573040,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753785481
    },
    {
        "content": "<p>Yeah, the proof mostly boils down to unfolding <code>Functor.Liftr</code></p>",
        "id": 531573137,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753785509
    },
    {
        "content": "<p>Could the bisimulation theorem be stated using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Relator.BiTotal#doc\">docs#Relator.BiTotal</a></p>",
        "id": 531577800,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753786980
    },
    {
        "content": "<p>It could. A bisimulation is relation when <code>r x y</code> implies that <code>r</code> is bitotal when restricted to the left resp. right options of <code>x</code> and <code>y</code>.</p>",
        "id": 531799340,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753869295
    },
    {
        "content": "<p>That needlessly introduces subtypes though, so I'm not sure it's better than what I wrote down.</p>",
        "id": 531799697,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753869393
    },
    {
        "content": "<p>It might be worth adding that to the docstring, though.</p>",
        "id": 531799738,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753869407
    },
    {
        "content": "<p>Actually, it's a bit more subtle than that. A bisimulation requires that some subrelation of r is bitotal on the left resp. right sets, not necessarily that the entire thing is.</p>",
        "id": 531800095,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753869506
    },
    {
        "content": "<p>just mentioning <a class=\"message-link\" href=\"/#narrow/channel/516743-computer-science/topic/Bisimulation/near/530982132\">#computer science &gt; Bisimulation @ 💬</a>, in case there's opportunity for code reuse here</p>",
        "id": 531806325,
        "sender_full_name": "Bhavik Mehta",
        "timestamp": 1753871498
    },
    {
        "content": "<p>The problem isn't really defining bisimulations, but rather how to best convert the horrible functorial mess <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Functor.Liftr#doc\">docs#Functor.Liftr</a> gives you into something nice for our specific case.</p>",
        "id": 531806671,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753871624
    },
    {
        "content": "<p>Bisimulation proofs are so funny, as soon as you finish them you go back and realize \"hey the clever bisimulation i built is literally just an equality\"</p>",
        "id": 531956178,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753922039
    },
    {
        "content": "<p>I've been pretty successful with my lemma <code>eq_of_bisim</code>. Check this out:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">add_assoc'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">eq_of_bisim</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨⟨</span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">∪</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">∪</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">∪</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">∪</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)))</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩⟩</span>\n<span class=\"w\">  </span><span class=\"n\">all_goals</span><span class=\"w\"> </span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">image_union</span><span class=\"o\">])</span>\n</code></pre></div>",
        "id": 531957606,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753922970
    },
    {
        "content": "<p>I managed to prove the <code>SubtractionCommMonoid</code>structure on <code>LGame</code>, and prove a few simple equations like <code>on + off = dud</code> and <code>x + dud = dud</code>.<br>\n<a href=\"https://github.com/vihdzp/combinatorial-games/pull/166\">https://github.com/vihdzp/combinatorial-games/pull/166</a></p>",
        "id": 531958414,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753923523
    },
    {
        "content": "<p>If you think of equality in <code>QPF.Cofix</code> as a coinductive type with destructor</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">eq_liftr_dest</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">QPF</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">Cofix</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Functor</span><span class=\"bp\">.</span><span class=\"n\">Liftr</span><span class=\"w\"> </span><span class=\"n\">Eq</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">subst</span><span class=\"w\"> </span><span class=\"n\">h</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">&lt;$&gt;</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">comp_map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_def</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">id_map</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">comp_map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_def</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">QPF</span><span class=\"bp\">.</span><span class=\"n\">id_map</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">dest</span>\n</code></pre></div>\n<p>then bisimulation provides a corecursion principle for equality</p>",
        "id": 531959793,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753924518
    },
    {
        "content": "<p>Interesting! I hadn't really understood that link between corecursion and bisimulations.</p>",
        "id": 531961334,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753925611
    },
    {
        "content": "<p>Is it possible to define multiplication of loopy games?</p>",
        "id": 531967488,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753929524
    },
    {
        "content": "<p>In some \"natural\" way that gives you the theorem <code>toLGame (x * y) = toLGame x * toLGame y</code></p>",
        "id": 531967544,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753929555
    },
    {
        "content": "<p>Or perhaps more explicitly. Say that you have two games <code>corec α lα rα x</code> and <code>corec β lβ rβ y</code>. If you wanted to multiply them as <code>corec γ lγ rγ z</code>, what would the type <code>γ</code> be?</p>",
        "id": 531967698,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753929665
    },
    {
        "content": "<p>For addition, <code>γ = α × β</code>, representing that a state in the addition is a pair of states, one in <code>α</code>, one in <code>β</code>.</p>",
        "id": 531967734,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753929694
    },
    {
        "content": "<p>I guess you could define <code>γ</code> as some appropriate inductive type. Wouldn't be pretty, though.</p>",
        "id": 531968101,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753929927
    },
    {
        "content": "<p>Oh actually, it might work to define <code>γ = Multiset (α × β)</code>.</p>",
        "id": 531968701,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753930331
    },
    {
        "content": "<p>No, it's worse than that.</p>",
        "id": 531974434,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753934081
    },
    {
        "content": "<p>Correct me if I'm wrong but, every subposition of <code>x * y</code> looks like a finite sum of <code>± a_i * b_i</code> for <code>a_i</code> a subposition of <code>x</code> and <code>b_i</code> a subposition of <code>y</code></p>",
        "id": 532000286,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753946888
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 532004385,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753948248
    },
    {
        "content": "<p>So my idea is, define <code>x * y</code> as <code>corec (Multiset (Bool × LGame × LGame)) lγ rγ (true, x, y)</code>, where <code>lγ</code> and <code>rγ</code> are the bespoke functions that assign a multiset (interpreted as a game <code>Σ ±aᵢ × bᵢ</code>) to the other multisets for their left and right options.</p>",
        "id": 532006038,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753948804
    },
    {
        "content": "<p>This is an awful definition, and it will be awful to prove that the left and right moves of <code>x * y</code> are what we expect, but hopefully once we do that we never have to work with the multiset definition again.</p>",
        "id": 532006142,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753948831
    },
    {
        "content": "<p>Lmk if you have simpler ideas</p>",
        "id": 532006238,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753948855
    },
    {
        "content": "<p>I honestly doubt there's much to say about multiplication of loopy games in general. But at the very least we should still be able to prove the basic stuff like <code>0 * x = 0</code> and <code>1 * x = 1</code>.</p>",
        "id": 532156231,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1753991510
    },
    {
        "content": "<p>Question, is this true?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">proof_wanted</span><span class=\"w\"> </span><span class=\"n\">eq_iGame_of_not_subposition</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">Subposition</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IGame</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"n\">toLGame</span>\n</code></pre></div>",
        "id": 532202474,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754012657
    },
    {
        "content": "<p>no</p>",
        "id": 532204258,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754013593
    },
    {
        "content": "<p>Is anything similar to this true?</p>",
        "id": 532204333,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754013629
    },
    {
        "content": "<p>Basically I'm trying to find the conditions for a loopy game to not be loopy</p>",
        "id": 532204357,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754013636
    },
    {
        "content": "<p>the condition is that the subpositions are well founded</p>",
        "id": 532204414,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754013658
    },
    {
        "content": "<p>Oh, you're right. It is possible for a game to go on forever without repeating subpositions</p>",
        "id": 532204502,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754013686
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/532204333\">said</a>:</p>\n<blockquote>\n<p>Is anything similar to this true?</p>\n</blockquote>\n<p>the counterexample is <a class=\"message-link\" href=\"/#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/531214029\">#combinatorial-games &gt; Loopy games @ 💬</a>  but two sided</p>",
        "id": 532204510,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754013689
    },
    {
        "content": "<p>I think it's the same as <code>Acc Subposition x</code></p>",
        "id": 532205411,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754014176
    },
    {
        "content": "<p>That's a very elegant way to put it. So <code>IGame</code> is in a sense the subtype of accessible <code>LGame</code>s</p>",
        "id": 532206144,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754014584
    },
    {
        "content": "<p>I gave a definition of multiplication. But I'm having a really hard time proving <code>corec_mul_corec</code> and <code>leftMoves_mul</code>: <a href=\"https://github.com/vihdzp/combinatorial-games/blob/a60241d87afbc07c390c9b0b19ba38937e766c28/CombinatorialGames/Game/Loopy/Basic.lean#L576\">https://github.com/vihdzp/combinatorial-games/blob/a60241d87afbc07c390c9b0b19ba38937e766c28/CombinatorialGames/Game/Loopy/Basic.lean#L576</a></p>",
        "id": 532364091,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754075324
    },
    {
        "content": "<p>it can't be that hard right</p>",
        "id": 532364158,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754075360
    },
    {
        "content": "<p>I'll try</p>",
        "id": 532364164,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754075363
    },
    {
        "content": "<p>It may be that I'm not using the simplest/nicest definition for it, if you can find any improvements please push them to the branch!</p>",
        "id": 532364260,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754075409
    },
    {
        "content": "<p>I have an aversion to changing definitions even if it makes everything better</p>",
        "id": 532364384,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754075485
    },
    {
        "content": "<p>also I'm 90% sure that I don't have push access</p>",
        "id": 532364540,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754075561
    },
    {
        "content": "<p>Oh yeah you're right</p>",
        "id": 532364573,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754075574
    },
    {
        "content": "<p>uhhh you can clone my branch ig</p>",
        "id": 532364587,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754075579
    },
    {
        "content": "<p>try doing something simpler first</p>",
        "id": 532368487,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754077341
    },
    {
        "content": "<p>can you prove <code>leftMovesAux</code> commutes with the map</p>",
        "id": 532368510,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754077352
    },
    {
        "content": "<p>Can you write the type signature for that?</p>",
        "id": 532368627,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754077400
    },
    {
        "content": "<p>It would look like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">lα</span><span class=\"w\"> </span><span class=\"n\">rα</span><span class=\"w\"> </span><span class=\"n\">lβ</span><span class=\"w\"> </span><span class=\"n\">rβ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">lα'</span><span class=\"w\"> </span><span class=\"n\">rα'</span><span class=\"w\"> </span><span class=\"n\">lβ'</span><span class=\"w\"> </span><span class=\"n\">rβ'</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>\n<p>but I don't know what the relation between <code>lα</code> and <code>lα'</code> etc would be</p>",
        "id": 532368789,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754077461
    },
    {
        "content": "<p>the goal is to show that <code>leftMovesAux</code> is a natural transformation of functors</p>",
        "id": 532368992,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754077538
    },
    {
        "content": "<p>I'm currently trying to figure out what that translates to in Lean</p>",
        "id": 532369046,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754077565
    },
    {
        "content": "<p>I think this is correct</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/--</span>\n<span class=\"sd\">If `f : α₁ → α₂` and `g : β₁ → β₂` are morphisms in the category of `GameFunctor`-coalgebras then</span>\n<span class=\"sd\">the diagram</span>\n<span class=\"sd\">```</span>\n<span class=\"sd\">               leftMovesAux</span>\n<span class=\"sd\">    (Bool × α₁ × β₁) → Set (MulTy α₁ β₁)</span>\n<span class=\"sd\"> (id, f, g) ↓                   ↓ Set.image (MulTy.map f g)</span>\n<span class=\"sd\">    (Bool × α₂ × β₂) → Set (MulTy α₂ β₂)</span>\n<span class=\"sd\">               leftMovesAux</span>\n<span class=\"sd\">```</span>\n<span class=\"sd\">commutes</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux_comp_prodMap</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMovesα₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMovesβ₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">α₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">α₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">β₁</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">β₂</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">fl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">fr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">gl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">gr</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 532371012,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754078520
    },
    {
        "content": "<p>wow, and yikes</p>",
        "id": 532371094,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754078559
    },
    {
        "content": "<p>the diagram makes it easy to understand</p>",
        "id": 532371161,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754078594
    },
    {
        "content": "<p>That's appreciated</p>",
        "id": 532371180,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754078605
    },
    {
        "content": "<p>Here you go!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kd\">@[</span><span class=\"n\">simp</span><span class=\"kd\">]</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">map_mulOption</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mulOption</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">mulOption</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">mulOption</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"o\">]</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">maxHeartBeats</span><span class=\"w\"> </span><span class=\"mi\">500000</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux'_comp_prodMap</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux'</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux'</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">funext_iff</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux'</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">at</span><span class=\"w\"> </span><span class=\"bp\">*</span>\n<span class=\"w\">  </span><span class=\"n\">aesop</span>\n</code></pre></div>",
        "id": 532373610,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754079775
    },
    {
        "content": "<p>God bless aesop</p>",
        "id": 532373626,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754079780
    },
    {
        "content": "<p><code>500000</code>???</p>",
        "id": 532373657,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754079791
    },
    {
        "content": "<p>wow</p>",
        "id": 532373664,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754079793
    },
    {
        "content": "<p>that's for the primed version but the unprimed version should follow directly from this and the analogous result for right moves</p>",
        "id": 532373718,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754079816
    },
    {
        "content": "<p>great</p>",
        "id": 532373760,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754079841
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/532373657\">said</a>:</p>\n<blockquote>\n<p><code>500000</code>???</p>\n</blockquote>\n<p>Not even the highest number in our repo <span aria-label=\"sob\" class=\"emoji emoji-1f62d\" role=\"img\" title=\"sob\">:sob:</span></p>",
        "id": 532373775,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754079847
    },
    {
        "content": "<p>It seems you have already done the appropriate square for <code>split</code> so next is <code>leftMoves</code> and <code>rightMoves</code></p>",
        "id": 532373991,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754079965
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux_comp_prodMap</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span>\n<span class=\"w\">      </span><span class=\"n\">MulTy</span><span class=\"bp\">.</span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">funext</span>\n<span class=\"w\">  </span><span class=\"n\">rintro</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">congrFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rightMovesAux'_comp_prodMap</span><span class=\"w\"> </span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"n\">hrg</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">false</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">congrFun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">leftMovesAux'_comp_prodMap</span><span class=\"w\"> </span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"n\">hrg</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">true</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 532375601,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754080744
    },
    {
        "content": "<p>Yeah this one was easy</p>",
        "id": 532375627,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754080752
    },
    {
        "content": "<p>I should be able to prove the actual result now maybe?</p>",
        "id": 532375644,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754080759
    },
    {
        "content": "<p>that's the idea</p>",
        "id": 532375663,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754080765
    },
    {
        "content": "<p>Awesome!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMoves_comp_map</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hrg</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₂</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₂</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₂</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span>\n<span class=\"w\">    </span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"n\">leftMovesα₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesα₁</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ₁</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ₁</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">funext</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"n\">simp_rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">image_sUnion</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">split_map</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">coe_image</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">image_image</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map_fst</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map_snd</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">comp_apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Prod</span><span class=\"bp\">.</span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)),</span>\n<span class=\"w\">    </span><span class=\"n\">leftMovesAux_comp_prodMap</span><span class=\"w\"> </span><span class=\"n\">hlf</span><span class=\"w\"> </span><span class=\"n\">hrf</span><span class=\"w\"> </span><span class=\"n\">hlg</span><span class=\"w\"> </span><span class=\"n\">hrg</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">aesop</span>\n</code></pre></div>",
        "id": 532378354,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754082029
    },
    {
        "content": "<p>Just managed to prove <code>corec_mul_corec</code> too! Pushed it to the branch.</p>",
        "id": 532378690,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754082208
    },
    {
        "content": "<p>yay</p>",
        "id": 532378722,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754082223
    },
    {
        "content": "<p><code>leftMoves_mul</code> should follow then I think</p>",
        "id": 532378734,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754082232
    },
    {
        "content": "<p>On a related note. I'm a bit unsure about how much of <code>MulTy</code> should be private API and how much should be public.</p>",
        "id": 532378754,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754082243
    },
    {
        "content": "<p>I think to prove <code>leftMoves_mul</code> you might have to use <code>hom_unique</code> again</p>",
        "id": 532381521,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754083769
    },
    {
        "content": "<p>Oh oops turns out my definition of <code>leftMovesAux</code>is wrong <span aria-label=\"frown\" class=\"emoji emoji-1f641\" role=\"img\" title=\"frown\">:frown:</span></p>",
        "id": 532381558,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754083787
    },
    {
        "content": "<p>:(</p>",
        "id": 532381572,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754083795
    },
    {
        "content": "<p>It should be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">leftMovesAux</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulTy</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">rec</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">rightMovesAux'</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">!</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">leftMovesAux'</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>(the <code>(!x.1, x.2)</code> bit was just an <code>x</code> previously)</p>",
        "id": 532381648,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754083840
    },
    {
        "content": "<p>Since left moves of <code>-x * y</code> are <em>negatives</em> of right moves of <code>x * y</code></p>",
        "id": 532381710,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754083884
    },
    {
        "content": "<p>thankfully all the other proofs compile with minimal changes</p>",
        "id": 532381733,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754083897
    },
    {
        "content": "<p>I'm glad I don't have to think about this</p>",
        "id": 532381735,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754083899
    },
    {
        "content": "<p>I'm thinking about the privacy thing still. What do you think about making <code>leftMovesAux'</code> private, but making <code>leftMovesAux</code> public (with a better name) as well as <code>leftMoves</code>?</p>",
        "id": 532381920,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084018
    },
    {
        "content": "<p>no idea</p>",
        "id": 532381933,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754084031
    },
    {
        "content": "<p>Specifically, we'd make this public API:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">leftMovesSingle_def</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Bool</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">leftMovesSingle</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">rec</span>\n<span class=\"w\">      </span><span class=\"o\">((</span><span class=\"n\">mulOption</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">!</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">''</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">×ˢ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">×ˢ</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"n\">mulOption</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">''</span>\n<span class=\"w\">        </span><span class=\"o\">(</span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">×ˢ</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">×ˢ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"bp\">_⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">rfl</span>\n</code></pre></div>",
        "id": 532382442,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084323
    },
    {
        "content": "<p>(<code>leftMovesAux</code> → <code>leftMovesSingle</code>)</p>",
        "id": 532382471,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084342
    },
    {
        "content": "<p>sure I guess</p>",
        "id": 532382592,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754084413
    },
    {
        "content": "<p>Wait I'm realizing something isn't </p>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/532381710\">said</a>:</p>\n<blockquote>\n<p>Since left moves of <code>-x * y</code> are <em>negatives</em> of right moves of <code>x * y</code></p>\n</blockquote>\n<p>oh also nvm about this I just realized that I don't have to negate <code>x.1</code> like that since that's already the case where it's false</p>",
        "id": 532382654,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084449
    },
    {
        "content": "<p>you can tell I barely have a grasp on this</p>",
        "id": 532382692,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084459
    },
    {
        "content": "<p>I might understand it if you translate it into category theory</p>",
        "id": 532382766,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754084503
    },
    {
        "content": "<p>I've no idea how to do that</p>",
        "id": 532382818,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084528
    },
    {
        "content": "<p>I think this makes more sense if you think of <code>MulTy α β</code> as the type of formal signed sums of products in <code>α × β</code></p>",
        "id": 532383069,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084691
    },
    {
        "content": "<p>so it's the free something on <code>α × β</code></p>",
        "id": 532383188,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754084756
    },
    {
        "content": "<p><code>Multiset α</code> is the free commutative monoid on <code>α</code> I believe</p>",
        "id": 532383246,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084790
    },
    {
        "content": "<p>so <code>MulTy α β</code> is the free commutative monoid on <code>Bool × α × β</code></p>",
        "id": 532383269,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754084808
    },
    {
        "content": "<p>...sure</p>",
        "id": 532383333,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754084848
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/532381521\">said</a>:</p>\n<blockquote>\n<p>I think to prove <code>leftMoves_mul</code> you might have to use <code>hom_unique</code> again</p>\n</blockquote>\n<p>Yeah, I think I need to prove that <code>mulOption</code> commutes with <code>corec</code></p>",
        "id": 532384937,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754085727
    },
    {
        "content": "<p>More specifically this (I think <code>h</code> is redundant here)<br>\n<a href=\"/user_uploads/3121/5jSZtB6fjdgajluNWVlYgkcz/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/5jSZtB6fjdgajluNWVlYgkcz/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"471x173\" src=\"/user_uploads/thumbnail/3121/5jSZtB6fjdgajluNWVlYgkcz/image.png/840x560.webp\"></a></div>",
        "id": 532385605,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754086123
    },
    {
        "content": "<p>Actually this looks more like <code>corec_comp_hom</code>.</p>",
        "id": 532387481,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754087278
    },
    {
        "content": "<p>In either case I have no idea what the map is supposed to be</p>",
        "id": 532388714,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754088094
    },
    {
        "content": "<p>help welcome</p>",
        "id": 532388718,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754088099
    },
    {
        "content": "<p>Oh NVM I get it</p>",
        "id": 532391103,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754089968
    },
    {
        "content": "<p>I have to define the function <code>MulTy LGame LGame -&gt; LGame</code> in the obvious way</p>",
        "id": 532391157,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754090004
    },
    {
        "content": "<p>And use that in <code>corec_comp_hom</code></p>",
        "id": 532391196,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754090035
    },
    {
        "content": "<p>I've kept deliberating on this. I really think <code>MulTy</code> should be public API. There's a sort of naturality here: addition of two games is described by a pair of states from both games. Multiplication of two games is described by a signed finite sum of pairs of states of both games.</p>",
        "id": 532402033,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754098527
    },
    {
        "content": "<p>Following this, we could add <code>ConcreteGame (α × β)</code> and <code>ConcreteGame (MulTy α β)</code> instances.</p>",
        "id": 532402059,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754098551
    },
    {
        "content": "<p>Speaking of. I was thinking about splitting <code>ConcreteGame</code> into <code>ConcreteLGame</code> and <code>ConcreteIGame</code>, with the latter extending the former with proofs that <code>relLeft</code> and <code>relRight</code> are wf.</p>",
        "id": 532403649,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754099920
    },
    {
        "content": "<p>that sounds not bad</p>",
        "id": 532405035,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754100984
    },
    {
        "content": "<p>I managed to find a bit of a simplification in definitions. Turns out you don't need <code>MulTy.split</code>, you can just do this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MulTy</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">MulTy</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">⋃</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">erase</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">''</span><span class=\"w\"> </span><span class=\"n\">leftMovesSingle</span><span class=\"w\"> </span><span class=\"n\">leftMovesα</span><span class=\"w\"> </span><span class=\"n\">rightMovesα</span><span class=\"w\"> </span><span class=\"n\">leftMovesβ</span><span class=\"w\"> </span><span class=\"n\">rightMovesβ</span><span class=\"w\"> </span><span class=\"n\">y</span>\n</code></pre></div>",
        "id": 532412241,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754107260
    },
    {
        "content": "<p>I like how when you simplify a definition the proofs follow neatly</p>",
        "id": 532413291,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754108018
    },
    {
        "content": "<p>I'm still breaking my head over this. I haven't been able to prove the main theorem about <code>MulTy</code> yet (<code>corec</code> of <code>x : MulTy α β</code> equals <code>Σ ±aᵢ * bᵢ</code>), but I feel like I'm making progress.</p>",
        "id": 532504829,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754185071
    },
    {
        "content": "<p>Can't continue today though, and probably can't continue tomorrow either, but I'll see what I can do over the week.</p>",
        "id": 532504845,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754185086
    },
    {
        "content": "<p>good luck</p>",
        "id": 532504869,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754185104
    },
    {
        "content": "<p>Call an <code>LGame</code> short if <code>Finite {y | Subposition y x}</code>. Is the product of two short <code>LGame</code>s short?</p>",
        "id": 532805952,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754346375
    },
    {
        "content": "<p>At face value it seems like the answer should be no, because <code>MulTy α β</code> is always infinite for nonempty types. But it is possible for a lot of the states to collapse. For instance, I'm pretty sure <code>dud * x = dud</code> for all <code>x ≠ 0</code>.</p>",
        "id": 532806054,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754346451
    },
    {
        "content": "<p>At the very least, I'm not aware of counterexamples.</p>",
        "id": 532806160,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754346535
    },
    {
        "content": "<p>Consider <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi></mrow><mo>=</mo><mo stretchy=\"false\">{</mo><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi><mi mathvariant=\"bold\">n</mi></mrow><mi mathvariant=\"normal\">∣</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\bold{tis} = \\{\\bold{tisn} | \\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">tis</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathbf\">tisn</span></span><span class=\"mord\">∣</span><span class=\"mclose\">}</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi><mi mathvariant=\"bold\">n</mi></mrow><mo>=</mo><mo stretchy=\"false\">{</mo><mi mathvariant=\"normal\">∣</mi><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi></mrow><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\bold{tisn} = \\{ | \\bold{tis}\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">tisn</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathbf\">tis</span></span><span class=\"mclose\">}</span></span></span></span></p>",
        "id": 532808783,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754348716
    },
    {
        "content": "<p>then I claim the product <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi></mrow><mo>⋅</mo><mrow><mi mathvariant=\"bold\">t</mi><mi mathvariant=\"bold\">i</mi><mi mathvariant=\"bold\">s</mi><mi mathvariant=\"bold\">n</mi></mrow></mrow><annotation encoding=\"application/x-tex\">\\bold{tis} \\cdot \\bold{tisn}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">tis</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">tisn</span></span></span></span></span> has infinitely many distinct subpositions</p>",
        "id": 532808977,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754348843
    },
    {
        "content": "<p>What does tis stand for?</p>",
        "id": 532814826,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354108
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/-ZiU9nt2xQX6OdgqRxR7CMtg/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/-ZiU9nt2xQX6OdgqRxR7CMtg/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"692x427\" src=\"/user_uploads/thumbnail/3121/-ZiU9nt2xQX6OdgqRxR7CMtg/image.png/840x560.webp\"></a></div>",
        "id": 532814976,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754354236
    },
    {
        "content": "<p>from Winning Ways volume 2</p>",
        "id": 532814986,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754354250
    },
    {
        "content": "<p>Oh nice</p>",
        "id": 532814997,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354261
    },
    {
        "content": "<p>Someone should make a small PR adding those two</p>",
        "id": 532815059,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354326
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 532815060,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354326
    },
    {
        "content": "<p>So clearly tisn= -tis and thus tis * tisn = -(tis * tis)</p>",
        "id": 532815126,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354379
    },
    {
        "content": "<p>I have to go for now</p>",
        "id": 532815188,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754354448
    },
    {
        "content": "<p>The only left move of tis * tis is -3 • (tis * tis), it has no right moves</p>",
        "id": 532815194,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354454
    },
    {
        "content": "<p>It doesn't seem completely implausible that tis * tis = tis</p>",
        "id": 532815244,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354511
    },
    {
        "content": "<p>I gtg too, I'll come back to this</p>",
        "id": 532815260,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754354524
    },
    {
        "content": "<p>So then 3 • (tis * tis) = {2 • (tis * tis) - 3 • (tis * tis) | }</p>",
        "id": 532816761,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754355988
    },
    {
        "content": "<p>Interesting</p>",
        "id": 532816782,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356005
    },
    {
        "content": "<p>I'm back</p>",
        "id": 532816827,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356034
    },
    {
        "content": "<p>So am I</p>",
        "id": 532816841,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356045
    },
    {
        "content": "<p>welcome back</p>",
        "id": 532816931,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356117
    },
    {
        "content": "<p>so the infinitely many subpositions I was talking about is <code>3 ^ n • (tis * tis)</code> for every odd <code>n</code></p>",
        "id": 532816992,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356180
    },
    {
        "content": "<p>clearly these are all distinct</p>",
        "id": 532817036,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356229
    },
    {
        "content": "<p>and they also all arise as subpositions</p>",
        "id": 532817049,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356236
    },
    {
        "content": "<p>It's not clear to me</p>",
        "id": 532817051,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356236
    },
    {
        "content": "<p>There's idempotent games such as <code>dud</code></p>",
        "id": 532817058,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356248
    },
    {
        "content": "<p>count how many moves you can make in a row as left before you run out</p>",
        "id": 532817075,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356266
    },
    {
        "content": "<p>The only left option of <code>3 ^ n • (tis * tis)</code> is <code>(3 ^ n - 1) • (tis * tis) - 3 • (tis * tis)</code></p>",
        "id": 532817231,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356413
    },
    {
        "content": "<p>The left options of that I'm not too eager to calculate</p>",
        "id": 532817254,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356442
    },
    {
        "content": "<p>what are the left options of <code>- 3 • (tis * tis)</code>?</p>",
        "id": 532817273,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754356462
    },
    {
        "content": "<p>Oh, there's none</p>",
        "id": 532817292,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356476
    },
    {
        "content": "<p>I see</p>",
        "id": 532817296,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356479
    },
    {
        "content": "<p>So you can do 3 ^ n consecutive moves as left, no less and no more</p>",
        "id": 532817349,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356519
    },
    {
        "content": "<p>And obviously this value is well-defined so that shows all these games are distinct</p>",
        "id": 532817401,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356569
    },
    {
        "content": "<p>Oh and also obviously they're all achievable as subpositions</p>",
        "id": 532817432,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356597
    },
    {
        "content": "<p>You just keep dividing <code>tis * tis</code> into <code>-3</code> copies of itself over and over</p>",
        "id": 532817451,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356622
    },
    {
        "content": "<p>Awesome!</p>",
        "id": 532817464,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356630
    },
    {
        "content": "<p>I'd love to see this in the counterexample folder</p>",
        "id": 532817481,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356647
    },
    {
        "content": "<p>...as soon as I actually PR multiplication of loopy games, that is</p>",
        "id": 532817489,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754356658
    },
    {
        "content": "<p>I did it!<br>\n<a href=\"/user_uploads/3121/bI0e7e_YN0RpbeOrmYPNxj6X/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/bI0e7e_YN0RpbeOrmYPNxj6X/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"872x427\" src=\"/user_uploads/thumbnail/3121/bI0e7e_YN0RpbeOrmYPNxj6X/image.png/840x560.webp\"></a></div>",
        "id": 532850689,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754378636
    },
    {
        "content": "<p>Only took 400 lines of code + two <code>maxHeartbeats 1000000</code></p>",
        "id": 532850737,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754378659
    },
    {
        "content": "<p>(feel inclined to tag Bhavik just to annoy him <span aria-label=\"stuck out tongue\" class=\"emoji emoji-1f61b\" role=\"img\" title=\"stuck out tongue\">:stuck_out_tongue:</span>)</p>",
        "id": 532850782,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754378681
    },
    {
        "content": "<p><a href=\"https://github.com/vihdzp/combinatorial-games/pull/168\">https://github.com/vihdzp/combinatorial-games/pull/168</a></p>",
        "id": 532853937,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754379765
    },
    {
        "content": "<p>I made a best effort to organize and explain my code, though it's still a bit rough around the edges. I'd appreciate if you guys could take a good look.</p>",
        "id": 532880843,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754387787
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/532815059\">said</a>:</p>\n<blockquote>\n<p>Someone should make a small PR adding those two</p>\n</blockquote>\n<p>I truly can't help myself<br>\n<a href=\"https://github.com/vihdzp/combinatorial-games/pull/171/files\">https://github.com/vihdzp/combinatorial-games/pull/171/files</a></p>",
        "id": 532883405,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754388748
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"767695\">@Tristan Figueroa-Reid</span> asking you as someone more familiar with literature. How should we define the preorder of loopy games?</p>",
        "id": 533043992,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754466586
    },
    {
        "content": "<p>I've been reluctant about adding definitions of outcomes to <code>IGame</code>, since they're entirely determined by the order relations of a game with 0. But in the loopy case this isn't true anymore.</p>",
        "id": 533044322,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754466707
    },
    {
        "content": "<p>No clue for that one. Outcome classes are the only way I know how to reason with ordering for loopy games.</p>",
        "id": 533044328,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754466710
    },
    {
        "content": "<p>You could also try defining ordering with stoppers? Though it seems more intuitive to define ordering with outcome classes, then formalize stoppers and reason with those after the fact.</p>",
        "id": 533044805,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754466858
    },
    {
        "content": "<p>In any case we need <em>some</em> way to state what the outcome of a game is.</p>",
        "id": 533045289,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754467036
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533044805\">said</a>:</p>\n<blockquote>\n<p>You could also try defining ordering with stoppers? Though it seems more intuitive to define ordering with outcome classes, then formalize stoppers and reason with those after the fact.</p>\n</blockquote>\n<p>How do you define ordering with stoppers?</p>",
        "id": 533045885,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754467250
    },
    {
        "content": "<p>I think this trick was done in Aaron Siegel's masters thesis (this might not be terminating on long loopy games?), but for determining G &lt;= H, you can show that right can not force left to run out of games in H - G by traversing H - G starting at its start vertex:</p>\n<p>When traversing a vertex <code>V</code> with player <code>P</code>, you store a counter <code>c</code> to V for the number of its outgoing edges that are not marked as wins for the opposing player of <code>P</code>. If <code>c</code> is 0 then <code>V</code> is a win, and all nodes connecting incoming edges get their counters decremented (where this <code>c = 0</code> check gets propagated backwards). Then you repeat this for all outgoing neighbors of <code>V</code>.</p>\n<p>(I'll just try to find the reference but I don't have a copy of Aaron Siegel's thesis anymore?)</p>",
        "id": 533047613,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754467856
    },
    {
        "content": "<p>(Then, since this works only for stoppers, you can decompose a game into its sides and do this check for both sides when either one of G and H aren't loopy)</p>",
        "id": 533048368,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754468120
    },
    {
        "content": "<p>But not all loopy games have such a decomposition, do they?</p>",
        "id": 533048466,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754468150
    },
    {
        "content": "<p>I recall seeing that in another of Siegel's papers</p>",
        "id": 533048505,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754468161
    },
    {
        "content": "<p>Right - Bach's Carousel can't be decomposed with sides.</p>",
        "id": 533048805,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754468259
    },
    {
        "content": "<p>So I think the question now is how to formalize outcomes.</p>",
        "id": 533048901,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754468287
    },
    {
        "content": "<p>Do we need to first formalize strategies? That sounds somewhat painful.</p>",
        "id": 533048944,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754468306
    },
    {
        "content": "<p>I don't think so? At least for non-tied loopy games, you can say that a loopy game is winnable by Left or Right recursively by looking for empty sets of right or left moves respectively (then for games with no empty right/left sets, looking at the right/left options and checking if any of it's left/right options are in the desired outcome class).</p>",
        "id": 533049257,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754468435
    },
    {
        "content": "<p>Well that's the thing, we can't define things recursively if the games aren't well-founded</p>",
        "id": 533049522,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754468536
    },
    {
        "content": "<p>Perhaps if there exists some amount of fuel which can be used to traverse these games?</p>",
        "id": 533049744,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754468625
    },
    {
        "content": "<p>Actually. What even is the mathematical definition of saying that a loopy game is tied, say, if left starts?</p>",
        "id": 533051927,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754469399
    },
    {
        "content": "<p>Good question! I've always understood it as games that don't belong in any of the winning outcome classes, which is why I suggested using fuel.</p>",
        "id": 533052301,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754469548
    },
    {
        "content": "<p>I'm unsure if using fuel works even in the case of an infinite well-founded game.</p>",
        "id": 533052596,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754469656
    },
    {
        "content": "<p>At least I can't figure out how to complete the idea. Is it \"a game is tied iff it isn't won by left or right in n moves, for any n\"?</p>",
        "id": 533052717,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754469693
    },
    {
        "content": "<p>Take some positive game x such that for every n, there exists some right option of x that cannot end in less than n turns. This definitely exists, I think every positive irrational should work.</p>\n<p>Then, if right starts, the game x is won by left, but it's not necessarily won by left in n turns, for any given n.</p>",
        "id": 533054602,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754470287
    },
    {
        "content": "<p>From working with loopy vs. well-founded games, I get the impression that the theory of loopy games is somehow more global - for instance, to define a general loopy game, you need to use the corecursor, which requires you to build the entire game graph. By contrast, the theory of well-founded games is more local. To define a game you only need consider its immediate options.</p>",
        "id": 533055354,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754470552
    },
    {
        "content": "<p>From that perspective, it seems quite reasonable that strategies would be required to talk about loopy games, even if they can be omitted from a treatment of well-founded games.</p>",
        "id": 533055454,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754470584
    },
    {
        "content": "<p>Though perhaps a better question to ask: how do you define survivability?</p>",
        "id": 533057565,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471293
    },
    {
        "content": "<p>I think that is what we need to formalize. A strategy is just a proof of survivability <del>on a well-founded game.</del></p>",
        "id": 533057780,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471356
    },
    {
        "content": "<p>Informally a strategy is a sort of recursive object. In a strategy for left, for every subposition reachable by right under the strategy, it assigns a left move. (Which in particular implies a left move exists, under these circumstances)</p>",
        "id": 533058570,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471602
    },
    {
        "content": "<p>As to how to translate this into Lean...</p>",
        "id": 533058667,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471635
    },
    {
        "content": "<p>I feel like this might be a coinductive type? Not sure.</p>",
        "id": 533058954,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471715
    },
    {
        "content": "<p>You can (terribly, with dependent types and all) formalize strategies by making a function from an LGame subtype of all possible options of <code>x</code>  to its subpositions. However, I don't think having a definition of strategy is the biggest concern?</p>",
        "id": 533058973,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754471720
    },
    {
        "content": "<p>Well, I don't see a way to define survivability otherwise.</p>",
        "id": 533059044,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471746
    },
    {
        "content": "<p>How would survivability be defined?</p>",
        "id": 533059114,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754471766
    },
    {
        "content": "<p>Left survives a loopy game if there exists a strategy for him.</p>",
        "id": 533059164,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471783
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533058973\">said</a>:</p>\n<blockquote>\n<p>You can (terribly, with dependent types and all) formalize strategies by making a function from an LGame subtype of all possible options of <code>x</code>  to its subpositions. However, I don't think having a definition of strategy is the biggest concern?</p>\n</blockquote>\n<p>That's not quite it, I think. What would be a left strategy for 1? It exists, of course. But there's no function that maps all subpositions of 1 to a left option of them, because 0 has no left option.</p>",
        "id": 533059673,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471955
    },
    {
        "content": "<p>Perhaps I misunderstand what you mean?</p>",
        "id": 533059708,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754471964
    },
    {
        "content": "<p>You're right, it should be a partial function.</p>",
        "id": 533059780,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754471988
    },
    {
        "content": "<p>Oh, that might actually work</p>",
        "id": 533059846,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472004
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533059164\">said</a>:</p>\n<blockquote>\n<p>Left survives a loopy game if there exists a strategy for him.</p>\n</blockquote>\n<p>Strategies can exist without them being good ones.</p>",
        "id": 533059864,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754472007
    },
    {
        "content": "<p>So a partial function such that if you follow it, the output is never <code>none</code>?</p>",
        "id": 533059954,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472039
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533059954\">said</a>:</p>\n<blockquote>\n<p>So a partial function such that if you follow it, the output is never <code>none</code>?</p>\n</blockquote>\n<p>Hm, that might work for properly loopy games, but I believe that fails for well-founded games.</p>",
        "id": 533060071,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754472070
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533059864\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533059164\">said</a>:</p>\n<blockquote>\n<p>Left survives a loopy game if there exists a strategy for him.</p>\n</blockquote>\n<p>Strategies can exist without them being good ones.</p>\n</blockquote>\n<p>I'm not saying Left has to win. To survive a game is simply not to lose.</p>",
        "id": 533060115,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472081
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533060071\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533059954\">said</a>:</p>\n<blockquote>\n<p>So a partial function such that if you follow it, the output is never <code>none</code>?</p>\n</blockquote>\n<p>Hm, that might work for properly loopy games, but I believe that fails for well-founded games.</p>\n</blockquote>\n<p>Take 1. A strategy for left is the function 1 -&gt; 0 and 0 -&gt; none. If you follow the strategy, after any right move, the function doesn't return none, because there's no move right can make if you follow the strategy!</p>",
        "id": 533060347,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472155
    },
    {
        "content": "<p>Hm. How about a Left strategy on -1?</p>",
        "id": 533060420,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754472176
    },
    {
        "content": "<p>That won't exist, because -1 is won by right.</p>",
        "id": 533060479,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472190
    },
    {
        "content": "<p>Right. Left's strategy on <code>{-1|}</code>?</p>",
        "id": 533060572,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754472224
    },
    {
        "content": "<p>That's equivalent to 0, right? So if left starts he doesn't have a strategy, because right wins.</p>",
        "id": 533061016,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472369
    },
    {
        "content": "<p>Let me formalize what I mean. Let x be a game. Let f be a partial function mapping subpositions of x to either left options of them, or none. Define a (left) \"history\" of f as a list of pairs p_i = (a_i, b_i), where a_0 = x, b_i is some arbitrary right move of a_i, and a_(i+1) = f(b_i). Then f is a strategy for left (starting first) if for every history of f ending in (a_i, b_i), we have f(b_i) ≠ none.</p>",
        "id": 533062160,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472764
    },
    {
        "content": "<p>A strategy for left starting second can be defined similarly. It can also be defined as a function from right options of x to strategies of left starting first.</p>",
        "id": 533062471,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754472864
    },
    {
        "content": "<p>This definition seems to work <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 533063065,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754473065
    },
    {
        "content": "<p>Here's a stub:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">CombinatorialGames</span><span class=\"bp\">.</span><span class=\"n\">Game</span><span class=\"bp\">.</span><span class=\"n\">Loopy</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">CombinatorialGames</span><span class=\"bp\">.</span><span class=\"n\">Game</span><span class=\"bp\">.</span><span class=\"n\">IGame</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">LGame</span>\n\n<span class=\"sd\">/-- A sequence of moves following a left strategy `f`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LeftHistory</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"k\">match</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">False</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">LeftHistory</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">c</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">d</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">::</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">LeftHistory</span><span class=\"bp\">.</span><span class=\"n\">ne_nil</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftHistory</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"o\">[]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">cases</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"k\">with</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">nil</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">contradiction</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">cons</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"bp\">.</span><span class=\"n\">cons_ne_nil</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span>\n\n<span class=\"sd\">/-- A strategy for Left, when they go second. -/</span>\n<span class=\"kn\">structure</span><span class=\"w\"> </span><span class=\"n\">LeftStrategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">forall_mem_leftMoves</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span>\n<span class=\"w\">  </span><span class=\"n\">exists_forall_leftHistory</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">List</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hl</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftHistory</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hl₀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">getLast</span><span class=\"w\"> </span><span class=\"n\">hl</span><span class=\"bp\">.</span><span class=\"n\">ne_nil</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"bp\">.</span><span class=\"n\">head</span><span class=\"w\"> </span><span class=\"n\">hl</span><span class=\"bp\">.</span><span class=\"n\">ne_nil</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">isSome</span>\n\n<span class=\"n\">proof_wanted</span><span class=\"w\"> </span><span class=\"n\">zero_le_of_leftStrategy</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IGame</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LeftStrategy</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">toLGame</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">x</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">LGame</span>\n</code></pre></div>",
        "id": 533069223,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475126
    },
    {
        "content": "<p>Does this seem reasonable?</p>",
        "id": 533069233,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475130
    },
    {
        "content": "<p>I have a different idea</p>",
        "id": 533069294,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475155
    },
    {
        "content": "<p>I'm all ears</p>",
        "id": 533069317,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475166
    },
    {
        "content": "<p>Instead of asking left to win in <code>n</code> moves for some <code>n</code></p>",
        "id": 533069393,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475188
    },
    {
        "content": "<p>wait what was the goal again?</p>",
        "id": 533069608,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475274
    },
    {
        "content": "<p>To define a Preorder on <code>LGame</code></p>",
        "id": 533069637,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754475285
    },
    {
        "content": "<p>what's the order?</p>",
        "id": 533069673,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475295
    },
    {
        "content": "<p>The one from Misere games</p>",
        "id": 533069753,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475313
    },
    {
        "content": "<p>x ≤ y when o(x + z) ≤ o(y + z) for all z</p>",
        "id": 533069805,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475331
    },
    {
        "content": "<p>so the goal is to define outcomes</p>",
        "id": 533069841,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475347
    },
    {
        "content": "<p>Indeed</p>",
        "id": 533069882,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475363
    },
    {
        "content": "<p>I was trying to define what it meant for a player to survive a game</p>",
        "id": 533069908,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475375
    },
    {
        "content": "<p>I don't see a better way to do it than strategies</p>",
        "id": 533069930,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475382
    },
    {
        "content": "<p>Define survive as \"not die\"?</p>",
        "id": 533070073,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475435
    },
    {
        "content": "<p>I have an idea that I think works for dying on stoppers</p>",
        "id": 533070168,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475469
    },
    {
        "content": "<p>Stoppers are fine, but I think it was brought up earlier that we can't decompose all LGames to their sides.</p>",
        "id": 533070224,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754475490
    },
    {
        "content": "<p>yeah not all loopy games have stopper sides</p>",
        "id": 533070271,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475507
    },
    {
        "content": "<p>I think</p>",
        "id": 533070302,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475518
    },
    {
        "content": "<p>(yet another thing to add to the counterexample folder)</p>",
        "id": 533070317,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475526
    },
    {
        "content": "<p>I'm a bit hazy on everything</p>",
        "id": 533070329,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475530
    },
    {
        "content": "<p>I think we had an explicit counterexample of Bach's Carousel. That's going to be fun to encode in <code>LGame</code>.</p>",
        "id": 533070437,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754475565
    },
    {
        "content": "<p>So yeah, the best idea I've got is to define strategies</p>",
        "id": 533071217,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754475882
    },
    {
        "content": "<p>Here's my spelling of \"left kills right when right goes first on <code>x</code>\":</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Option</span><span class=\"w\"> </span><span class=\"n\">Ordinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}),</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"bp\">.</span><span class=\"n\">isSome</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">,</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">o'</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">o'</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">o'</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">o'</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">o</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 533071286,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475910
    },
    {
        "content": "<p>this also works with slight modifications for left going first, or for right killing left</p>",
        "id": 533071427,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754475973
    },
    {
        "content": "<p>I think I sort of get it. <code>f x</code> is supposed to represent the number of left/right moves remaining?</p>",
        "id": 533072065,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476200
    },
    {
        "content": "<p>yes</p>",
        "id": 533072095,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476208
    },
    {
        "content": "<blockquote>\n<p><code>∀ y, (∀ o ∈ y.1, ∃ z ∈ y.leftMoves, ∃ o' ∈ z.2, o' &lt; o)</code></p>\n</blockquote>\n<p>I have no idea what the types are supposed to be here.</p>",
        "id": 533072369,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476297
    },
    {
        "content": "<p>sorry, editited</p>",
        "id": 533072477,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476346
    },
    {
        "content": "<p>I think it should be good now</p>",
        "id": 533072560,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476378
    },
    {
        "content": "<p>I was typing this without an infoview</p>",
        "id": 533072598,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476387
    },
    {
        "content": "<p>Shouldn't it be <code>o ≤ o'</code> in the last inequality?</p>",
        "id": 533073331,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476693
    },
    {
        "content": "<p>explain?</p>",
        "id": 533073372,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476708
    },
    {
        "content": "<p>Every right move of <code>y</code> should be no better for right than for left</p>",
        "id": 533073394,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476714
    },
    {
        "content": "<p>I don't get it</p>",
        "id": 533073443,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476735
    },
    {
        "content": "<p><code>o</code> is the value for right, <code>o'</code> is the value for left</p>",
        "id": 533073470,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476745
    },
    {
        "content": "<p>I think</p>",
        "id": 533073488,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476750
    },
    {
        "content": "<p>not true</p>",
        "id": 533073495,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476752
    },
    {
        "content": "<p>the ordinals need to decrease to ensure termination</p>",
        "id": 533073603,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476783
    },
    {
        "content": "<p>What do the ordinals represent, though?</p>",
        "id": 533073909,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754476913
    },
    {
        "content": "<p>they're a death clock</p>",
        "id": 533073945,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476927
    },
    {
        "content": "<p>they keep decreasing, and when they hit zero then right loses</p>",
        "id": 533073980,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754476939
    },
    {
        "content": "<p>And left never loses before right does, because...?</p>",
        "id": 533074215,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477012
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533072065\">said</a>:</p>\n<blockquote>\n<p>I think I sort of get it. <code>f x</code> is supposed to represent the number of left/right moves remaining?</p>\n</blockquote>\n<p>How is that consistent with the above statement? I don't see how this + the ordinals decreasing + <code>o ≤ o'</code> being wrong can all coexist.</p>",
        "id": 533074222,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754477014
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533074215\">said</a>:</p>\n<blockquote>\n<p>And left never loses before right does, because...?</p>\n</blockquote>\n<p>because left always has another move (<code>∀ o ∈ (f y).1, ∃ z ∈ y.leftMoves, ...</code>)</p>",
        "id": 533074316,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477047
    },
    {
        "content": "<p>when left moves the death clock goes down</p>",
        "id": 533074377,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477071
    },
    {
        "content": "<p>Oh, so <code>f x</code> is really just a single clock, and you read the entry according to which player is playing. If left plays, he has some move decreasing the clock. If right plays, none of her moves can increase the clock.</p>",
        "id": 533075055,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477315
    },
    {
        "content": "<p>It's not side weird two sided clock</p>",
        "id": 533075209,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477367
    },
    {
        "content": "<p>The only reason I needed two sides is that you can arrive at a game with either player to move</p>",
        "id": 533075291,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477396
    },
    {
        "content": "<p>Why do we need the <code>(f x).2.isSome</code> condition, though?</p>",
        "id": 533075428,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477450
    },
    {
        "content": "<p>So you can't just supply <code>fun _ =&gt; (none, none)</code></p>",
        "id": 533075492,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477478
    },
    {
        "content": "<p>This satisfies all the other conditions</p>",
        "id": 533075526,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477492
    },
    {
        "content": "<p>Oh, of course. Your clock needs to at the very least consider every position that right could get to under this strategy.</p>",
        "id": 533075838,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477609
    },
    {
        "content": "<p>And for that it's sufficient that it considers <code>x</code> itself.</p>",
        "id": 533075863,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477619
    },
    {
        "content": "<p>This is a very elegant definition. I wouldn't mind just going ahead and calling this a strategy.</p>",
        "id": 533076140,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477737
    },
    {
        "content": "<p>I guess it is a strategy</p>",
        "id": 533076189,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477755
    },
    {
        "content": "<p>(I'm a bit confused though, are strategies in the literature supposed to win? Or just survive?)</p>",
        "id": 533076207,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477760
    },
    {
        "content": "<p>It's a strategy to win</p>",
        "id": 533076244,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477774
    },
    {
        "content": "<p>You can probably cook up a different definition for a strategy to survive</p>",
        "id": 533076291,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477794
    },
    {
        "content": "<p>Strategies in the literature can either win or survive (you can define a variant for either one, so this construction seems natural).</p>",
        "id": 533076317,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754477810
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533076291\">said</a>:</p>\n<blockquote>\n<p>You can probably cook up a different definition for a strategy to survive</p>\n</blockquote>\n<p>Do we need to? Left survives if there exists no winning strategy for right.</p>",
        "id": 533076412,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754477850
    },
    {
        "content": "<p>We don't need to</p>",
        "id": 533076460,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477872
    },
    {
        "content": "<p>But we can do it</p>",
        "id": 533076483,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477880
    },
    {
        "content": "<p>It could be useful</p>",
        "id": 533076539,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477904
    },
    {
        "content": "<p>Defining (a surviving strategy) using the existing winning strategy, then adding a theorem that defines it directly seems nicer from a trusted code perspective.</p>",
        "id": 533076727,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754477967
    },
    {
        "content": "<p>Surviving strategies are simpler</p>",
        "id": 533076790,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754477996
    },
    {
        "content": "<p>They don't have ordinals since there's no need to force an end</p>",
        "id": 533076824,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478009
    },
    {
        "content": "<p>It's just a set of games satisfying some properties</p>",
        "id": 533076936,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478057
    },
    {
        "content": "<p>Then perhaps we can define winning strategies from surviving strategies? A winning strategy for Left is when Left survives but Right doesn't.</p>",
        "id": 533076982,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754478070
    },
    {
        "content": "<p>Well, two sets</p>",
        "id": 533076984,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478070
    },
    {
        "content": "<p>You can also drop the second set</p>",
        "id": 533077229,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478161
    },
    {
        "content": "<p>Just like you can define LE without LF</p>",
        "id": 533077257,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478171
    },
    {
        "content": "<p>Can you type that down?</p>",
        "id": 533077277,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478178
    },
    {
        "content": "<p>\"right goes first and left survives\"</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div>",
        "id": 533077578,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478292
    },
    {
        "content": "<p>you can probably define it coinductively</p>",
        "id": 533077738,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478343
    },
    {
        "content": "<p>wasn't there some sort of <code>greatest_fixpoint</code> thing?</p>",
        "id": 533077773,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478355
    },
    {
        "content": "<p>Coinductive types are primitives in Coq, not in Lean</p>",
        "id": 533077885,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478388
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover/lean4/pull/8097\">lean4#8097</a></p>",
        "id": 533078038,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478432
    },
    {
        "content": "<p>This is news to me</p>",
        "id": 533078387,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478556
    },
    {
        "content": "<p>I haven't touched Coq (or Rocq) so I wouldn't be confusing it</p>",
        "id": 533078413,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478566
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533077578\">said</a>:</p>\n<blockquote>\n<p>\"right goes first and left survives\"</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">},</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>Oh, I get it. <code>s</code> is precisely the set in which the partial function of the strategy is defined.</p>",
        "id": 533078577,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478634
    },
    {
        "content": "<p>This does smell coinductive to me, but I don't know what we'd gain out of defining it as a coinductive predicate.</p>",
        "id": 533078953,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478785
    },
    {
        "content": "<p>The coinduction?</p>",
        "id": 533079033,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478813
    },
    {
        "content": "<p>I guess we already get the coinduction</p>",
        "id": 533079114,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754478837
    },
    {
        "content": "<p>What would coinduction say here?</p>",
        "id": 533079567,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754478992
    },
    {
        "content": "<p>It's exactly the <code>Exists.intro</code> on the definition I put above</p>",
        "id": 533079651,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754479027
    },
    {
        "content": "<p>Hm yeah that makes sense</p>",
        "id": 533079670,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479035
    },
    {
        "content": "<p>I've just realized the construction I have is essentially what Tarski's fixpoint theorem tells you</p>",
        "id": 533080266,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754479287
    },
    {
        "content": "<p>All that's left is to prove it's a fixpoint</p>",
        "id": 533080291,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754479300
    },
    {
        "content": "<p>Not sure what you mean by that.</p>",
        "id": 533080445,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479371
    },
    {
        "content": "<p>This is genuinely so nice.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LeftStrategy</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LeftSurvivesSnd</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LeftStrategy</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">s</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">LeftSurvivesFst</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LeftSurvivesSnd</span><span class=\"w\"> </span><span class=\"n\">y</span>\n</code></pre></div>",
        "id": 533080716,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479466
    },
    {
        "content": "<p>I think we should now consider API.</p>",
        "id": 533081056,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479586
    },
    {
        "content": "<p>I think something important is to link these definitions to <code>IGame</code>. Prove that <code>LeftSurvivesSnd (toLGame x) ↔ 0 ≤ x</code> and <code>LeftSurvivesFst (toIGame x) ↔ 0 ⧏ x</code>.</p>",
        "id": 533081206,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479639
    },
    {
        "content": "<p>We should also prove that either left or right survives any given game.</p>",
        "id": 533081270,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754479659
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533081056\">said</a>:</p>\n<blockquote>\n<p>I think we should now consider API.</p>\n</blockquote>\n<p>I think I am in favor of just defining a bunch of explicitly-named definitions for surviving/outcomes, in hopes that Left/RightSurvivesFst/Snd, and their tie and win variants eventually become either notation or auxiliary.</p>",
        "id": 533081835,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754479883
    },
    {
        "content": "<p>I'm unsure if we need tie/win variants.</p>",
        "id": 533082159,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480007
    },
    {
        "content": "<p>I think we could introduce notation on top of this. Define <code>leftOutcome x</code> as either of <code>L</code>, <code>D</code>, or <code>R</code>. Likewise for <code>rightOutcome</code>. And then we get our outcome function by taking the product of these linear orders.</p>",
        "id": 533082825,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480253
    },
    {
        "content": "<p>So maybe instead of <code>LeftSurvivesSnd x</code> we simply write <code>D ≤ rightOutcome x</code>.</p>",
        "id": 533082932,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480295
    },
    {
        "content": "<p>Yeah, the API should definitely be written in terms of this outcome function.</p>",
        "id": 533083158,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480357
    },
    {
        "content": "<p>Hm, it being given a linear order feels a little confusing when trying to differentiate between left and right outcomes.</p>",
        "id": 533083390,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754480440
    },
    {
        "content": "<p>(Though I suppose this is fine since the scope of <code>left/rightOutcome</code> would be near auxiliary)</p>",
        "id": 533083472,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754480472
    },
    {
        "content": "<p>what instead then?</p>",
        "id": 533083474,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754480473
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533083474\">said</a>:</p>\n<blockquote>\n<p>what instead then?</p>\n</blockquote>\n<p>Two distinct enums for each <code>left</code> and <code>right</code> outcome with explicit conversions between the two, which would make ordering quickly canonical for each one. Again, though, that is a lot for this small-scoped construction.</p>",
        "id": 533083628,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754480531
    },
    {
        "content": "<p>Should <code>left/rightOutcome</code> be auxiliary? I feel like in a sense they're more natural definitions than <code>outcome</code> itself.</p>",
        "id": 533083726,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480571
    },
    {
        "content": "<p>They are more natural, but I was under the impression that <code>outcome</code> itself was very auxiliary.</p>",
        "id": 533083772,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754480587
    },
    {
        "content": "<p>I'm pretty sure <code>outcome</code> is what this entire theory is all about!</p>",
        "id": 533083819,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480607
    },
    {
        "content": "<p>It is! Though outside of <code>outcome</code> itself, <code>LGame</code> would mainly be using <code>outcome</code> through *<code>LGame</code> ordering?</p>",
        "id": 533083866,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754480623
    },
    {
        "content": "<p>I don't think so. In the case of <code>IGame</code> the four outcomes very neatly correspond to the four possible order relations a game can have with zero. With <code>LGame</code> there's nine outcomes, and there's no such known characterization.</p>",
        "id": 533084145,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754480711
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767695\">Tristan Figueroa-Reid</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533083628\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533083474\">said</a>:</p>\n<blockquote>\n<p>what instead then?</p>\n</blockquote>\n<p>Two distinct enums for each <code>left</code> and <code>right</code> outcome with explicit conversions between the two, which would make ordering quickly canonical for each one. Again, though, that is a lot for this small-scoped construction.</p>\n</blockquote>\n<p>I think we get a slightly nicer API if we have two distinct enums, and our final <code>outcome</code> enum be the 9 possible outcomes, where we can then define the usual lattice on loopy outcomes.</p>",
        "id": 533085468,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754481158
    },
    {
        "content": "<p>I don't really see what we get out of duplicating our outcome order.</p>",
        "id": 533085582,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754481205
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533085582\">said</a>:</p>\n<blockquote>\n<p>I don't really see what we get out of duplicating our outcome order.</p>\n</blockquote>\n<p>Just to clearly type-differentiate between the left/right outcomes. I don't really see a benefit when we don't differentiate.</p>",
        "id": 533085750,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754481261
    },
    {
        "content": "<p>Presumably there's little ambiguity as is? <code>leftOutcome</code> and <code>rightOutcome</code> tell you outright. As for the <code>outcome</code> function, the left entry would be <code>leftOutcome</code>, and the right entry would be <code>rightOutcome</code>. You don't even need a mnemonic for that one.</p>",
        "id": 533086004,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754481352
    },
    {
        "content": "<p>Not like intent and extent</p>",
        "id": 533086078,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754481379
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533086004\">said</a>:</p>\n<blockquote>\n<p>Presumably there's little ambiguity as is? <code>leftOutcome</code> and <code>rightOutcome</code> tell you outright. As for the <code>outcome</code> function, the left entry would be <code>leftOutcome</code>, and the right entry would be <code>rightOutcome</code>. You don't even need a mnemonic for that one.</p>\n</blockquote>\n<p>I forgot that we'll know the origin of our data as we're working in a theorem prover. <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 533086440,
        "sender_full_name": "Tristan Figueroa-Reid",
        "timestamp": 1754481521
    },
    {
        "content": "<p>I'm thinking, <code>LeftStrategy</code> and <code>RightStrategy</code> can be public API. We'll then keep everything private until we can define the outcome function, and state all the results on outcomes in terms of it.</p>",
        "id": 533086776,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754481649
    },
    {
        "content": "<p>So, how do we actually prove this?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">private</span><span class=\"w\"> </span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">left_or_right_survive_left</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LeftStrategy</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">RightStrategy</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 533087255,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754481807
    },
    {
        "content": "<p>It's probably probable</p>",
        "id": 533087550,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754481913
    },
    {
        "content": "<p>*provable</p>",
        "id": 533087581,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754481924
    },
    {
        "content": "<p>If you put it on a branch I can attempt it today</p>",
        "id": 533087698,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754481967
    },
    {
        "content": "<p>Way ahead of you<br>\n<a href=\"https://github.com/vihdzp/combinatorial-games/tree/vi.outcome\">https://github.com/vihdzp/combinatorial-games/tree/vi.outcome</a></p>",
        "id": 533087777,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754482000
    },
    {
        "content": "<p>I gtg, I'll come back to this in a few hours</p>",
        "id": 533088230,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754482171
    },
    {
        "content": "<p>I have an idea</p>",
        "id": 533107486,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754488080
    },
    {
        "content": "<p>I'm interested</p>",
        "id": 533108279,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488301
    },
    {
        "content": "<p>I was thinking about this as well</p>",
        "id": 533108417,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488339
    },
    {
        "content": "<p>My class doesn't start for another eight minutes</p>",
        "id": 533108456,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488350
    },
    {
        "content": "<p>you have class???</p>",
        "id": 533108480,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754488360
    },
    {
        "content": "<p>I'm a uni student yeah</p>",
        "id": 533108535,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488371
    },
    {
        "content": "<p>this is more complicated than I thought</p>",
        "id": 533109745,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754488744
    },
    {
        "content": "<p>There's probably some auxiliary theorems you need to prove first</p>",
        "id": 533109843,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488772
    },
    {
        "content": "<p>Like, if there's a <code>LeftStrategy</code> for x, there's one for some left move of every right move of <code>x</code>.</p>",
        "id": 533110003,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754488814
    },
    {
        "content": "<p>In fact this should be an iff</p>",
        "id": 533112859,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754489602
    },
    {
        "content": "<p>Here's what I'm thinking about</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"n\">o</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨅</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">monotone'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"n\">o</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⨆</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⨅</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">monotone'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">consistent_le_closed_left</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">consistent_le_closed_right</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lfp_eq_gfp_left</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"bp\">.</span><span class=\"n\">gfp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lfp_eq_gfp_right</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"bp\">.</span><span class=\"n\">gfp</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">The ordinal corresponding to the time it takes for left to force a win going first,</span>\n<span class=\"sd\">counted in right moves.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftLeft</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">The ordinal corresponding to the time it takes for left to force a win going second,</span>\n<span class=\"sd\">counted in right moves.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeLeftRight</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">stoppingTimeLeftApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">The ordinal corresponding to the time it takes for right to force a win going second,</span>\n<span class=\"sd\">counted in left moves.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightLeft</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n\n<span class=\"sd\">/--</span>\n<span class=\"sd\">The ordinal corresponding to the time it takes for right to force a win going first,</span>\n<span class=\"sd\">counted in left moves.</span>\n<span class=\"sd\">-/</span>\n<span class=\"kn\">noncomputable</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">stoppingTimeRightRight</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">WithTop</span><span class=\"w\"> </span><span class=\"n\">NatOrdinal</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">stoppingTimeRightApprox</span><span class=\"bp\">.</span><span class=\"n\">lfp</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span>\n</code></pre></div>",
        "id": 533112957,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754489629
    },
    {
        "content": "<p>I hope all the <code>sorry</code>s are actually true</p>",
        "id": 533113231,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754489704
    },
    {
        "content": "<p>I didn't check that carefully</p>",
        "id": 533113241,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754489709
    },
    {
        "content": "<p>For loopy games you can still define winning positions as an inductive predicate. These should be contained in the surviving positions (i.e. those contained in some strategy). The right surviving positions should be the complement of the left winning positions.</p>",
        "id": 533113294,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754489727
    },
    {
        "content": "<p>My reasoning is: if you prove the least and greatest fixpoints are equal, then you can use both induction and coinduction</p>",
        "id": 533113523,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754489800
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533113231\">said</a>:</p>\n<blockquote>\n<p>I hope all the <code>sorry</code>s are actually true</p>\n</blockquote>\n<p>I've no idea</p>",
        "id": 533115384,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754490412
    },
    {
        "content": "<p>I admit I liked the other definition we had better.</p>",
        "id": 533115442,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754490427
    },
    {
        "content": "<p>but you get an ordinal out this way</p>",
        "id": 533115471,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754490438
    },
    {
        "content": "<p>that's more information than just \"yes\" or \"no\"</p>",
        "id": 533115537,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754490460
    },
    {
        "content": "<p>These are nice definitions, assuming they work. But perhaps they should be a separate development from strategies.</p>",
        "id": 533118899,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754491406
    },
    {
        "content": "<p>maybe</p>",
        "id": 533118923,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754491414
    },
    {
        "content": "<p>but you can directly extract a strategy from them</p>",
        "id": 533118971,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754491428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533087777\">said</a>:</p>\n<blockquote>\n<p>Way ahead of you<br>\n<a href=\"https://github.com/vihdzp/combinatorial-games/tree/vi.outcome\">https://github.com/vihdzp/combinatorial-games/tree/vi.outcome</a></p>\n</blockquote>\n<p>I think I know how to prove this. You need two lemmas:</p>\n<ul>\n<li>A game has a left strategy iff every right move has a left move with a left strategy. Simple enough.</li>\n<li>If every right move of a game has no right strategy, then the game has a left strategy. The left strategy is really silly: for every single game with no right strategy, take an arbitrary left move such that every right move has no right strategy.</li>\n</ul>",
        "id": 533123815,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754492932
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"816344\">Aaron Liu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533118971\">said</a>:</p>\n<blockquote>\n<p>but you can directly extract a strategy from them</p>\n</blockquote>\n<p>The more I think about it the more I like your idea. It feels weird to use this to define strategies rather than the much easier set definition. But it might be worth putting this in its own file.</p>",
        "id": 533125865,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754493563
    },
    {
        "content": "<p>Surely, surely this definition exists somewhere in the literature?</p>",
        "id": 533125911,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754493575
    },
    {
        "content": "<p>(again, assuming it works)</p>",
        "id": 533125977,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754493596
    },
    {
        "content": "<p>I don't read enough literature to know if this exists somewhere</p>",
        "id": 533126032,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754493613
    },
    {
        "content": "<p>Glad we have our resident reader <span class=\"user-mention\" data-user-id=\"767695\">@Tristan Figueroa-Reid</span></p>",
        "id": 533126083,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754493633
    },
    {
        "content": "<p>It's interesting that Lean doesn't accept this inductive predicate:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"c\">/-</span><span class=\"cm\"> (kernel) invalid nested inductive datatype 'Exists', nested inductive datatypes parameters cannot contain local variables. -/</span>\n</code></pre></div>\n<p>In principle this is similar to <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Acc#doc\">docs#Acc</a>. Let me think of another way to construct it ...</p>",
        "id": 533150285,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754501103
    },
    {
        "content": "<p>If I break it down then it works:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hy</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"n\">hy</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">x</span>\n</code></pre></div>",
        "id": 533151619,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754501676
    },
    {
        "content": "<p>Interesting! Yeah, this seems like it should work.</p>",
        "id": 533152327,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754501993
    },
    {
        "content": "<p>I think it's by far the most natural definition in this thread.</p>",
        "id": 533152457,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754502060
    },
    {
        "content": "<p>Presumably we can prove whatever the inductive principle for the exists version should be.</p>",
        "id": 533153131,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754502382
    },
    {
        "content": "<p>what about the coinductive principle</p>",
        "id": 533153165,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754502397
    },
    {
        "content": "<p>I don't think this definition is supposed to be coinductive?</p>",
        "id": 533153260,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754502437
    },
    {
        "content": "<p>there is an inductive definition and a coinductive definition and they are complements</p>",
        "id": 533153294,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754502455
    },
    {
        "content": "<p>I think</p>",
        "id": 533153302,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754502460
    },
    {
        "content": "<p>I think the coinductive version might correspond to games that left survives</p>",
        "id": 533153824,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754502704
    },
    {
        "content": "<p>yes that's what I was thinking I think</p>",
        "id": 533153852,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754502721
    },
    {
        "content": "<p>not sure anymore</p>",
        "id": 533153862,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754502723
    },
    {
        "content": "<p>I mean, as nice as it would be to have this inductive/coinductive duality</p>",
        "id": 533154540,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754503018
    },
    {
        "content": "<p>We really only need one or the other</p>",
        "id": 533154565,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754503029
    },
    {
        "content": "<p>I'm trying to prove it right now</p>",
        "id": 533154569,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754503030
    },
    {
        "content": "<p>Oh nice</p>",
        "id": 533154588,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754503037
    },
    {
        "content": "<p>proven half of it<br>\n<a href=\"/user_uploads/3121/XTCyO_-DjQGNIX_mluZE1aTY/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/XTCyO_-DjQGNIX_mluZE1aTY/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1067x711\" src=\"/user_uploads/thumbnail/3121/XTCyO_-DjQGNIX_mluZE1aTY/image.png/840x560.webp\"></a></div>",
        "id": 533156382,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754503800
    },
    {
        "content": "<p>I changed the definition of LeftStrategy in order to state <code>leftStrategy_iUnion</code> to prove a key lemma <code>isLeftSurviving_iff_forall</code>:<br>\n<a href=\"/user_uploads/3121/HphQj-GZbCang5IbhhIzd8Dx/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/HphQj-GZbCang5IbhhIzd8Dx/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"982x766\" src=\"/user_uploads/thumbnail/3121/HphQj-GZbCang5IbhhIzd8Dx/image.png/840x560.webp\"></a></div>",
        "id": 533163599,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754506980
    },
    {
        "content": "<p>I did it!</p>",
        "id": 533178066,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754513740
    },
    {
        "content": "<p>now for the easy part</p>",
        "id": 533178074,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754513745
    },
    {
        "content": "<p>I just pushed <a href=\"https://github.com/vihdzp/combinatorial-games/commit/c0ee3871b49b9cbb2a2d872dd94de60b50953796\">a proof</a> of <code>left_or_right_survive_left</code> at <a href=\"https://github.com/vihdzp/combinatorial-games/compare/master...alreadydone:combinatorial-games:jyxu/outcome?expand=1\">this branch</a></p>",
        "id": 533178179,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754513816
    },
    {
        "content": "<p>I proved <code>stoppingTimeLeftApprox.lfp = stoppingTimeLeftApprox.gfp</code></p>",
        "id": 533178411,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754513936
    },
    {
        "content": "<p>I might make a PR</p>",
        "id": 533185021,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754517593
    },
    {
        "content": "<p>I'm not opposed to having these definitions in the repo, because they do seem like pretty natural notions (they straightforwardly generalize the number of moves left in a short game). But I would prefer to first see them used somewhere else. That would then inform the names of definitions and the results to be proven.</p>",
        "id": 533200542,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754528810
    },
    {
        "content": "<p><del>I have never seen these used anywhere</del> I saw them once in <a href=\"https://www.youtube.com/watch?v=b-Bb_TyhC1A\">The Search for the Longest Infinite Chess Game</a></p>\n<div class=\"youtube-video message_inline_image\"><a data-id=\"b-Bb_TyhC1A\" href=\"https://www.youtube.com/watch?v=b-Bb_TyhC1A\"><img src=\"https://uploads.zulipusercontent.net/8d3a862cee546fd024e8f7afc3015a11f8524823/68747470733a2f2f692e7974696d672e636f6d2f76692f622d42625f5479684331412f6d7164656661756c742e6a7067\"></a></div>",
        "id": 533200684,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754528906
    },
    {
        "content": "<p>Holy **** you're right they're exactly that!</p>",
        "id": 533200741,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754528949
    },
    {
        "content": "<p>Well actually I'm not sure if they're exactly that</p>",
        "id": 533201004,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529163
    },
    {
        "content": "<p>might be off by one in some places</p>",
        "id": 533201067,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529211
    },
    {
        "content": "<p><a href=\"https://neugierde.github.io/cantors-attic/Omega_one_chess\">https://neugierde.github.io/cantors-attic/Omega_one_chess</a></p>",
        "id": 533201209,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529316
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 533201227,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529325
    },
    {
        "content": "<p>There's a mismatch in definitions. You measure the left stopping time in terms of right moves, while that definition measures it in terms of left moves</p>",
        "id": 533201501,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529535
    },
    {
        "content": "<p>yes that is true</p>",
        "id": 533201527,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529551
    },
    {
        "content": "<p>off by one in some places</p>",
        "id": 533201528,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529556
    },
    {
        "content": "<p>And now we play the game of figuring out which definition is better</p>",
        "id": 533201572,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529592
    },
    {
        "content": "<p>I will of course advocate for my definition</p>",
        "id": 533201600,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529615
    },
    {
        "content": "<p>its range is <code>Set.univ</code></p>",
        "id": 533201637,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529639
    },
    {
        "content": "<p>Does the other one not have that property?</p>",
        "id": 533201698,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529685
    },
    {
        "content": "<p>it doesn't hit <code>ω</code></p>",
        "id": 533201736,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529717
    },
    {
        "content": "<p>if white is to move</p>",
        "id": 533201756,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529737
    },
    {
        "content": "<p>white to move misses all the limit ordinals</p>",
        "id": 533201765,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529747
    },
    {
        "content": "<p>black to move hits everything</p>",
        "id": 533201799,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754529778
    },
    {
        "content": "<p>Huh</p>",
        "id": 533201843,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754529806
    },
    {
        "content": "<p>To be frank, I also find \"supremum of the successors\" to be a more mathematically satisfying definition than \"successor of the supremum\".</p>",
        "id": 533202687,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530420
    },
    {
        "content": "<p>It's an infimum though</p>",
        "id": 533202829,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754530561
    },
    {
        "content": "<p>Huh</p>",
        "id": 533202844,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530573
    },
    {
        "content": "<p>infimum over all possible moves of how long to kill the opponent in each position</p>",
        "id": 533202854,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754530579
    },
    {
        "content": "<p>since you always choose the best move which is the minimum time to kill</p>",
        "id": 533202877,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754530595
    },
    {
        "content": "<p>No you wrote down supremum of the succesors</p>",
        "id": 533202929,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530634
    },
    {
        "content": "<p>Supremum is the union thing isn't it</p>",
        "id": 533202936,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530642
    },
    {
        "content": "<p>that's the other one</p>",
        "id": 533202941,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754530648
    },
    {
        "content": "<p>supremum over all the positions of how long to die</p>",
        "id": 533202958,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754530663
    },
    {
        "content": "<p>Hm yeah the thing is that the \"successor of supremum\" definition is the one used in the article<br>\n<a href=\"https://arxiv.org/pdf/1302.4377\">https://arxiv.org/pdf/1302.4377</a></p>",
        "id": 533203240,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530910
    },
    {
        "content": "<p>Do we know that these definitions are only off by one?</p>",
        "id": 533203307,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754530970
    },
    {
        "content": "<p>I know they are only off by one</p>",
        "id": 533203369,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754531016
    },
    {
        "content": "<p>Supremum of successors sound more natural as it's also used in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/SetTheory/ZFC/Rank.html#PSet.rank\">PSet.rank</a>.</p>",
        "id": 533266344,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754563462
    },
    {
        "content": "<p>I'm currently working on outcomes that incorporate misere play convention<br>\n<a href=\"/user_uploads/3121/97RbIyXZxNsptIJBDC-T__hS/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/97RbIyXZxNsptIJBDC-T__hS/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"971x668\" src=\"/user_uploads/thumbnail/3121/97RbIyXZxNsptIJBDC-T__hS/image.png/840x560.webp\"></a></div>",
        "id": 533266379,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754563479
    },
    {
        "content": "<p>Just recording that this also doesn't work with a different error message:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">      </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"c\">/-</span><span class=\"cm\"> (kernel) arg #2 of 'LGame.IsLeftWinning.intro'' has a non positive occurrence of the datatypes being declared -/</span>\n</code></pre></div>",
        "id": 533267807,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754563918
    },
    {
        "content": "<p>Yeah</p>",
        "id": 533267916,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754563959
    },
    {
        "content": "<p>There are reasons</p>",
        "id": 533268006,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754563988
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533266379\">said</a>:</p>\n<blockquote>\n<p>I'm currently working on outcomes that incorporate misere play convention<br>\n<a href=\"/user_uploads/3121/97RbIyXZxNsptIJBDC-T__hS/image.png\">image.png</a></p>\n</blockquote>\n<p>Does the <code>toMisere</code> idea I had earlier not work here? Take any state without moves for some player and add a single move for that player to 0</p>",
        "id": 533268106,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754564034
    },
    {
        "content": "<p>This one happens to work out but if you modify it slightly you get a contradiction</p>",
        "id": 533268121,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754564042
    },
    {
        "content": "<p>It doesn't seem possible to make <code>IsLeftWinning</code> and <code>IsRightLosing</code> mutual recursives either.</p>",
        "id": 533268190,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754564064
    },
    {
        "content": "<p>I have something just as good</p>",
        "id": 533268279,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754564096
    },
    {
        "content": "<p>It's the stopping times I proved yesterday</p>",
        "id": 533268313,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754564110
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533268106\">said</a>:</p>\n<blockquote>\n<p>Does the <code>toMisere</code> idea I had earlier not work here? Take any state without moves for some player and add a single move for that player to 0</p>\n</blockquote>\n<p>Yes, I think it works and is a better solution!</p>",
        "id": 533270484,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754564948
    },
    {
        "content": "<blockquote>\n<p>It's the stopping times I proved yesterday</p>\n</blockquote>\n<p>If you want to prove something about the \"stopping time\" you might start with some <a href=\"https://www.daniellitt.com/blog/2018/3/4/guest-post-ordinals-and-hydras-by-brian-lawrence\">hydra game</a> which should be easier to formalize than chess. And we can certainly show e.g. that the left stopping time isn't top iff <code>IsLeftWinning</code>.</p>",
        "id": 533279358,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754568347
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/channel/518132-combinatorial-games/topic/Loopy.20games/near/533268190\">said</a>:</p>\n<blockquote>\n<p>It doesn't seem possible to make <code>IsLeftWinning</code> and <code>IsRightLosing</code> mutual recursives either.</p>\n</blockquote>\n<p>Oops I was wrong, this actually works</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">mutual</span>\n<span class=\"w\">  </span><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">rightMoves</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsRightLosing</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">IsRightLosing</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">    </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LGame</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">leftMoves</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsLeftWinning</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsRightLosing</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"kn\">end</span>\n</code></pre></div>",
        "id": 533280402,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754568780
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"224323\">Junyan Xu</span> <a href=\"#narrow/stream/518132-combinatorial-games/topic/Loopy.20games/near/533279358\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>It's the stopping times I proved yesterday</p>\n</blockquote>\n<p>If you want to prove something about the \"stopping time\" you might start with some <a href=\"https://www.daniellitt.com/blog/2018/3/4/guest-post-ordinals-and-hydras-by-brian-lawrence\">hydra game</a> which should be easier to formalize than chess. And we can certainly show e.g. that the left stopping time isn't top iff <code>IsLeftWinning</code>.</p>\n</blockquote>\n<p>I proved something about the stopping times of loopy games (that you can do both induction and coinduction)</p>",
        "id": 533284486,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754570344
    },
    {
        "content": "<p>Using mutual inductives <a href=\"https://github.com/vihdzp/combinatorial-games/commit/2b7216d763b1c004804e4f1d1b3e1537cf489da4\">shortens the code a bit</a>. The same definition works also for IGame and in fact for ConcreteGame as well. For IGames we should show that IsLeftSurviving is the same as IsLeftWinning, or maybe we should show this for any position such that the union of the left and right relations (or the appropriate composition of the left and right relations) is well founded on its subpositions.</p>",
        "id": 533305587,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754576954
    },
    {
        "content": "<p>Pushed a proof of <code>theorem mem_range_toLGame_iff_acc {x : LGame} : x ∈ range IGame.toLGame ↔ Acc LGame.IsOption x</code></p>",
        "id": 533355656,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754596853
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/vihdzp/combinatorial-games/pull/179/files#diff-aa59ef8ec70bea1b0b161cc1d25f20a4c66161e823075edde9bc6205ae897aa6\">PR#179</a> for loopy outcomes.</p>",
        "id": 533479990,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754665091
    },
    {
        "content": "<p>I'm considering dropping the IsLeft/RightSurviving definitions since they're equivalent to the negation of IsLeft/RightLosing. I think it's also more intuitive to switch left and right so that whenever a decl name mentions \"left\", it always means that left is going first rather than second.</p>",
        "id": 533509344,
        "sender_full_name": "Junyan Xu",
        "timestamp": 1754677619
    },
    {
        "content": "<p>I'll check it out in a bit.</p>",
        "id": 533537526,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1754693876
    }
]