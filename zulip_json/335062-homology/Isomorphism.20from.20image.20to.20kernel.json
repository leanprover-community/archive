[
    {
        "content": "<p>What is the <span class=\"user-mention\" data-user-id=\"459699\">@Joël Riou</span>-approved way of getting that the image of the first map of a short exact complex is isomorphic to the kernel of the second one?</p>",
        "id": 544412633,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1760286264
    },
    {
        "content": "<p>we also want the cokernel of the first map isomorphic to the coimage of the second one</p>",
        "id": 544412730,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760286365
    },
    {
        "content": "<p>I think everything we need should be in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html</a></p>",
        "id": 544416562,
        "sender_full_name": "Joël Riou",
        "timestamp": 1760289845
    },
    {
        "content": "<p>I would use <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html#CategoryTheory.ShortComplex.Exact.isLimitImage\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html#CategoryTheory.ShortComplex.Exact.isLimitImage</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html#CategoryTheory.ShortComplex.Exact.isColimitCoimage\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Abelian/Exact.html#CategoryTheory.ShortComplex.Exact.isColimitCoimage</a>, plus the uniqueness (up to isomorphism) of kernel and cokernel.</p>",
        "id": 545419491,
        "sender_full_name": "Sophie Morel",
        "timestamp": 1760638549
    },
    {
        "content": "<p>I think the right question is that whether we should use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Abelian.image#doc\">docs#Abelian.image</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Abelian.coimage#doc\">docs#Abelian.coimage</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.image#doc\">docs#CategoryTheory.Limits.image</a> or <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.imageSubobject#doc\">docs#CategoryTheory.Limits.imageSubobject</a> for the \"image\"</p>",
        "id": 545422582,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1760639606
    },
    {
        "content": "<p>If you decide to use the more general definition of the image, you have the analogues of the theorems I quoted (they're in the same file, just below).<br>\nWhich one you decide to use depends on what else you are doing with images/coimages. In my experience with homological algebra, it was always more convenient to use <code>Abelian.image</code> and <code>Abelian.coimage</code>, but ymmv. <br>\nAs for <code>imageSubobject</code>, I was not able to use it for my purposes when I tried.</p>",
        "id": 545426764,
        "sender_full_name": "Sophie Morel",
        "timestamp": 1760641197
    },
    {
        "content": "<p>we have an exact sequence <code>A ⟶ B ⟶ C ⟶ D</code> where we want to conclude that <code>coker(A ⟶ B) ≅ ker(C ⟶ D)</code> (since <code>coker(A ⟶ B) ≅ coim(B ⟶ C) ≅ im(B ⟶ C) ≅ ker(C ⟶ D)</code>)</p>",
        "id": 545442919,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760648085
    },
    {
        "content": "<p>that's <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.cokernel#doc\">docs#CategoryTheory.Limits.cokernel</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CategoryTheory.Limits.kernel#doc\">docs#CategoryTheory.Limits.kernel</a></p>",
        "id": 545443580,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760648370
    },
    {
        "content": "<p>I don't know how you enter your exact sequence exactly, but this seems to work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">CategoryTheory</span><span class=\"bp\">.</span><span class=\"n\">Abelian</span><span class=\"bp\">.</span><span class=\"n\">Exact</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">CategoryTheory</span>\n\n<span class=\"kn\">universe</span><span class=\"w\"> </span><span class=\"n\">u</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Category</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Abelian</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"n\">D</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"bp\">⟶</span><span class=\"w\"> </span><span class=\"n\">D</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">zero1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≫</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">zero2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≫</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ex1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ShortComplex</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ShortComplex</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">zero1</span><span class=\"o\">))</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ex2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ShortComplex</span><span class=\"bp\">.</span><span class=\"n\">Exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ShortComplex</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"n\">zero2</span><span class=\"o\">))</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">cokernel</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≅</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">kernel</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">cokernel</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≅</span><span class=\"w\"> </span><span class=\"n\">Abelian</span><span class=\"bp\">.</span><span class=\"n\">coimage</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">IsColimit</span><span class=\"bp\">.</span><span class=\"n\">coconePointUniqueUpToIso</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">colimit</span><span class=\"bp\">.</span><span class=\"n\">isColimit</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">IsColimit</span><span class=\"bp\">.</span><span class=\"n\">ofIsoColimit</span><span class=\"w\"> </span><span class=\"n\">ex1</span><span class=\"bp\">.</span><span class=\"n\">isColimitCoimage</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">Cofork</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Iso</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)))</span>\n<span class=\"w\">  </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">e''</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Abelian</span><span class=\"bp\">.</span><span class=\"n\">image</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">≅</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">kernel</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">IsLimit</span><span class=\"bp\">.</span><span class=\"n\">conePointUniqueUpToIso</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">IsLimit</span><span class=\"bp\">.</span><span class=\"n\">ofIsoLimit</span><span class=\"w\"> </span><span class=\"n\">ex2</span><span class=\"bp\">.</span><span class=\"n\">isLimitImage</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">Fork</span><span class=\"bp\">.</span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Iso</span><span class=\"bp\">.</span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Limits</span><span class=\"bp\">.</span><span class=\"n\">limit</span><span class=\"bp\">.</span><span class=\"n\">isLimit</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">set</span><span class=\"w\"> </span><span class=\"n\">e'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Abelian</span><span class=\"bp\">.</span><span class=\"n\">coimageIsoImage</span><span class=\"w\"> </span><span class=\"n\">g</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"bp\">≪≫</span><span class=\"w\"> </span><span class=\"n\">e'</span><span class=\"w\"> </span><span class=\"bp\">≪≫</span><span class=\"w\"> </span><span class=\"n\">e''</span>\n</code></pre></div>",
        "id": 545960399,
        "sender_full_name": "Sophie Morel",
        "timestamp": 1760962668
    },
    {
        "content": "<p>We also want this identification to be natural in the exact sequence</p>",
        "id": 545960837,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760962792
    },
    {
        "content": "<p>so it's a functor from the category of exact sequences of this length</p>",
        "id": 545961000,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1760962832
    },
    {
        "content": "<p>The identification will be natural because the isomorphisms commute with any reasonable map, because of theorems like <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Limits/IsLimit.html#CategoryTheory.Limits.IsLimit.conePointUniqueUpToIso_hom_comp\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/CategoryTheory/Limits/IsLimit.html#CategoryTheory.Limits.IsLimit.conePointUniqueUpToIso_hom_comp</a><br>\nI could help, but only if you show me how your category of exact sequences is actually implemented.</p>",
        "id": 545999685,
        "sender_full_name": "Sophie Morel",
        "timestamp": 1760971586
    },
    {
        "content": "<p>Thanks Sophie, but we already got there now: <a href=\"https://github.com/kbuzzard/ClassFieldTheory/pull/31/files#diff-cf53f2f0482db4201a596440e315c51d7c5c267bdc3e9b061e420d97255001d9\">https://github.com/kbuzzard/ClassFieldTheory/pull/31/files#diff-cf53f2f0482db4201a596440e315c51d7c5c267bdc3e9b061e420d97255001d9</a></p>",
        "id": 546001461,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1760971976
    }
]