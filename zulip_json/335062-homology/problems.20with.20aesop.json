[
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"243562\">Adam Topaz</span> <a href=\"#narrow/stream/335062-homology/topic/Roadmap.20for.20sheaf.20cohomology/near/448689005\">said</a>:</p>\n<blockquote>\n<p>Unfortunately <code>Indexed C</code> is a little \"evil\"... <code>ext</code> for its <code>Hom</code>s would involve <code>HEq</code> or <code>eqToHom</code>s</p>\n</blockquote>\n<p>In order to prove the <code>map_id</code> and <code>map_comp</code> fields of the functor <code>cechSimplicial</code>, I did not use an <code>ext</code> lemma (which would indeed involve <code>eqToHom</code>), because <code>congr</code> worked (because the maps on indices were defeq!)</p>",
        "id": 448691368,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1719950188
    },
    {
        "content": "<p>Yes, I see that. But unfortunately that means that <code>aesop_cat</code> won't be too useful in this context.</p>",
        "id": 448691403,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1719950216
    },
    {
        "content": "<p><code>aesop_cat</code> does a great job in general, but it cannot prove everything!</p>",
        "id": 448691645,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1719950328
    },
    {
        "content": "<p>I know, but this is concrete enough that I feel like it <em>should</em> be able to do a lot.</p>",
        "id": 448691907,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1719950417
    },
    {
        "content": "<p>With a suitable <code>hom_ext</code> lemma, <code>aesop_cat</code> fails, but <code>ext &lt;;&gt; simp</code> works!</p>",
        "id": 448693575,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1719950933
    },
    {
        "content": "<p>Do you know what it tries instead? Something is going wrong if <code>aesop_cat</code> is missing <code>ext &lt;;&gt; simp</code> proofs!</p>",
        "id": 448715288,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1719959956
    },
    {
        "content": "<p>I have tried this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">noncomputable</span><span class=\"w\"> </span><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">cechSimplicial</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFiniteProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">SimplicialObject</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FormalCoproduct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">Œî</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œî.unop.len</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">      </span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">‚àè·∂ú</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œî</span><span class=\"w\"> </span><span class=\"n\">Œî'</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f.unop.toOrderHom</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"k\">Pi</span><span class=\"bp\">.</span><span class=\"n\">map'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">f.unop.toOrderHom</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">map_id</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">map_comp</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">warnOnNonterminal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"o\">})</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">rule_sets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CategoryTheory</span><span class=\"o\">])</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>It seems <code>aesop</code> has mostly applied <code>ext</code>, which creates two goals, and solved the first (which is <code>rfl</code>), but it fails to see that the second goal can be proved <code>by simp</code>.</p>",
        "id": 448718767,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1719961951
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459699\">Jo√´l Riou</span> <a href=\"#narrow/stream/335062-homology/topic/Roadmap.20for.20sheaf.20cohomology/near/448718767\">said</a>:</p>\n<blockquote>\n<p>I have tried this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">noncomputable</span><span class=\"w\"> </span><span class=\"kd\">def</span><span class=\"w\"> </span><span class=\"n\">cechSimplicial</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HasFiniteProducts</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">SimplicialObject</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">FormalCoproduct</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">Œî</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">I</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Fin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Œî.unop.len</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">I</span>\n<span class=\"w\">      </span><span class=\"n\">obj</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"bp\">‚àè·∂ú</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">map</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œî</span><span class=\"w\"> </span><span class=\"n\">Œî'</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f.unop.toOrderHom</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"n\">œÜ</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"k\">Pi</span><span class=\"bp\">.</span><span class=\"n\">map'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"n\">f.unop.toOrderHom</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚Ü¶</span><span class=\"w\"> </span><span class=\"mi\">ùüô</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"w\">  </span><span class=\"n\">map_id</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">  </span><span class=\"n\">map_comp</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"kd\">by</span>\n<span class=\"w\">    </span><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">config</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">warnOnNonterminal</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"o\">})</span>\n<span class=\"w\">            </span><span class=\"o\">(</span><span class=\"n\">rule_sets</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CategoryTheory</span><span class=\"o\">])</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>It seems <code>aesop</code> has mostly applied <code>ext</code>, which creates two goals, and solved the first (which is <code>rfl</code>), but it fails to see that the second goal can be proved <code>by simp</code>.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"459699\">@Jo√´l Riou</span>, is there a branch/commit you can point me to where I can take a look at this issue?</p>",
        "id": 451791789,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721144800
    },
    {
        "content": "<p>Yes, this is the branch <a href=\"https://github.com/leanprover-community/mathlib4/tree/cech-experiment\">https://github.com/leanprover-community/mathlib4/tree/cech-experiment</a></p>",
        "id": 452023322,
        "sender_full_name": "Jo√´l Riou",
        "timestamp": 1721212123
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"256311\">@Jannis Limperg</span>, I think I've identified the problem. I'm not sure if it is a bug in <code>aesop</code> or just suprising behaviour.</p>\n<p>In the proof of <code>map_id</code> and <code>map_comp</code> above,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">aesop</span>\n</code></pre></div>\n<p>works, as does</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">safe</span><span class=\"w\"> </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">hom_ext</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>(<code>hom_ext</code> is the lemma that <code>ext</code> is applying), however</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">aesop</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">safe</span><span class=\"w\"> </span><span class=\"n\">tactic</span><span class=\"w\"> </span><span class=\"n\">Std</span><span class=\"bp\">.</span><span class=\"n\">Tactic</span><span class=\"bp\">.</span><span class=\"n\">Ext</span><span class=\"bp\">.</span><span class=\"n\">extCore'</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>fails, apparently because <code>aesop</code> doesn't continue working on both goals generated after applying the <code>ext</code> lemma.</p>\n<p>If you'd like to take a look at this, please use <a href=\"https://github.com/leanprover-community/mathlib4/tree/cech-experiment-aesop\">branch#cech-experiment-aesop</a>, and see the file Mathlib/CategoryTheory/Sites/Cech.lean, in the declaration <code>cechSimplicial</code>.</p>",
        "id": 452110479,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721230581
    },
    {
        "content": "<p>More generally, now that <code>ext</code> is a core lean tactic, I wonder if you would consider turning it on by default, or otherwise providing an easier hook than having to define <code>extCore'</code>.</p>",
        "id": 452110648,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721230648
    },
    {
        "content": "<p>Thanks for the debugging Kim!</p>",
        "id": 452124461,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721233736
    },
    {
        "content": "<p>Yeah, thanks. I'm quite ill atm, so I'll take a closer look once I'm on my feet again. However, I can already say that <code>ext</code> is on by default in Aesop these days, so this should just work.</p>",
        "id": 452133001,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1721235788
    },
    {
        "content": "<p>Ah! I will try to remove <code>extCore</code> from <code>aesop_cat</code> and report back.</p>\n<p>I hope you're feeling better soon. :-(</p>",
        "id": 452134827,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721236159
    },
    {
        "content": "<p>Preliminary cleanup at <a href=\"https://github.com/leanprover-community/mathlib4/pull/14843\">#14843</a></p>",
        "id": 452146207,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721238872
    },
    {
        "content": "<p>And <a href=\"https://github.com/leanprover-community/mathlib4/pull/14845\">#14845</a>, removing all the apparently unused configuration options for <code>aesop_cat</code>.</p>",
        "id": 452150576,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1721239757
    },
    {
        "content": "<p>All right, back from the dead. :) Did removing <code>extCore</code> fix the original issue?</p>",
        "id": 454316544,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1722005742
    },
    {
        "content": "<p>Thanks for the reminder, I will look again in the next few days (or someone else can :-)</p>",
        "id": 454323824,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722007686
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"256311\">@Jannis Limperg</span> this is still failing, after I'm merged <code>master</code> into <code>cech-experiment</code>.</p>\n<p>The <code>map_id</code> field of <code>cechSimplicial</code> work by <code>ext &lt;;&gt; simp</code>, but does not work by <code>aesop</code>, despite it working (with a nonterminal warning) with</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">aesop</span>\n<span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>Here <code>aesop?</code> suggests</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"n\">inst_1</span><span class=\"w\"> </span><span class=\"n\">inst_2</span><span class=\"w\"> </span><span class=\"n\">inst_3</span><span class=\"w\"> </span><span class=\"n\">inst_4</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"n\">simp_all</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">unop_id</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SimplexCategory</span><span class=\"bp\">.</span><span class=\"n\">id_toOrderHom</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">OrderHom</span><span class=\"bp\">.</span><span class=\"n\">id_coe</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">id_eq</span><span class=\"o\">]</span>\n<span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>which is reasonable, and again</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">rename_i</span><span class=\"w\"> </span><span class=\"n\">inst</span><span class=\"w\"> </span><span class=\"n\">inst_1</span><span class=\"w\"> </span><span class=\"n\">inst_2</span><span class=\"w\"> </span><span class=\"n\">inst_3</span><span class=\"w\"> </span><span class=\"n\">inst_4</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"n\">simp_all</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">unop_id</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">SimplexCategory</span><span class=\"bp\">.</span><span class=\"n\">id_toOrderHom</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">OrderHom</span><span class=\"bp\">.</span><span class=\"n\">id_coe</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">id_eq</span><span class=\"o\">]</span>\n<span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"bp\">&lt;;&gt;</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n</code></pre></div>\n<p>closes the goal.</p>\n<p>So I think it is a bug in <code>aesop</code>!</p>",
        "id": 454397945,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1722040963
    },
    {
        "content": "<p>So this turns out to be quite a deep issue. Essentially, what happens is this:</p>\n<ul>\n<li>Aesop runs <code>simp_all</code> and <code>ext</code>. This produces two goals <code>?g1</code> and <code>?g2</code> such that <code>?g1</code> appears as a metavariable in <code>?g2</code>.</li>\n<li>Aesop therefore doesn't treat <code>?g1</code> as a goal in its own right and only works on <code>?g2</code>.</li>\n<li>Aesop runs <code>simp_all</code> on <code>?g2</code>, which solves it but doesn't solve <code>?g1</code>. This is forbidden, so Aesop discards the result of <code>simp_all</code>.</li>\n<li>No other rules apply to <code>?g2</code>, so Aesop gives up.</li>\n</ul>\n<p>I believe it would be possible to change Aesop's behaviour in step 3 such that it adds <code>?g1</code> as an additional goal to be solved. However, doing this cleanly would be a major operation and since anything metavariable-related is hell on earth, I'm inclined to leave this as a known limitation.</p>",
        "id": 455480977,
        "sender_full_name": "Jannis Limperg",
        "timestamp": 1722458774
    }
]