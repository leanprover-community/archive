[
    {
        "content": "<p>I'm new to Veil, but can anyone tell me why the following fails to prove?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Veil</span>\n\n<span class=\"n\">veil</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"n\">Test</span>\n\n<span class=\"n\">individual</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n<span class=\"bp\">#</span><span class=\"n\">gen_state</span>\n\n<span class=\"n\">after_init</span><span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">action</span><span class=\"w\"> </span><span class=\"n\">incr</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">invariant</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"bp\">#</span><span class=\"n\">check_invariants</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Test</span>\n</code></pre></div>",
        "id": 573099324,
        "sender_full_name": "Mark R. Tuttle",
        "timestamp": 1770743067
    },
    {
        "content": "<p>Two issues:</p>\n<ul>\n<li><code>=</code> in the <code>incr</code> action</li>\n<li>missing pragma <code>#gen_spec</code> after all invariants are defined</li>\n</ul>\n<p>Corrected file:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Veil</span>\n\n<span class=\"n\">veil</span><span class=\"w\"> </span><span class=\"n\">module</span><span class=\"w\"> </span><span class=\"n\">Test</span>\n\n<span class=\"n\">individual</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span>\n\n<span class=\"bp\">#</span><span class=\"n\">gen_state</span>\n\n<span class=\"n\">after_init</span><span class=\"w\">  </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">action</span><span class=\"w\"> </span><span class=\"n\">incr</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"bp\">;</span>\n<span class=\"o\">}</span>\n\n<span class=\"n\">invariant</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">&gt;=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"bp\">#</span><span class=\"n\">gen_spec</span>\n\n<span class=\"bp\">#</span><span class=\"n\">check_invariants</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Test</span>\n</code></pre></div>",
        "id": 573109311,
        "sender_full_name": "Ilya Sergey",
        "timestamp": 1770745479
    },
    {
        "content": "<p>Thanks, the missing <code>#gen_spec</code> was the issue.  The action syntax seems to require the <code>=</code> with both</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/verse-lab/veil.git\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/verse-lab/veil/tree/veil-2.0-preview\"</span>\n</code></pre></div>",
        "id": 573110834,
        "sender_full_name": "Mark R. Tuttle",
        "timestamp": 1770745868
    },
    {
        "content": "<blockquote>\n<p>The action syntax seems to require the <code>=</code> with both</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"717546\">@Mark R. Tuttle</span> I suspect you're still using Veil 1.0. To use Veil 2.0, you should have the following in <code>lakefile.toml</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"veil\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/verse-lab/veil.git\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"veil-2.0-preview\"</span>\n</code></pre></div>\n<p>Note the use of <code>rev</code>, rather than giving the path to the branch in the <code>git</code> field.</p>\n<p>Then run <code>lake update veil</code>.</p>\n<p>I've added a version of the usage example for <code>veil-2.0-preview</code> at <a href=\"https://github.com/verse-lab/veil-usage-example/tree/veil-2.0-preview\">https://github.com/verse-lab/veil-usage-example/tree/veil-2.0-preview</a></p>\n<blockquote>\n<p><code>=</code> in the <code>incr</code> action</p>\n</blockquote>\n<p>To clarify: Veil 1.0's syntax mirrored Ivy (i.e. <code>action foo = {}</code>), but we're moving to <code>action foo { }</code> syntax in Veil 2.0 (without <code>=</code>).</p>",
        "id": 573178385,
        "sender_full_name": "George Pîrlea",
        "timestamp": 1770770907
    },
    {
        "content": "<p>Thanks.  And which version of lean should I be using?  The lake update veil updated the toolchain to 27.0.</p>",
        "id": 573316772,
        "sender_full_name": "Mark R. Tuttle",
        "timestamp": 1770823540
    },
    {
        "content": "<p>v4.27.0 is the correct version, yes.</p>",
        "id": 573423055,
        "sender_full_name": "George Pîrlea",
        "timestamp": 1770862563
    }
]