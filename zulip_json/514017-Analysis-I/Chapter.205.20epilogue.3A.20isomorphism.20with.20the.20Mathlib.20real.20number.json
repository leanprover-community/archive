[
    {
        "content": "<p>Has anyone managed to make <a href=\"https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean\"><code>Section_5_epilogue.lean</code></a> build <code>sorry</code> free?</p>",
        "id": 529896882,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1753106165
    },
    {
        "content": "<p>Some context: in the chapter 5 epilogue it is shown that there is an isomorphism between the Chapter 5 reals and the Mathlib reals.</p>",
        "id": 529968811,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1753133551
    },
    {
        "content": "<p>Could it be that this level (the section 5 epilogue) hasn’t been \"play tested\" by anyone yet?</p>",
        "id": 530848108,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1753477323
    },
    {
        "content": "<p>Honestly I don't see why we have to go through dedekind cuts</p>",
        "id": 530848504,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753477486
    },
    {
        "content": "<p>Both constructions satisfy the property \"(conditionally) complete linear ordered field\" and so must be uniquely isomorphic as ordered fields</p>",
        "id": 530848688,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753477560
    },
    {
        "content": "<p>Since they must be Archimedean and any Archimedean linear ordered field embeds uniquely in any conditionally complete linearly ordered field</p>",
        "id": 530848847,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753477639
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> I'm not sure I follow. Are you suggesting that the Cauchy sequence construction should have been used instead, or that an axiomatic approach would be more appropriate? I thought the intention was to follow the book, which uses the Dedekind construction. If I understand correctly, the Dedekind approach is typically used in introductory real analysis texts (such as Analysis I and Baby Rudin) because it's conceptually simpler than the Cauchy construction.</p>",
        "id": 530851119,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1753478786
    },
    {
        "content": "<p>I mean for showing that <code>Chapter5.Real</code> is uniquely isomorphic to <code>_root_.Real</code> you really don't need to know the details of either of them,  just that they're both conditionally complete linearly ordered fields, and you also don't have to define dedekind cuts. Uniqueness is a lot easier than existence ehre.</p>",
        "id": 530851364,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753478901
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"816344\">@Aaron Liu</span> Now I think I follow. The goal should be to show <code>noncomputable instance : ConditionallyCompleteLinearOrderedField Chapter5.Real := …</code>?</p>\n<p>(We already know that <code>noncomputable instance : ConditionallyCompleteLinearOrderedField ℝ := { }</code>.)</p>\n<p>Context:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"ss\">`ConditionallyCompleteLinearOrderedField</span><span class=\"bp\">`</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"w\"> </span><span class=\"n\">satisfying</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">standard</span><span class=\"w\"> </span><span class=\"n\">axiomatization</span><span class=\"w\"> </span><span class=\"n\">of</span>\n<span class=\"w\">  </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">real</span><span class=\"w\"> </span><span class=\"n\">numbers</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">being</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">Dedekind</span><span class=\"w\"> </span><span class=\"n\">complete</span><span class=\"w\"> </span><span class=\"n\">and</span><span class=\"w\"> </span><span class=\"n\">linear</span><span class=\"w\"> </span><span class=\"n\">ordered</span><span class=\"w\"> </span><span class=\"n\">field</span><span class=\"bp\">.</span>\n</code></pre></div>",
        "id": 530852203,
        "sender_full_name": "Louis Cabarion",
        "timestamp": 1753479341
    },
    {
        "content": "<p>There is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearOrderedField.uniqueOrderRingIso#doc\">docs#LinearOrderedField.uniqueOrderRingIso</a> in mathlib, I'm saying you can just replicate this argument with <code>Chapter5.Real</code> and <code>_root_.Real</code>, without having to go through dedekind cuts.</p>",
        "id": 530852502,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753479492
    },
    {
        "content": "<p>The problem with textbook dedekind cuts is that they duplicate all the rational numbers and you have to explicitly exclude some of them</p>",
        "id": 530852576,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753479534
    },
    {
        "content": "<blockquote>\n<p>Could it be that this level (the section 5 epilogue) hasn’t been \"play tested\" by anyone yet?</p>\n</blockquote>\n<p>FWIW I'm doing the exercises roughly in order, but I find the epilogues and Chapter 3 pretty boring so I am planning to skip them until after chapter 11 <span aria-label=\"slight smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"slight smile\">:slight_smile:</span></p>",
        "id": 530854358,
        "sender_full_name": "Li Xuanji",
        "timestamp": 1753480547
    },
    {
        "content": "<p>I have not playtested this epilogue either, but my intent was to avoid too heavy a reliance on existing Mathlib theorems such as <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LinearOrderedField.uniqueOrderRingIso#doc\">docs#LinearOrderedField.uniqueOrderRingIso</a> and use the opportunity to teach some further mathematics, in particular introducing the alternate Dedekind cut approach to the reals without having to set up the full construction.  No doubt there are more efficient ways to achieve the specific goal of showing existence and uniqueness of the reals, but that was not quite my primary objective.</p>",
        "id": 530859787,
        "sender_full_name": "Terence Tao",
        "timestamp": 1753483524
    },
    {
        "content": "<p>Ok, I am finally at this section. I got the set isomorphism working and I am stuck on proving the homomorphism for the various operations - see <a href=\"https://github.com/rkirov/analysis\">https://github.com/rkirov/analysis</a></p>\n<p>I think I should make use of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/Group/Pointwise/CompleteLattice.html#csSup_add\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/Group/Pointwise/CompleteLattice.html#csSup_add</a> but haven't figure out how to.</p>",
        "id": 539923603,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758080730
    },
    {
        "content": "<p>ok, I have solutions for addition and le homomorphisms. </p>\n<p>First I define addition, multiplication and le on Dedekind cuts. Then prove OrderedRing isos between Real ~ DedekindCuts and R ~ DedekindCuts (the second one is basically copy paste of the first). Finally mathlib already knows that OrderedRing isos compose. Not sure if this is defeating the original intent of the exercises, but it does require me to learn more about Dedekind cuts (to define their + and * ops). In fact, I haven't finished the mul part as there is some trickery involved, but will read Rubin tomorrow and figure it out.</p>\n<p>see <a href=\"https://github.com/rkirov/analysis/commit/1a7741d2297b10f1a58a8711c111bd54a59b4e77\">https://github.com/rkirov/analysis/commit/1a7741d2297b10f1a58a8711c111bd54a59b4e77</a></p>",
        "id": 539946783,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758094441
    },
    {
        "content": "<p>Made some more progress here - finished all pow iso proofs, started defining DedekindCut mul following Rudin, but ran into a blocker - termination checker is not happy with my definition. I have never worked with it, so will need to do some more poking around tomorrow to figure out how to convince it that the recursive call will always reach the positive-positive branch with at most one recusive call.</p>\n<p><a href=\"https://github.com/rkirov/analysis/commit/b0dfdf71d32c161e20ef10ecfc9374bd4142c58a#diff-aba545776da0ad4df868df9bba8a9b120c1aae75bf23cce41c21cab506bdecd0R360-R369\">https://github.com/rkirov/analysis/commit/b0dfdf71d32c161e20ef10ecfc9374bd4142c58a#diff-aba545776da0ad4df868df9bba8a9b120c1aae75bf23cce41c21cab506bdecd0R360-R369</a></p>",
        "id": 540159365,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758179119
    },
    {
        "content": "<p>It occurs to me that an alternate way to proceed is to show that the embedding of the rationals in both the Chapter 5 reals and the Mathlib reals are compatible with the isomorphism between the two, i.e.,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">coe_equiv_coe</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>which is probably a lemma that should have gone in the epilogue anyway.  From this lemma one can show homomorphism properties on the rationals first, and then take limits to conclude the corresponding homomorphism properties for general reals.</p>\n<p>p.s.  Please feel free to record any tips for future users as pull requests to these sections!</p>",
        "id": 540205584,
        "sender_full_name": "Terence Tao",
        "timestamp": 1758193687
    },
    {
        "content": "<p>That's a great idea and looks much simpler than defining the whole theory of ring operations on Dedekind cuts.</p>\n<p>So I have the following</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">toCut</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">.</span><span class=\"n\">toCut</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">???</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">coe_equiv_coe</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">q</span><span class=\"o\">:</span><span class=\"n\">ℝ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"c1\">-- proved</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR_add_q</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">y</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- proved</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR_LIM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LIM_IN_R</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\">  </span><span class=\"c1\">-- ???</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR_add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\">  </span><span class=\"c1\">-- can be proved</span>\n</code></pre></div>\n<p>What I am missing:<br>\n1) somehow can't finish the basic <code>Real.equivR_eq</code> . It should be just <code>EquivLike.inv_apply_eq</code> but I have a <code>.symm</code> instead of <code>.inv</code> and can't find a way to transform between them :'(<br>\n2) I don't know what's the equivalent of LIM in mathlib's R but I need it for some sort of <code>equivR_LIM</code> theorem to finish the proof.</p>",
        "id": 540275745,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758212855
    },
    {
        "content": "<blockquote>\n<p>p.s. Please feel free to record any tips for future users as pull requests to these sections!</p>\n</blockquote>\n<p>Definitely, I plan so step back at the end of Chapter 5 (feels like a good point with all of Z,N,R built) and go through previous chapter and clean up stuff (also using <span class=\"user-mention\" data-user-id=\"418569\">@Dan Abramov</span> solutions for Ch2 and Ch3 that was recently finished), and write up the tips sections. I am two sorries away from finishing all of ch5, so a hopefully will be done with this by this weekend.</p>",
        "id": 540276501,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758213094
    },
    {
        "content": "<p>Ok, ignore problem 1) above, you had that in the original scaffold - <a href=\"https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean#L129-L131\">https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean#L129-L131</a> I just removed when going after the DedekindCut OrderRingIso approach. Adding it back works perfectly (though I continue to find working with <code>Equiv</code> and <code>EquivLike</code> surprisingly tricky due to <code>.symm</code> vs <code>.inv</code> or <code>.toFun</code> of direct eval).</p>",
        "id": 540278235,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758213606
    },
    {
        "content": "<p>As for problem 2: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CauSeq.lim#doc\">docs#CauSeq.lim</a> might work for you.  There is a more general limit notion <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=limUnder#doc\">docs#limUnder</a> but it is a little unintuitive to use; the limit of a convergent sequence <code>a:ℕ → ℝ</code>, for instance, is I believe <code>limUnder Filter.atTop a</code> if I am not mistaken.  The assertion that a sequence <code>a</code> converges to a limit <code>L</code> is <code>Filter.atTop.Tendsto a (nhds L)</code>, which is a little clunky, although one gets used to it (and filters do eventually make mathematical sense, I promise!)</p>",
        "id": 540309375,
        "sender_full_name": "Terence Tao",
        "timestamp": 1758224888
    },
    {
        "content": "<p>Using <code>CauSeq</code> worked reasonably well (I will eventually learn filters, but rather solve this more traditionally first).</p>\n<p>The leftover parts of the proof now boils down to transforming inequalities for limits in Reals and R into statements purely in Q and then showing they are equivalent. The theorems I have left to prove are (statements could be a bit off): </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">LIM_lt_LIM</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">LIM_le_LIM</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">∨</span>\n<span class=\"w\">    </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"bp\">.</span><span class=\"n\">lim_lt_lim</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"bp\">.</span><span class=\"n\">lim_le_lim</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">ε</span>\n<span class=\"w\">      </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"o\">:</span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ε</span><span class=\"w\"> </span><span class=\"bp\">&gt;</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">≥</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"n\">ε</span>\n<span class=\"w\">     </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>For custom Reals, it feels like something we would have proved (at least with epsilon real, and we can translate to epsilon in Q using exists_rat_between), but I can't seem to find it now.</p>\n<p>For the versions in mathlib R, I am very stumped and can't seem to find anything like that.</p>",
        "id": 540374793,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758259080
    },
    {
        "content": "<p><del>As I type, <code>Real.LIM_le_LIM</code> is a statement about &lt; not &lt;=. I assume there is a slip somewhere?</del> (edit: fixed)</p>",
        "id": 540428426,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1758279908
    },
    {
        "content": "<p>On looking a bit more at the <code>CauSeq</code> API it seems that there is only a light amount of API for <code>lim</code> itself, but a lot more on <code>LimZero</code>, the <code>const</code> Cauchy sequences, and the ordering on <code>CauSeq</code>, so one may have to first invoke things like <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CauSeq.equiv_lim#doc\">docs#CauSeq.equiv_lim</a> to translate things to a setting where there is more API.</p>",
        "id": 540432695,
        "sender_full_name": "Terence Tao",
        "timestamp": 1758281388
    },
    {
        "content": "<blockquote>\n<p>As I type, <code>Real.LIM_le_LIM</code> is a statement about &lt; not &lt;=. I assume there is a slip somewhere?</p>\n</blockquote>\n<p>Ah, typo, fixed it.</p>",
        "id": 540470113,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758292101
    },
    {
        "content": "<p>Made some more progress here. First I realized that some of the machinary in chapter 5 is just for \\N -&gt; \\Q, so can be used directly. The theorems I had above can be restated as (and doing &lt; and = version to derive &lt;= easily):</p>\n<p>Custom Real versions</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">LIM_lt_LIM</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">BoundedAwayPos</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">Equiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">c</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">LIM_eq_LIM'</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">):</span>\n<span class=\"w\">    </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">Equiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>and mathlib versions</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"bp\">.</span><span class=\"n\">lim_lt_lim</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)):</span>\n<span class=\"w\">    </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↔</span>\n<span class=\"w\">       </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">BoundedAwayPos</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">Equiv</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">c</span>\n\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"bp\">.</span><span class=\"n\">lim_eq_lim</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hb</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">)):</span>\n<span class=\"w\">    </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">lim</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">hb</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↔</span>\n<span class=\"w\">      </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">Equiv</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>I proved the custom Reals version, and also  <code>R.lim_eq_lim</code> using the tip from <span class=\"user-mention\" data-user-id=\"657719\">@Terence Tao</span> to translate to <code>LimZero</code> and use <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/CauSeq/Completion.html#CauSeq.lim_eq_zero_iff\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/Order/CauSeq/Completion.html#CauSeq.lim_eq_zero_iff</a>.  I think the same approach would work for <code>R.lim_lt_lim</code> but there is no <code>lim_lt_zero_iff</code>, so I need to understand a bit more how to use the other APIs.</p>\n<p>Btw, noticed there is no <code>CauSeq.lim_sub</code>, so wrote my own - <a href=\"https://github.com/rkirov/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean#L439-L442\">https://github.com/rkirov/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean#L439-L442</a>. Should I be upstreaming that to mathlib? Or given how overwhelmed the review queue is not bother.</p>",
        "id": 540555743,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758338898
    },
    {
        "content": "<p>Found a number of other useful APIs (there were two files containing them in mathlib) and with some unfolding ( <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>  I know I am not supposed to but there is no algorithm to know whether the right API wasn't build and unfolding is required, or I just haven't found it) managed to complete the final sorry - <a href=\"https://github.com/rkirov/analysis/commit/56babb2f9558a3d6f0e9be1b3c9f76c65ba04846\">https://github.com/rkirov/analysis/commit/56babb2f9558a3d6f0e9be1b3c9f76c65ba04846</a>.</p>\n<p>One other purely CauSeq theorem I needed and proved :</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"bp\">.</span><span class=\"n\">pos_equiv_pos</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"w\"> </span><span class=\"n\">abs</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">h</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≈</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">):</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">Pos</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">Pos</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>might be a good candidate for upstreaming too.</p>\n<p>Chapter 5 is fully complete now! Will take the next few days to write up a retro and go back to fill in the tips.</p>",
        "id": 540565729,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1758351657
    },
    {
        "content": "<p>I'm not familiar with the Mathlib upstreaming process, but I would imagine that small commits that just add a few simple and uncontroversial lemmas should be easy to process.  </p>\n<p>I have a tools directory in the repository for lemmas that could potentially be useful outside of the analysis text, one could also temporarily put those lemmas there until the Mathlib process resolves, and import them in the Chapter 5 epilogue.</p>",
        "id": 540585638,
        "sender_full_name": "Terence Tao",
        "timestamp": 1758374698
    },
    {
        "content": "<p>There's documentation at <a href=\"https://leanprover-community.github.io/contribute/index.html\">https://leanprover-community.github.io/contribute/index.html</a> , but yes, straightforward lemmas usually go through pretty quickly. (Definitions can be harder)</p>",
        "id": 540589151,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1758378387
    },
    {
        "content": "<p>I ended up solving it a different way where instead of going through <code>CauSeq.lim</code>, I used <code>_root_.Real.mk</code> since it behaves a lot more similarly to the <code>Chapter5.LIM</code></p>\n<p>The general idea was to first convert <code>IsCauchy</code> to <code>CauSeq</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"bp\">.</span><span class=\"n\">to_IsCauSeq</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauSeq</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">root_</span><span class=\"bp\">.</span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"n\">a</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"bp\">.</span><span class=\"n\">CauSeq</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">CauSeq</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"n\">root_</span><span class=\"bp\">.</span><span class=\"n\">abs</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">a</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">·.</span><span class=\"n\">to_IsCauSeq</span><span class=\"bp\">⟩</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>And then use that to show an that  <code>(LIM a).equivR = Real.mk ha.CauSeq</code> with this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">equivR_eq</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sequence</span><span class=\"bp\">.</span><span class=\"n\">IsCauchy</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">),</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">LIM</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">equivR</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">Real</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">ha</span><span class=\"bp\">.</span><span class=\"n\">CauSeq</span>\n</code></pre></div>\n<p>Which then let me solve <code>Real.equivR_ordered_ring</code> using operations on sequences</p>\n<p>I ended up making the template for this at: <a href=\"https://github.com/ggrandi/analysis/blob/a6c2ccb2a5453ef83b7c99548db762ac49ac7923/analysis/Analysis/Section_5_epilogue.lean#L130\">https://github.com/ggrandi/analysis/blob/a6c2ccb2a5453ef83b7c99548db762ac49ac7923/analysis/Analysis/Section_5_epilogue.lean#L130</a></p>\n<p>And my solution using this idea: <a href=\"https://github.com/ggrandi/analysis/blob/my_solutions/analysis/Analysis/Section_5_epilogue.lean#L208\">https://github.com/ggrandi/analysis/blob/my_solutions/analysis/Analysis/Section_5_epilogue.lean#L208</a></p>",
        "id": 570203799,
        "sender_full_name": "Giovanni",
        "timestamp": 1769468279
    },
    {
        "content": "<p>thanks for sharing, this looks a lot simpler than my approach <a href=\"https://github.com/rkirov/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean\">https://github.com/rkirov/analysis/blob/main/analysis/Analysis/Section_5_epilogue.lean</a> , you should upstream it.</p>",
        "id": 571319131,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1769983338
    },
    {
        "content": "<p>I ended up opening a PR for it at: <a href=\"https://github.com/teorth/analysis/pull/439\">https://github.com/teorth/analysis/pull/439</a></p>",
        "id": 571515823,
        "sender_full_name": "Giovanni",
        "timestamp": 1770062882
    }
]