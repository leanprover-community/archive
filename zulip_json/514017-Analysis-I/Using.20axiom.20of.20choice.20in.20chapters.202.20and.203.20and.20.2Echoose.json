[
    {
        "content": "<p>AFAIKT, the text is careful to not use axiom of choice in chapters 2 and 3 so far and exercise 3.6.8 says</p>\n<blockquote>\n<p>(The converse to this statement requires the axiom of choice; see Exercise 8.4.3.)</p>\n</blockquote>\n<p>Meanwhile in lean code we use <code>Classical.choose</code> quite liberally. Is this due to subtle difference in Lean axiomatization and the book? Or it is justified because it is always of some more limited flavor like - finite choice?</p>\n<p>If my solution for 3.6.8 uses <code>choice</code> - <a href=\"https://github.com/rkirov/analysis/blob/6c84045c7b31208848e373418705deff855f99af/analysis/Analysis/Section_3_6.lean#L2239-L2240\">https://github.com/rkirov/analysis/blob/6c84045c7b31208848e373418705deff855f99af/analysis/Analysis/Section_3_6.lean#L2239-L2240</a> should I try to find another one that doesn't? Which I feel would be hard without assuming finite A and B.</p>",
        "id": 531988649,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1753942180
    },
    {
        "content": "<p>Lean/Mathlib uses <code>Classical.choose</code> like a swiss army knife, to solve all sorts of problems.  For instance, I think the law of the excluded middle ultimately requires choice to prove in Lean, and choice is also needed for the far more innocuous \"axiom of unique choice\" that a choice function exists when there is only a unique choice of output for each input.  If we were not aiming to transition from the textbook to Mathlib, one could imagine (rather tediously) setting up several intermediate axioms between <code>Classical.choice</code> and no choice whatsoever (in particular, having <code>ExistsUnique.choice</code> as a separate axiom), and take care to craft proofs of various Mathlib lemmas so that they use the minimal amount of choice, but this would be a lot of work for very little gain (it would be largely invisible to the student doing the exercises, other than if that student cared to <code>#print axioms</code> on the various assertions proved; reducing the dependence on choice also does not help too much in making <code>noncomputable</code> definitions <code>computable</code>, unless one reduces the axiom set all the way down to constructive mathematics, which is noticeably more restrictive than simply not using choice).</p>\n<p>This by the way is perhaps a future use case of automated AI tools: to take a Lean proof based on Mathlib and somehow work out its reverse mathematics, i.e., find the minimal axioms under which one could still have \"essentially the same\" proof.</p>",
        "id": 532107270,
        "sender_full_name": "Terence Tao",
        "timestamp": 1753976327
    },
    {
        "content": "<p>I see, I think I understand it now. Mathematically, in terms of strength we have (from strongest to weakest, stronger implies weaker, but not vice versa) : AC -&gt; AUC -&gt; LEM. In Lean (or mathlib specifically?), constructive mathematic means we have none of those, but \"Classical\" means we start with AC and pick up the rest. So Lean has two main foundation \"levels\", but in theory there are these in between axiomatizations.</p>\n<p>For example:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">em</span>\n<span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">em'</span><span class=\"w\"> </span><span class=\"n\">depends</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>So the companion code will diverge too much from Mathlib if it decides to work in <code>LEM + AFC + AUC (but not AC)</code> axiomatization for chapter 2 and 3. For example,</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">#</span><span class=\"n\">print</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">finite_choice</span>\n<span class=\"bp\">'</span><span class=\"n\">Chapter3</span><span class=\"bp\">.</span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">finite_choice'</span><span class=\"w\"> </span><span class=\"n\">depends</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">axioms</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">propext</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"bp\">.</span><span class=\"n\">choice</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Quot</span><span class=\"bp\">.</span><span class=\"n\">sound</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>but the proof actually used just LEM.</p>\n<p>The answer to my question above that my solution for 3.6.8 is justified because it uses unique choice (because of injectivity the preimage has a single element), and such distinction is not possible in the current shape of the companion so ok to use <code>classical.choice</code>.</p>\n<p>I guess the only question left is why the book doesn't prove <code>unique choice</code>, since it already has proofs for <code>single choice</code> and <code>finite choice</code>. Is it a) it is not provable with the axioms in Ch3 and needs to be an axiom of its own or b) intentionally skipped because it might be too much foundations. How would one solve 3.6.8 on pen-and-paper without that?</p>",
        "id": 532327857,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1754061525
    },
    {
        "content": "<p>In the book, unique choice is baked into the definition of a function (Definition 3.3.1, or <a href=\"https://teorth.github.io/analysis/docs/Analysis/Section_3_3.html#Chapter3.Function\">https://teorth.github.io/analysis/docs/Analysis/Section_3_3.html#Chapter3.Function</a> in the lean formalization; see also Remark 3.3.2 which alludes to this definition really being an axiom).  After Section 3.3, this notion of a function is deprecated in favor of the Mathlib functions; unique choice is then implemented in <a href=\"https://teorth.github.io/analysis/docs/Analysis/Tools/ExistsUnique.html#ExistsUnique.choose\">https://teorth.github.io/analysis/docs/Analysis/Tools/ExistsUnique.html#ExistsUnique.choose</a> .  The coercion from Chapter 3 functions to Mathlib functions in <a href=\"https://teorth.github.io/analysis/docs/Analysis/Section_3_3.html#Chapter3.Function.to_fn\">https://teorth.github.io/analysis/docs/Analysis/Section_3_3.html#Chapter3.Function.to_fn</a> can also be viewed as an implementation of unique choice.  Of course, to construct this coercion in Mathlib requires <code>Classical.choose</code>.</p>\n<p>In orthodox set theory (as opposed to type theory), it is common to define functions through their graph, in which case unique choice is a consequence of the other axioms of set theory.  This is implemented in the book as Exercise 3.5.10 , <a href=\"https://teorth.github.io/analysis/docs/Analysis/Section_3_5.html#Chapter3.SetTheory.Set.is_graph\">https://teorth.github.io/analysis/docs/Analysis/Section_3_5.html#Chapter3.SetTheory.Set.is_graph</a></p>",
        "id": 532333207,
        "sender_full_name": "Terence Tao",
        "timestamp": 1754063325
    },
    {
        "content": "<p>Oh, I see, this is very subtle, because choice axiom statements use functions, the answer depends on precisely how we define functions themselves which differs in type theory and orthodox set theory. Thanks for explaining it!</p>",
        "id": 532521638,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1754200261
    },
    {
        "content": "<p>By the way, in case you all aren't aware -- Choice can be invoked without using Mathlib or even ever opening Classical. I accidentally proved some intermediate lemmas using it while going through Chapter 2. </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">lem</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">¬</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">∨</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">tauto</span>\n</code></pre></div>\n<p>The <code>tauto</code> tactic does document that it tries to solve things classically. I'm not sure which other tactics do.</p>",
        "id": 532607177,
        "sender_full_name": "JJ",
        "timestamp": 1754260490
    }
]