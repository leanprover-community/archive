[
    {
        "content": "<p>I am trying to do a simple rewrite using a proof <code>Fin 0 = \\emptyset</code> using <code>rw [this]</code> see screenshot. I understand now what the error says - <code>Fin 0</code> is used also in the type of <code>A</code>, but is there a way to tell Lean rewrite that too? Simp [this] makes no progress either.</p>\n<p><a href=\"/user_uploads/3121/LtWH9jasfRxD-_b284pYM-h6/Screenshot-2025-07-30-at-9.48.49PM.png\">Screenshot 2025-07-30 at 9.48.49 PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/LtWH9jasfRxD-_b284pYM-h6/Screenshot-2025-07-30-at-9.48.49PM.png\" title=\"Screenshot 2025-07-30 at 9.48.49 PM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"818x298\" src=\"/user_uploads/thumbnail/3121/LtWH9jasfRxD-_b284pYM-h6/Screenshot-2025-07-30-at-9.48.49PM.png/840x560.webp\"></a></div><p><a href=\"/user_uploads/3121/D07HWzkftwpwwoF7hn8AE2C_/Screenshot-2025-07-30-at-9.49.02PM.png\">Screenshot 2025-07-30 at 9.49.02 PM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/D07HWzkftwpwwoF7hn8AE2C_/Screenshot-2025-07-30-at-9.49.02PM.png\" title=\"Screenshot 2025-07-30 at 9.49.02 PM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1658x598\" src=\"/user_uploads/thumbnail/3121/D07HWzkftwpwwoF7hn8AE2C_/Screenshot-2025-07-30-at-9.49.02PM.png/840x560.webp\"></a></div>",
        "id": 531979931,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1753937414
    },
    {
        "content": "<p>Try <code>revert A</code> and then rewrite</p>",
        "id": 532032730,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753956526
    },
    {
        "content": "<p>That's what I do and it usually works</p>",
        "id": 532032759,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1753956534
    },
    {
        "content": "<p>Nice, that worked for me too.</p>",
        "id": 532093897,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1753973103
    },
    {
        "content": "<p>Most of the time, \"motive not type correct\" means that after doing the rewrite, one of the subterms has a type that couldn't be rewritten. The rewrite tactic can only rewrite subterms, not types of subterms.</p>\n<p>In this case, see how the error message says that <code>A</code> has type <code>(Fin 0).subtype -&gt; Set</code> but it's expected to have type <code>_a.toSubtype -&gt; Set</code>? That <code>_a</code> represents the subterm that's being rewritten; it starts as <code>Fin 0</code>, and it will become <code>\\emptyset</code>.</p>\n<p>Since <code>A</code> is a local variable, this suggests that a solution could be to <code>revert</code> it. The effect of doing this is that now the type of <code>A</code> is in the goal. Since the type is now a subterm, it's something that <code>rw</code> can rewrite.</p>",
        "id": 532123813,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753980677
    },
    {
        "content": "<p>Makes sense, sounds like <code>revert A</code> is something I need to add to my bag of tricks.</p>\n<blockquote>\n<p>The rewrite tactic can only rewrite subterms, not types of subterms.</p>\n</blockquote>\n<p>I was testing this with some contrived examples - but it does seem here <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQATAUwDM4BzACgH0AuOATQEpbBUQjmoF44AGOHNA6ARBwk6dAC8CUCOQCetRrVJxZcTjw5wsqqEXQ4CADyTh0BOOUO0AGgwuoba+kzJxDTjZ2044cKAHc4AG1UAF0ReEMfP0Cg0QkpCFCcHCA\">https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQATAUwDM4BzACgH0AuOATQEpbBUQjmoF44AGOHNA6ARBwk6dAC8CUCOQCetRrVJxZcTjw5wsqqEXQ4CADyTh0BOOUO0AGgwuoba+kzJxDTjZ2044cKAHc4AG1UAF0ReEMfP0Cg0QkpCFCcHCA</a>  that Lean can make <code>x: X</code> turn into <code>x: Y</code> with <code>rw</code>. So maybe the limitation above is more of <code>rw</code> can't rewrite at two places at once - the goal and local definitions?</p>",
        "id": 532328585,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1754061767
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488971\">Rado Kirov</span> <a href=\"#narrow/channel/514017-Analysis-I/topic/hitting.20the.20dreaded.20motive.20rw.20error.20in.203.2E6.2E10/near/532328585\">said</a>:</p>\n<blockquote>\n<p>Makes sense, sounds like <code>revert A</code> is something I need to add to my bag of tricks.</p>\n<blockquote>\n<p>The rewrite tactic can only rewrite subterms, not types of subterms.</p>\n</blockquote>\n<p>I was testing this with some contrived examples - but it does seem here <a href=\"https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQATAUwDM4BzACgH0AuOATQEpbBUQjmoF44AGOHNA6ARBwk6dAC8CUCOQCetRrVJxZcTjw5wsqqEXQ4CADyTh0BOOUO0AGgwuoba+kzJxDTjZ2044cKAHc4AG1UAF0ReEMfP0Cg0QkpCFCcHCA\">https://live.lean-lang.org/#codez=JYWwDg9gTgLgBAWQIYwBYBtgCMBQATAUwDM4BzACgH0AuOATQEpbBUQjmoF44AGOHNA6ARBwk6dAC8CUCOQCetRrVJxZcTjw5wsqqEXQ4CADyTh0BOOUO0AGgwuoba+kzJxDTjZ2044cKAHc4AG1UAF0ReEMfP0Cg0QkpCFCcHCA</a>  that Lean can make <code>x: X</code> turn into <code>x: Y</code> with <code>rw</code>. So maybe the limitation above is more of <code>rw</code> can't rewrite at two places at once - the goal and local definitions?</p>\n</blockquote>\n<p>That's because you are rewriting the type of <code>x</code>, not <code>x</code> itself</p>",
        "id": 532328991,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754061911
    },
    {
        "content": "<p>Right, but that's what I wanted in the original question - rewrite <code>Fin 0</code> both in the goal and in the type of <code>A</code> which would have allowed for the whole thing to continue to type-check.</p>\n<p>The problem is these are two rewrites, so something like <code>rw [h] at \\goal A</code> could have worked, if the <code>rw</code> works simultaneously across both places (which I guess it doesn't).</p>",
        "id": 532329828,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1754062180
    },
    {
        "content": "<p>yeah you can't rewrite simultaneously in multiple places</p>",
        "id": 532330322,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754062325
    },
    {
        "content": "<p>you have to put them together into a single expression</p>",
        "id": 532330362,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754062337
    },
    {
        "content": "<p>so that's what <code>revert x</code> will do</p>",
        "id": 532330382,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1754062346
    }
]