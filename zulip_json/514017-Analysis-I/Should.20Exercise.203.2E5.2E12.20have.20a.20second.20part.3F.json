[
    {
        "content": "<p>In the book, Exercise 3.5.12 has a second part:</p>\n<p><a href=\"/user_uploads/3121/Io4VGBE6cgUVulSQec_xjAgq/Screenshot-2025-08-13-at-18.00.00.png\">Screenshot 2025-08-13 at 18.00.00.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Io4VGBE6cgUVulSQec_xjAgq/Screenshot-2025-08-13-at-18.00.00.png\" title=\"Screenshot 2025-08-13 at 18.00.00.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1422x1502\" src=\"/user_uploads/thumbnail/3121/Io4VGBE6cgUVulSQec_xjAgq/Screenshot-2025-08-13-at-18.00.00.png/840x560.webp\"></a></div><p>I solved <code>SetTheory.Set.recursion</code> using <code>Nat.rec</code> like this:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Exercise 3.5.12, with errata from web site incorporated -/</span>\n<span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">recursion</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">c</span><span class=\"o\">:</span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃!</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">nat</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">apply</span><span class=\"w\"> </span><span class=\"n\">existsUnique_of_exists_of_unique</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">rec</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">n</span>\n<span class=\"w\">    </span><span class=\"n\">simp_all</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">a</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">f1</span><span class=\"w\"> </span><span class=\"n\">f2</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">h1z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h1s</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">h2z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2s</span><span class=\"bp\">⟩</span>\n<span class=\"w\">  </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">induction'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"k\">with</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">hn</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">((</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">):</span><span class=\"n\">nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">cc</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h1s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h2s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hn</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>Assuming this solution makes sense, it only covers the first part.</p>\n<p>Is it worth trying to approach the second part (using only Peano Axioms)? I suppose this would require importing <code>Chapter2.Nat</code>? Or would the recommended approach be to work with Mathlib <code>Nat</code> but to avoid <code>Nat.rec</code> and order?</p>\n<p>Or is the second part of this exercise not well-suited to this formalization in general?</p>\n<p>Thanks.</p>",
        "id": 534270316,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755104564
    },
    {
        "content": "<p>I guess I'm also not sure that my solution is legit at all (even for the first part) since depending on <code>Nat.rec</code> might be defeating the point?</p>",
        "id": 534270555,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755104677
    },
    {
        "content": "<p>Yeah on a second thought, my solution is kind of circular and doesn't follow the hint so I'll give it another try. Still, wondering if the second part is intended to be done.</p>",
        "id": 534270985,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1755104892
    },
    {
        "content": "<p>The general philosophy I have in the book is that once a relevant concept (e.g., the natural numbers) is developed, one transitions over to the Mathlib version of that concept, and full access to all the API of that version is then permitted; for instance, after Chapter 2, one is encouraged use the entire library of <code>Nat</code>, including <code>Nat.rec</code>.</p>\n<p>With this perspective, one way to proceed would be to continue to use Mathlib's <code>Nat</code>, but only via the <code>Mathlib_Nat</code> object constructed in the Chapter 2 epilogue.  (But as one can see from that object, <code>Nat.rec</code> is oneo of the components, so your argument would basically fulfill the spirit of the exercise already.)</p>",
        "id": 534301420,
        "sender_full_name": "Terence Tao",
        "timestamp": 1755117803
    }
]