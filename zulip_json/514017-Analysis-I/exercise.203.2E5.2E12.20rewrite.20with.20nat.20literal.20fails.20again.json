[
    {
        "content": "<p>I thought I understood nat literals but I am stuck on what appears a very basic rewriting again.</p>\n<p><a href=\"/user_uploads/3121/u2a3D7pLO9QMXzEiWGDda616/Screenshot-2025-07-19-at-8.44.11AM.png\">Screenshot 2025-07-19 at 8.44.11 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/u2a3D7pLO9QMXzEiWGDda616/Screenshot-2025-07-19-at-8.44.11AM.png\" title=\"Screenshot 2025-07-19 at 8.44.11 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"512x138\" src=\"/user_uploads/thumbnail/3121/u2a3D7pLO9QMXzEiWGDda616/Screenshot-2025-07-19-at-8.44.11AM.png/840x560.webp\"></a></div>",
        "id": 529584656,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752940234
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/Ou3j3BNMkfSKUu4JoscnKIfE/Screenshot-2025-07-19-at-8.48.08AM.png\">Screenshot 2025-07-19 at 8.48.08 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Ou3j3BNMkfSKUu4JoscnKIfE/Screenshot-2025-07-19-at-8.48.08AM.png\" title=\"Screenshot 2025-07-19 at 8.48.08 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1370x536\" src=\"/user_uploads/thumbnail/3121/Ou3j3BNMkfSKUu4JoscnKIfE/Screenshot-2025-07-19-at-8.48.08AM.png/840x560.webp\"></a></div>",
        "id": 529584714,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752940308
    },
    {
        "content": "<p>Am I correct that the ofNat part matches?<br>\n<a href=\"/user_uploads/3121/hH536hlGHTlCoDO8yIH-OzTl/Screenshot-2025-07-19-at-8.52.35AM.png\">Screenshot 2025-07-19 at 8.52.35 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/hH536hlGHTlCoDO8yIH-OzTl/Screenshot-2025-07-19-at-8.52.35AM.png\" title=\"Screenshot 2025-07-19 at 8.52.35 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"524x150\" src=\"/user_uploads/thumbnail/3121/hH536hlGHTlCoDO8yIH-OzTl/Screenshot-2025-07-19-at-8.52.35AM.png/840x560.webp\"></a></div>",
        "id": 529584778,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752940377
    },
    {
        "content": "<p>my hypothesis is that actually <code>nat_equiv.symm</code> has implicit args that don't</p>\n<p><a href=\"/user_uploads/3121/l8mO1aQL-8RNrxZmXklc6O1i/Screenshot-2025-07-19-at-8.53.30AM.png\">Screenshot 2025-07-19 at 8.53.30 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/l8mO1aQL-8RNrxZmXklc6O1i/Screenshot-2025-07-19-at-8.53.30AM.png\" title=\"Screenshot 2025-07-19 at 8.53.30 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"554x206\" src=\"/user_uploads/thumbnail/3121/l8mO1aQL-8RNrxZmXklc6O1i/Screenshot-2025-07-19-at-8.53.30AM.png/840x560.webp\"></a></div><p>vs </p>\n<p><a href=\"/user_uploads/3121/kfLrheJipg-9rTybgbpQYpA9/Screenshot-2025-07-19-at-8.54.23AM.png\">Screenshot 2025-07-19 at 8.54.23 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/kfLrheJipg-9rTybgbpQYpA9/Screenshot-2025-07-19-at-8.54.23AM.png\" title=\"Screenshot 2025-07-19 at 8.54.23 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"468x148\" src=\"/user_uploads/thumbnail/3121/kfLrheJipg-9rTybgbpQYpA9/Screenshot-2025-07-19-at-8.54.23AM.png/840x560.webp\"></a></div><p>but not sure how to resolve that (assuming that's the issue)</p>",
        "id": 529584856,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752940451
    },
    {
        "content": "<p>Not sure if this is even a problem because I have <code>example : { x: Object // x ∈ nat } = Nat := by exact rfl</code></p>",
        "id": 529585379,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752940945
    },
    {
        "content": "<p>well... looking at your first screenshot, i suspect that if you hover over the left <code>0</code> in <code>this</code> you'll see a <em>second</em> <code>OfNat.ofNat</code>, which <em>doesn't</em> match with your goal...</p>",
        "id": 529586824,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752941214
    },
    {
        "content": "<p>You are absolutely right<br>\n<a href=\"/user_uploads/3121/kOjdsoIA_nPFGG2PQKKB98LG/Screenshot-2025-07-19-at-9.10.02AM.png\">Screenshot 2025-07-19 at 9.10.02 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/kOjdsoIA_nPFGG2PQKKB98LG/Screenshot-2025-07-19-at-9.10.02AM.png\" title=\"Screenshot 2025-07-19 at 9.10.02 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"536x180\" src=\"/user_uploads/thumbnail/3121/kOjdsoIA_nPFGG2PQKKB98LG/Screenshot-2025-07-19-at-9.10.02AM.png/840x560.webp\"></a></div>",
        "id": 529588681,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752941460
    },
    {
        "content": "<p>This from a lemma I wrote:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nat_equiv_zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">nat_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ofNat</span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">):</span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">symm_apply_eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>how should I write the lemma so that the rw works?</p>",
        "id": 529588992,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752941500
    },
    {
        "content": "<p>Just don't write <code>ofNat(0)</code>, the <code>ofNat(n)</code> is for when <code>n</code> is a variable, you should just put <code>0</code> instead</p>",
        "id": 529589413,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752941562
    },
    {
        "content": "<p><a href=\"/user_uploads/3121/GEXt9RWhbvpGXH35RVwqv4wx/Screenshot-2025-07-19-at-9.14.14AM.png\">Screenshot 2025-07-19 at 9.14.14 AM.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/GEXt9RWhbvpGXH35RVwqv4wx/Screenshot-2025-07-19-at-9.14.14AM.png\" title=\"Screenshot 2025-07-19 at 9.14.14 AM.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1822x560\" src=\"/user_uploads/thumbnail/3121/GEXt9RWhbvpGXH35RVwqv4wx/Screenshot-2025-07-19-at-9.14.14AM.png/840x560.webp\"></a></div>",
        "id": 529590106,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752941666
    },
    {
        "content": "<p>So writing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nat_equiv_zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">nat_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Equiv</span><span class=\"bp\">.</span><span class=\"n\">symm_apply_eq</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rfl</span>\n</code></pre></div>\n<p>doesn't work for the reason above.</p>\n<p>Writing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nat_equiv_zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">nat_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"bp\">_</span>\n</code></pre></div>\n<p>works for the lemma but the rw doesn't apply</p>",
        "id": 529590978,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752942368
    },
    {
        "content": "<p>what is <code>Nat.toSubtype</code>?</p>",
        "id": 529591872,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752943427
    },
    {
        "content": "<p><a href=\"https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_3_1.lean#L383\">https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_3_1.lean#L383</a></p>",
        "id": 529591972,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752943556
    },
    {
        "content": "<p>Various nat casts begin here - <a href=\"https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_3_1.lean#L583\">https://github.com/teorth/analysis/blob/main/analysis/Analysis/Section_3_1.lean#L583</a> but I don’t believe toSubtype is specialized on Nat</p>",
        "id": 529592079,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752943677
    },
    {
        "content": "<p>could it be the case that the clue is that there's two <code>nat_equiv</code>s? there's <code>SetTheory.Set.nat_equiv</code> (which shows as <code>nat_equiv</code> due to <a href=\"https://github.com/teorth/analysis/blob/b3ee408ab67808b5a768ff808d345501e5b2f40f/analysis/Analysis/Section_3_1.lean#L150C1-L150C19\">this line</a>, whereas there also is <code>SetTheory.nat_equiv</code> which is a field of the <code>SetTheory</code> structure?</p>",
        "id": 529593030,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752944795
    },
    {
        "content": "<p>i think that rewrite doesn't see through this</p>",
        "id": 529593053,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752944820
    },
    {
        "content": "<p>it seemed weird to me that the infoview was inconsistent between showing <code>nat_equiv</code> with and without namespace</p>",
        "id": 529593100,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752944879
    },
    {
        "content": "<p>all this together seems to suggest that using this lemma should work:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nat_equiv_symm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℕ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">nat_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"n\">ofNat</span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ofNat</span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 529593237,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752945059
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488971\">Rado Kirov</span> <a href=\"#narrow/channel/514017-Analysis-I/topic/exercise.203.2E5.2E12.20rewrite.20with.20nat.20literal.20fails.20again/near/529590106\">said</a>:</p>\n<blockquote>\n<p><a href=\"/user_uploads/3121/GEXt9RWhbvpGXH35RVwqv4wx/Screenshot-2025-07-19-at-9.14.14AM.png\">Screenshot 2025-07-19 at 9.14.14 AM.png</a></p>\n</blockquote>\n<p>put <code>(0 : Nat)</code> instead of <code>(ofNat(0):Nat)</code></p>",
        "id": 529602630,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752946865
    },
    {
        "content": "<p>Thank you all for the discussion! It gives me some more things to try and will update here when I get back to a computer.</p>",
        "id": 529607006,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752952033
    },
    {
        "content": "<p>Yeah, that did it</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">nat_equiv_symm_zero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">SetTheory</span><span class=\"bp\">.</span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">nat_equiv</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>applies well!</p>",
        "id": 529610171,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752956121
    },
    {
        "content": "<p>The definitions is here <a href=\"https://github.com/teorth/analysis/blob/b3ee408ab67808b5a768ff808d345501e5b2f40f/analysis/Analysis/Section_3_1.lean#L583\">https://github.com/teorth/analysis/blob/b3ee408ab67808b5a768ff808d345501e5b2f40f/analysis/Analysis/Section_3_1.lean#L583</a> and along with <code>open SetTheory.Set</code> there seems to be non-trivial aliasing. So now I wonder whether this should have been <code>abbrev</code> to avoid these type of issues. Very sharp edge for new learners, didn't even think to look into namespacing and aliasing, and blamed it all on literals.</p>",
        "id": 529610256,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752956229
    },
    {
        "content": "<p>Meta-question, could I have done something better debugging earlier - say I have at theorem <code>f a = b</code> that doesn't apply a rw in some complex expression where I 'believe' I see <code>f a</code>. Was there something to hint me that <code>f</code> doesn't match vs <code>a</code>? A slight variation is also some times <code>f a</code> looks that same, but the type of <code>f</code> or <code>a</code> doesn't match or some implicit parameter of <code>f</code>.</p>",
        "id": 529610637,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752956737
    },
    {
        "content": "<p>I don't know enough to be giving compiler authors advice, but I wonder if the error messages on <code>rw</code> can be improved with some 'partial matches' info. Here is an example of how TypeScript compiler shows different error message depending on how different branches of an union type match</p>\n<p><a href=\"https://www.typescriptlang.org/play/#code/GYVwdgxgLglg9mABMAFADwFyIN4Gc4C2ApgPoAOATnGVnoaQCZFFnlU2K5QUxgDmAXwGIAPjnzEScKAAsiFNtVoTGzVpSWIwIAgCN5QgJQ4BAKFMAbIlERpEAXnH1FHOpKYtymgOTehAbktrRABPBydJaTkFDVcVEg91TQAGANNUNENA1BCs8ysbAC9w7D4AQwpdMr4iZWdElyxfNNRCrKA\">https://www.typescriptlang.org/play/?#code/GYVwdgxgLglg9mABMAFADwFyIN4Gc4C2ApgPoAOATnGVnoaQCZFFnlU2K5QUxgDmAXwGIAPjnzEScKAAsiFNtVoTGzVpSWIwIAgCN5QgJQ4BAKFMAbIlERpEAXnH1FHOpKYtymgOTehAbktrRABPBydJaTkFDVcVEg91TQAGANNUNENA1BCs8ysbAC9w7D4AQwpdMr4iZWdElyxfNNRCrKA</a></p>",
        "id": 529611121,
        "sender_full_name": "Rado Kirov",
        "timestamp": 1752957275
    },
    {
        "content": "<p>There could be a trace option for this (but there isn't), it's not too hard to implement I think</p>",
        "id": 529613464,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752960333
    },
    {
        "content": "<p>The function that does the matching is called <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.Meta.kabstract#doc\">docs#Lean.Meta.kabstract</a></p>",
        "id": 529613493,
        "sender_full_name": "Aaron Liu",
        "timestamp": 1752960380
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488971\">Rado Kirov</span> <a href=\"#narrow/channel/514017-Analysis-I/topic/exercise.203.2E5.2E12.20rewrite.20with.20nat.20literal.20fails.20again/near/529610256\">said</a>:</p>\n<blockquote>\n<p>So now I wonder whether this should have been <code>abbrev</code> to avoid these type of issues.</p>\n</blockquote>\n<p>i don't think so, i believe you'd run into the same issue</p>",
        "id": 529614452,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1752961684
    }
]