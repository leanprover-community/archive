[
    {
        "content": "<p>I noticed that if any declarations fail linting, we exit <code>runLinter</code> with code 1, and radar fails entirely.</p>\n<p>I'm not sure this is actually a radar issue; perhaps <code>runLinter</code> should not be exiting with code 1 when declarations fail linting. After all, the program itself succeeded; and for radar to handle it, it would have to capture every exit 1 in <code>runLinter</code>, even less intentional ones.</p>\n<p>I'm not quite sure what best practice is here. Perhaps a <code>warningAsError</code> config flag, like lean has, which determines whether we exit with 0 or 1 on linting warnings? (And should linting warnings be printed to stdout or stderr?)</p>",
        "id": 573171528,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1770766888
    },
    {
        "content": "<p>Could you point out a radar run affected by this? I think I'm missing some context about when this happens.</p>\n<p>My initial thought (that you've probably already considered) is that downstream breakage of CI needs to be considered/coordinated for this, otherwise anything that uses this as its lint driver will begin to silently allow failures.</p>",
        "id": 573182781,
        "sender_full_name": "Chris Henson",
        "timestamp": 1770773496
    },
    {
        "content": "<p>I don't think radar should be benchmarking <code>runLinter</code> at all if it fails</p>",
        "id": 573183008,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1770773710
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"687698\">Chris Henson</span> <a href=\"#narrow/channel/348111-batteries/topic/runLinter.3A.20exit.201.20or.200.20when.20declarations.20fail.20linting.3F/near/573182781\">said</a>:</p>\n<blockquote>\n<p>Could you point out a radar run affected by this? I think I'm missing some context about when this happens.</p>\n</blockquote>\n<p>Sure! It happens when you either introduce declarations that violate a linter or modify/introduce linters in a way that introduces violations. Consider e.g. <a href=\"https://github.com/leanprover-community/mathlib4/pull/35095#issuecomment-3880172625\">this bench</a>.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"687698\">Chris Henson</span> <a href=\"#narrow/channel/348111-batteries/topic/runLinter.3A.20exit.201.20or.200.20when.20declarations.20fail.20linting.3F/near/573182781\">said</a>:</p>\n<blockquote>\n<p>My initial thought (that you've probably already considered) is that downstream breakage of CI needs to be considered/coordinated for this, otherwise anything that uses this as its lint driver will begin to silently allow failures.</p>\n</blockquote>\n<p>Yeah, true; maybe an opt-in flag to not exit 1 would be best?</p>",
        "id": 573183527,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1770773981
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/channel/348111-batteries/topic/runLinter.3A.20exit.201.20or.200.20when.20declarations.20fail.20linting.3F/near/573183008\">said</a>:</p>\n<blockquote>\n<p>I don't think radar should be benchmarking the linter at all if it fails</p>\n</blockquote>\n<p>The issue is that the whole run fails, so you don’t get information on the build either.</p>\n<p>Maybe that means radar should split these into two separate pieces of the bench somehow, so that the linter failing doesn’t make radar fail?</p>\n<p>(I do think the notion of “<code>runLinter</code> succeeded in reporting linting warnings, therefore exit 0” is probably a useful mode in principle, but yeah, maybe it’s not the right approach here after all…)</p>",
        "id": 573184063,
        "sender_full_name": "Thomas Murrills",
        "timestamp": 1770774294
    },
    {
        "content": "<p>I see. I agree with you that it would be nice to split these. Even for this very particular case though, I don't think a zero exit code would be great.</p>",
        "id": 573184888,
        "sender_full_name": "Chris Henson",
        "timestamp": 1770774782
    }
]