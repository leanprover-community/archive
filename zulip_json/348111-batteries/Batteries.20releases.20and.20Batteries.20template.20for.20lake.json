[
    {
        "content": "<p>I started a batteries only project and had a lot of build errors. Then I pinned the toolchain to v4.13.0-rc3 and found out that there was no rc3 for batteries</p>",
        "id": 476977429,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995244
    },
    {
        "content": "<p>How do I get batteries to build and (RFC) could we have a project template for batteries with nice defaults?</p>",
        "id": 476977588,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995287
    },
    {
        "content": "<p>Currently I am falling back to 4.12.0</p>",
        "id": 476977860,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995381
    },
    {
        "content": "<p>Batteries' main branch is on rc3, so you can use that</p>",
        "id": 476977883,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728995387
    },
    {
        "content": "<p>That was my first attempt. It failed</p>",
        "id": 476977923,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995400
    },
    {
        "content": "<p>Got masses of build errors</p>",
        "id": 476977978,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995405
    },
    {
        "content": "<p>How?</p>",
        "id": 476977983,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728995407
    },
    {
        "content": "<p>With what in your lean-toolchain?</p>",
        "id": 476978020,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728995421
    },
    {
        "content": "<p><code>leanprover/lean4:v4.13.0-rc3</code></p>",
        "id": 476978117,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995452
    },
    {
        "content": "<p>And what commit of batteries?</p>",
        "id": 476978285,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728995489
    },
    {
        "content": "<p>The lakefile.toml was:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"&lt;redacted&gt;\"</span>\n<span class=\"n\">defaultTargets</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s2\">\"&lt;redacted&gt;\"</span><span class=\"o\">]</span>\n\n<span class=\"o\">[[</span><span class=\"n\">require</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"batteries\"</span>\n<span class=\"n\">git</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"https://github.com/leanprover-community/batteries\"</span>\n<span class=\"n\">rev</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"main\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_lib</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"&lt;redacted&gt;\"</span>\n\n<span class=\"o\">[[</span><span class=\"n\">lean_exe</span><span class=\"o\">]]</span>\n<span class=\"n\">name</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"&lt;redacted&gt;\"</span>\n<span class=\"n\">root</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Main\"</span>\n</code></pre></div>",
        "id": 476978546,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995559
    },
    {
        "content": "<p>except those <code>&lt;redacted&gt;</code> bits of course</p>",
        "id": 476978598,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995577
    },
    {
        "content": "<p>Update : got it working  by clearing out lake-manifest and ./.lake and re-running everything again</p>",
        "id": 476979602,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995898
    },
    {
        "content": "<p>But it seems I can't pin Batteries to 4.13.0-rc3 because there is no tag</p>",
        "id": 476979661,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728995921
    },
    {
        "content": "<p>Probably just forgotten, cc <span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span></p>",
        "id": 476981849,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728996558
    },
    {
        "content": "<p>You can use a commit hash like <code>daf1ed9</code> instead of <code>main</code> in your <code>lakefile.toml</code></p>",
        "id": 476981985,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1728996600
    },
    {
        "content": "<p>Sounds good. In the long run, it would be nice if we could <code>lake add Batteries</code> and get the correct revision automatically added</p>",
        "id": 476982765,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1728996790
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"307953\">Ruben Van de Velde</span> <a href=\"#narrow/stream/348111-batteries/topic/Batteries.20releases.20and.20Batteries.20template.20for.20lake/near/476981985\">said</a>:</p>\n<blockquote>\n<p>You can use a commit hash like <code>daf1ed9</code> instead of <code>main</code> in your <code>lakefile.toml</code></p>\n</blockquote>\n<p>Isn't this what <code>lake-manifest.json</code> is for?</p>",
        "id": 476989849,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1728998793
    },
    {
        "content": "<p><code>lake-manifest.json</code> is for saying what the current version of the project is building with, the <code>rev =</code> in <code>lakefile.toml</code> is for saying what you want to happen when you next run <code>lake update</code>.</p>",
        "id": 477088329,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729034946
    },
    {
        "content": "<p>using a hash or tag there is opting out of automatic updates</p>",
        "id": 477088459,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1729035012
    },
    {
        "content": "<p>I've now pushed a <code>v4.13.0-rc3</code> tag. (Fran√ßois did the bump while I was on holiday.)</p>",
        "id": 477088780,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1729035216
    }
]