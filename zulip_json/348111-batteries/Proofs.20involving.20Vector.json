[
    {
        "content": "<p>Good day,<br>\nI'm a newcomer to Lean, so apologies in advance if I'm missing something obvious or cause any offense.<br>\nI've recently tried to use <code>Batteries.Vector</code> in my project, and found doing proofs with it extremely cumbersome. There's sore lack of basic theorems, like getElem_set, etc. I find myself writing unfolds of someone else's functions, which is probably not what I am supposed to be doing.<br>\nIs there a canonical way to do that? I feel that at least <code>getElem_toArray</code> would be very helpful.</p>",
        "id": 479564328,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730235543
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Batteries.Vector#doc\">docs#Batteries.Vector</a> is a recent addition. Furthermore, Batteries had a maintainer availability crisis until recently. I am not a Batteries maintainer, but I am sure that a PR adding those lemmas would be welcome <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 479564735,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1730235714
    },
    {
        "content": "<p>Right. I'll try to lemmafy my own code to remove unfold duplication, and whatever I end up with, I'll send upstream.<br>\nI wonder why mathlib's vector is a subtype of lists, not arrays; I guess it's better for induction.</p>",
        "id": 479565662,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730236088
    },
    {
        "content": "<p>Where?</p>",
        "id": 479565763,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730236136
    },
    {
        "content": "<p>Stdlib's vectors?</p>",
        "id": 479565779,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730236143
    },
    {
        "content": "<p>As far as I know, what you say is true for Mathlib's vectors</p>",
        "id": 479565831,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730236166
    },
    {
        "content": "<p>Right :D I mean, what are you even doing without mathlib</p>",
        "id": 479566395,
        "sender_full_name": "Alex Mobius",
        "timestamp": 1730236423
    },
    {
        "content": "<p>There is a planned Batteries PR for many of these gaps for Vector. It's waiting for some Lean core changes right now, which I believe will all be part of the next release at the end of this week.</p>",
        "id": 479571011,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730238639
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"119741\">@François G. Dorais</span> which changes are those? If you're waiting on something that is not yet merged, please let me know asap, as I have nothing further on my radar for the release cut.</p>",
        "id": 479571782,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730238993
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"767265\">@Alex Mobius</span>, I would suggest treating Mathlib's <code>Vector</code> as vestigial. (Indeed, if it's possible to replace uses of it with Batteries' <code>Vector</code>, I'd be happy to see that happen.)</p>",
        "id": 479571831,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730239015
    },
    {
        "content": "<p>Currently <code>Batteries.Vector</code> is a \"best effort\" API. I still have a lot of work to do on the <code>Array</code> API in the Lean repository over the next month, but once that nears completion I will turn my attention to <code>Vector</code>. The closer people can get it to the <code>Array</code> API, the better (i.e. the less work for me later. :-)</p>",
        "id": 479571943,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730239076
    },
    {
        "content": "<p>The changes I need are already in for the next release. I just haven't checked carefully yet. Will do soon! <del>It would help if there was a recent PR with a full toolchain for testing. (I use System 76 Pop! so elan doesn't allow me to grab the Ubuntu builds even though they probably would work just fine. I can also use Mac OS on my M2.)</del></p>",
        "id": 479572395,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730239303
    },
    {
        "content": "<p>Why does your Linux distro influence what downloads elan can make? I can just fetch all releases on my Fedora machine without troubles</p>",
        "id": 479572879,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1730239519
    },
    {
        "content": "<p><code>lake build</code> says <code>error: binary package was not provided for 'linux'</code> when I try to use the <code>pr-release-5705</code> toolchain.</p>",
        "id": 479573162,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730239650
    },
    {
        "content": "<p>so if you run</p>",
        "id": 479573396,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1730239757
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">λ</span><span class=\"w\"> </span><span class=\"n\">lean</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"n\">leanprover</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">-</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">releases</span><span class=\"o\">:</span><span class=\"n\">pr</span><span class=\"bp\">-</span><span class=\"n\">release</span><span class=\"bp\">-</span><span class=\"mi\">5705</span><span class=\"w\">  </span><span class=\"c1\">--help</span>\n</code></pre></div>\n<p>that doesn't work?</p>",
        "id": 479573406,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1730239761
    },
    {
        "content": "<p>Ha! That does work! Why?</p>",
        "id": 479573563,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730239835
    },
    {
        "content": "<p>what's in your lean-toolchain file for that directory?</p>",
        "id": 479573688,
        "sender_full_name": "Henrik Böving",
        "timestamp": 1730239903
    },
    {
        "content": "<p>Hahaha! Thanks! I was missing the 4... lol!</p>",
        "id": 479573835,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730239976
    },
    {
        "content": "<p>All good now! Thanks Henrik!</p>",
        "id": 479574265,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730240191
    },
    {
        "content": "<p>Btw, the Vector API is still incomplete</p>",
        "id": 479574810,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730240444
    },
    {
        "content": "<p>I have a PR to port the monadic defs as well, but it has been in limbo dating back a few months, when batteries' status was unclear</p>",
        "id": 479574851,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730240465
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"767265\">Alex Mobius</span> <a href=\"#narrow/channel/348111-batteries/topic/Proofs.20involving.20Vector/near/479566395\">said</a>:</p>\n<blockquote>\n<p>Right :D I mean, what are you even doing without mathlib</p>\n</blockquote>\n<p>Loads of <del>CS</del> programming stuff and a lot of CS-ish stuff</p>",
        "id": 479575059,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730240573
    },
    {
        "content": "<p>The PR is <a href=\"https://github.com/leanprover-community/batteries/pull/925\">batteries#925</a> feel free to take it up and finish it. I don't expect to be able to touch it until January.</p>",
        "id": 479575495,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730240783
    },
    {
        "content": "<p>There are only three <code>sorry</code>s to fix: in <code>modifyM</code>, <code>mapM</code>, and <code>mapIdxM</code>. Here's <a href=\"https://github.com/leanprover-community/batteries/pull/925/files#r1720862960\">one of them</a></p>",
        "id": 479575704,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730240894
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"767265\">@Alex Mobius</span> : There is a <code>getElem</code> instance for <code>Batteries.Vector</code>. For the theorems you should be able to piggy-back off the corresponding array theorems for the moment</p>",
        "id": 479575999,
        "sender_full_name": "Shreyas Srinivas",
        "timestamp": 1730241036
    },
    {
        "content": "<p>Oof, I just ran into the gaps in <code>Vector</code> this morning, it was pretty painful, nigh unusable. I've created <a href=\"https://github.com/leanprover-community/batteries/pull/1018\">batteries#1018</a> as a start, but there is a long way to go here.</p>",
        "id": 479581594,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730244348
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110087\">@Kim Morrison</span> I agree! Can this wait until I get my vector PR ready? I'll make sure it includes what you need. Now that Henrik figured out my silly typo <span aria-label=\"man facepalming\" class=\"emoji emoji-1f926-200d-2642\" role=\"img\" title=\"man facepalming\">:man_facepalming:</span> , I can get that PR up before the upcoming Lean update.</p>",
        "id": 479582319,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730244862
    },
    {
        "content": "<p>It is actually easier to just merge <a href=\"https://github.com/leanprover-community/batteries/pull/1018\">batteries#1018</a> and wait for the next lean update before the bigger vector update.</p>",
        "id": 479985909,
        "sender_full_name": "François G. Dorais",
        "timestamp": 1730427924
    },
    {
        "content": "<p>Yes, nothing should ever wait unnecessarily. :-)</p>",
        "id": 479989907,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1730431606
    }
]