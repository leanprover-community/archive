[
    {
        "content": "<p>If I understand correctly, <a href=\"https://leanprover-community.github.io/mathlib4_docs/Batteries/Util/Cache.html#Batteries.Tactic.DeclCache.mk\"><code>DeclCache.mk</code></a> <a href=\"https://github.com/leanprover-community/batteries/blob/9c1ad6d93126e346c859d4a17d71b010e7951f92/Batteries/Util/Cache.lean#L115-L118\">builds a cache</a> of all the available <code>getEnv.constants</code>.</p>\n<p><code>constants</code> is a map from names to <a href=\"https://leanprover-community.github.io/mathlib4_docs/Lean/Declaration.html#Lean.ConstantInfo\"><code>Lean.ConstantInfo</code></a>, and some constants are definitions (<code>ConstantInfo.defnInfo</code> variant).</p>\n<p>These constants are definitions that have corresponding lazily autogenerated equations, that can be generated by calling <a href=\"https://github.com/leanprover/lean4/blob/14ff08db6f651775ead432d367b6b083878bb0f9/src/Lean/Elab/PreDefinition/Eqns.lean#L380-L394\"><code>getEqnsFor?</code></a> on the constant's name, <a href=\"https://github.com/leanprover/doc-gen4/blob/31cc380418e01263dad34aff8c7ae7980c14f427/DocGen4/Process/DefinitionInfo.lean#L32-L39\">like docgen does</a>.</p>\n<p>I propose forcing all equations to generate and adding them to the cache by calling <code>getEqnsFor?</code> in <code>DeclCache.mk</code>. The motivation is seeing all equations on Loogle. Are there other users of <code>DeclCache</code> which this change might break? Maybe adding <code>(addEqnDecl : Name → ConstantInfo → α → MetaM α)</code> parameter to <code>DeclCache.mk</code> is a good solution, and default that parameter to a no-op.</p>\n<p>Thoughts?</p>",
        "id": 544443603,
        "sender_full_name": "Snir Broshi",
        "timestamp": 1760320776
    }
]