[
    {
        "content": "<p>When I add a new test file to, say, <code>tests/lean/run/foo.lean</code>, what do I have to do to make <code>ctest</code> pick it up? All tests seem to be put into <code>build/release/stage1/shell/CTestTestfile.cmake</code> at some stage. Is there something better than <code>rm-rf build</code> to generate that file?</p>",
        "id": 400160222,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1699026547
    },
    {
        "content": "<p><code>make test</code> should rerun cmake automatically I think</p>",
        "id": 400164038,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1699027712
    },
    {
        "content": "<p>Hmm, I thought I even ran <code>cmake ../..</code> manually and it didn’t help. But somehow the test has appeared now. Odd. <br>\nBut thanks, I’m unblocked until I can complain better.</p>",
        "id": 400164169,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1699027759
    },
    {
        "content": "<p>I don't think that reconfigures the CMake project in stage1/</p>",
        "id": 400164327,
        "sender_full_name": "Sebastian Ullrich",
        "timestamp": 1699027818
    },
    {
        "content": "<p>Classical case of “I thought I tried that”, but even running <code>make </code>in <code>stage1</code> suffices:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"bp\">~/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span> <span class=\"bp\">$</span> <span class=\"n\">cp</span> <span class=\"n\">tests</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">run</span><span class=\"bp\">/</span><span class=\"mi\">2810</span><span class=\"bp\">.</span><span class=\"n\">lean</span> <span class=\"n\">tests</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">run</span><span class=\"bp\">/</span><span class=\"mi\">2810</span><span class=\"bp\">-</span><span class=\"n\">copy.lean</span>\n<span class=\"bp\">~/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span> <span class=\"bp\">$</span> <span class=\"n\">ctest</span> <span class=\"c1\">--test-dir ~/build/lean/lean4/build/release/stage1 -R 2810-copy</span>\n<span class=\"n\">Internal</span> <span class=\"n\">ctest</span> <span class=\"n\">changing</span> <span class=\"n\">into</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span>\n<span class=\"n\">Test</span> <span class=\"n\">project</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span>\n<span class=\"n\">No</span> <span class=\"n\">tests</span> <span class=\"n\">were</span> <span class=\"n\">found</span><span class=\"bp\">!!!</span>\n<span class=\"bp\">~/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span> <span class=\"bp\">$</span> <span class=\"n\">make</span> <span class=\"bp\">-</span><span class=\"n\">C</span> <span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span> <span class=\"bp\">-</span><span class=\"n\">j8</span>\n<span class=\"bp\">…</span>\n<span class=\"o\">[</span><span class=\"mi\">100</span><span class=\"bp\">%</span><span class=\"o\">]</span> <span class=\"n\">Built</span> <span class=\"n\">target</span> <span class=\"n\">lean</span>\n<span class=\"n\">make</span><span class=\"o\">:</span> <span class=\"n\">Verzeichnis</span> <span class=\"bp\">„/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span><span class=\"bp\">“</span> <span class=\"n\">wird</span> <span class=\"n\">verlassen</span>\n<span class=\"bp\">~/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span> <span class=\"bp\">$</span> <span class=\"n\">ctest</span> <span class=\"c1\">--test-dir ~/build/lean/lean4/build/release/stage1 -R 2810-copy</span>\n<span class=\"n\">Internal</span> <span class=\"n\">ctest</span> <span class=\"n\">changing</span> <span class=\"n\">into</span> <span class=\"n\">directory</span><span class=\"o\">:</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span>\n<span class=\"n\">Test</span> <span class=\"n\">project</span> <span class=\"bp\">/</span><span class=\"n\">home</span><span class=\"bp\">/</span><span class=\"n\">jojo</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">lean</span><span class=\"bp\">/</span><span class=\"n\">lean4</span><span class=\"bp\">/</span><span class=\"n\">build</span><span class=\"bp\">/</span><span class=\"n\">release</span><span class=\"bp\">/</span><span class=\"n\">stage1</span>\n    <span class=\"n\">Start</span> <span class=\"mi\">738</span><span class=\"o\">:</span> <span class=\"n\">leanruntest_2810</span><span class=\"bp\">-</span><span class=\"n\">copy.lean</span>\n<span class=\"mi\">1</span><span class=\"bp\">/</span><span class=\"mi\">1</span> <span class=\"n\">Test</span> <span class=\"bp\">#</span><span class=\"mi\">738</span><span class=\"o\">:</span> <span class=\"n\">leanruntest_2810</span><span class=\"bp\">-</span><span class=\"n\">copy.lean</span> <span class=\"bp\">.......</span>   <span class=\"n\">Passed</span>    <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">11</span> <span class=\"n\">sec</span>\n\n<span class=\"mi\">100</span><span class=\"bp\">%</span> <span class=\"n\">tests</span> <span class=\"n\">passed</span><span class=\"o\">,</span> <span class=\"mi\">0</span> <span class=\"n\">tests</span> <span class=\"n\">failed</span> <span class=\"n\">out</span> <span class=\"n\">of</span> <span class=\"mi\">1</span>\n\n<span class=\"n\">Total</span> <span class=\"n\">Test</span> <span class=\"n\">time</span> <span class=\"o\">(</span><span class=\"n\">real</span><span class=\"o\">)</span> <span class=\"bp\">=</span>   <span class=\"mi\">0</span><span class=\"bp\">.</span><span class=\"mi\">14</span> <span class=\"n\">sec</span>\n</code></pre></div>",
        "id": 400167583,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1699028855
    },
    {
        "content": "<p>Left a short note at the documentation: <a href=\"https://github.com/leanprover/lean4/pull/2815\">https://github.com/leanprover/lean4/pull/2815</a> <br>\n(Are those super-trivial PRs welcome?)</p>",
        "id": 400168203,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1699029071
    }
]