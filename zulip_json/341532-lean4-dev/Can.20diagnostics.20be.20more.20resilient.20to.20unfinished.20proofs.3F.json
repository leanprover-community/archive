[
    {
        "content": "<p>I've basically trained myself to write code like this now:</p>\n<p><a href=\"/user_uploads/3121/Kd56i_ji37GQBhH3j_D7Jct0/Screenshot-2025-07-12-at-19.53.25.png\">Screenshot 2025-07-12 at 19.53.25.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Kd56i_ji37GQBhH3j_D7Jct0/Screenshot-2025-07-12-at-19.53.25.png\" title=\"Screenshot 2025-07-12 at 19.53.25.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1580x796\" src=\"/user_uploads/thumbnail/3121/Kd56i_ji37GQBhH3j_D7Jct0/Screenshot-2025-07-12-at-19.53.25.png/840x560.webp\"></a></div><p>(Note a bunch of <code>sorry</code>s I put <strong>before</strong> starting to type in the middle.)</p>\n<p>Otherwise I'm flooded with diagnostics:</p>\n<p><a href=\"/user_uploads/3121/QK3iaJoY41sawTrrrPCwCPWm/Screenshot-2025-07-12-at-19.53.17.png\">Screenshot 2025-07-12 at 19.53.17.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/QK3iaJoY41sawTrrrPCwCPWm/Screenshot-2025-07-12-at-19.53.17.png\" title=\"Screenshot 2025-07-12 at 19.53.17.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1606x778\" src=\"/user_uploads/thumbnail/3121/QK3iaJoY41sawTrrrPCwCPWm/Screenshot-2025-07-12-at-19.53.17.png/840x560.webp\"></a></div><p>I wonder if there's any way to reduce the noise here?</p>\n<p>I think I understand the reasoning (we want to make it clear which goals are unclosed) but somehow it still feels very distracting. If the diagnostics can't be more resilient to typing an unfinished proof, maybe <code>sorry</code>s could automatically inserted when you indent, or something?</p>\n<p>What is the ideal user experience here?</p>",
        "id": 528478276,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752347017
    },
    {
        "content": "<p>Is there a downside to only reporting the diagnostic for the innermost unsolved proof(s)?</p>",
        "id": 528478368,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752347137
    },
    {
        "content": "<p>FWIW I have also trained myself to write code like that now (and I did this many years ago)</p>",
        "id": 528482980,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1752352179
    },
    {
        "content": "<p>Another example of a similar issue.</p>\n<p>I have to do this:</p>\n<p><a href=\"/user_uploads/3121/15SCkMb-L7ZaT_OegvDSnP0y/Screenshot-2025-07-13-at-00.27.28.png\">Screenshot 2025-07-13 at 00.27.28.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/15SCkMb-L7ZaT_OegvDSnP0y/Screenshot-2025-07-13-at-00.27.28.png\" title=\"Screenshot 2025-07-13 at 00.27.28.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1652x818\" src=\"/user_uploads/thumbnail/3121/15SCkMb-L7ZaT_OegvDSnP0y/Screenshot-2025-07-13-at-00.27.28.png/840x560.webp\"></a></div><p>Otherwise the parser just chokes:</p>\n<p><a href=\"/user_uploads/3121/Ed8MT2kkmlXq2WoZrx6YGIbh/Screenshot-2025-07-13-at-00.27.36.png\">Screenshot 2025-07-13 at 00.27.36.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/Ed8MT2kkmlXq2WoZrx6YGIbh/Screenshot-2025-07-13-at-00.27.36.png\" title=\"Screenshot 2025-07-13 at 00.27.36.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1676x710\" src=\"/user_uploads/thumbnail/3121/Ed8MT2kkmlXq2WoZrx6YGIbh/Screenshot-2025-07-13-at-00.27.36.png/840x560.webp\"></a></div><p>Can the parser be modified to understand that I'm probably going to type at the indentation?</p>",
        "id": 528490057,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752362908
    },
    {
        "content": "<p>I guess maybe my feature request is to treat</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ...</span>\n</code></pre></div>\n<p>analogous to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">constructor</span>\n<span class=\"w\">  </span><span class=\"bp\">¬∑</span><span class=\"w\"> </span><span class=\"o\">{}</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ...</span>\n</code></pre></div>\n<p>and</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n\n<span class=\"w\">  </span><span class=\"c1\">-- ...</span>\n</code></pre></div>\n<p>analogous to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Function</span><span class=\"bp\">.</span><span class=\"n\">invFun</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"o\">{}</span>\n<span class=\"w\">  </span><span class=\"c1\">-- ...</span>\n</code></pre></div>\n<p>So, assume there's an implicit empty block there.</p>",
        "id": 528490354,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752363393
    },
    {
        "content": "<p>That would be <a href=\"https://github.com/leanprover/lean4/issues/3555\">https://github.com/leanprover/lean4/issues/3555</a>, I think</p>",
        "id": 528783958,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1752558826
    },
    {
        "content": "<p>Related, this is just as annoying with <code>fun</code>:</p>\n<p><a href=\"/user_uploads/3121/_MIaUCmMW4FfzrM9hZT-mNn-/Screenshot-2025-07-16-at-18.42.06.png\">Screenshot 2025-07-16 at 18.42.06.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/_MIaUCmMW4FfzrM9hZT-mNn-/Screenshot-2025-07-16-at-18.42.06.png\" title=\"Screenshot 2025-07-16 at 18.42.06.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1894x496\" src=\"/user_uploads/thumbnail/3121/_MIaUCmMW4FfzrM9hZT-mNn-/Screenshot-2025-07-16-at-18.42.06.png/840x560.webp\"></a></div><p>I can't see any context because the parser dies.</p>",
        "id": 529108553,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752687846
    },
    {
        "content": "<p>But if you add the <code>,</code> will it come back to life?</p>",
        "id": 529209710,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1752733330
    },
    {
        "content": "<p>Nope</p>\n<p><a href=\"/user_uploads/3121/jn_flofzhU20HCEcVC5QikNG/Screenshot-2025-07-17-at-14.18.34.png\">Screenshot 2025-07-17 at 14.18.34.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/jn_flofzhU20HCEcVC5QikNG/Screenshot-2025-07-17-at-14.18.34.png\" title=\"Screenshot 2025-07-17 at 14.18.34.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1304x366\" src=\"/user_uploads/thumbnail/3121/jn_flofzhU20HCEcVC5QikNG/Screenshot-2025-07-17-at-14.18.34.png/840x560.webp\"></a></div>",
        "id": 529277619,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752758325
    },
    {
        "content": "<p>In general non-tactic mode feels like second class citizen, e.g. <code>let</code> bindings don't display in InfoView</p>\n<p><a href=\"/user_uploads/3121/7Nj1wZ_tjzKj7vVjTm-s9PqQ/Screenshot-2025-07-17-at-14.33.06.png\">Screenshot 2025-07-17 at 14.33.06.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/7Nj1wZ_tjzKj7vVjTm-s9PqQ/Screenshot-2025-07-17-at-14.33.06.png\" title=\"Screenshot 2025-07-17 at 14.33.06.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1320x398\" src=\"/user_uploads/thumbnail/3121/7Nj1wZ_tjzKj7vVjTm-s9PqQ/Screenshot-2025-07-17-at-14.33.06.png/840x560.webp\"></a></div>",
        "id": 529280421,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752759205
    },
    {
        "content": "<p>I find that underscores <code>_</code> \"capture\" more: does <code>, _</code> get you in a better state?</p>",
        "id": 529280436,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752759210
    },
    {
        "content": "<p>Do you get the <code>let</code> if you move the cursor further away?</p>",
        "id": 529280544,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752759242
    },
    {
        "content": "<p>I have noticed that in some situations, something does not show up in the infoview at a position where it should, but it does show if I move to the next \"relevant\" position.</p>",
        "id": 529280669,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752759275
    },
    {
        "content": "<p>Ah yeah you're right. It shows up at the beginning of the next non-empty line.</p>\n<p>And yes <code>_</code> does help for parsing.</p>",
        "id": 529280971,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752759340
    },
    {
        "content": "<p>I do not know why sometimes the infoview does not show something that it should, but I have noticed it quite often.</p>",
        "id": 529281148,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1752759402
    },
    {
        "content": "<p>Actually <code>_</code> or <code>sorry</code> at the end is not even a good workaround because the last expression may consume it.</p>\n<p><a href=\"/user_uploads/3121/S9a6Df0nIlXsVp0hr-5JUE9c/Screenshot-2025-07-17-at-21.03.30.png\">Screenshot 2025-07-17 at 21.03.30.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/S9a6Df0nIlXsVp0hr-5JUE9c/Screenshot-2025-07-17-at-21.03.30.png\" title=\"Screenshot 2025-07-17 at 21.03.30.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1400x278\" src=\"/user_uploads/thumbnail/3121/S9a6Df0nIlXsVp0hr-5JUE9c/Screenshot-2025-07-17-at-21.03.30.png/840x560.webp\"></a></div><p><a href=\"/user_uploads/3121/T0_LzsY2-UwgI5FxkgT9mKlu/Screenshot-2025-07-17-at-21.03.38.png\">Screenshot 2025-07-17 at 21.03.38.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/T0_LzsY2-UwgI5FxkgT9mKlu/Screenshot-2025-07-17-at-21.03.38.png\" title=\"Screenshot 2025-07-17 at 21.03.38.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1284x296\" src=\"/user_uploads/thumbnail/3121/T0_LzsY2-UwgI5FxkgT9mKlu/Screenshot-2025-07-17-at-21.03.38.png/840x560.webp\"></a></div><p>So this is just.. kinda borked.</p>",
        "id": 529348027,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752782633
    },
    {
        "content": "<p>Is it just that the span is too long? Python does the same, but the squigglies are mostly limited to a single word or character:<br>\n<a href=\"/user_uploads/3121/vUa1x4ExgZDpozD_GOt_sQYh/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/vUa1x4ExgZDpozD_GOt_sQYh/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"376x149\" src=\"/user_uploads/thumbnail/3121/vUa1x4ExgZDpozD_GOt_sQYh/image.png/840x560.webp\"></a></div>",
        "id": 529538916,
        "sender_full_name": "Dax Fohl",
        "timestamp": 1752883529
    },
    {
        "content": "<p>My main problem is the InfoView being effectively broken.</p>\n<p>In Python, there's nothing like the InfoView to guide you writing code, whereas in Lean it's pretty essential to see the current proof state to know what to write next. So parser errors during the general writing flow (at least after every line) are IMO unacceptable if they break the InfoView.</p>",
        "id": 529584184,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752939692
    },
    {
        "content": "<p>To be fair, InfoView doesn't get borked <em>as</em> much anymore, i.e. during a theorem it still works (despite the diagnostics being overly noisy).</p>\n<p>But in the last case I showed (inside a function definition), it does actually break completely.</p>",
        "id": 529584640,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752940217
    },
    {
        "content": "<blockquote>\n<p>Is it just that the span is too long?</p>\n</blockquote>\n<p>It's not just that. It's that it misdiagnoses the problem and highlights valid lines.</p>\n<p>This is misleading ‚Äî the next line is fine:</p>\n<p><a href=\"/user_uploads/3121/t7kc9ZanIm6eKMmXKFwmrwIL/Screenshot-2025-07-19-at-16.56.57.png\">Screenshot 2025-07-19 at 16.56.57.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/t7kc9ZanIm6eKMmXKFwmrwIL/Screenshot-2025-07-19-at-16.56.57.png\" title=\"Screenshot 2025-07-19 at 16.56.57.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1232x526\" src=\"/user_uploads/thumbnail/3121/t7kc9ZanIm6eKMmXKFwmrwIL/Screenshot-2025-07-19-at-16.56.57.png/840x560.webp\"></a></div><p>The next line shouldn't lose syntax highlight because of this.<br>\nInstead it should behave like this:</p>\n<p><a href=\"/user_uploads/3121/NoeurUj7U-1cjRP6vQkgqcSI/Screenshot-2025-07-19-at-17.00.50.png\">Screenshot 2025-07-19 at 17.00.50.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/NoeurUj7U-1cjRP6vQkgqcSI/Screenshot-2025-07-19-at-17.00.50.png\" title=\"Screenshot 2025-07-19 at 17.00.50.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1064x484\" src=\"/user_uploads/thumbnail/3121/NoeurUj7U-1cjRP6vQkgqcSI/Screenshot-2025-07-19-at-17.00.50.png/840x560.webp\"></a></div><p>Similarly, I find this to be very misleading:</p>\n<p><a href=\"/user_uploads/3121/wS876IBHtmRZ0tgFfuJU0v0I/Screenshot-2025-07-19-at-17.01.27.png\">Screenshot 2025-07-19 at 17.01.27.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/wS876IBHtmRZ0tgFfuJU0v0I/Screenshot-2025-07-19-at-17.01.27.png\" title=\"Screenshot 2025-07-19 at 17.01.27.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1196x606\" src=\"/user_uploads/thumbnail/3121/wS876IBHtmRZ0tgFfuJU0v0I/Screenshot-2025-07-19-at-17.01.27.png/840x560.webp\"></a></div><p>There's no problem with the <code>rintro</code> line! The problem is the proof is unfinished. Again, I think it should behave like this instead:</p>\n<p><a href=\"/user_uploads/3121/L4k3wzAD-WQQwOXEOqsyYWKR/Screenshot-2025-07-19-at-17.02.09.png\">Screenshot 2025-07-19 at 17.02.09.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/L4k3wzAD-WQQwOXEOqsyYWKR/Screenshot-2025-07-19-at-17.02.09.png\" title=\"Screenshot 2025-07-19 at 17.02.09.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"980x578\" src=\"/user_uploads/thumbnail/3121/L4k3wzAD-WQQwOXEOqsyYWKR/Screenshot-2025-07-19-at-17.02.09.png/840x560.webp\"></a></div><p>Show me unfinished goals at the place where it's <em>actionable</em>. Unsolved goals are actionable <em>when you've stopped trying to prove them</em>, not where they're declared.</p>",
        "id": 529585698,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941011
    },
    {
        "content": "<p>One litmus test is ‚Äî when you see a squiggle, does the squiggle highlight the place that is broken and needs to be edited.  If it doesn't (and in the vast majority of Lean diagnostics today, it doesn't) ‚Äî the squiggle needs to be moved to the place that actually needs to be fixed.</p>",
        "id": 529586071,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941089
    },
    {
        "content": "<p>Sometimes there's ambiguity there (e.g. \"is the goal wrong or is the proof incomplete\"), just like with types, so I understand it may be more delicate than I'm describing. But as a user, I am certainly feeling that I can't trust the squiggles in Lean the same way I trust them in TypeScript etc. It's just always highlighting the wrong place for the fix and it's very annoying.</p>",
        "id": 529586543,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941174
    },
    {
        "content": "<p>The empty cdot problem is issue <a href=\"https://github.com/leanprover/lean4/pull/3555\">lean4#3555</a>, and there's also <a href=\"https://github.com/leanprover/lean4/pull/4181\">lean4#4181</a></p>",
        "id": 529587606,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752941317
    },
    {
        "content": "<p>I'm not sure I understand what <a class=\"message-link\" href=\"/#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529348027\">#lean4 dev &gt; Can diagnostics be more resilient to unfinished proofs? @ üí¨</a> is demonstrating. What does putting <code>sorry</code> after a term meant to do? That's passing <code>sorry</code> as an extra argument to the previous term</p>",
        "id": 529588022,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752941372
    },
    {
        "content": "<p>Right, I'm just trying to do anything to fix the parsing error so that the InfoView starts working again. I agree it doesn't make sense to put <code>sorry</code> there but I'm not sure how else to unbreak the InfoView.</p>",
        "id": 529588832,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941479
    },
    {
        "content": "<p>Basically I need InfoView to work at all times while I'm writing a new line of code. It can't disappear because I rely on it in writing.</p>",
        "id": 529589038,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941506
    },
    {
        "content": "<p>What was broken with the infoview in that case? That's what I'm missing. Without the <code>sorry</code> it looks like it's parsing correctly.</p>",
        "id": 529589092,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752941512
    },
    {
        "content": "<p>I start typing. The quantifier breaks the InfoView:</p>\n<p><a href=\"/user_uploads/3121/mdwS59Gi17dwO4CBEW4bAoVZ/Screenshot-2025-07-19-at-17.12.39.png\">Screenshot 2025-07-19 at 17.12.39.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/mdwS59Gi17dwO4CBEW4bAoVZ/Screenshot-2025-07-19-at-17.12.39.png\" title=\"Screenshot 2025-07-19 at 17.12.39.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1724x420\" src=\"/user_uploads/thumbnail/3121/mdwS59Gi17dwO4CBEW4bAoVZ/Screenshot-2025-07-19-at-17.12.39.png/840x560.webp\"></a></div><p>I want to fix it so I know what to type. So I add a <code>sorry</code> to kick the parser:</p>\n<p><a href=\"/user_uploads/3121/3rCzdTEycQAoZNFanwhe15IC/Screenshot-2025-07-19-at-17.14.16.png\">Screenshot 2025-07-19 at 17.14.16.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/3rCzdTEycQAoZNFanwhe15IC/Screenshot-2025-07-19-at-17.14.16.png\" title=\"Screenshot 2025-07-19 at 17.14.16.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1712x646\" src=\"/user_uploads/thumbnail/3121/3rCzdTEycQAoZNFanwhe15IC/Screenshot-2025-07-19-at-17.14.16.png/840x560.webp\"></a></div><p>Then I forget about that <code>sorry</code> and keep typing. So now I have an extra <code>sorry</code>.</p>\n<p>Of course I can remove that <code>sorry</code> now... </p>\n<p>Except now InfoView breaks again:</p>\n<p><a href=\"/user_uploads/3121/7kmg0qKm26dt389wFNBUiJwJ/Screenshot-2025-07-19-at-17.14.54.png\">Screenshot 2025-07-19 at 17.14.54.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/7kmg0qKm26dt389wFNBUiJwJ/Screenshot-2025-07-19-at-17.14.54.png\" title=\"Screenshot 2025-07-19 at 17.14.54.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1760x488\" src=\"/user_uploads/thumbnail/3121/7kmg0qKm26dt389wFNBUiJwJ/Screenshot-2025-07-19-at-17.14.54.png/840x560.webp\"></a></div><p>So I add the <code>sorry</code> back and later I'll again forget to remove it. Et cetera.</p>",
        "id": 529590316,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941721
    },
    {
        "content": "<p>I think the design constraint here should be something like \"the InfoView is never allowed to disappear if the parsing error is local to a single line and wouldn't break the entire document\". You need to be able to trust that this thing sticks around.</p>",
        "id": 529590390,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941793
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529585698\">said</a>:</p>\n<blockquote>\n<p>There's no problem with the <code>rintro</code> line!</p>\n</blockquote>\n<p>Yeah, this error position is quite annoying. A little background here: the entire focus dot proof has an error associated to it, but there's a heuristic that the error range is restricted to just the first line. It looks like it's complaining about <code>rintro</code>, but that's just because it's part of the first line. It used to highlight the entire subproof, which wasn't very usable.</p>\n<p>Maybe part of <a href=\"https://github.com/leanprover/lean4/pull/3555\">lean4#3555</a> is to have a parser at the end of a tactic sequence that's just looking for a blank line with enough space to make it to the expected column.</p>\n<p>I wonder though: if that blank line isn't there, the natural place for the \"unsolved goals\" error is back at the focus dot. Would it be confusing if the error jumps from the focus dot to the end of the subproof by virtue of hitting enter then tab?</p>",
        "id": 529590398,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752941799
    },
    {
        "content": "<p>Is there a downside to placing it at the last line of the (incomplete) proof instead? Basically, put the squiggle at the place that, when I focus on it, has an \"abandoned\" goal that's pending more work.</p>",
        "id": 529590532,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752941927
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529590390\">said</a>:</p>\n<blockquote>\n<p>You need to be able to trust that this thing sticks around.</p>\n</blockquote>\n<p>I don't think you should feel like you need to put much energy into convincing anyone that this should be the goal! We definitely want that to be the case. (Did you look at <a href=\"https://github.com/leanprover/lean4/pull/4181\">lean4#4181</a> yet? That's the issue recording this. Feel free to weigh in there.)</p>",
        "id": 529590555,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752941946
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529590532\">said</a>:</p>\n<blockquote>\n<p>Is there a downside to placing it at the last line of the (incomplete) proof instead?</p>\n</blockquote>\n<p>Do you mean that it should blame the last tactic for not completing the subproof?</p>",
        "id": 529590610,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942000
    },
    {
        "content": "<p>Yup yup, I think it has actually drastically improved since the last time I complained about it! It's much better in tactic mode, but in the term mode it's still flaky.</p>",
        "id": 529590612,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752942001
    },
    {
        "content": "<blockquote>\n<p>Do you mean that it should blame the last tactic for not completing the subproof?</p>\n</blockquote>\n<p>That would be my intuition, yeah.</p>",
        "id": 529590631,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752942015
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529590612\">said</a>:</p>\n<blockquote>\n<p>Yup yup, I think it has actually drastically improved since the last time I complained about it! It's much better in tactic mode, but in the term mode it's still flaky.</p>\n</blockquote>\n<p>I don't remember there being any changes, so unfortunately it might be that you're getting used to it <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span></p>",
        "id": 529590656,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942040
    },
    {
        "content": "<blockquote>\n<p>I don't remember there being any changes, so unfortunately it might be that you're getting used to it¬†</p>\n</blockquote>\n<p>Actually you might be right... I realize that I now just type <code>rintro \\&lt;a, b, c\\&gt;</code> without looking and then drill down into <code>a</code>, <code>b</code>, and <code>c</code> separately, etc.</p>",
        "id": 529590757,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752942140
    },
    {
        "content": "<p>Re parsing errors: the parsing error recovery isn't particularly robust; e.g. it doesn't try very hard to re-sync. There's some limited support where missing terms can be skipped and parsing continues.</p>\n<p>What's really hit-or-miss is that the elaborators aren't all very error-tolerant. The <code>let</code> elaborator can handle a missing body, but the <code>Exists</code> elaborator can't. That means in the first case you get an infoview, but in the second case you don't.</p>",
        "id": 529590807,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942197
    },
    {
        "content": "<p>(I might be wrong about <code>Exists</code>, I'd have to check actually. It's just that many elaborators are defined as macros, and the syntax matches tend to require complete-ish syntax. The <code>let</code> elaborator I know for sure doesn't use syntax matches, instead indexing into the syntax objects directly to get different components.)</p>",
        "id": 529590906,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942300
    },
    {
        "content": "<p>Another option is to make InfoView slightly \"stateful\" so it remembers the last successful state (and displays pending errors). But as you surely know, this can also lead to highly unintuitive and frustrating experiences.</p>",
        "id": 529590934,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752942328
    },
    {
        "content": "<p>Maybe you're right about having tactic sequences blame the last tactic in a sequence for not finishing a proof. That would be a good first approximation, and the cherry on top could be to blame the whitespace right after that line if there's a blank line with enough spaces.</p>\n<p>There's also the project to go through the parsers and elaborators systematically and make them more tolerant to errors, and to be able to resynchronize in some intelligent way. The main resynchronization is the top-level command parser, which on failure starts consuming tokens until a command parses again.</p>",
        "id": 529591179,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942572
    },
    {
        "content": "<p>I wonder if there's anything that can be done at a higher level that doesn't require all pieces to \"be smart\", especially when so much syntax is user-programmable.</p>\n<p>E.g. I wonder if InfoView could show the state for the program \"excluding\" the broken block if some block is broken, or something like that. Usually that's good enough and better than nothing?</p>",
        "id": 529591297,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752942701
    },
    {
        "content": "<p>Something that Python does that Lean doesn't is that Python has two parsers: one for the happy path, and another to go through again and try to diagnose parsing errors.  Sometimes I wonder what we might be able to do if we had such a system. Right now we do add some incorrect parses here and there into the grammar so that something smarter can happen at elaboration time. One example that comes to mind is trailing dots in identifiers (<code>a.b.</code>) which then is used to trigger completions.</p>",
        "id": 529591305,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752942712
    },
    {
        "content": "<p>Some internals for you: during elaboration, each bit of syntax can be annotated with some ElabInfo, including one kind of ElabInfo called TermInfo. The TermInfo is thus already nested, or even overlapping. The LSP has heuristics to decide which TermInfo to use at a particular cursor point to then create the \"Expected Type\" view, with the local context and the expected type at that point.</p>\n<p>Tactics create TacticInfo, which records the before/after goal lists rather than an expected type, but it's similar. (E.g. the entire focus dot syntax, including all the contained tactics, gets a TacticInfo covering the entire block, as do each of the individual contained tactics.)</p>\n<p>With your idea about excluding TermInfo for broken syntax, I worry that this would easily go up too far, and not show you the closer of the TermInfo that you want to see. Think about <code>let</code> with a missing body: it's broken, but you've said you want to be sure you see the scope for the body of the <code>let</code>.</p>",
        "id": 529591593,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752943051
    },
    {
        "content": "<blockquote>\n<p>Something that Python does that Lean doesn't is that Python has two parsers: one for the happy path, and another to go through again and try to diagnose parsing errors</p>\n</blockquote>\n<p>This sounds like maybe similar to what C# (Roslyn) is <a href=\"https://github.com/dotnet/roslyn/issues/24642#issuecomment-363296578\">doing</a>? I don't have any domain knowledge there so don't know what SOTA is and how far Lean is from it, but my impression is that both C# and TypeScript are pretty good at parser error recovery these days.</p>",
        "id": 529591876,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752943434
    },
    {
        "content": "<p>Part of the deal is that Lean's grammar is extensible, using a parser combinator approach rather than a hand-written recursive-descent parser, and it also doesn't use a parser generator (here's <a href=\"https://github.com/python/cpython/blob/3.14/Grammar/python.gram\">Python's grammar</a>, and <a href=\"https://docs.python.org/3/reference/grammar.html\">an explanation</a> in the reference). Python uses a PEG grammar, and you can see there are a whole lot of \"<code>invalid</code>\" rules.</p>\n<p>That said, it's plausible for there to be a metaprogram that generates an error recovery version of each parser (there could be annotations for alternatives that are specifically for error recovery that are stripped out for the main parser). It seems tricky though, since you need to make sure that the error recovery parser still parses correct programs correctly, but a benefit is that you can match on common mistakes and explain the issue in the error message, and also decide to commit to certain parses that you might not want to commit to normally, for sake of error recovery.</p>",
        "id": 529593031,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752944796
    },
    {
        "content": "<blockquote>\n<p>Maybe you're right about having tactic sequences blame the last tactic in a sequence for not finishing a proof. That would be a good first approximation, and the cherry on top could be to blame the whitespace right after that line if there's a blank line with enough spaces.</p>\n</blockquote>\n<p>How much work would it be to prototype this?</p>",
        "id": 529598152,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1752945871
    },
    {
        "content": "<p>For a prototype that affects just cdot blocks, you'd need to modify <code>Lean.Elab.Tactic.evalTacticCDot</code> to instead of using <code>withCaseRef</code>, use <code>withRef</code> and the last tactic in the sequence, I believe.</p>",
        "id": 529601590,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1752946401
    },
    {
        "content": "<p>I was playing with the parser last week. It does seem to do two passes, as any traces I add will get hit twice (usually). I think that's managed by <code>leadingParser</code> and <code>trailingLoop</code> <a href=\"https://github.com/leanprover/lean4/blob/3aaa3beeee32834d3aa22cdc63581e6292b0b568/src/Lean/Parser/Basic.lean#L1924\">here</a>. Though I am still trying to figure it all out, and not sure if that's what you mean above by two passes.</p>",
        "id": 529628859,
        "sender_full_name": "Dax Fohl",
        "timestamp": 1752984976
    },
    {
        "content": "<p>The main struggle while trying to ramp up on it though has been the dev loop. So far it's been \"play with Lean in VSCode, look at info panel for a unique-looking message, copy the text, search for it in lean source, try to back trace it to a plausible call point, add a trace log there to see if that's what's calling it, recompile, wait, go back to Lean in VSCode, reload, see if the trace showed up, repeat\", and so on up the stack. So if there's a faster way to iterate on things like that, it'd be good to know.</p>",
        "id": 529629184,
        "sender_full_name": "Dax Fohl",
        "timestamp": 1752985471
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/stream/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/529590532\">said</a>:</p>\n<blockquote>\n<p>Is there a downside to placing it at the last line of the (incomplete) proof instead? Basically, put the squiggle at the place that, when I focus on it, has an \"abandoned\" goal that's pending more work.</p>\n</blockquote>\n<p>Let's say we have an incomplete proof ending in a subproof, e.g. <code>suffices ... by</code>, the error span would be the last line under the suffices, which to me seems misleading. To demonstrate:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">suffices</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">this</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"bp\">.</span><span class=\"n\">zero_lt_one</span><span class=\"w\"> </span><span class=\"c1\">-- the error span is here and this line would be red</span>\n</code></pre></div>\n<p>One option could be to somehow have the error indicate the indentation depth and have maybe a little red triangle there to indicate whether it's the main proof or subproof which is incomplete. However, I don't think current diagnostic tools have support for this (or at least I've never seen it myself).</p>",
        "id": 529695762,
        "sender_full_name": "Niklas Halonen",
        "timestamp": 1753025635
    },
    {
        "content": "<p>That's a good example to keep in mind. I was think \"last line\" would be \"first line of the last tactic in a tactic sequence\". It's <code>suffices</code> that's the reason for the main <code>by</code> not being complete.</p>",
        "id": 529697330,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753027351
    },
    {
        "content": "<blockquote>\n<p>I was think \"last line\" would be \"first line of the last tactic in a tactic sequence\". It's¬†<code>suffices</code>¬†that's the reason for the main¬†<code>by</code>¬†not being complete.</p>\n</blockquote>\n<p>Yeah, that's a good clarification. And, if there's an empty line with some indentation after, ideally the squiggle would move to it.</p>",
        "id": 529961190,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753129929
    },
    {
        "content": "<p>In other language plugins, I've found it more common that type hints are inlaid rather than showing up in a side view that follows the cursor. Would it be possible / desirable to do something similar here, where the remaining goal is inlaid after each line? (assuming the completed section above the cursor is resilient to parse errors below it and doesn't stutter the whole screen as you type). Or is the goal state of the previous line not usually that useful if you're in the middle of typing something? Does the LSP return enough info to make that possible?</p>",
        "id": 529985924,
        "sender_full_name": "Dax Fohl",
        "timestamp": 1753146566
    },
    {
        "content": "<p>In terms of recovery, here's the behavior in the C# plugin. In the first case it looks like it can recover within the current function; it deletes the type inlays of the things that it can't figure out, and leaves the rest. Then when the error is fixed, it recalculates the type in the background (leaving the inlay as \"...\") and adds it when it's finished. In the second case it looks like it can't recover the current function, so it just grays everything below the error point out, but leaves the type hint inlays as they were. Would this be useful behavior to mimic?</p>\n<p><a href=\"/user_uploads/3121/9ElzXFGBUjPxaky1x6pITJ-j/ScreenRecording2025-07-21at5.41.16PM.gif\">ScreenRecording2025-07-21at5.41.16PM.gif</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/9ElzXFGBUjPxaky1x6pITJ-j/ScreenRecording2025-07-21at5.41.16PM.gif\" title=\"ScreenRecording2025-07-21at5.41.16PM.gif\"><img data-animated=\"true\" data-original-content-type=\"image/gif\" data-original-dimensions=\"666x448\" src=\"/user_uploads/thumbnail/3121/9ElzXFGBUjPxaky1x6pITJ-j/ScreenRecording2025-07-21at5.41.16PM.gif/840x560-anim.webp\"></a></div>",
        "id": 529986584,
        "sender_full_name": "Dax Fohl",
        "timestamp": 1753147225
    },
    {
        "content": "<p>Here's the existing proposal for better diagnostic ranges in unfinished proofs, but it's different from the one suggested in this thread: <a href=\"https://github.com/leanprover/lean4/pull/8919\">lean4#8919</a><br>\nI think that both proposals are reasonable. Note that you won't be able to implement either one as-is because we definitely want the <code>fullRange</code> of the error to be the full block (which our messages currently aren't capable of), so there are some more architectural changes required. I'll definitely look into this at some point. It will also require some adjustments to our custom diagnostic decorations in the extension.</p>",
        "id": 530363619,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753281736
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span> For being able to put errors into the whitespace, I wonder if <code>tacticSeq</code> could end in a special parser that doesn't consume characters, but instead steals some of the whitespace of the last tactic if it starts with a newline indented to the current <code>savedPos</code>? That would support multiple levels of indentation, since each dedent would give an opportunity to steal the next bit of whitespace. (I'm sure you've got your own ideas here, given all the work you've done with diagnostics in whitespace.)</p>",
        "id": 530367871,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753282765
    },
    {
        "content": "<p>I think I still like the idea of putting the squiggly exclusively on the symbol that introduces the block more at this point for those reasons :-)<br>\nWe've already got the unsolved goals symbol to mark the \"end\" of the block without having to attach it to any specific symbol in the code, after all.</p>",
        "id": 530369915,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753283239
    },
    {
        "content": "<p>I like the conceptual simplicity of moving it to ‚Äúby‚Äù but what‚Äôs the intended workflow when coming back to a broken proof? Ideally I want to avoid the need to glance ‚Äúup and down‚Äù. More concretely, I want the mental operation of ‚Äúdeciding where to put the cursor‚Äù to be O(1).</p>",
        "id": 530822038,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753465852
    },
    {
        "content": "<p>Does the unsolved goals symbol not provide that information?</p>",
        "id": 530829004,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753468728
    },
    {
        "content": "<p>Ahh, the \"tools\" icon means \"unsolved goals\"? I would've never guessed that!</p>\n<p>When I first noticed it a couple of weeks ago (while making screenshots for this thread), I assumed it's a VS Code bug or some kind of a linter autofix prompt that wasn't working. I didn't make any connection to unsolved goals. It looked like the kind of thing you'd press to get linter suggestions ‚Äî except that hovering it didn't give any hint about what it is. The \"tools\" icon generally evokes \"settings\" but pressing it also didn't do anything. So I stopped guessing what it is then and forgot about it.</p>\n<p>I've actually had to take a few seconds now to notice it in my code ‚Äî apparently I haven't noticed it even once since those two weeks ago. I presume my brain has learned to completely tune it out because I didn't understand its purpose.</p>",
        "id": 530835435,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753471501
    },
    {
        "content": "<p>I do like the idea of this marker. But I think:</p>\n<ul>\n<li>\"Tools\" is a completely wrong metaphor for it ‚Äî the icon needs to be something else</li>\n<li>It <em>must</em> have a hover state that explains what it is and/or shows the actual goals</li>\n</ul>\n<p>Otherwise it comes across as noise or a bug</p>",
        "id": 530835598,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753471582
    },
    {
        "content": "<p>It's also just hard to notice in the first place because it has so much less visual \"weight\" compared to the actual \"error\". So it's hard to notice <em>and</em> hard to imagine that it has something to do with the red thing.</p>\n<p><a href=\"/user_uploads/3121/QSwfMhD00E3IbFJAkeSiqD-M/Screenshot-2025-07-25-at-20.28.22.png\">Screenshot 2025-07-25 at 20.28.22.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/QSwfMhD00E3IbFJAkeSiqD-M/Screenshot-2025-07-25-at-20.28.22.png\" title=\"Screenshot 2025-07-25 at 20.28.22.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1010x458\" src=\"/user_uploads/thumbnail/3121/QSwfMhD00E3IbFJAkeSiqD-M/Screenshot-2025-07-25-at-20.28.22.png/840x560.webp\"></a></div>",
        "id": 530835988,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753471755
    },
    {
        "content": "<p>I guess the \"error lens\" extension is my own choice and maybe that shouldn't be taken into consideration. If we assume people <em>don't</em> have it on then the current behavior is this:</p>\n<p><a href=\"/user_uploads/3121/B1384IU_0I0DtmiHP4ZFwWQS/Screenshot-2025-07-25-at-20.41.40.png\">Screenshot 2025-07-25 at 20.41.40.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/B1384IU_0I0DtmiHP4ZFwWQS/Screenshot-2025-07-25-at-20.41.40.png\" title=\"Screenshot 2025-07-25 at 20.41.40.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1368x356\" src=\"/user_uploads/thumbnail/3121/B1384IU_0I0DtmiHP4ZFwWQS/Screenshot-2025-07-25-at-20.41.40.png/840x560.webp\"></a></div><p>If I correctly understand it, your proposed change would turn it into this:</p>\n<p><a href=\"/user_uploads/3121/akIXTbhz9ceADnyeDGJrj_AJ/Screenshot-2025-07-25-at-20.42.08.png\">Screenshot 2025-07-25 at 20.42.08.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/akIXTbhz9ceADnyeDGJrj_AJ/Screenshot-2025-07-25-at-20.42.08.png\" title=\"Screenshot 2025-07-25 at 20.42.08.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1028x396\" src=\"/user_uploads/thumbnail/3121/akIXTbhz9ceADnyeDGJrj_AJ/Screenshot-2025-07-25-at-20.42.08.png/840x560.webp\"></a></div><p>Which makes me wonder, what about something like this?</p>\n<p><a href=\"/user_uploads/3121/SIbrK9jBssjbLqAHb1jHAvY-/Screenshot-2025-07-25-at-20.42.08.png\">Screenshot 2025-07-25 at 20.42.08.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/SIbrK9jBssjbLqAHb1jHAvY-/Screenshot-2025-07-25-at-20.42.08.png\" title=\"Screenshot 2025-07-25 at 20.42.08.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1028x396\" src=\"/user_uploads/thumbnail/3121/SIbrK9jBssjbLqAHb1jHAvY-/Screenshot-2025-07-25-at-20.42.08.png/840x560.webp\"></a></div><p>So, replacing the \"tools\" marker with an actual statement of the unsolved goal.</p>",
        "id": 530838230,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753472693
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530835598\">said</a>:</p>\n<blockquote>\n<ul>\n<li>\"Tools\" is a completely wrong metaphor for it ‚Äî the icon needs to be something else</li>\n</ul>\n</blockquote>\n<p>Happy to hear about potential alternatives. Due to VS Code limitations, it has to be an emoji (or text); we can't put a custom .svg there.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530835598\">said</a>:</p>\n<blockquote>\n<ul>\n<li>It <em>must</em> have a hover state that explains what it is and/or shows the actual goals</li>\n</ul>\n</blockquote>\n<p>I wish it was, but this is unfortunately not possible due to VS Code limitations.</p>\n<p>See <a href=\"https://github.com/leanprover-community/vscode-lean4/pull/585\">vscode-lean4#585</a>.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530835988\">said</a>:</p>\n<blockquote>\n<p>It's also just hard to notice in the first place because it has so much less visual \"weight\" compared to the actual \"error\".</p>\n</blockquote>\n<p>I think this is in part due to the fact that you are using the Error Lens extension, which highlights the entire line :-)</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530838230\">said</a>:</p>\n<blockquote>\n<p>So, replacing the \"tools\" marker with an actual statement of the unsolved goal.</p>\n</blockquote>\n<p>Most Lean goals are far too large in practice to render them in an editor decoration.</p>",
        "id": 530838385,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753472757
    },
    {
        "content": "<p>Right, I guess I was assuming that the Lean plugin could use a similar approach for this marker as the Error Lens extension does? (Maybe that's a wrong assumption)</p>\n<p>I think I enabled Error Lens because some Lean tutorial encouraged it. I'll probably turn it off for myself.</p>",
        "id": 530838544,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753472830
    },
    {
        "content": "<p>I personally think that the Error Lens extension (both the red line background and the squashed text after it) are too noisy to enable them by default in the Lean extension. This is essentially why we have the error markers on the left (the cross and the line are a Lean feature!) as a less noisy alternative that also provides more context than Error Lens, namely where the full range of the error ends.</p>",
        "id": 530838832,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753472970
    },
    {
        "content": "<p>The error lens extension used to be completely essential for Lean use, but Marc‚Äôs recent work made it much less crucial, and even maybe harmful.</p>",
        "id": 530839077,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473096
    },
    {
        "content": "<p>(I don't remember if you considered <span aria-label=\"construction\" class=\"emoji emoji-1f3d7\" role=\"img\" title=\"construction\">:construction:</span> <span class=\"user-mention\" data-user-id=\"221921\">@Marc Huisinga</span>. It might give somewhat more of a construction site feel than <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span>, though Zulip calls <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> \"working on it\" and it makes enough sense.)</p>",
        "id": 530839292,
        "sender_full_name": "Kyle Miller",
        "timestamp": 1753473212
    },
    {
        "content": "<p>Dan, the standard description of <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> on this zulip is ‚Äúworking on it‚Äù. It is the way you type it and the way it is used here.</p>",
        "id": 530839422,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473293
    },
    {
        "content": "<p>So in the VSCode extension it means: you still have work to do here.</p>",
        "id": 530839473,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473317
    },
    {
        "content": "<p>I‚Äôm not saying we can‚Äôt find a better one, only explaining the rational.</p>",
        "id": 530839501,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473333
    },
    {
        "content": "<p>I don‚Äôt know universal is this ‚Äúworking on it‚Äù description.</p>",
        "id": 530839547,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473360
    },
    {
        "content": "<p>(I sympathize with the point that it's a bit obscure without the hover though. I really wish the editor decoration API was capable of this.)</p>",
        "id": 530839570,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753473369
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530838230\">said</a>:</p>\n<blockquote>\n<p>If I correctly understand it, your proposed change would turn it into this:</p>\n</blockquote>\n<p>For <code>by</code>, it will look the same way as it does now. But in your dot case example, it will put a squiggly under the dot instead of the full line with the <code>rintro</code> tactic, so that it won't suggest that something is wrong with the tactic anymore.</p>",
        "id": 530839896,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753473540
    },
    {
        "content": "<p>I see. I think that's a pretty unorthodox name for this icon. (Seems like it's just \"hammer and wrench\" in Unicode?) Maybe familiar to Zulip users but not very discoverable or clear to someone who wasn't already taught that.</p>\n<p>I agree Error Lens seems like maybe a poor recommendation at this point. I'm not sure where I saw it. I thought either Kevin's course or MIL but can't find it there either. Maybe it's safe to assume most beginners won't have that.</p>\n<p>I didn't realize the left pane is already custom. If we have control over it, then I don't see much point in the emoji decoration. Maybe left pane could just be a bit clearer about what's going on? Could we do more custom stuff there?</p>\n<p>IMO the most intuitive icon for \"unfinished goal\" would just be the goal icon. So if we have more control over the left pane, maybe something like this would make sense?</p>\n<p><a href=\"/user_uploads/3121/ohCY2RL26573VuV2qDOg0Cw6/Screenshot-2025-07-25-at-20.42.08.png\">Screenshot 2025-07-25 at 20.42.08.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/ohCY2RL26573VuV2qDOg0Cw6/Screenshot-2025-07-25-at-20.42.08.png\" title=\"Screenshot 2025-07-25 at 20.42.08.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1028x396\" src=\"/user_uploads/thumbnail/3121/ohCY2RL26573VuV2qDOg0Cw6/Screenshot-2025-07-25-at-20.42.08.png/840x560.webp\"></a></div>",
        "id": 530840236,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753473676
    },
    {
        "content": "<p>I don‚Äôt remember whether we mention error lens in MIL, but it may very well be the case. Do you know this extension is very configurable?</p>",
        "id": 530840477,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473775
    },
    {
        "content": "<p>I checked and the word lens does not appear in the source of MIL.</p>",
        "id": 530840603,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473834
    },
    {
        "content": "<p>So we won‚Äôt have to decide whether to remove it or not.</p>",
        "id": 530840628,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753473847
    },
    {
        "content": "<p>OK I think a lot of my beef was actually with Error Lens. It's not as distracting without it. And if the squigglies are also slightly reined in, it would be a further improvement.</p>\n<p>The \"working on it\" icon feels like pure noise to me now since it's duplicating the information in the left pane. </p>\n<p><a href=\"/user_uploads/3121/QB3YcfaA9zRLvwhDiD1MToXz/Screenshot-2025-07-25-at-21.08.31.png\">Screenshot 2025-07-25 at 21.08.31.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/QB3YcfaA9zRLvwhDiD1MToXz/Screenshot-2025-07-25-at-21.08.31.png\" title=\"Screenshot 2025-07-25 at 21.08.31.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"892x230\" src=\"/user_uploads/thumbnail/3121/QB3YcfaA9zRLvwhDiD1MToXz/Screenshot-2025-07-25-at-21.08.31.png/840x560.webp\"></a></div><p>If the left pane is always as clear as in this screenshot (note that's not always true ‚Äî earlier examples in this thread showed it's sometimes very noisy with multiple circles) I think that would be enough.</p>",
        "id": 530841401,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753474186
    },
    {
        "content": "<p>However, if you don't have <code>sorry</code> at the end, the left pane is red for the entirety of the proof and that makes it sort of useless.</p>\n<p><a href=\"/user_uploads/3121/BKmsyXG7ct2zJgjWWld8SrlB/Screenshot-2025-07-25-at-21.11.38.png\">Screenshot 2025-07-25 at 21.11.38.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/BKmsyXG7ct2zJgjWWld8SrlB/Screenshot-2025-07-25-at-21.11.38.png\" title=\"Screenshot 2025-07-25 at 21.11.38.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"942x736\" src=\"/user_uploads/thumbnail/3121/BKmsyXG7ct2zJgjWWld8SrlB/Screenshot-2025-07-25-at-21.11.38.png/840x560.webp\"></a></div><p>I wonder if that specific pattern could be improved.</p>",
        "id": 530841809,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753474349
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530840236\">said</a>:</p>\n<blockquote>\n<p>IMO the most intuitive icon for \"unfinished goal\" would just be the goal icon. So if we have more control over the left pane, maybe something like this would make sense?</p>\n</blockquote>\n<p>The reason for why we put it at the end of the line is two-fold:</p>\n<ol>\n<li>It's closer to the idea of \"this is where you should continue typing\" than a decoration on the left (also known as \"the gutter\" in VS Code). It's still not optimal in this regard, since you'd really like it to be on the next empty line in multi-line blocks, but this is quite tricky for complicated technical reasons.</li>\n<li>Each icon on the left side should interact nicely with other icons on the left side. If there is both an error and the end of an unsolved goals error on that line, which icon should we display? Having it on the right automatically disambiguates this.</li>\n</ol>\n<p>We could have <code>‚ä¢</code> instead of <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span>. I vaguely remember rejecting it for some reason, perhaps because it blended into the text too easily, since it is just a regular Unicode symbol. I don't remember exactly.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530841401\">said</a>:</p>\n<blockquote>\n<p>The \"working on it\" icon feels like pure noise to me now since it's duplicating the information in the left pane.</p>\n</blockquote>\n<p>Note that the design language in the left pane isn't entirely unambiguous when there are multiple overlapping error ranges, but it's the best I could come up with given the limited space in the gutter. Removing the unsolved goals symbol would certainly make it harder to spot the end of an \"unsolved goals\" range in this case, but also in general because you first have to identify the bend to the right as being one from an \"unsolved goals\" error at the top.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530841809\">said</a>:</p>\n<blockquote>\n<p>However, if you don't have <code>sorry</code> at the end, the left pane is red for the entirety of the proof and that makes it sort of useless.</p>\n</blockquote>\n<p>Well, there's an error spanning from the first <code>by</code> all the way to the end of the block in this case after all, so that's what the gutter decorations display :-)</p>",
        "id": 530842141,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753474486
    },
    {
        "content": "<p>I see. I guess the question is ‚Äî what's the recommended workflow when typing? Do you want to encourage people to type <code>sorry</code> ASAP to make the left gutter useful? Because if they don't, it's perpetually in a state where multiple things will overlap. I understand that technically they \"should\" overlap because you \"do\" have a range error, but for me that's an argument to not treat it as a range.</p>",
        "id": 530842552,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753474659
    },
    {
        "content": "<p>This, while losing the \"range\" information, feels more immediately useful to me:</p>\n<p><a href=\"/user_uploads/3121/rEuhtlrHqsJIGXyqdn_ky-Yv/Screenshot-2025-07-25-at-21.14.12.png\">Screenshot 2025-07-25 at 21.14.12.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/rEuhtlrHqsJIGXyqdn_ky-Yv/Screenshot-2025-07-25-at-21.14.12.png\" title=\"Screenshot 2025-07-25 at 21.14.12.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"828x740\" src=\"/user_uploads/thumbnail/3121/rEuhtlrHqsJIGXyqdn_ky-Yv/Screenshot-2025-07-25-at-21.14.12.png/840x560.webp\"></a></div><p>Because it accurately portrays the actionable points.</p>",
        "id": 530842686,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753474719
    },
    {
        "content": "<p>Another argument against ranges is that as soon as you have &gt;1, the nesting looks so confusing that it doesn't convey the actual ranges anymore anyway. It feels like multiple overlapping ranges should be a corner case, but right now that's the default behavior unless you always add <code>sorry</code>s.</p>",
        "id": 530842962,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753474837
    },
    {
        "content": "<p>I think the \"unsolved goals\" error is fairly unique in the sense that only its start line and its end line are relevant. For most other errors that span multiple lines, I don't think this holds - you really want a signal that a line is part of an error, and the fact that an error range ends at a line is secondary information.</p>\n<p>Could you clarify again why the <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> symbols aren't sufficient for unsolved goals errors in particular? You stated that they duplicate the information on the left, but I don't think they do, and I believe that they express the position where you should continue typing more nicely than a decoration in the gutter.</p>",
        "id": 530843616,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753475146
    },
    {
        "content": "<p>I agree \"unsolved goals\" is special. Partially because, like you said, only the first and the last lines are relevant. Partially because it's expected that the space between them will likely keep expanding (and so the range will likely get longer and nested). And partially because unlike many other errors, this one is \"expected\" while you're typing. So it's bad if it distracts you from... typing.</p>\n<p>I see your point about decorations. Maybe you're right. I don't feel like <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> conveys what it's doing, so I'm not sure if other users broadly understand what it is. I see your point re: goal indicator maybe blending in too much. (I'm not sure if you can choose the color or font there btw?) It is hard for me to offer alternatives for without actually playing with a real setup and plugging different options.</p>",
        "id": 530844313,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753475471
    },
    {
        "content": "<p>To sum up my complaints at this point, it would be that the <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span>s are too hard to visually scan for when the entire gutter panel is shouting at me with red lines (and 90% of the area these red lines cover have no errors). So <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span> are informative but hard to see, and the gutter is not informative but is in my face.</p>",
        "id": 530844618,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753475606
    },
    {
        "content": "<p>Also, just having three sources of information (gutter, squiggles, and <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span>s) that aren't <em>quite</em> conveying the same thing (but are somewhat related) feels like a lot. My eyes keep darting between them whenever something changes.</p>",
        "id": 530844786,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753475687
    },
    {
        "content": "<p>I still feel like whatever the outcome, I'll just keep adding <code>sorry</code>s manually so that I can stay focused on actual, real errors ‚Äî and not have my attention destroyed by screaming red lines. Which is maybe fine. But then I wish the tooling just embraced that. E.g. insert <code>sorry</code> for me or something.</p>",
        "id": 530845217,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753475872
    },
    {
        "content": "<p>You can choose a font, font weight, color, background color, etc. The problem with the background color one is that it will end up looking a bit weird since the bounding box is not a square.</p>\n<p>Ultimately, I think that using \\vdash (no matter where) for an unsolved goal might also be pretty confusing to some people, so perhaps that's part of why I rejected it :-)</p>\n<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530845217\">said</a>:</p>\n<blockquote>\n<p>I'll just keep adding <code>sorry</code>s manually so that I can stay focused on actual, real errors ‚Äî and not have my attention destroyed by screaming red lines.</p>\n</blockquote>\n<p>I think this depends entirely on whether you're trying to find errors in your code at a glance or whether you're editing and just want to proceed at the moment. I certainly operate in both of these \"modes\" at different times while working on code. In a modal editor, I'd probably even explicitly distinguish the two in terms of how we display diagnostics. <br>\nWe introduced the red lines and the other gutter decorations because students kept missing squigglies in their code when they were looking for errors, and also because the squiggly isn't necessarily an accurate depiction of the range of the error, even outside of \"unsolved goals\". Certainly, covering the editor in squigglies is also not a reasonable option.</p>\n<p>RE: Displaying different kinds of diagnostic when editing vs browsing like would be possible in a modal editor, I do have some ideas for adding an optional purely client-side mode to vscode-lean4 at some point that allows switching between these two modes with a shortcut without it affecting the actual editing experience, only diagnostics and the InfoView, so that there is less flickering and noise while you're editing. It's not that far up on my endless backlog, though :-)</p>",
        "id": 530847266,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753476900
    },
    {
        "content": "<p>Yes, using a modal editor is indeed better.</p>",
        "id": 530849303,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753477875
    },
    {
        "content": "<p>And, Dan, most people write <code>sorry</code> very often, and I think you already asked this question not long ago.</p>",
        "id": 530849581,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1753477989
    },
    {
        "content": "<p>I also constantly add <code>sorry</code>s and focusing dots: I am always very suspicious of what lean tells me, when there are errors around.</p>",
        "id": 530905718,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1753513671
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530849581\">said</a>:</p>\n<blockquote>\n<p>And, Dan, most people write <code>sorry</code> very often, and I think you already asked this question not long ago.</p>\n</blockquote>\n<p>Yea I don't have much to add here without going in circles. I want to clarify that I'm not asking about customizations <em>for myself</em>, I'm just saying the default experience (and it's the default experience I care about) of writing Lean code feels (to me) worse than the default experience of writing Python, TypeScript, or most other modern languages with IDE integration, and the reason it feels worse is because during the natural course of writing (left to right, top to bottom), the IDE integration is \"more paranoid\" (highlighting things in red, adding squigglies) than other languages ‚Äî calling attention to \"issues\" that aren't actual issues and are expected in the process of writing. Maybe I'm \"holding it wrong\" and this is best \"fixed\" by writing \"not exactly top down\" and adding <code>sorry</code>s whenever I indent. But again, this reminds me of how modern language integrations automatically insert matching curlies, or recover more gracefully from incomplete lines, etc.</p>\n<p>If I can use a math metaphor, imagine taking an integral over the cumulative amount of noise as you type a proof top to bottom and left to right, where noise is defined as red lines and squiggles that don't actually demand switching attention to them (with extra noise \"points\" for squiggles and red lines that are downright misleading, i.e. failing to parse). Then compare the amount of noise to a similar integral taken over writing a TypeScript function. Then maybe there is something actionable there ‚Äî I think reducing that cumulative amount \"as you type\" is a good idea, with attention paid to what happens at every single keystroke. That's all I was trying to say.</p>",
        "id": 530973104,
        "sender_full_name": "Dan Abramov",
        "timestamp": 1753548891
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"221921\">Marc Huisinga</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530842141\">said</a>:</p>\n<blockquote>\n<p>We could have <code>‚ä¢</code> instead of <span aria-label=\"working on it\" class=\"emoji emoji-1f6e0\" role=\"img\" title=\"working on it\">:working_on_it:</span>. I vaguely remember rejecting it for some reason, perhaps because it blended into the text too easily, since it is just a regular Unicode symbol. I don't remember exactly.</p>\n</blockquote>\n<p>Bad idea. Imagine if the last tactic was <code>simp at h</code> and you stuck a faded <code>‚ä¢</code> after it...</p>",
        "id": 531018383,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1753571121
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"418569\">Dan Abramov</span> <a href=\"#narrow/channel/341532-lean4-dev/topic/Can.20diagnostics.20be.20more.20resilient.20to.20unfinished.20proofs.3F/near/530973104\">said</a>:</p>\n<blockquote>\n<p>I want to clarify that I'm not asking about customizations <em>for myself</em>, I'm just saying the default experience (and it's the default experience I care about) of writing Lean code feels (to me) worse than the default experience of writing Python, TypeScript, or most other modern languages with IDE integration, and the reason it feels worse is because during the natural course of writing (left to right, top to bottom), the IDE integration is \"more paranoid\" (highlighting things in red, adding squigglies) than other languages ‚Äî calling attention to \"issues\" that aren't actual issues and are expected in the process of writing.</p>\n</blockquote>\n<p>I suspect that part of the reason for this is also just that some of these issues are a bit harder in Lean than in other languages (e.g. due to Lean's extensibility, or due to the fact that practically everything is just some sort of nested expression). For example, here's the kind of diagnostic highlighting I get in TypeScript when there's a type error in a larger expression:<br>\n<a href=\"/user_uploads/3121/VHhUZ1P9JdaK3KQWlLgGDAK7/image.png\">image.png</a><br>\nI don't think this is great, either :-)</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/VHhUZ1P9JdaK3KQWlLgGDAK7/image.png\" title=\"image.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"1052x158\" src=\"/user_uploads/thumbnail/3121/VHhUZ1P9JdaK3KQWlLgGDAK7/image.png/840x560.webp\"></a></div><p>(To be clear, I still definitely agree with your points that we could and should do much better in regards to error recovery and where errors are reported in plenty of examples.)</p>",
        "id": 532059535,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1753964551
    }
]