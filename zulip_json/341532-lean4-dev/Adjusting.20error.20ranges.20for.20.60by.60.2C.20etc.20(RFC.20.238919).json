[
    {
        "content": "<p>I'm interested in working on <a href=\"https://github.com/leanprover/lean4/issues/8919\">https://github.com/leanprover/lean4/issues/8919</a> . Based on my current understanding, implementing this is going to require:</p>\n<ol>\n<li>Adjusting <code>Lean.MonadRef</code> (and all of the structures which implement it) to additionaly store something like <code>fullRef: Option (m Syntax)</code>. This will be used to store the 'full' <code>Syntax</code> associated with a message - in the <code>by</code> example, this will be the entire <code>by ...</code> expression, while <code>ref</code> will start storing just the <code>by</code> token.</li>\n<li>Remove <code>BaseMessage.keepFullRange</code>, and instead store <code>fullPos</code>/<code>endFullPos</code> positions (which will be populated from the new <code>fullRef</code> from <code>Lean.MonadRef</code>)</li>\n<li>Adjust <code>msgToInteractiveDiagnostic </code> to directly construct <code>range</code> and <code>fullRange</code> from <code>pos/endPos</code> and <code>fullPos/endFullPos</code> respectively. This function will no longer ever perform truncation of ranges that span more than one line.</li>\n</ol>\n<p>Does that sound correct? I'm unsure about exactly what the API for getting/setting <code>fullRef</code> should like - I assume that we'll want to make it difficult to accidentally update either <code>ref</code>/<code>fullRef</code> without explicitly setting or clearing the other.</p>",
        "id": 538045582,
        "sender_full_name": "Aaron Hill",
        "timestamp": 1757211932
    },
    {
        "content": "<p>Your plan is good, but since this will require fairly deep changes to multiple components (including the VS Code extension since the new ranges won't satisfy some invariants that the old ones satisfied), I think that it's best implemented by someone at the FRO at some point.</p>",
        "id": 539535738,
        "sender_full_name": "Marc Huisinga",
        "timestamp": 1757937241
    }
]