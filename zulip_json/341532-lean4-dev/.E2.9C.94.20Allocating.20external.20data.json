[
    {
        "content": "<p>I am writing a lean binding to a C API. The API has the form:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">struct</span><span class=\"w\"> </span><span class=\"n\">mystruct</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">uint8_t</span><span class=\"w\"> </span><span class=\"n\">buf</span><span class=\"o\">[</span><span class=\"mi\">8</span><span class=\"o\">]</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"o\">}</span>\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">init_mystruct</span><span class=\"o\">(</span><span class=\"n\">struct</span><span class=\"w\"> </span><span class=\"n\">mystruct</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"n\">data</span><span class=\"o\">)</span><span class=\"bp\">;</span>\n<span class=\"n\">void</span><span class=\"w\"> </span><span class=\"n\">delete_mystruct</span><span class=\"o\">(</span><span class=\"n\">struct</span><span class=\"w\"> </span><span class=\"n\">mystruct</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"n\">data</span><span class=\"o\">)</span><span class=\"bp\">;</span>\n</code></pre></div>\n<p>(i.e the library expects you to allocate the struct mystruct yourself, and pass in a pointer etc.)</p>\n<p>What would be the recommended way of wrapping this using lean? <code>lean_alloc_external_data</code> allocates a lean object that wraps a pointer to external data, but doesn't allocate it itself. </p>\n<p>Should I just malloc the data myself and then wrap it in <code>lean_alloc_external_data</code>? Are there specific alloc functions in <code>lean.h</code> I should use?</p>",
        "id": 529083412,
        "sender_full_name": "Kiran",
        "timestamp": 1752678864
    },
    {
        "content": "<p>Calling malloc yourself is fine yes</p>",
        "id": 529085034,
        "sender_full_name": "Henrik BÃ¶ving",
        "timestamp": 1752679315
    },
    {
        "content": "<p>awesome, awesome! Just wanted to check in case there was some specific wrapper around malloc I was meant to use!</p>",
        "id": 529085162,
        "sender_full_name": "Kiran",
        "timestamp": 1752679356
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"241754\">Kiran</span> has marked this topic as resolved.</p>",
        "id": 529085171,
        "sender_full_name": "Notification Bot",
        "timestamp": 1752679358
    }
]