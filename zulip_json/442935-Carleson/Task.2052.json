[
    {
        "content": "<p>Quick question about task 52: </p>\n<blockquote>\n<p>that if the subset has no chains of length¬†n+1¬†then the union of the first¬†n¬†sets is the original set</p>\n</blockquote>\n<p>What is the general notion for ‚Äúchain of length n‚Äù and ‚Äúhas no chain of length n‚Äù? <br>\nGiven a partial order and two elements <code>x</code> and <code>y</code> , what is the idiomatic way to say that <code>x &lt; ‚Ä¶ (n steps) &lt; y</code></p>",
        "id": 453793670,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721854204
    },
    {
        "content": "<p>There's no idiomatic way. I'd say use a list <code>[x] ++ l ++ [y]</code> and assume it is sorted</p>",
        "id": 453794789,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1721854521
    },
    {
        "content": "<p>I thought that we had all this chain and krull dimension stuff now? (On mobile but search for krull dimension maybe?)</p>",
        "id": 453795136,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721854626
    },
    {
        "content": "<p>Indeed there is <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Order/KrullDimension.html#krullDim\">krullDim</a>  (Œ± : Type u_1) ‚Üí [inst : Preorder Œ±] ‚Üí WithBot (WithTop ‚Ñï), which may be suitable here</p>",
        "id": 453798524,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721855482
    },
    {
        "content": "<p>So maybe <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LTSeries#doc\">docs#LTSeries</a> is what you're looking for?</p>",
        "id": 453800005,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721856250
    },
    {
        "content": "<p>Oh I see, but this doesn't have fixed endpoints</p>",
        "id": 453800110,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721856312
    },
    {
        "content": "<p>Maybe I am simply looking for some form of relation iteration, possibly <code>R^n</code></p>",
        "id": 453800285,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721856395
    },
    {
        "content": "<p>I tried a few things in <a href=\"https://github.com/fpvandoorn/carleson/pull/90\">https://github.com/fpvandoorn/carleson/pull/90</a>, still very early.</p>\n<p>My main question is the interface to</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"sd\">/-- Part of Lemma 5.5.2 -/</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">iUnion_L0'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">‚ãÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">ùîè‚ÇÄ'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">ùîè‚ÇÄ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>The generalization of that lemma needs this extra assumption ‚Äúsubset has no chains of length¬†n+1‚Äù, and I wonder if you already know in which form that assumption is most convenient? the krulllDim sounds right, but maybe be awkward (WithBot and WithTop complications, supremums etc.). Maybe </p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">hlength</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LTSeries</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>is easiest?</p>\n<p>Although it feels very natural to identify <code>ùîè‚ÇÄ' k n l </code>  with those elements in <code>ùîè‚ÇÄ k n</code> that have <code>height</code> <code>l</code> (in that set), and mathlib‚Äôs <code>height</code> definition goes via <code>krulllDim</code>. And lacks lots of API, it seems.</p>",
        "id": 453812764,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721862503
    },
    {
        "content": "<p>(And it‚Äôs dangerous to start something like this two hours before bedtime, because then bedtime loses‚Ä¶ :-D)</p>",
        "id": 453812996,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721862653
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"566592\">@Fangming Li (John)</span> this is a use case for DimensionLT perhaps</p>",
        "id": 453865611,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1721889695
    },
    {
        "content": "<p>After thinking about it a bit, I think</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"o\">(</span><span class=\"n\">hlength</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LTSeries</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>is a naturally basic way to express this, in particular as the strict bound isn‚Äôt needed. The lemma to get there would be something along the lines</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">exists_ltseries_of_mem_foo</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">by_height</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"bp\">.</span><span class=\"n\">length</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">/\\</span><span class=\"w\"> </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"bp\">.</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">by_height</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div>\n<p>from which the existing</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">exists_le_of_mem_ùîè‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùîì</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">ùîè‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">‚Ñ≠‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">ùî∞</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">ùî∞</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>should follow, together with <code>StrictMono ùî∞</code>.</p>\n<p>If this <code>by_height</code>  construction goes towards mathlib, then something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">mem_foo_iff_height</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">x</span><span class=\"bp\">.</span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">height</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>would be a nice addition, but maybe not strictly necessary for Task 52.</p>",
        "id": 453868241,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721890503
    },
    {
        "content": "<p>The last lemma might not be strictly necessary for the task, but if it goes into Mathlib, it is nice to have!</p>",
        "id": 453893788,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1721898374
    },
    {
        "content": "<p>More thoughts:<br>\nThis <code>minLayer</code> really is just the partition of the set by the height of elements. So I'd say I'd complete the (almost non-existent) API for height, and hopefully we'll get the lemmas we need from that easily:</p>\n<ul>\n<li>An element of finite height n has a LTSeries ending in it of length n</li>\n<li>Every series of length n ending in the element has at position I an element of height I</li>\n<li>A series of length n ends in an element of height at least n</li>\n<li>For an element of height n there exists a series of length n ending in it (this is almost all that's needed for the lemma that gives you a <code>p'</code> with <code>s</code> differing by at least <code>n</code> , and maybe allows to strengthen it to unblock Jeremy)</li>\n<li>The elements of height n are the minimal elements when removing elements of height &lt;n. This lemma proves the recursive equation in the blueprint.</li>\n</ul>\n<p>Let's see how many international flights this takes :-)</p>",
        "id": 454283220,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1721995132
    },
    {
        "content": "<p>Oh, there is <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.subchain#doc\">docs#Set.subchain</a> in <code>Mathlib.Order.Height</code>which already has plenty of lemmas, all phrased in terms of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Batteries/Data/List/Basic.html#List.Chain'\">List.Chain'</a> rather than <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=LTSeries#doc\">docs#LTSeries</a>. I guess <code>LTSeries</code> is a bit nicer here, mostly becaue it's no-empty.</p>",
        "id": 454310644,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722004193
    },
    {
        "content": "<p>Ok, pushed some reasonable preliminary version to <a href=\"https://github.com/fpvandoorn/carleson/pull/90\">https://github.com/fpvandoorn/carleson/pull/90</a><br>\nIt contains some reasonable API coverage for height, defined as</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">height</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Preorder</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"bp\">‚àû</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚®Ü</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">LTSeries</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"n\">last</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"o\">}),</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"bp\">.</span><span class=\"n\">length</span>\n</code></pre></div>\n<p>(which I believe can replace the <code>height</code> definition in mathlib).</p>\n<p>Based on that there is also a definition</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">with_height</span><span class=\"bp\">.</span><span class=\"o\">{</span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ±</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"n\">u_1</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Preorder</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span>\n</code></pre></div>\n<p>that is the <code>minLayer</code> in Jeremy‚Äôs PR. It can equivalently be defined using the recursion as in the repo right now, or via</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">mem_with_height_iff</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nat</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"bp\">.</span><span class=\"n\">with_height</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">height</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚ü®</span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"bp\">‚ü©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>This is then used to fill in the blanks in <code>DiscreteCarleson</code>.</p>\n<p>Maybe of particular interest is my proof for</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">exists_le_of_mem_ùîè‚ÇÅ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ùîì</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hp</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">ùîè‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">‚àÉ</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">‚àà</span><span class=\"w\"> </span><span class=\"n\">‚Ñ≠‚ÇÅ</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">ùî∞</span><span class=\"w\"> </span><span class=\"n\">p'</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"bp\">‚â§</span><span class=\"w\"> </span><span class=\"n\">ùî∞</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n</code></pre></div>\n<p>Which goes like this</p>\n<ul>\n<li>From <code>hp : p ‚àà ùîè‚ÇÅ k n j l</code> we know that <code>p</code> has height <code>l</code></li>\n<li>Therefore we have a sequence <code>p' &lt; ‚Ä¶ &lt; p</code> of length l</li>\n<li><code>ùî∞</code> is strictly monotone, so <code>ùî∞ p' &lt; ‚Ä¶ &lt; ùî∞ p</code> is still a sequence of length l</li>\n<li>That‚Äôs a sequence in Z, so <code>ùî∞ p' + l ‚â§ ùî∞ p</code> follows.</li>\n</ul>\n<p>Possibly that sequence <code>p' &lt; ‚Ä¶ &lt; p</code> is actually of interest beyond that lemma?</p>",
        "id": 454480661,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722092048
    },
    {
        "content": "<p>Questions as of now:</p>\n<ul>\n<li>Is the API provided by <code>ToMathlib.Height</code> roughly ok?</li>\n<li>What's a better name for <code>Set.with_height</code>?</li>\n<li>Worth merging soon to get the API in to be able to build on it, or should I finish the few remaining <code>sorries</code> (some results about infinite height elements) and do general cleanup first?</li>\n<li>Assuming the <code>height</code> definition is mathlib-worthy, is it a good idea to upstream in parallel to the project, or less friction to upstream once it‚Äôs done and stable? (I think the <code>Set.with_height</code> is a bid too specific to upstream.)</li>\n</ul>",
        "id": 454480959,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722092244
    },
    {
        "content": "<p>Nice task by the way :-)</p>",
        "id": 454481079,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722092390
    },
    {
        "content": "<p>Note that we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=height#doc\">docs#height</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=krullDim#doc\">docs#krullDim</a> in Mathlib, and AFAIR they are (were?) off by 1.</p>",
        "id": 454540564,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722122457
    },
    {
        "content": "<p>I think that these 2 definitions should be deduplicated. I hope that you aren't going to add another one instead.</p>",
        "id": 454540652,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722122503
    },
    {
        "content": "<blockquote>\n<p>I think the¬†<code>Set.with_height</code>¬†is a bid too specific to upstream</p>\n</blockquote>\n<p>I hope that the whole project will be upstreamed one day, because I think that we want to have the main result[^1] in Mathlib.</p>\n<p>[^1]: More precisely, I'm sure that we want the more classical result in Mathlib, but if we'll have a more precise result formalized, then why not add it instead?</p>",
        "id": 454541083,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722122671
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/454540564\">said</a>:</p>\n<blockquote>\n<p>Note that we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=height#doc\">docs#height</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=krullDim#doc\">docs#krullDim</a> in Mathlib, and AFAIR they are (were?) off by 1.</p>\n</blockquote>\n<p>I know about <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=height#doc\">docs#height</a>; my proposal is to replace that with my definition (it‚Äôs very similar, but mathlib‚Äôs has a <code>WithBot</code> around the result type which mine doesn‚Äôt). <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=height#doc\">docs#height</a> doesn‚Äôt have much of an API or uses yet anyways, so I hope this won‚Äôt be disruptive.</p>\n<blockquote>\n<p>I hope that the whole project will be upstreamed one day, because I think that we want to have the main result[^1] in Mathlib.</p>\n</blockquote>\n<p>Good point. Well, <code>s.with_height n</code> (or maybe better called <code>Set.by_height</code>?) isn‚Äôt inherently bad. I am just wondering if it‚Äôs needed when it‚Äôs mostly just the preimage of  <code>n</code> under <code>height</code> in the partial order restricted to a set <code>s</code>. But maybe that‚Äôs already enough to justify its own definition.</p>",
        "id": 454608533,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722169890
    },
    {
        "content": "<p>This is now sorry-free <del>up to <a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/stream/217875-Is-there-code-for-X.3F/topic/ENat.2EiSup_eq_coe_iff\">#Is there code for X? &gt; ENat.iSup_eq_coe_iff</a></del></p>",
        "id": 454620481,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722178346
    },
    {
        "content": "<p>I think all of this (including <code>with_height</code> is Mathlib-worthy. I think your definition is better than <code>height</code> in Mathlib (which should really be namespaced). Mathlib's <code>height a</code> can never be <code>\\bot</code>, right?</p>\n<p>I am not sure about upstreaming the whole project, but that is a separate discussion (which I'm certainly happy to have!)</p>",
        "id": 454838078,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722260575
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/454838078\">said</a>:</p>\n<blockquote>\n<p>I think all of this (including <code>with_height</code> is Mathlib-worthy. I think your definition is better than <code>height</code> in Mathlib (which should really be namespaced). Mathlib's <code>height a</code> can never be <code>\\bot</code>, right?</p>\n</blockquote>\n<p>Exactly!</p>\n<p>So what is the preferred course of action? How about we merge this quickly to be able to build on build on it within <code>carleson</code>. Then I start upstreaming to mathlib, cleaning up in the mathlib PRs based on maintainer reviews, and removing bits from <code>carleson</code> as they appear in the mathlib we follow there?<br>\n(If we upstream it anways, and assuming that the mathlib review process will have more clean-up inputs, it seems to be more efficient to do most cleanup on the way to mathlib, rather than first in the <code>carleson</code> and then again, based on more feedback, on the way to mathlib.</p>",
        "id": 454849369,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722262711
    },
    {
        "content": "<p>Yes, I would definitely like to have this available in <code>carleson</code> soon, so merging it to <code>carleson</code> quickly and then making PRs to mathlib sounds perfect!</p>",
        "id": 454854661,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722263907
    },
    {
        "content": "<p>Mathlib used to have a different definition of <code>height</code>, then I complained about 2 almost identical definitions (<code>height</code> and <code>krullDimension</code>) and someone deduplicated them. I remember that they were off by one.</p>",
        "id": 454893492,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722273349
    },
    {
        "content": "<p>OMG, we still have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=height#doc\">docs#height</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Set.chainHeight#doc\">docs#Set.chainHeight</a></p>",
        "id": 454894238,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722273491
    },
    {
        "content": "<p>It would be nice to clean up this mess.</p>",
        "id": 454894400,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722273533
    },
    {
        "content": "<p>See <a class=\"stream-topic\" data-stream-id=\"287929\" href=\"/#narrow/stream/287929-mathlib4/topic/RelSeries.20vs.20List.2Echain.20vs.20Order.2Eheight\">#mathlib4 &gt; RelSeries vs List.chain vs Order.height</a></p>",
        "id": 454894812,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722273626
    },
    {
        "content": "<p>The height is off by one against the math literature, but on the other hand it's natural to those who like start counting at 0, and it's a but strange to map to the Natural numbers but don't use the zero.</p>\n<p>What is the convention in mathlib? Stick to the literature, or be at liberty if something is off by one of it leads to a more natural definition?</p>",
        "id": 454925864,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722280926
    },
    {
        "content": "<p>I'm not clear about \"the math literature\" in general, but certainly in algebraic geometry/commutative algebra the ring <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi><mo stretchy=\"false\">[</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo separator=\"true\">,</mo><mi>Z</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\R[X,Y,Z]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">R</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">]</span></span></span></span> has got Krull dimension 3 because a maximal chain of prime ideals is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>‚äÇ</mo><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>‚äÇ</mo><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>‚äÇ</mo><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo separator=\"true\">,</mo><mi>Z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">0\\subset(X)\\subset(X,Y)\\subset(X,Y,Z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6835em;vertical-align:-0.0391em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚äÇ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚äÇ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">‚äÇ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mclose\">)</span></span></span></span>, that being a chain of length 3 -- with four prime ideals in it. The prime ideal <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(X)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span></span></span></span> has got height 1 and the prime ideal <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> has got height 0. We certainly need to stick to these conventions in commutative algebra or we'll confuse everyone doing commutative algebra and algebraic geometry. If there are other conventions in other parts of mathematics (are there?) then we might have to namespace different concepts of height and document them well.</p>",
        "id": 454930306,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722281984
    },
    {
        "content": "<p>Oh, ok, but that's the height I'm currently calculating - minimal elements have height 0.</p>",
        "id": 454940088,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722284621
    },
    {
        "content": "<p><code>Set.chainHeight</code> is off by one. I think that it should be fixed, and possibly merged with <code>height</code> (which should take values in <code>ENat</code>). Also, Krull dimension should take values in <code>WithBot ENat</code> (defeq to <code>WithBot (WithTop Nat)</code> but we have lemmas about <code>ENat</code>).</p>",
        "id": 455122106,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722345796
    },
    {
        "content": "<p>I was already thinking that it might be nice to have <code>height</code> take a Set argument (since that is nicer than taking the height of a subtype). In that case it might be even easier to remove <code>chainHeight</code>.</p>",
        "id": 455126149,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722347017
    },
    {
        "content": "<p>It seems that there is always a tension between phrasing something in terms of sets or types? Certainly when defining it using a type is easier, and especially since (so far) there is always one set, I chose to define height without the additional restriction. My inclination is to keep it that way, and if you need the set-restriction use <code>Set.withHeight</code> or use the subtype, and maybe we can extend the API to make that more usable.</p>\n<p>But I don't have much experience with that aspect of API design, so maybe doing it all with sets is actually better. But it seems that then we'd also want a set-restricted version of or LTSeries?</p>",
        "id": 455169609,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722358542
    },
    {
        "content": "<p>Yet, a set-restricted version of <code>LTSeries</code> also seems good to me: it often shows up, and then you don't have to move to subtypes, which is often a bit annoying.</p>",
        "id": 455175616,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1722359793
    },
    {
        "content": "<p>BTW, is it really more convenient to work with <code>List</code>s rather than <code>Chain</code>s?</p>",
        "id": 455177629,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722360223
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/287929-mathlib4/topic/RelSeries.20vs.20List.2Echain.20vs.20Order.2Eheight/near/418092105\">said</a>:</p>\n<blockquote>\n<p>BTW, why not use something like this?</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">myHeight</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Œ±</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ENat</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">‚®Ü</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">‚äÜ</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsChain</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">‚ãÖ</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"bp\">‚ãÖ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">encard</span><span class=\"w\"> </span><span class=\"n\">t</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I mean this.</p>",
        "id": 455177795,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1722360258
    },
    {
        "content": "<p>Note to myself: the lemmas in <a href=\"https://github.com/leanprover-community/mathlib4/pull/15271/files\">https://github.com/leanprover-community/mathlib4/pull/15271/files</a> might allow me to define <code>height</code> more elegantly as a nested inf rather than an inf over a product. Will try once near a computer again</p>",
        "id": 455203853,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722367999
    },
    {
        "content": "<p>By the way, if you don't want to be dealing with <code>WithBot (WithTop Nat)</code> then note that the same information is captured by the predicates <code>HeightLT n</code> with n a natural.</p>",
        "id": 455231857,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1722378300
    },
    {
        "content": "<p>Brief update: I started fleshing out a nice module for <code>height</code> (and soon <code>krullDim</code>) with an API beyond what's needed for Carleson, and hope to PR that to mathlib in a few days or so. Hope I'm not accidentally duplicating someone else's work</p>",
        "id": 455645439,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722518147
    },
    {
        "content": "<p>Getting closer; just opened the draft PR at <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">https://github.com/leanprover-community/mathlib4/pull/15524</a>, but there is more cleanup and docstrings etc. to be done before it‚Äôs ready for review. Also, the whole <code>height</code> API ought to be be duplicated for <code>coheight</code>. I hope that clever tricks with defeq or a nice set of duality-simp rules will make this only repetitive.</p>",
        "id": 456596963,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722869539
    },
    {
        "content": "<p>Status update: The PR has now all the definitions and theorems I was planning to add, and everything that isn‚Äôt going into that file is in a separate PR:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15387\">feat(RelSeries): {head,last}_map¬†#15387</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15386\">feat(RelSeries): eraseLast_last_rel_last¬†#15386</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15384\">feat(RelSeries): head_singleton, last_singleton¬†#15384</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15383\">feat(LTSeries): toFun_add_sub_le_toFun_{int,nat}¬†#15383</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">feat(ENat): isup_add¬†#15344</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15555\">feat(RelSeries): LTSeries.iota¬†#15555</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15556\">feat(RelSeries): {last,head}_reverse¬†#15556</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15557\">feat(RelSeries): RelSeries.take and RelSeries.drop¬†#15557</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15558\">feat(ENat): CompleteLinearOrder (WithBot ENat)¬†#15558</a></li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/15560\">refactor(ConditionallyCompleteLattice): adhere to <code>csSup</code> vs. <code>sSup</code> naming convention¬†#15560</a></li>\n</ul>\n<p>Docstrings and module header not complete yet, but maybe I‚Äôll wait for the dependencies to go through first, in case some of them require non-trivial changes.</p>",
        "id": 456886774,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722958304
    },
    {
        "content": "<p>Why don't you consolidate your PRs? Some of them are just 10 lines or so long</p>",
        "id": 456983673,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1722992941
    },
    {
        "content": "<p>You mean after I spent time to nicely separate them into easily reviewable, separate PRs, some of them hopefully correctly labeled <code>easy</code>? :-)</p>\n<p>Ok, the <del>two</del> three adding <code>head/tail</code> lemmas to RelSeries functions could be one. I think in that case one was already underway when the need for the next one arose. But they are all <code>easy</code>, so hopefully not much difference either way.</p>",
        "id": 456986054,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722994824
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"598052\">@Jeremy Tan</span> why don't you review some of the PRs, and then you'll see how much easier it is to review a small one!</p>",
        "id": 457020354,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1723011728
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/457020354\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> why don't you review some of the PRs, and then you'll see how much easier it is to review a small one!</p>\n</blockquote>\n<p>I would consider a PR with 100 total changed lines small</p>",
        "id": 457022616,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723012576
    },
    {
        "content": "<p>I agree Joachim's definitions are possibly <em>a bit</em> too atomic (I would have personally put all the <code>RelSeries</code> lemmas in one PR), but it's definitely better to have too small PRs than two big ones</p>",
        "id": 457022860,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723012701
    },
    {
        "content": "<p>Yeah, for <code>{head,last}</code> it would have definitely be better to have a ‚ÄúI went through all definitions in the module and added the missing  lemmas‚Äù PR. Would have created this now that I have a few minutes, but two of those PRs have just been merged :)</p>\n<p>Adding <code>iota</code> and <code>take/drop</code> in separate PRs is maybe borderline useful as a separation. <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span>.</p>",
        "id": 457113062,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723038072
    },
    {
        "content": "<p>Could you please add <code>t-order</code> label to all/most of these PRs?</p>",
        "id": 457116026,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723038843
    },
    {
        "content": "<p>Will do!</p>",
        "id": 457116080,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723038860
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/457116026\">said</a>:</p>\n<blockquote>\n<p>Could you please add <code>t-order</code> label to all/most of these PRs?</p>\n</blockquote>\n<p>Would it make sense to automatically label PRs with <code>t-&lt;root_folder&gt;</code> for each root folder containing modifications?</p>",
        "id": 457127238,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723042037
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/457127238\">said</a>:</p>\n<blockquote>\n<p>Would it make sense to automatically label PRs with <code>t-&lt;root_folder&gt;</code> for each root folder containing modifications?</p>\n</blockquote>\n<p>This leads to the question, if we are formalizing a combinatorics theorem which required us to add a small helper function in the algebra folder, should we add <code>t-algebra</code> in addition to the <code>t-combinatorics</code>?</p>",
        "id": 457131500,
        "sender_full_name": "Rida Hamadani",
        "timestamp": 1723043177
    },
    {
        "content": "<p>Usually, no.</p>",
        "id": 457136134,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1723044308
    },
    {
        "content": "<p>I think that, if this is a desirable feature, then we can investigate what to do in such cases, whether the bot should add a single or multiple labels and what heuristics it should use.  I just wanted to see if some form of automatic labeling was potentially useful.</p>",
        "id": 457136831,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723044476
    },
    {
        "content": "<p>E.g. a simple test would be: if there is a single root folder modified, use that, otherwise do nothing.</p>",
        "id": 457137037,
        "sender_full_name": "Damiano Testa",
        "timestamp": 1723044528
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"321459\">Damiano Testa</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/457127238\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/457116026\">said</a>:</p>\n<blockquote>\n<p>Could you please add <code>t-order</code> label to all/most of these PRs?</p>\n</blockquote>\n<p>Would it make sense to automatically label PRs with <code>t-&lt;root_folder&gt;</code> for each root folder containing modifications?</p>\n</blockquote>\n<p><code>t-logic</code> would like to disagree</p>",
        "id": 457191550,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723061654
    },
    {
        "content": "<p>The list of depending PRs is getting smaller, so maybe time to get <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">https://github.com/leanprover-community/mathlib4/pull/15524</a> itself into shape.</p>\n<p><span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> , you mentioned that <code>height</code> should be namespaced. What namespace should I use? Simply <code>namesapce Order</code>? And should <code>krullDim</code> (which is less generic than <code>height</code>) also go into that same namesapce?</p>",
        "id": 460048912,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723457605
    },
    {
        "content": "<p>I think <code>Order.height</code> is a good name</p>",
        "id": 460049092,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1723457677
    },
    {
        "content": "<p>Is <code>krullDim</code> less generic across the board? In that case it could maybe just be removed? After all, mathlib doesn't have <code>vectorSpace</code>, so why should it have <code>krullDim</code>?</p>",
        "id": 460073101,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1723465888
    },
    {
        "content": "<p>Sorry, I meant the <em>name</em> is less generic than <code>height</code>, so the need to namespace <code>height</code> may not apply to <code>krullDim</code>. As mathematical concept‚Äôs, they are incomparable (one is for elements, the other one for types), and unless I am missing something both are useful.</p>",
        "id": 460105865,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723476736
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> has been missing from this project for a week now</p>",
        "id": 462013305,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723522134
    },
    {
        "content": "<p>I've just bumped the project to 4.11.0-rc2 at <a href=\"https://github.com/fpvandoorn/carleson/pull/109\">https://github.com/fpvandoorn/carleson/pull/109</a></p>",
        "id": 462013473,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1723522243
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"598052\">Jeremy Tan</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/462013305\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> has been missing from this project for a week now</p>\n</blockquote>\n<p>He may be on vacations. Such things are common at this time of the year.</p>",
        "id": 462057766,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1723539463
    },
    {
        "content": "<p>I was indeed on a break, and will not always be online for the next ~month. Expect some periods of time where I will be away for a week or so.<br>\nThanks for doing this very big bump!</p>",
        "id": 462218134,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1723586084
    },
    {
        "content": "<p>Status update: The last ‚Äútricky‚Äù dependency is in (topology on ENat), and the height PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">#15524</a> now only waits on <code>LTSeries.iota</code> (<a href=\"https://github.com/leanprover-community/mathlib4/pull/15555\">#15555</a>) before the <code>blocked-by-other-PR</code> label disappears and the PR shows upon the review queue</p>",
        "id": 463189077,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1723994491
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/460073101\">said</a>:</p>\n<blockquote>\n<p>Is <code>krullDim</code> less generic across the board? In that case it could maybe just be removed? After all, mathlib doesn't have <code>vectorSpace</code>, so why should it have <code>krullDim</code>?</p>\n</blockquote>\n<p>Mathlib <em>did</em> have <code>vector_space</code> back in the Lean 3 days, it was only <a href=\"https://github.com/leanprover-community/mathlib3/pull/7322\">removed</a> because we couldn't get it to work well with <code>module</code> in Lean 3. I think mathlib <em>should</em> have <code>VectorSpace k V</code> and the fact that we don't might just be a historical accident.</p>",
        "id": 463663996,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1724151586
    },
    {
        "content": "<p>The <code>height</code> refactoring PR (<a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">#15524</a>) is now dependency-free</p>",
        "id": 467536594,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725456553
    },
    {
        "content": "<p>This is quite huge still. Is there really nothing more you can split off?</p>",
        "id": 467539483,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1725457168
    },
    {
        "content": "<p>Hmm, let me page it back in, it‚Äôs been a while‚Ä¶</p>\n<p>Every second lemma is about <code>coheight</code>. I could move the introduction of <code>coheight</code> into a follow-up PR‚Ä¶ ah, but there is already a <code>coheight</code> definitions there, so that makes that awkward.</p>\n<p>The last 100lines or so are calculations for concrete orders; these can easily be moved into  a separate PR (or even many small ones). Not sure how much that helps.</p>\n<p>Or maybe I trim the PR to just the the parts needed to replace the existing definitions, and then one or more (or many) PRs that add new theorems.</p>\n<p>None of that really reduces the number of lines to look at, though <span aria-label=\"shrug\" class=\"emoji emoji-1f937\" role=\"img\" title=\"shrug\">:shrug:</span></p>",
        "id": 467566364,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725461987
    },
    {
        "content": "<p>Even if it doesn't really the number of lines, it certainly reduces the cognitive load!</p>",
        "id": 467568910,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1725462407
    },
    {
        "content": "<p>Yeah, I see that. I'll see what I can do.</p>",
        "id": 467568994,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725462422
    },
    {
        "content": "<p>Ok, +100loc, that may be a bit better: <a href=\"https://github.com/leanprover-community/mathlib4/pull/16480\">https://github.com/leanprover-community/mathlib4/pull/16480</a>. Thanks to <code>#show_unused</code> it was not too bad to trim this to the old API</p>",
        "id": 467576292,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725463815
    },
    {
        "content": "<p>Wow yes! Let me move over the comments I started writing</p>",
        "id": 467576529,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1725463862
    },
    {
        "content": "<p>Ah sorry for criss-crossing</p>",
        "id": 467577619,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725464100
    },
    {
        "content": "<p>No worries. <span aria-label=\"smiley\" class=\"emoji emoji-1f603\" role=\"img\" title=\"smiley\">:smiley:</span></p>",
        "id": 467577811,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1725464147
    },
    {
        "content": "<p>Thanks Ya√´l for the low-latency review of the first PR! Next batch up at <a href=\"https://github.com/leanprover-community/mathlib4/pull/16500\">https://github.com/leanprover-community/mathlib4/pull/16500</a></p>",
        "id": 467819899,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725534835
    },
    {
        "content": "<p>Thanks Ya√´l again! Next batch up at¬†<a href=\"https://github.com/leanprover-community/mathlib4/pull/16555\">https://github.com/leanprover-community/mathlib4/pull/16555</a>. I keep hitting nice numbers. (Or maybe most numbers are nice.)</p>",
        "id": 468392134,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725705735
    },
    {
        "content": "<p>I wanted to link to the \"smallest uninteresting number\" xkcd but apparently I dreamt it up <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 468395341,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1725708408
    },
    {
        "content": "<p>Hmm, I know what you mean, but not sure if it was xkcd</p>",
        "id": 468396218,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1725709036
    },
    {
        "content": "<p>There is <a href=\"https://en.wikipedia.org/wiki/Interesting_number_paradox\">wikipedia</a> for sure</p>",
        "id": 468546487,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1725791883
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"111080\">Floris van Doorn</span> <a href=\"#narrow/stream/442935-Carleson/topic/Task.2052/near/462218134\">said</a>:</p>\n<blockquote>\n<p>I was indeed on a break, and will not always be online for the next ~month.</p>\n</blockquote>\n<p>hmm, it's been about a month now</p>",
        "id": 468670922,
        "sender_full_name": "Jeremy Tan",
        "timestamp": 1725856260
    },
    {
        "content": "<p>JFTR, in case someone looks at this thread:<br>\n<a href=\"https://github.com/leanprover-community/mathlib4/pull/16555\">#16555</a> is now waiting on <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span> ‚Äôs <a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">#15344</a> (which was ready, but got a merge conflict three days ago, which I hope I just fixed).</p>",
        "id": 480043291,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1730463884
    },
    {
        "content": "<p>Thanks to <span class=\"user-mention\" data-user-id=\"387244\">@Ya√´l Dillies</span>‚Äôs tireless reviewing the 28 PRs split off <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">#15524</a> are now in, and we can conclude this upstreaming with <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">#15524</a> itself (which is mostly just the module doc string).</p>",
        "id": 483487601,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1732110502
    },
    {
        "content": "<p>28?!? <span aria-label=\"flushed\" class=\"emoji emoji-1f633\" role=\"img\" title=\"flushed\">:flushed:</span></p>",
        "id": 483487664,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1732110523
    },
    {
        "content": "<ul>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15421\">#15421</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15385\">#15385</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15347\">#15347</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15345\">#15345</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15342\">#15342</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15341\">#15341</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15196\">#15196</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15387\">#15387</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15386\">#15386</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15384\">#15384</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15344\">#15344</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15555\">#15555</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15556\">#15556</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15557\">#15557</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15558\">#15558</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/15601\">#15601</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/16480\">#16480</a></li>\n<li>[x]  <a href=\"https://github.com/leanprover-community/mathlib4/pull/16500\">#16500</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/16555\">#16555</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19003\">#19003</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19028\">#19028</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19110\">#19110</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19111\">#19111</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19147\">#19147</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19148\">#19148</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19155\">#19155</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19210\">#19210</a></li>\n<li>[x] <a href=\"https://github.com/leanprover-community/mathlib4/pull/19251\">#19251</a></li>\n</ul>",
        "id": 483487790,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1732110571
    },
    {
        "content": "<p>And the branch of <a href=\"https://github.com/leanprover-community/mathlib4/pull/15524\">#15524</a> accumulated 204 commits (although that‚Äôs an inflated number, due to lots of merge commits and duplications due to squash-merging the dependent PRs)</p>",
        "id": 483488025,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1732110636
    },
    {
        "content": "<p>And merged. With the next mathlib bump we‚Äôll see how much of <a href=\"https://github.com/fpvandoorn/carleson/blob/master/Carleson/ToMathlib/Height.lean\">https://github.com/fpvandoorn/carleson/blob/master/Carleson/ToMathlib/Height.lean</a> and <a href=\"https://github.com/fpvandoorn/carleson/blob/master/Carleson/ToMathlib/MinLayer.lean\">https://github.com/fpvandoorn/carleson/blob/master/Carleson/ToMathlib/MinLayer.lean</a> can now actually be removed, or if during upstreaming things have changed a bit and there are more lemmas needed.</p>",
        "id": 483505548,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1732115096
    },
    {
        "content": "<p>Great! Thanks for this! That's a lot of small PRs... <span aria-label=\"amazement\" class=\"emoji emoji-1fae2\" role=\"img\" title=\"amazement\">:amazement:</span></p>",
        "id": 483513971,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1732117138
    },
    {
        "content": "<p>Small PRs is a great way to get stuff into mathlib these days!</p>",
        "id": 483846965,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732258225
    },
    {
        "content": "<p>Yesterday, a PR bumping to recent mathlib was merged. I removed everything in <code>Height.lean</code>, as that had been upstreamed.<br>\n<span class=\"user-mention\" data-user-id=\"470149\">@Joachim Breitner</span>  It's not clear to me if something in <code>MinLayer.lean</code> can also be removed. Would you like to take a look? Thanks!</p>",
        "id": 483879842,
        "sender_full_name": "Michael Rothgang",
        "timestamp": 1732271095
    },
    {
        "content": "<p>I have a gut feeling that maybe we don't need the minlayer abstraction, or that it would be more natural to be defined as the preimage under <code>height</code>, but such gut feeling can be misleading, and it'd only be a nice-to-have gut feeling. I don't know if I'll have time to have a look soon, but it's also not really pressing for the project, is it?</p>",
        "id": 483888643,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1732274237
    }
]