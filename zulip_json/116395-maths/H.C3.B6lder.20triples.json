[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110050\">@SÃ©bastien GouÃ«zel</span> , <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> I have just created <a href=\"https://github.com/leanprover-community/mathlib4/pull/21583\">#21583</a> and marked it as RFC. This PR introduces a <code>ENNReal.HolderTriple</code> class which just says that <code>1 / r = 1 / p + 1 / q</code>. This makes it possible to define an <code>HMul</code> instance on <code>MeasureTheory.Lp</code>. From there I develop the natural map from <code>Lp ğ•œ p Î¼</code> into the dual of <code>Lp ğ•œ q Î¼</code> for <code>HolderTriple 1 p q</code>.</p>\n<p>Let me know what you think. I've left out <code>simp</code> lemmas and various other details from the PR for now until I get some feedback from you about it.</p>",
        "id": 498533111,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739046081
    },
    {
        "content": "<p>I guess you could also do this with <code>Fact</code>?</p>",
        "id": 498547688,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739058990
    },
    {
        "content": "<p>I think not because you need <code>r</code> to be at least a <code>semiOutParam</code>? I'll double check though.</p>",
        "id": 498549770,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739060916
    },
    {
        "content": "<p>If there is no feedback from me in the next 20h, then please don't wait for it, as I'm travelling Feb 9-15</p>",
        "id": 498556811,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739067646
    },
    {
        "content": "<p>This looks very nice! I'm just wondering about the generality, as always: if <code>f</code> is a scalar-valued function in <code>L^p</code> and <code>g</code> is a vector-valued function in <code>L^q</code>, should we also introduce <code>f â€¢ g</code> for the vector-valued function in <code>L^r</code> (which would specialize to your construction when <code>g</code> is in fact scalar-valued)? And for the duality statement, for a general normed vector space <code>E</code>, there is a natural map from <code>Lp (Dual E) p</code> to <code>Dual (Lq E q)</code>, should we look at this one (and at the specialized one when <code>E</code> is a Hilbert space) or just at the one-dimensional case?</p>",
        "id": 498573963,
        "sender_full_name": "SÃ©bastien GouÃ«zel",
        "timestamp": 1739084358
    },
    {
        "content": "<p>I think these generalizations all make sense, and we should do those. If we need bespoke material for one dimension we can do that when we need it.</p>",
        "id": 498623212,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739126501
    },
    {
        "content": "<p>BTW, should we use <code>HMul</code>/<code>HSMul</code> or a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.convolution#doc\">docs#MeasureTheory.convolution</a> style operator?</p>",
        "id": 498623743,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1739126923
    },
    {
        "content": "<p>To expand Yury's comment: I also think it might be nice to work with vector-valued functions and a bilinear map, like we do with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.convolution#doc\">docs#MeasureTheory.convolution</a>. Then this can be instantiated to (scalar) multiplication.</p>\n<p>Btw, my experience is to avoid <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Lp#doc\">docs#MeasureTheory.Lp</a> as much as possible, and work with explicit functions instead. But it's possible of course that with more API using these quotients is also feasible, so I'm definitely not against adding this to Mathlib.</p>",
        "id": 498717870,
        "sender_full_name": "Floris van Doorn",
        "timestamp": 1739182115
    },
    {
        "content": "<p>I agree that using <code>Lp</code> explicitly is generally not desirable, but sometimes you need it to state the correct result. For example, we will I think need the ultraweak topology on <code>Lp \\infty</code> in order to state the Borel functional calculus properly, even though the API for it will still use bare functions.</p>",
        "id": 498762378,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739194422
    },
    {
        "content": "<p>I just had a look at <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.convolution#doc\">docs#MeasureTheory.convolution</a>, as I wasn't really familiar with it prior to this. <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> can you expand on this comment? What exactly are you wanting to replace with something that looks like this? Just the <code>toDual</code> map I have in the PR, or am I missing something bigger?</p>",
        "id": 498815843,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739207185
    },
    {
        "content": "<p>Nevermind, I think I understand. This, right?</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Î¼</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Î±</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NontriviallyNormedField</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">NormedAddCommGroup</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormedSpace</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">â„</span><span class=\"bp\">â‰¥</span><span class=\"mi\">0</span><span class=\"bp\">âˆ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">HolderTriple</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"o\">)]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">â‰¤</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)]</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">Lp</span><span class=\"bp\">.</span><span class=\"n\">applyBilinear</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Lp</span><span class=\"w\"> </span><span class=\"n\">E</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">Î¼</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Lp</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"n\">Î¼</span><span class=\"w\"> </span><span class=\"bp\">â†’</span><span class=\"n\">L</span><span class=\"o\">[</span><span class=\"n\">ğ•œ</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Lp</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"n\">Î¼</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">mkContinuousâ‚‚</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">LinearMap</span><span class=\"bp\">.</span><span class=\"n\">mkâ‚‚</span><span class=\"w\"> </span><span class=\"n\">ğ•œ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">â†¦</span><span class=\"w\"> </span><span class=\"n\">Memâ„’p</span><span class=\"bp\">.</span><span class=\"n\">toLp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">â†¦</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"bp\">â€–</span><span class=\"n\">B</span><span class=\"bp\">â€–</span>\n<span class=\"w\">    </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 498869688,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739223759
    },
    {
        "content": "<p>Related issue: <a href=\"https://github.com/leanprover-community/mathlib4/pull/6108\">#6108</a></p>",
        "id": 498873023,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1739224910
    },
    {
        "content": "<p>Anatole, the links in <a href=\"https://github.com/leanprover-community/mathlib4/pull/6108\">#6108</a> are broken. Do you remember what you were referencing exactly?</p>",
        "id": 498880528,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739227773
    },
    {
        "content": "<p>I guess the lemma was <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.eLpNorm_le_eLpNorm_mul_eLpNorm_of_nnnorm#doc\">docs#MeasureTheory.eLpNorm_le_eLpNorm_mul_eLpNorm_of_nnnorm</a></p>",
        "id": 498880779,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739227863
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 498899388,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739235287
    },
    {
        "content": "<p>I've created <a href=\"https://github.com/leanprover-community/mathlib4/pull/21792\">#21792</a> to address <a href=\"https://github.com/leanprover-community/mathlib4/pull/6108\">#6108</a> and now <a href=\"https://github.com/leanprover-community/mathlib4/pull/21583\">#21583</a> depends on this. In addition, <a href=\"https://github.com/leanprover-community/mathlib4/pull/21583\">#21583</a> implements the convolution-style bilinear map approach, and uses it to get the map <code>Lp (Dual ğ•œ E) p Î¼ â†’L[ğ•œ] Dual ğ•œ (Lp E q Î¼)</code>. Finally, I switch from <code>mul</code> to <code>smul</code>, but I left it as a separate construction (i.e., I did not use the bilinear map construction) because it is possible to get slightly more general results without it. If we decide this slight increase in generality isn't worth it, I can implement <code>â€¢</code> via the bilinear map approach. It's close to the same amount of work either way.</p>\n<p>There are probably still some missing <code>simp</code> lemmas, and perhaps some other small bits of clean-up before I would put it on the queue for review, but right now it's still marked RFC, so please comment.</p>",
        "id": 499342492,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739400231
    },
    {
        "content": "<p>I will look at this tomorrow, sorry for the delay.</p>",
        "id": 499603426,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1739488226
    },
    {
        "content": "<p>I think I've converged on something pretty nice:</p>\n<ul>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21854\">#21854</a> implements the <code>HolderTriple</code> type class, and does nothing else</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21792\">#21792</a> generalizes the existing HÃ¶lder inequality results to more general continuous bilinear forms per <a href=\"https://github.com/leanprover-community/mathlib4/pull/6108\">#6108</a>, and makes use of the new type class. (Sorry there was some variable shuffling here also.)</li>\n<li><a href=\"https://github.com/leanprover-community/mathlib4/pull/21583\">#21583</a> puts it together and defines for <code>B : E â†’L[ğ•œ] F â†’L[ğ•œ]</code> a map <code>B.holder : Lp p E Î¼ â†’ Lp q E Î¼ â†’ Lp r E Î¼</code>, and upgrades it so a continuous linear map under appropriate hypotheses. It also defines an <code>HSMul</code> instance for <code>Lp</code> spaces.</li>\n</ul>",
        "id": 499603764,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739488412
    },
    {
        "content": "<p>no problem, I am in no rush.</p>",
        "id": 499603812,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1739488438
    },
    {
        "content": "<p>I've just looked at the (now merged) <a href=\"https://github.com/leanprover-community/mathlib4/pull/21792\">#21792</a>, and indeed I think it solves everything I had in mind when writing <a href=\"https://github.com/leanprover-community/mathlib4/pull/6108\">#6108</a> (although to be fair I don't remember exactly what the state of this file was at the time).</p>",
        "id": 500869205,
        "sender_full_name": "Anatole Dedecker",
        "timestamp": 1740055606
    },
    {
        "content": "<p><span aria-label=\"ping pong\" class=\"emoji emoji-1f3d3\" role=\"img\" title=\"ping pong\">:ping_pong:</span> on <a href=\"https://github.com/leanprover-community/mathlib4/pull/21583\">#21583</a>. I think there's not much left to do here, unless someone says otherwise.</p>",
        "id": 503087057,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1741023851
    }
]