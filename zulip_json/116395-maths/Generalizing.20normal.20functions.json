[
    {
        "content": "<p>I've been thinking on and off for the past few days about generalizing <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ordinal.IsNormal#doc\">docs#Ordinal.IsNormal</a> to functions with arbitrary (well-ordered) domain and codomain.</p>",
        "id": 483587192,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144171
    },
    {
        "content": "<p>The motivation here is that there are some functions, particularly between ordinals and cardinals, which are morally normal but which we can't currently state as such. These are:</p>\n<ul>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Cardinal.ord#doc\">docs#Cardinal.ord</a></li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Cardinal.aleph#doc\">docs#Cardinal.aleph</a> (and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Cardinal.preAleph#doc\">docs#Cardinal.preAleph</a>)</li>\n<li><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Cardinal.beth#doc\">docs#Cardinal.beth</a></li>\n</ul>",
        "id": 483587488,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144326
    },
    {
        "content": "<p>This generalized definition could also potentially be useful in results about cofinality. The cofinality of a well-order <code>α</code> is the least ordinal <code>o</code> such that there exists a normal function <code>Iio o → α</code> with unbounded range.</p>",
        "id": 483587681,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144443
    },
    {
        "content": "<p>Likewise, if for whatever reason we want to talk about club sets in arbitrary well-orders, we can show they're precisely the ranges of unbounded normal functions.</p>",
        "id": 483587864,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144554
    },
    {
        "content": "<p>Now, the thing about doing this generalization is that it opens up a whole can of worms about whether it even makes sense to have normal functions, since they're exactly the same as strictly monotonic continuous functions (wrt the order topology).</p>",
        "id": 483588005,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144622
    },
    {
        "content": "<p>Maybe it's undesirable to have ordinals importing topology? But on the other hand, defining normal functions like this avoids a bunch of duplication: it'd become much simpler to prove that normal functions commute with suprema, or that the composition of normal functions is normal.</p>",
        "id": 483588149,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144700
    },
    {
        "content": "<p>Moreover, talking about continuous functions in general means we can also talk about (non-strictly) monotonic continuous functions, which appear for instance as ordinal collapsing functions (something I'm working on in my own repo)</p>",
        "id": 483588259,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144764
    },
    {
        "content": "<p>It seems perhaps more elegant to show that e.g. multiplication is always continuous on the right, instead of proving it's normal on the right for a non-zero left argument.</p>",
        "id": 483588381,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144813
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"565854\">@Nir Paz</span> Thoughts?</p>",
        "id": 483588391,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732144824
    },
    {
        "content": "<p>Are ordinals imported in many files that don't currently import topology? What is the impact of importing <code>Topology.Algebra.Monoid</code> in <code>SetTheory.Ordinal.Arithmetic</code>, for example?</p>",
        "id": 483616679,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732164085
    },
    {
        "content": "<p>That seems likely to be a bad idea.</p>",
        "id": 483618020,
        "sender_full_name": "Kim Morrison",
        "timestamp": 1732165216
    },
    {
        "content": "<p>Yeah, it seems fairly bad, see <a href=\"https://github.com/leanprover-community/mathlib4/pull/19320\">#19320</a> (it also violates the two <code>assert_not_exists</code> there)</p>",
        "id": 483619411,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732166296
    },
    {
        "content": "<p>Although I don't know how many of these files actually depend on <code>Ordinal.IsNormal</code> - perhaps that could be split into a separate file, which would then import topology?</p>",
        "id": 483619657,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732166526
    },
    {
        "content": "<p>A lot of ordinal arithmetic depends on normal functions.</p>",
        "id": 483625926,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732171057
    },
    {
        "content": "<p>Although, not many applications of ordinals depend on ordinal arithmetic beyond perhaps basic sums and products.</p>",
        "id": 483625998,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732171088
    },
    {
        "content": "<p>Currently <code>SetTheory.Ordinal.Arithmetic</code> is a monolith of a file, containing the basic results of ordinal arithmetic but also the definition of <code>omega0</code> and lemmas on the lattice structure of ordinals.</p>",
        "id": 483626218,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732171223
    },
    {
        "content": "<p><code>omega0</code> (at least the basic results) can likely be moved to <code>SetTheory.Ordinal.Basic</code>, while most of the lattice stuff is in some step of being completely deprecated or generalized.</p>",
        "id": 483626342,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732171296
    },
    {
        "content": "<p>I think it'd be interesting to see how many files still need ordinal arithmetic after finishing this whole refactor business. Ideally I'd expect nothing beyond more ordinal arithmetic to depend on it.</p>",
        "id": 483626550,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732171413
    },
    {
        "content": "<p>Is one solution simply to split <code>SetTheory.Ordinal.Arithmetic</code> into the \"simple\" part (ie <code>.Basic</code>) and the more technical part? (Oh -- Daniel already suggested this, sorry)</p>",
        "id": 483639186,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1732177506
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"459227\">Violeta Hernández</span> <a href=\"#narrow/channel/116395-maths/topic/Generalizing.20normal.20functions/near/483625926\">said</a>:</p>\n<blockquote>\n<p>A lot of ordinal arithmetic depends on normal functions.</p>\n</blockquote>\n<p>Perhaps our current proofs rely on it too much, though. For instance <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ordinal.mul_le_mul_iff_left#doc\">docs#Ordinal.mul_le_mul_iff_left</a> uses that multiplication is normal when really it should be possible to prove it at the relation embedding level.</p>",
        "id": 483639512,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732177644
    },
    {
        "content": "<p>I of course don't like the idea of normal functions being defined topologically, but there's no need to repeat that discussion haha.</p>\n<p>For the suggestion, I agree it would be nice to state all these function are normal directly, just like the <code>omega</code> function simplified all the normality arguments about the aleph function.</p>\n<p>But all the recent <code>iSup</code>-<code>Small</code> api is specific for ordinals, right? It's a bit sus to add a definition that talks about <code>iSup</code> to arbitrary well orders, without them having the api to reason about <code>iSup</code> very well.</p>",
        "id": 483649266,
        "sender_full_name": "Nir Paz",
        "timestamp": 1732181067
    },
    {
        "content": "<p>Oh I just looked, normal functions don't use <code>iSup</code> in the definition. But it is often something you use to work with them.</p>",
        "id": 483649985,
        "sender_full_name": "Nir Paz",
        "timestamp": 1732181302
    },
    {
        "content": "<p>Perhaps we could have a <code>SetTheory.Ordinal.Topology</code> file which shows the equivalence of <code>IsNormal</code> to being continuous and strictly monotonic, and that addition and multiplication are continuous</p>",
        "id": 483650087,
        "sender_full_name": "Daniel Weber",
        "timestamp": 1732181340
    },
    {
        "content": "<p>We already have a <code>SetTheory.Ordinal.Topology</code> file that proves the equivalence of <code>IsNormal</code> to being continues and strictly monotonic <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 483651381,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732181747
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Ordinal.isNormal_iff_strictMono_and_continuous#doc\">docs#Ordinal.isNormal_iff_strictMono_and_continuous</a></p>",
        "id": 483651464,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732181763
    },
    {
        "content": "<p>We don't prove addition and multiplication are continuous because they're not. They're just continuous on the right.</p>",
        "id": 483651665,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732181829
    },
    {
        "content": "<p>It would be nice to have parts of the ordinal arithmetic that are needed for cardinal arithmetic with minimal dependencies. IMHO, cardinal arithmetic is what matters most in other parts of the library (e.g., dimensions etc), while advanced ordinal arithmetic is used much less in the library (am I wrong?)</p>",
        "id": 483801691,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1732228681
    },
    {
        "content": "<p>I opened <a href=\"https://github.com/leanprover-community/mathlib4/pull/20504\">#20504</a> where I \"generalize\" normal functions to functions between well-orders. Even if the intended definition of normal functions is just \"strictly monotonic and continuous\" I think it's fine to collect all the other standard (and often more useful) definitions in terms of least upper bounds / suprema into their own predicate.</p>",
        "id": 492253551,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1736233431
    }
]