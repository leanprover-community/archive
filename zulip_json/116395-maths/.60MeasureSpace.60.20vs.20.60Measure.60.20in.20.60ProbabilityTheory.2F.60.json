[
    {
        "content": "<p>Some files (and lots of notation) in <code>ProbabilityTheory/</code> assume <code>[MeasureSpace _]</code>. This makes them hard to use if I have <code>Œº : Measure _</code> with <code>[IsProbabilityMeasure]</code>.</p>",
        "id": 476526619,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728741888
    },
    {
        "content": "<p>I suggest that we migrate to writing theory in terms of <code>{P : Measure Œ©} [IsProbabilityMeasure P]</code>.</p>",
        "id": 476526675,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728741943
    },
    {
        "content": "<p>What you suggest is the way things are supposed to be done currently? I am surprised by that claim. There are indeed notations that are specific to MeasureSpace, but they should not be used much in Mathlib.<br>\nWhat are the files that use MeasureSpace?</p>",
        "id": 476528589,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728743688
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">Distributions</span><span class=\"bp\">/</span><span class=\"n\">Gaussian</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">314</span><span class=\"o\">:</span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">Notation</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">39</span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">condexp</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"bp\">.</span><span class=\"n\">MeasureSpace</span><span class=\"bp\">.</span><span class=\"n\">volume</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">StrongLaw</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">208</span><span class=\"o\">:</span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsProbabilityMeasure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">‚Ñô</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">)]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">StrongLaw</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">606</span><span class=\"o\">:</span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">strong_law_ae_real</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">StrongLaw</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">643</span><span class=\"o\">:</span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsProbabilityMeasure</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">‚Ñô</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Measure</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">)]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">StrongLaw</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">790</span><span class=\"o\">:</span><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"n\">strong_law_ae</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">StrongLaw</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">826</span><span class=\"o\">:</span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Œ©</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span>\n<span class=\"n\">Mathlib</span><span class=\"bp\">/</span><span class=\"n\">Probability</span><span class=\"bp\">/</span><span class=\"n\">Variance</span><span class=\"bp\">.</span><span class=\"n\">lean</span><span class=\"o\">:</span><span class=\"mi\">181</span><span class=\"o\">:</span><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasureSpace</span><span class=\"w\"> </span><span class=\"n\">Œ©</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 476552743,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728767243
    },
    {
        "content": "<p>This <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span> is the output of <code>git grep ¬†-n MeasureSpace Mathlib/Probability/ | grep -v notation</code></p>",
        "id": 476552754,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728767262
    },
    {
        "content": "<p>Should I just change them to <code>{P : Measure Œ©}</code>?</p>",
        "id": 476552818,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728767321
    },
    {
        "content": "<p>Also, should we add variants of the notations that take measure argument?</p>",
        "id": 476552851,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728767373
    },
    {
        "content": "<p>Like we have for integral.</p>",
        "id": 476552860,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728767391
    },
    {
        "content": "<p>In the strong law of large numbers file, it's a long and complicated argument, where having the measure space with a probability measure is really convenient for the notations. However, it would definitely make sense to restate the last theorems in a <code>MeasurableSpace</code> setting.</p>",
        "id": 476580646,
        "sender_full_name": "S√©bastien Gou√´zel",
        "timestamp": 1728800618
    },
    {
        "content": "<p>Ok, that's really just a few declarations in 3 files, and not a general thing across the Probability folder. Yes, we should generalize those results.</p>\n<p>You also say that lots of notation assume MeasureSpace and want to add variants that take measure arguments. Which notations are those? All the MeasureSpace specific notations defined in Probability/Notation already have counterparts for generic measures.<br>\nThe only notations I can identify that don't have variants with a measure argument are the two notations for variance. Are there others?</p>",
        "id": 476587727,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728806871
    },
    {
        "content": "<p>PR for the strong law of large numbers at <a href=\"https://github.com/leanprover-community/mathlib4/pull/17692\">#17692</a>. It's slightly less readable IMHO (one needs to add quite a bit of <code>‚àÇŒº</code> or <code>Œº</code>, and one loses the nice notation ùîº`), but not so bad.</p>",
        "id": 476590046,
        "sender_full_name": "S√©bastien Gou√´zel",
        "timestamp": 1728809282
    },
    {
        "content": "<p>Expectation?</p>",
        "id": 476611276,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728830420
    },
    {
        "content": "<p>Yes, expectation with respect to volume in a measure space. That's the standard notation for expectation in probability theory. With a measurable space, you have to specify the measure, so it can't be as nice.</p>",
        "id": 476612784,
        "sender_full_name": "S√©bastien Gou√´zel",
        "timestamp": 1728831770
    },
    {
        "content": "<p>IMHO, if we can still use <code>ùîº</code>, then it's not that bad.</p>",
        "id": 476614537,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728833320
    },
    {
        "content": "<p>Because sometimes you want to apply it to a non-standard measure.</p>",
        "id": 476614560,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728833352
    },
    {
        "content": "<p>There is an expectation notation for a non-volume measure: for a measure <code>¬µ</code> and a random variable <code>X</code>, <code>¬µ[X]</code> is the expectation of X.<br>\nIt does not use the character <code>ùîº</code>, but it correspond to a notation that some people actually use in paper maths, and it is shorter than any notation that would use <code>ùîº</code> in which you would have to specify the measure.</p>",
        "id": 476615761,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728834425
    },
    {
        "content": "<p>I was also confused recently about the difference between <code>MeasureSpace</code> and <code>Measure</code>, and which one should I use. By the way, I made a PR for variance <a href=\"https://github.com/leanprover-community/mathlib4/pull/17702\">#17702</a>.</p>",
        "id": 476616159,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1728834756
    },
    {
        "content": "<p>(Background: I had a personal communication with <span class=\"user-mention\" data-user-id=\"558149\">@Kei TSUKAMOTO</span> that he came across this issue when working on <a href=\"#narrow/stream/287929-mathlib4/topic/Hoeffding's.20lemma\">hoeffding</a>.)</p>",
        "id": 476616742,
        "sender_full_name": "Yuma Mizuno",
        "timestamp": 1728835296
    },
    {
        "content": "<p>What do you think about <code>Var[X] ‚àÇŒº</code> as notation for <code>variance X Œº</code>?</p>",
        "id": 476681480,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728884649
    },
    {
        "content": "<p>How does that interact with integrals? (ok, you don't often integrate a variance, but...)</p>\n<p>In the PFR project we had a general convention of adding <code>; ¬µ</code> to the notation to make the measure explicit. For example the entropy of a random variable in a MeasureSpace is <code>H[X]</code> and the corresponding notation in a MeasurableSpace+Measure is <code>H[X ; ¬µ]</code>. Same for the Ruzsa distance: we have <code>d[X # Y]</code> or <code>d[X ; ¬µ # Y ; ¬µ']</code>.<br>\nWhat do you think of using <code>Var[X ; ¬µ]</code>?</p>",
        "id": 476702131,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728891019
    },
    {
        "content": "<p>I actually find that convention a bit confusing (because intuitively <code>;</code> has quite low precedence). What about using <code>~</code> instead of <code>;</code>, so that it looks like <code>d[X ~ ¬µ # Y ~ ¬µ']</code>?</p>",
        "id": 476702504,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1728891094
    },
    {
        "content": "<p><code>X ~ ¬µ</code> is usual notation for \"X has law ¬µ\", which is not what it means here (X has law <code>¬µ.map X</code>).</p>",
        "id": 476702885,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728891190
    },
    {
        "content": "<p>So I don't like it so much. But if you don't like <code>;</code> we can presumably find something else.</p>",
        "id": 476703002,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728891219
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"350992\">R√©my Degenne</span> <a href=\"#narrow/stream/116395-maths/topic/.60MeasureSpace.60.20vs.20.60Measure.60.20in.20.60ProbabilityTheory.2F.60/near/476702885\">said</a>:</p>\n<blockquote>\n<p><code>X ~ ¬µ</code> is usual notation for \"X has law ¬µ\", which is not what it means here (X has law <code>¬µ.map X</code>).</p>\n</blockquote>\n<p>I know, which is why I suggested something like that. But I guess we need a different symbol to <code>~</code>... <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 476703189,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1728891259
    },
    {
        "content": "<p>(why did we use <code>#</code> instead of  a comma in the distance notation?)</p>",
        "id": 476703257,
        "sender_full_name": "R√©my Degenne",
        "timestamp": 1728891276
    },
    {
        "content": "<p>Maybe to avoid confusion with lists? but the leading <code>d</code> is enough to disambiguate</p>",
        "id": 476703504,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1728891334
    },
    {
        "content": "<p>What about <code>Var_¬µ[X]</code>?</p>",
        "id": 477935695,
        "sender_full_name": "Thomas Zhu",
        "timestamp": 1729466035
    },
    {
        "content": "<p>That's risky when your variance has a space in its name, eg <code>Var_Œº + ŒΩ[X]</code> looks like it won't make Lean happy (nor me, as a matter of fact)</p>",
        "id": 477973934,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1729493585
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/channel/116395-maths/topic/.60MeasureSpace.60.20vs.20.60Measure.60.20in.20.60ProbabilityTheory.2F.60/near/476681480\">said</a>:</p>\n<blockquote>\n<p>What do you think about <code>Var[X] ‚àÇŒº</code> as notation for <code>variance X Œº</code>?</p>\n</blockquote>\n<p>I am adding notation <code>Var[X ; Œº]</code> in <a href=\"https://github.com/leanprover-community/mathlib4/pull/20901\">#20901</a>.</p>",
        "id": 495061218,
        "sender_full_name": "Ya√´l Dillies",
        "timestamp": 1737469044
    }
]