[
    {
        "content": "<p>I am reading chapter 7 of  \"Mathematics in Lean\" and am somewhat mystified by the proofs on lines 110-127 of:</p>\n<p><a href=\"https://github.com/leanprover-community/mathematics_in_lean/blob/master/MIL/C07_Hierarchies/solutions/Solutions_S03_Subobjects.lean\">https://github.com/leanprover-community/mathematics_in_lean/blob/master/MIL/C07_Hierarchies/solutions/Solutions_S03_Subobjects.lean</a></p>\n<p>In particular, I have the following questions:</p>\n<p>(1) At the beginning of the proof for \"mul\", the proof state is like this:</p>\n<p><a href=\"/user_uploads/3121/BTPzvOgR-gEnTp_P1AQF70U_/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/BTPzvOgR-gEnTp_P1AQF70U_/image.png\" title=\"image.png\"><img data-original-dimensions=\"594x136\" src=\"/user_uploads/thumbnail/3121/BTPzvOgR-gEnTp_P1AQF70U_/image.png/840x560.webp\"></a></div><p>First of all, I do not know how to read the goal after the ⊢.  Second, I don't understand how the \"rintro\" on line 112 matches the goal.</p>\n<p>(2) After the \"rintro\", the goal looks like this:</p>\n<p><a href=\"/user_uploads/3121/oS7_V5AHbTX1Xs7NX6Vf1hY0/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/oS7_V5AHbTX1Xs7NX6Vf1hY0/image.png\" title=\"image.png\"><img data-original-dimensions=\"525x25\" src=\"/user_uploads/thumbnail/3121/oS7_V5AHbTX1Xs7NX6Vf1hY0/image.png/840x560.webp\"></a></div><p>I understand what the goal means (namely, a1<em>a2 and b1</em>b2 should satisfy the relation Setoid.r).  But I don't understand how the \"refine\" tactic works here.</p>\n<p>(3) The arguments of the \"rintro\" tactic son lines 118, 125, and 127 are enclosed in angle brackets.  I understand what is happening: we are introducing variables for representatives of the equivalence classes, not the equivalence classes themselves.  But I don't understand why the angle brackets have such capabilities.</p>",
        "id": 483188954,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1731996559
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Data/Quot.html#Quotient.map%E2%82%82'\">Quotient.map₂'</a></p>",
        "id": 483201011,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732002935
    },
    {
        "content": "<p>Honestly I'm confused too, I hadn't come across <code>⇒</code> before...</p>",
        "id": 483201832,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732003249
    },
    {
        "content": "<p>The angle brackets don't have the capability of introducing representatives for equivalence classes. I think that's being done implicitly by <code>Quotient.map₂'</code>.</p>",
        "id": 483201997,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732003310
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 483202204,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732003384
    },
    {
        "content": "<p>What I <em>presume</em> <code>Quotient.map₂'</code> does is: given a function <code>f : α → β → γ</code>, and a guarantee that equivalent terms in <code>α</code> and <code>β</code> yield equivalent terms in <code>γ</code>, it lifts the function to the respective quotients</p>",
        "id": 483202776,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732003621
    },
    {
        "content": "<p>What the angle brackets are actually destructing are the proofs that <code>a₁</code>, <code>b₁</code> and <code>a₂</code>, <code>b₂</code>, are equivalent</p>",
        "id": 483203373,
        "sender_full_name": "Violeta Hernández",
        "timestamp": 1732003844
    },
    {
        "content": "<p>I am reading this currently too and I found this first part and second part is hard to understand too. But for reading <code>Setoid.r ⇒ Setoid.r ⇒ Setoid.r</code> I find that the fact <code>⇒</code> is right associated quite helpful. Hence it’s same as <code>Setoid.r ⇒ (Setoid.r ⇒ Setoid.r)</code> and then unravel the definition for <code>⇒</code> twice and it gives the same intuition in math</p>",
        "id": 483223930,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1732010503
    },
    {
        "content": "<p>But for the solution for <code>mul_assoc</code> and <code>one_mul</code> etc, I am surprised that why <code>rintro ⟨a⟩ ⟨b⟩ ⟨c⟩</code> works too. Is there some special logic in the implementation of <code>rintro</code> for quotient?</p>",
        "id": 483224709,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1732010729
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"560873\">Shanghe Chen</span> <a href=\"#narrow/channel/116395-maths/topic/Reasoning.20about.20quotients/near/483224709\">said</a>:</p>\n<blockquote>\n<p>Is there some special logic in the implementation of <code>rintro</code> for quotient?</p>\n</blockquote>\n<p>Yes, there is</p>",
        "id": 483224898,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1732010779
    },
    {
        "content": "<p>after the <code>rintros</code> the solution uses <code>apply Quotient.sound</code>. It’s amazing the <code>Quotient sound</code> is applicable. It seems even applied multiple time without using <code>repeat</code></p>",
        "id": 483225073,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1732010840
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Reasoning.20about.20quotients/near/483224898\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"560873\">Shanghe Chen</span> <a href=\"#narrow/channel/116395-maths/topic/Reasoning.20about.20quotients/near/483224709\">said</a>:</p>\n<blockquote>\n<p>Is there some special logic in the implementation of <code>rintro</code> for quotient?</p>\n</blockquote>\n<p>Yes, there is</p>\n</blockquote>\n<p>which result does it relies on?</p>",
        "id": 483225829,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1732011099
    },
    {
        "content": "<p>before checking the solution in MIL I also tried to use <code>Quotient.inductionOn₃'</code> but it seems giving a dead end for me:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">GroupTheory</span><span class=\"bp\">.</span><span class=\"n\">QuotientGroup</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">true</span>\n\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"bp\">.</span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\">  </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">*</span><span class=\"n\">w</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"bp\">*</span><span class=\"n\">z</span>\n<span class=\"w\">  </span><span class=\"n\">iseqv</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span>\n<span class=\"w\">    </span><span class=\"n\">refl</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"bp\">.</span><span class=\"n\">one_mem</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"bp\">.</span><span class=\"n\">one_mem</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"n\">symm</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hw</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">z</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hz</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hw</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"bp\">⟩</span>\n<span class=\"w\">    </span><span class=\"n\">trans</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"o\">}</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">HasQuotient</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">quotient'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"bp\">.</span><span class=\"n\">Setoid</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">QuotientMonoid</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"bp\">.</span><span class=\"n\">Setoid</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">map₂'</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"bp\">·</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n<span class=\"w\">        </span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">mul_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Quotient</span><span class=\"bp\">.</span><span class=\"n\">inductionOn₃'</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span>\n<span class=\"w\">     </span><span class=\"c1\">-- seems dead end here</span>\n<span class=\"w\">     </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"w\">     </span><span class=\"c1\">-- failed to synthesize HMul</span>\n<span class=\"w\">     </span><span class=\"c1\">-- #check (Quotient.mk'' a * Quotient.mk'')</span>\n<span class=\"w\">     </span><span class=\"gr\">sorry</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">QuotientMonoid</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"w\">  </span><span class=\"n\">one_mul</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n<span class=\"w\">  </span><span class=\"n\">mul_one</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>I cannot even use the symbol <code>*</code> in the proof for <code>mul_assoc</code> after it</p>",
        "id": 483231645,
        "sender_full_name": "Shanghe Chen",
        "timestamp": 1732012874
    },
    {
        "content": "<p>Regarding my question (2), I noticed that the Setoid.r in the goal can be simplified away and then the \"refine\" can be replaced by two sets of \"use\" followed by \"simp\"; see lines 92-94 here:</p>\n<p><a href=\"https://github.com/ctchou/mathematics_in_lean/blob/main/MIL/C07_Hierarchies/S03_Subobjects_ctchou.lean\">https://github.com/ctchou/mathematics_in_lean/blob/main/MIL/C07_Hierarchies/S03_Subobjects_ctchou.lean</a></p>",
        "id": 483360761,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1732053544
    },
    {
        "content": "<p>I am pretty sure the goal didn’t look like that when I wrote this chapter. Something must have changed in between <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 483957581,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1732296454
    },
    {
        "content": "<p>Should I create an issue at the source repo <a href=\"https://github.com/avigad/mathematics_in_lean_source\">https://github.com/avigad/mathematics_in_lean_source</a> ?</p>",
        "id": 483970363,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1732301131
    },
    {
        "content": "<p>Yes please</p>",
        "id": 483988339,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1732308174
    },
    {
        "content": "<p><a href=\"https://github.com/avigad/mathematics_in_lean_source/issues/261\">https://github.com/avigad/mathematics_in_lean_source/issues/261</a></p>",
        "id": 484004916,
        "sender_full_name": "Ching-Tsun Chou",
        "timestamp": 1732316460
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"560873\">Shanghe Chen</span> <a href=\"#narrow/channel/116395-maths/topic/Reasoning.20about.20quotients/near/483231645\">said</a>:</p>\n<blockquote>\n<p>before checking the solution in MIL I also tried to use <code>Quotient.inductionOn₃'</code> but it seems giving a dead end for me:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"bp\">...</span>\n<span class=\"n\">I</span><span class=\"w\"> </span><span class=\"n\">cannot</span><span class=\"w\"> </span><span class=\"n\">even</span><span class=\"w\"> </span><span class=\"n\">use</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">symbol</span><span class=\"w\"> </span><span class=\"bp\">`*`</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">proof</span><span class=\"w\"> </span><span class=\"n\">for</span><span class=\"w\"> </span><span class=\"ss\">`mul_assoc</span><span class=\"bp\">`</span><span class=\"w\"> </span><span class=\"n\">after</span><span class=\"w\"> </span><span class=\"n\">it</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>re: the comment above about <code>rintro</code> magic, regular <code>intro</code> along with the surjectivity of the quotient map gets you to effectively the same goal:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">mul_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">      </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">a'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ha'</span><span class=\"bp\">⟩</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">quotient_map_surjective</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">a</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">b'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hb'</span><span class=\"bp\">⟩</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">quotient_map_surjective</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">b</span>\n<span class=\"w\">      </span><span class=\"k\">let</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">c'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hc'</span><span class=\"bp\">⟩</span><span class=\"w\">  </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">quotient_map_surjective</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">c</span>\n<span class=\"w\">      </span><span class=\"n\">repeat</span><span class=\"w\"> </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">ha'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hb'</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">hc'</span><span class=\"o\">]</span>\n<span class=\"w\">      </span><span class=\"c1\">-- goal is now:</span>\n<span class=\"w\">      </span><span class=\"c1\">-- ⊢ QuotientMonoid.mk N a' * QuotientMonoid.mk N b' * QuotientMonoid.mk N c' = QuotientMonoid.mk N a' * (QuotientMonoid.mk N b' * QuotientMonoid.mk N c')</span>\n</code></pre></div>\n<p>Resolving <code>*</code> as a binary op on <code>M / N</code> in the goal can be done by naming the instance, say <code>monoidInstMN</code> and then using that as the namespace, i.e. <code>(monoidInstMN N).mul</code>. There might be a simpler way. I didn't end up needing to refer to <code>*</code> explicitly on <code>M / N</code>.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"n\">monoidInstMN</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Submonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Monoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"bp\">⧸</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"bp\">...</span>\n<span class=\"w\">  </span><span class=\"n\">mul_assoc</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"bp\">...</span>\n<span class=\"w\">          </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">a'</span><span class=\"w\"> </span><span class=\"n\">b'</span><span class=\"w\"> </span><span class=\"n\">x'</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">a'</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">b'</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x'</span><span class=\"w\"> </span><span class=\"bp\">↔</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">monoidInstMN</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">mul</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">QuotientMonoid</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">a'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">QuotientMonoid</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">b'</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">QuotientMonoid</span><span class=\"bp\">.</span><span class=\"n\">mk</span><span class=\"w\"> </span><span class=\"n\">N</span><span class=\"w\"> </span><span class=\"n\">x'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">            </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>The key thing I got hung up on in this exercise was the use of <code>Quotient.sound</code>. I think if that was explained in the paragraph above the exercise it would be more straightforward.</p>",
        "id": 495353689,
        "sender_full_name": "Benjamin Jones",
        "timestamp": 1737572057
    },
    {
        "content": "<p>Regarding (1). Since the funny construction appears to be fully applied, I suspect that <code>dsimp</code> would expand it out.</p>",
        "id": 496965614,
        "sender_full_name": "Chris Wong",
        "timestamp": 1738316494
    }
]