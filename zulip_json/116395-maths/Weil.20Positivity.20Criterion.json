[
    {
        "content": "<p>Hi,</p>\n<p>New member here! I'm a beginner in Lean. I'm exploring using AI for a few ideas and I wanted a proper (human validated) formalization of the Weil Positivity Criterion (to RH) but I couldn't find anything in the existing Mathlib.</p>\n<p>I came up with something and wanted to know if I'm using the appropriate level of abstraction, and if this is correctly formulated. (I want to explore equivalences to other criteria).</p>\n<p>Thanks!</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">NumberTheory</span><span class=\"bp\">.</span><span class=\"n\">LSeries</span><span class=\"bp\">.</span><span class=\"n\">RiemannZeta</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Data</span><span class=\"bp\">.</span><span class=\"n\">Complex</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Algebra</span><span class=\"bp\">.</span><span class=\"n\">Star</span><span class=\"bp\">.</span><span class=\"n\">Basic</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Complex</span><span class=\"w\"> </span><span class=\"n\">Function</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">!</span>\n<span class=\"cm\"># Abstract Interface for Weil's Positivity Criterion (WPC)</span>\n<span class=\"cm\">This interface defines the components of WPC abstractly using opaque types,</span>\n<span class=\"cm\">isolating the structural properties from the analytical details.</span>\n<span class=\"cm\">-/</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">WPCInterface</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">! ## Abstract Components -/</span>\n\n<span class=\"sd\">/-- Class of admissible test functions (Weil tests). Abstractly represents C_c^‚àû((0, ‚àû); ‚ÑÇ). -/</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">IsWeilTestFunction</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n\n<span class=\"sd\">/-- The set of nontrivial zeros of Œ∂ as an abstract index type. -/</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">NonTrivialZero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n\n<span class=\"sd\">/-- Coercion giving the complex value of a zero. -/</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">zval</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonTrivialZero</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span>\n\n<span class=\"sd\">/-- The Mellin transform symbol. -/</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">Mellin</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Abstract \"sum over nontrivial zeros\". Think: `‚àë_{œÅ} F(œÅ)`. Implicitly handles summability. -/</span>\n<span class=\"kn\">opaque</span><span class=\"w\"> </span><span class=\"n\">ZeroSum</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">NonTrivialZero</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">! ## Definitions -/</span>\n\n<span class=\"sd\">/-- The Hermitian kernel `Œ¶_g(s) = Mellin(g,s) * Mellin(gÃÖ, 1 - s)`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Phi</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Mellin</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">Mellin</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">star</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Weil functional `W(g) = Œ£_œÅ Œ¶_g(œÅ)`. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">WeilFunctional</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">ZeroSum</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"n\">œÅ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NonTrivialZero</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">Phi</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">zval</span><span class=\"w\"> </span><span class=\"n\">œÅ</span><span class=\"o\">))</span>\n\n<span class=\"sd\">/-- Weil Positivity Condition (WPC): positivity for all nonzero tests. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">WPC</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"bp\">‚àÄ</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsWeilTestFunction</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚Üí</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">&lt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">WeilFunctional</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">re</span>\n\n<span class=\"c\">/-</span><span class=\"cm\">! ## The Criterion Statement -/</span>\n\n<span class=\"sd\">/-- Weil's Criterion: RH ‚Üî WPC. We take this as the defining axiom connecting the interface to RH. -/</span>\n<span class=\"kn\">axiom</span><span class=\"w\"> </span><span class=\"n\">WeilsCriterion</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">RiemannHypothesis</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">WPC</span>\n\n<span class=\"kn\">end</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">WPCInterface</span>\n</code></pre></div>",
        "id": 536217911,
        "sender_full_name": "Swami Kevala",
        "timestamp": 1756208836
    },
    {
        "content": "<p>A few points:</p>\n<p>1) I wouldn't recommend writing <code>opaque</code> definitions. If you need temporary placeholders for certain functions that you'd prefer to define later, you can use <code>sorry</code> as the definition.</p>\n<p>2) It's likely that some of these definitions are already in Mathlib (e.g. <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=mellin#doc\">docs#mellin</a>, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=tsum#doc\">docs#tsum</a>). Others shouldn't be too hard to define... for example, here's one way to define <code>NonTrivialZero</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">NonTrivialZero</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚ÑÇ</span><span class=\"w\"> </span><span class=\"bp\">//</span><span class=\"w\"> </span><span class=\"n\">riemannZeta</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">¬¨‚àÉ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">‚Ñï</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">n</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">‚àß</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">‚â†</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">}</span>\n</code></pre></div>\n<p>In this case, you wouldn't need <code>zval</code>... you could simply write <code>œÅ.val</code>.</p>\n<p>3) Don't define the criterion as an axiom. Rather, define it as a <code>Prop</code>, like so:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">WeilsCriterion</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">RiemannHypothesis</span><span class=\"w\"> </span><span class=\"bp\">‚Üî</span><span class=\"w\"> </span><span class=\"n\">WPC</span>\n</code></pre></div>\n<p>If you want to assume it in a theorem, you can include it as an argument.</p>",
        "id": 536344623,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756268296
    },
    {
        "content": "<p>Just out of curiosity, did you use any AI assistance for this? It is fine either way, but am curious.</p>",
        "id": 536344792,
        "sender_full_name": "Yan Yablonovskiy üá∫üá¶",
        "timestamp": 1756268462
    },
    {
        "content": "<p>he mentions AI in the third sentence so I assume it was involved somehow</p>",
        "id": 536344866,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756268538
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"380294\">Matt Diamond</span> <a href=\"#narrow/channel/116395-maths/topic/Weil.20Positivity.20Criterion/near/536344866\">said</a>:</p>\n<blockquote>\n<p>he mentions AI in the third sentence so I assume it was involved somehow</p>\n</blockquote>\n<p>I was too busy looking for subtler signs in the code <span aria-label=\"face in clouds\" class=\"emoji emoji-1f636-200d-1f32b\" role=\"img\" title=\"face in clouds\">:face_in_clouds:</span></p>",
        "id": 536344909,
        "sender_full_name": "Yan Yablonovskiy üá∫üá¶",
        "timestamp": 1756268590
    },
    {
        "content": "<p>it happens!</p>",
        "id": 536344935,
        "sender_full_name": "Matt Diamond",
        "timestamp": 1756268616
    },
    {
        "content": "<p>Thanks <span class=\"user-mention\" data-user-id=\"380294\">@Matt Diamond</span> that was helpful.</p>\n<p><span class=\"user-mention\" data-user-id=\"773147\">@Yan Yablonovskiy üá∫üá¶</span> -  Yes I used AI (GPT5) to generate the file, and did some minor tweaking</p>",
        "id": 536755864,
        "sender_full_name": "Swami Kevala",
        "timestamp": 1756461644
    }
]