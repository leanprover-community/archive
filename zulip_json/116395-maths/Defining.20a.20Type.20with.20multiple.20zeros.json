[
    {
        "content": "<p>I am working on defining a type for physical quantities in Lean. I have already finished defining a type for dimensional analysis, the code can be found <a href=\"https://github.com/ATOMSLab/LeanChemicalTheories/blob/main/src/dimensional_analysis/basic.lean\">here</a>. We have a manuscript almost done on the dimensional analysis stuff. For physical quantities the idea was to define a physical quantity type as the product of a number and the dimension, ie:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">science_unit</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">prod</span> <span class=\"n\">ℝ</span> <span class=\"o\">(</span><span class=\"n\">dimension</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Right now just using real numbers, but it will eventually be generalized to a vector space. For dimensional analysis, there is no zero because there is no identity element for addition. However, for physical quantities there is an identity element for addition, however there are multiple. That's because if we had 1 Length and added 0, 0 would have to have dimensions of Length too. That's because the addition of two physical quantities is only allowed if they have the same dimension.</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">protected</span> <span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">add</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}</span> <span class=\"o\">:</span> <span class=\"n\">science_unit</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">science_unit</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">science_unit</span> <span class=\"n\">α</span>\n<span class=\"bp\">|</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">a.fst</span> <span class=\"bp\">+</span> <span class=\"n\">b.fst</span><span class=\"o\">,</span> <span class=\"n\">a.snd</span> <span class=\"bp\">+</span> <span class=\"n\">b.snd</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>I wanted to get feedback on how we would go about defining zero, or even if it was possible to define a zero if a Type has multiple forms of zero.</p>",
        "id": 364891138,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686324176
    },
    {
        "content": "<p>You mean <code>a.snd</code>, not <code>a.snd + b.snd</code></p>",
        "id": 364900586,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326163
    },
    {
        "content": "<p>Do you want <code>add</code> to take a proof of <code>a.snd = b.snd</code> as an argument, or define it for all <code>science_unit</code>s and ask for <code>a.snd = b.snd</code> in proofs of properties?</p>",
        "id": 364901134,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326278
    },
    {
        "content": "<p>In the first case you're sure that one can't get <code>0 m + 1 s</code> by accident.</p>",
        "id": 364901289,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326303
    },
    {
        "content": "<p>Another approach is to allow such sums and deal with <code>dimension α →₀ ℝ</code> instead.</p>",
        "id": 364901601,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326376
    },
    {
        "content": "<p>(or, if you have a <code>group</code> structure on <code>dimension</code>s, then <code>monoid_algebra ℝ (dimension α)</code>)</p>",
        "id": 364901846,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326424
    },
    {
        "content": "<p>In this case you allow expressions like <code>0 m + 1 s</code></p>",
        "id": 364902015,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326460
    },
    {
        "content": "<p>Unfortunately, the product type doesn't have a vector space (or even an additive group) structure.</p>",
        "id": 364902186,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326498
    },
    {
        "content": "<p>(and probably you want to talk about <code>(10 m + 20 m) / (30 s) ^ 2</code>)</p>",
        "id": 364902383,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326533
    },
    {
        "content": "<p>Are there projects that formalize computations with dimensions in Coq, Isabelle, etc?</p>",
        "id": 364902548,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326571
    },
    {
        "content": "<p>If yes, what choices did they make?</p>",
        "id": 364902623,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326587
    },
    {
        "content": "<p>BTW, do you want to allow <code>1 cm + 3 m</code> or <code>5 in + 3 cm</code>?</p>",
        "id": 364902737,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326609
    },
    {
        "content": "<p>Or <code>(1 cm).to_dim in</code>?</p>",
        "id": 364902933,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686326644
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364900586\">said</a>:</p>\n<blockquote>\n<p>You mean <code>a.snd</code>, not <code>a.snd + b.snd</code></p>\n</blockquote>\n<p>We defined addition already in dimensional analysis using classical choice such that it only allows to dimensions to be added if they are like dimensions. So you can have <code>1 m + 1 s</code> but it won't simplify. </p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kn\">protected</span> <span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">add</span> <span class=\"o\">{</span><span class=\"n\">α</span><span class=\"o\">}:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span>\n<span class=\"n\">classical.epsilon</span> <span class=\"bp\">$</span> <span class=\"bp\">λ</span> <span class=\"n\">f</span><span class=\"o\">,</span> <span class=\"bp\">∀</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"o\">,</span> <span class=\"n\">a</span> <span class=\"bp\">=</span> <span class=\"n\">b</span> <span class=\"bp\">→</span> <span class=\"n\">f</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"bp\">=</span> <span class=\"n\">a</span>\n</code></pre></div>",
        "id": 364908405,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686327819
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364901846\">said</a>:</p>\n<blockquote>\n<p>(or, if you have a <code>group</code> structure on <code>dimension</code>s, then <code>monoid_algebra ℝ (dimension α)</code>)</p>\n</blockquote>\n<p>We have already defined the multiplicative comm_group for dimensions, but no groups for addition because dimensions don't have a zero</p>",
        "id": 364908615,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686327865
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364902548\">said</a>:</p>\n<blockquote>\n<p>Are there projects that formalize computations with dimensions in Coq, Isabelle, etc?</p>\n</blockquote>\n<p>not from what I have seen, but I could have missed it</p>",
        "id": 364908690,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686327890
    },
    {
        "content": "<p>If you want to allow expressions like <code>1 m + 1 s</code>, then I recommend using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra\">docs#monoid_algebra</a>.</p>",
        "id": 364910018,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686328190
    },
    {
        "content": "<p>It explicitly allows such expressions without asking for addition on <code>dimension</code>s.</p>",
        "id": 364910189,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686328221
    },
    {
        "content": "<p>Then you can define division that makes sense only if the denominator is a non-zero <code>single</code></p>",
        "id": 364910508,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686328302
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364902737\">said</a>:</p>\n<blockquote>\n<p>BTW, do you want to allow <code>1 cm + 3 m</code> or <code>5 in + 3 cm</code>?</p>\n</blockquote>\n<p>We want to allow this, but the addition won't simplify unless you convert the units. My idea of defining these units was:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">def</span> <span class=\"n\">meter</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_length</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">science_unit</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"n\">dimension.length</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">centimeter</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_length</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:=</span> <span class=\"mi\">100</span><span class=\"bp\">*</span><span class=\"o\">(</span><span class=\"n\">meter</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">def</span> <span class=\"n\">length_meter</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_length</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">(</span><span class=\"n\">value</span> <span class=\"o\">:</span> <span class=\"n\">ℝ</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"n\">value</span><span class=\"bp\">*</span><span class=\"o\">(</span><span class=\"n\">meter</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Although this is the current idea, I'm not happy with it because it requires us to agree that the base SI units are the reference points. Could possibly get around this with the class strucutre</p>",
        "id": 364910731,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686328350
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364910018\">said</a>:</p>\n<blockquote>\n<p>If you want to allow expressions like <code>1 m + 1 s</code>, then I recommend using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra\">docs#monoid_algebra</a>.</p>\n</blockquote>\n<p>Let me look at the monoid_algebra. I'm not familiar with it. What is the flaw with the current way if the addition for dimensions is already defined since the addition of the dimensions checks to make sure the units are compatible to add?</p>",
        "id": 364910995,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686328416
    },
    {
        "content": "<p>Max, you definitely want <a href=\"https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra\">docs#monoid_algebra</a>.</p>",
        "id": 364911001,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686328418
    },
    {
        "content": "<p>Ok, let me play around with some stuff and see how it works. Thank you!</p>",
        "id": 364911370,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686328509
    },
    {
        "content": "<p>Do you have any recommendations for resources to learn about monoid algebra and how I would apply it here?</p>",
        "id": 364911543,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686328551
    },
    {
        "content": "<p>You would use <code>monoid_algebra ℝ (dimension α)</code>. This is a synonym for <code>dimension α →₀ ℝ</code>, the collection of finitely supported functions on <code>dimension α</code>. You should think of these as finite formal sums of scalar multiples of dimensions. (e.g., like <code>2 d + π d'</code>, where <code>d d' : dimension α</code>). This structure forms an <code>ℝ</code>-algebra. The multiplication is defined in the way you want (as a convolution using the <code>comm_group</code> structure you have on dimensions).</p>",
        "id": 364913356,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686328976
    },
    {
        "content": "<p>So, suppose <code>d₁ d₂ d₃ d₄ : dimension α</code>, <code>r₁ r₂ r₃ r₃ : ℝ</code> and <code>r₁ d₁ + r₂ d₂</code> and <code>r₃ d₃ + r₄ d₄ : monoid_algebra ℝ (dimension α)</code> (these last two are not valid syntax), then</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"o\">(</span><span class=\"n\">r₁</span> <span class=\"n\">d₁</span> <span class=\"bp\">+</span> <span class=\"n\">r₂</span> <span class=\"n\">d₂</span><span class=\"o\">)</span> <span class=\"bp\">*</span> <span class=\"o\">(</span><span class=\"n\">r₃</span> <span class=\"n\">d₃</span> <span class=\"bp\">+</span> <span class=\"n\">r₄</span> <span class=\"n\">d₄</span><span class=\"o\">)</span> <span class=\"bp\">=</span> <span class=\"o\">(</span><span class=\"n\">r₁</span> <span class=\"bp\">*</span> <span class=\"n\">r₃</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d₁</span> <span class=\"bp\">*</span> <span class=\"n\">d₃</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">r₁</span> <span class=\"bp\">*</span> <span class=\"n\">r₄</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d₁</span> <span class=\"bp\">*</span> <span class=\"n\">d₄</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">r₂</span> <span class=\"bp\">*</span> <span class=\"n\">r₃</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d₂</span> <span class=\"bp\">*</span> <span class=\"n\">d₃</span><span class=\"o\">)</span> <span class=\"bp\">+</span> <span class=\"o\">(</span><span class=\"n\">r₂</span> <span class=\"bp\">*</span> <span class=\"n\">r₄</span><span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"n\">d₂</span> <span class=\"bp\">*</span> <span class=\"n\">d₄</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>And, supposing for the sake of example that <code>d₁ * d₃ = d₂ * d₄</code> and <code>d₁ * d₄ = d₂ * d₃</code>, then the above is equal to: <code>(r₁ * r₃ + r₂ * r₄) (d₁ * d₃) + (r₁ * r₄ + r₂ * r₃) (d₁ * d₄)</code></p>",
        "id": 364916031,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686329584
    },
    {
        "content": "<p>The classic example of a <code>monoid_algebra</code> is the group ring of a group <code>G</code> (which is <code>monoid_algebra ℤ G</code>)</p>",
        "id": 364916441,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686329676
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364910995\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364910018\">said</a>:</p>\n<blockquote>\n<p>If you want to allow expressions like <code>1 m + 1 s</code>, then I recommend using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra\">docs#monoid_algebra</a>.</p>\n</blockquote>\n<p>Let me look at the monoid_algebra. I'm not familiar with it.</p>\n</blockquote>\n<p><span class=\"user-mention\" data-user-id=\"474115\">@Max Bobbin</span>, can you confirm whether you actually do want to allow <code>1 m + 1 s</code>?</p>",
        "id": 364918902,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686330304
    },
    {
        "content": "<p>(If not then <code>(d : dimension α)</code> should be a parameter to <code>science_unit</code>, and then <code>science_unit</code> is just a fancy type synonym for <code>ℝ</code> and it will be hard to combine units)</p>",
        "id": 364922513,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686331229
    },
    {
        "content": "<p>That weird auxiliary sigma type which we use in grading theory has lots of zeros</p>",
        "id": 364927172,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1686332385
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364918902\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364910995\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364910018\">said</a>:</p>\n<blockquote>\n<p>If you want to allow expressions like <code>1 m + 1 s</code>, then I recommend using <a href=\"https://leanprover-community.github.io/mathlib_docs/find/monoid_algebra\">docs#monoid_algebra</a>.</p>\n</blockquote>\n<p>Let me look at the monoid_algebra. I'm not familiar with it.</p>\n</blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span>, can you confirm whether you actually do want to allow <code>1 m + 1 s</code>?</p>\n</blockquote>\n<p>We don't want <code>1 m + 1 s</code> to be a valid form, but I was thinking we would have to allow it to at least be possible to write so we can write complex equations like <code>1 m / 1 s + 1 m/s</code> The second equation is a valid equation to reduce to <code> 2 m/s</code> where as <code>1 m + 1 s</code> can't be reduced. Not sure if that answers the question though, I may be misunderstanding what you are asking.</p>",
        "id": 364938127,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686335238
    },
    {
        "content": "<p>Another way to do it is to use Lean 4 <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=HMul#doc\">docs4#HMul</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=HAdd#doc\">docs4#HAdd</a></p>",
        "id": 364948187,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686337868
    },
    {
        "content": "<p>You can say that <code>ScienceUnit (d : Dimension α) := ℝ</code>, then define <code>AddCommGroup</code> instance for each <code>ScienceUnit d</code> and <code>HMul</code> instances for <code>ScienceUnit d1 -&gt; ScienceUnit d2 -&gt; ScienceUnit (d1 * d2)</code>.</p>",
        "id": 364948677,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686338016
    },
    {
        "content": "<p>This way you will be able to write <code>a + b</code> only if <code>a</code> and <code>b</code> have definitionally equal dimensions.</p>",
        "id": 364948812,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686338053
    },
    {
        "content": "<p>(so, you need computable dimensions)</p>",
        "id": 364948842,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686338064
    },
    {
        "content": "<p>I think requiring defeq dimensions would be miserable. However, using <code>monoid_algebra</code> with an <code>is_valid_form</code> predicate saying that an element is equal to some <code>finsupp.single</code> would make sense.</p>",
        "id": 364949031,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686338133
    },
    {
        "content": "<p>That way you avoid computability requirements.</p>",
        "id": 364949101,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686338157
    },
    {
        "content": "<p>As you can see, you can get at least <code>n + 1</code> opinions from <code>n</code> experienced users. ;-)</p>",
        "id": 364949761,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686338356
    },
    {
        "content": "<p><code>1 m / 1 s + 1 m/s</code> is exactly the kind of thing you could do with <code>monoid_algebra</code> (or more precisely, <code>1 m * 1 s⁻¹ + 1 (m * s⁻¹)</code>) and have it make sense easily. Admittedly, Yury's heterogeneous suggestion should also work, but I would be concerned you would run into unification headaches (maybe that's an unfounded concern).</p>",
        "id": 364950965,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1686338716
    },
    {
        "content": "<p>I see, I'll work on implementing this. The other thing I've been mulling over is scale. I'm curious to see what others think, but my guess is using <code>monoid_algebra</code> we could define <code>meter := monoid_algebra 1 dimension.length</code> and then <code>centimeter := meter/100</code>. I worry that this definition is limiting, but I could be wrong.</p>",
        "id": 364951590,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686338911
    },
    {
        "content": "<p>You can define <code>centimeter := 100⁻¹ • meter</code></p>",
        "id": 364957480,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686340658
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364957480\">said</a>:</p>\n<blockquote>\n<p>You can define <code>centimeter := 100⁻¹ • meter</code></p>\n</blockquote>\n<p>What I meant was, I think there should be a better way then hoping that everyone agrees that the reference unit for length is 1 meter and everything is defined off the meter. The worry is someone comes along and defines the foot and they define it as 1, then you have 1 meter = 1 foot. Wanted to know if people had thoughts on this if its avoidable</p>",
        "id": 365178595,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686422864
    },
    {
        "content": "<p>You can either (a) use nonnegative reals and label your axes with the unit being used (meter, foot,...), (b) use no labelling and make your axes homogeneous spaces (so there is no \"1\" but you can still add, and multiply by a natural) or (c) use the nonnegative reals, not label your axes, and then have the ambiguity.</p>",
        "id": 365179030,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1686423048
    },
    {
        "content": "<p>Just call the type <code>structure Length := (meters : Real)</code>, now if someone does the same definition for feet there is a clash</p>",
        "id": 365179142,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686423107
    },
    {
        "content": "<p>What do you mean by labeling your axes? The second option sounds like what I could be looking for, but I'm not familiar with homogeneous spaces</p>",
        "id": 365179244,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686423134
    },
    {
        "content": "<p>the idea being that when you define <code>def meter : Length := { meters := 1 }</code>, in order to get unit confusion you would need to also define <code>def foot : Length := { meters := 1 }</code> which is obviously suspicious</p>",
        "id": 365179636,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686423293
    },
    {
        "content": "<p>This is basically the argument for newtypes in the setting of lean</p>",
        "id": 365179691,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686423313
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span> This doesn't help with <code>1 m / 1 s</code></p>",
        "id": 365202027,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686434920
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/365179244\">said</a>:</p>\n<blockquote>\n<p>What do you mean by labeling your axes? The second option sounds like what I could be looking for, but I'm not familiar with homogeneous spaces</p>\n</blockquote>\n<p>Labeling your axes: I mean what Mario is suggesting, with the constructor names saying which units you'er using. The homogeneous space idea: I'm suggesting not using the real numbers but a 1-dimensional vector space with no fixed choice of basis. This would be the \"correct\" abstract unitless way to do it. So you just have some 1-d space V and then a non-zero element of V represents a measurement, and given two nonzero elements <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">v,w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> of V there's a unique real number <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>v</mi><mo>=</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">rv=w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>, but it doesn't make sense to say \"v=1\" or \"v=37\" or anything, until you choose the unit, i.e. pick a basis. The moment you pick a basis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> (e.g. 1 metre or 1 foot) then every <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">v\\in V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> is of the form <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">re</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">re</span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> a real number and now you can call <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> \"r metres\" or \"r feet\" or whatever, although of course the value of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> changes depending on which basis you pick.</p>",
        "id": 365203118,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1686435562
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/364891138\">said</a>:</p>\n<blockquote>\n<p>I have already finished defining a type for dimensional analysis, the code can be found <a href=\"https://github.com/ATOMSLab/LeanChemicalTheories/blob/main/src/dimensional_analysis/basic.lean\">here</a>. </p>\n</blockquote>\n<p>This code looks a bit weird to me:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span> <span class=\"n\">has_time</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span>\n<span class=\"o\">[</span><span class=\"n\">dec</span> <span class=\"o\">:</span> <span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"o\">(</span><span class=\"n\">time</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"o\">(</span><span class=\"n\">h</span> <span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"n\">time</span><span class=\"o\">]</span><span class=\"bp\">.</span><span class=\"n\">nodup</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>What was your intention with <code>[time].nodup</code>? <code>[x].nodup</code> is always true, <a href=\"https://leanprover-community.github.io/mathlib_docs/find/list.nodup_singleton\">docs#list.nodup_singleton</a></p>",
        "id": 365204926,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686436590
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> How do you suggest to implement a 1-dimensional vector space with no fixed choice of basis?</p>",
        "id": 365206601,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686437649
    },
    {
        "content": "<p>What is the type definition?</p>",
        "id": 365206608,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686437655
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/365202027\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> This doesn't help with <code>1 m / 1 s</code></p>\n</blockquote>\n<p>What I described was just the 1D space for lengths. If you want to have all your units in a pot you need some <code>monoid_algebra</code> thing</p>",
        "id": 365207165,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686438027
    },
    {
        "content": "<p>The \"all the units in a pot\" thing feels like the wrong design to me</p>",
        "id": 365207195,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686438053
    },
    {
        "content": "<p>but you can build that on top of <code>Length</code> as one of the coordinates</p>",
        "id": 365207198,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686438057
    },
    {
        "content": "<p>If you're working in any real physical problem all your dimensions are known down to constructors anyway, so you have no defeq problems</p>",
        "id": 365207217,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686438077
    },
    {
        "content": "<p>you might have an n-dimensional problem?</p>",
        "id": 365207255,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686438106
    },
    {
        "content": "<p>granted that's probably not too common in physics, unless you are talking about e.g. the lagrangian in n-dimensional phase space</p>",
        "id": 365207334,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1686438145
    },
    {
        "content": "<p>These are dimensions in the sense of metrology not space</p>",
        "id": 365207346,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686438162
    },
    {
        "content": "<p>Ah, I guess your lagrangian remark covers that</p>",
        "id": 365207379,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686438200
    },
    {
        "content": "<p>I think it's rare enough that dealing with a <code>dimension.cast</code> of some form very rarely is much less bad than having to constantly persuade lean you haven't mixed incompatible dimensions</p>",
        "id": 365207403,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686438231
    },
    {
        "content": "<p>I'd probably go for something like</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span> <span class=\"n\">has_time</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">time</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">class</span> <span class=\"n\">has_length</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">length</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">class</span> <span class=\"n\">has_mass</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">mass</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[reducible]</span> <span class=\"kd\">def</span> <span class=\"n\">dimension</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"o\">:=</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">multiplicative</span> <span class=\"n\">ℚ</span>\n<span class=\"kd\">@[reducible]</span> <span class=\"kd\">def</span> <span class=\"n\">dimension.of</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">pi.single</span> <span class=\"n\">a</span> <span class=\"o\">(</span><span class=\"n\">multiplicative.of_add</span> <span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">length</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_length</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_length.length</span> <span class=\"n\">α</span>\n<span class=\"kd\">def</span> <span class=\"n\">time</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_time</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_time.time</span> <span class=\"n\">α</span>\n<span class=\"kd\">def</span> <span class=\"n\">mass</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_mass</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_mass.mass</span> <span class=\"n\">α</span>\n\n<span class=\"kd\">@[nolint unused_arguments]</span>\n<span class=\"kd\">structure</span> <span class=\"n\">measurement</span> <span class=\"o\">(</span><span class=\"n\">V</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">dim</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span><span class=\"n\">of</span> <span class=\"o\">::</span> <span class=\"o\">(</span><span class=\"n\">value</span> <span class=\"o\">:</span> <span class=\"n\">V</span><span class=\"o\">)</span>\n</code></pre></div>",
        "id": 365210011,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686440123
    },
    {
        "content": "<p>And then use it as</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">@[derive decidable_eq]</span>\n<span class=\"kd\">inductive</span> <span class=\"n\">system1</span>\n<span class=\"bp\">|</span> <span class=\"n\">second</span> <span class=\"bp\">|</span> <span class=\"n\">meter</span>\n\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_time</span> <span class=\"n\">system1</span> <span class=\"o\">:=</span> <span class=\"o\">{</span>  <span class=\"n\">time</span> <span class=\"o\">:=</span> <span class=\"n\">system1.second</span> <span class=\"o\">}</span>\n<span class=\"kd\">instance</span> <span class=\"o\">:</span> <span class=\"n\">has_length</span> <span class=\"n\">system1</span> <span class=\"o\">:=</span> <span class=\"o\">{</span> <span class=\"n\">length</span> <span class=\"o\">:=</span> <span class=\"n\">system1.meters</span> <span class=\"o\">}</span>\n\n<span class=\"c1\">-- `measurement real (time system1)` is a real-valued duration</span>\n</code></pre></div>",
        "id": 365210166,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686440224
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> just ask <code>findim V = 1</code> (or whatever the nat version of dimension is called)</p>",
        "id": 365249839,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1686467409
    },
    {
        "content": "<p>I meant \"how to define types\", not \"how to define a typeclass\".</p>",
        "id": 365338648,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686496040
    },
    {
        "content": "<p>BTW, not a formalization but a good C++ library for units: <a href=\"https://www.boost.org/doc/libs/1_65_0/doc/html/boost_units.html\">https://www.boost.org/doc/libs/1_65_0/doc/html/boost_units.html</a></p>",
        "id": 365338798,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686496085
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/365210011\">said</a>:</p>\n<blockquote>\n<p>I'd probably go for something like</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span> <span class=\"n\">has_time</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">time</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">class</span> <span class=\"n\">has_length</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">length</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n<span class=\"kd\">class</span> <span class=\"n\">has_mass</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:=</span> <span class=\"o\">(</span><span class=\"n\">mass</span> <span class=\"o\">[]</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span>\n\n<span class=\"kd\">@[reducible]</span> <span class=\"kd\">def</span> <span class=\"n\">dimension</span> <span class=\"o\">(</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"o\">:=</span> <span class=\"n\">α</span> <span class=\"bp\">→</span> <span class=\"n\">multiplicative</span> <span class=\"n\">ℚ</span>\n<span class=\"kd\">@[reducible]</span> <span class=\"kd\">def</span> <span class=\"n\">dimension.of</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span> <span class=\"n\">u</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">a</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">pi.single</span> <span class=\"n\">a</span> <span class=\"o\">(</span><span class=\"n\">multiplicative.of_add</span> <span class=\"mi\">1</span><span class=\"o\">)</span>\n\n<span class=\"kd\">def</span> <span class=\"n\">length</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_length</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_length.length</span> <span class=\"n\">α</span>\n<span class=\"kd\">def</span> <span class=\"n\">time</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_time</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_time.time</span> <span class=\"n\">α</span>\n<span class=\"kd\">def</span> <span class=\"n\">mass</span> <span class=\"o\">(</span><span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"n\">has_mass</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">[</span><span class=\"n\">decidable_eq</span> <span class=\"n\">α</span><span class=\"o\">]</span> <span class=\"o\">:</span> <span class=\"n\">dimension</span> <span class=\"n\">α</span> <span class=\"o\">:=</span> <span class=\"n\">dimension.of</span> <span class=\"bp\">$</span> <span class=\"n\">has_mass.mass</span> <span class=\"n\">α</span>\n\n<span class=\"kd\">@[nolint unused_arguments]</span>\n<span class=\"kd\">structure</span> <span class=\"n\">measurement</span> <span class=\"o\">(</span><span class=\"n\">V</span><span class=\"o\">)</span> <span class=\"o\">{</span><span class=\"n\">α</span> <span class=\"o\">:</span> <span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span> <span class=\"o\">(</span><span class=\"n\">dim</span> <span class=\"o\">:</span> <span class=\"n\">α</span><span class=\"o\">)</span> <span class=\"o\">:=</span><span class=\"n\">of</span> <span class=\"o\">::</span> <span class=\"o\">(</span><span class=\"n\">value</span> <span class=\"o\">:</span> <span class=\"n\">V</span><span class=\"o\">)</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I remember being recommended something like this in the past, but I couldn't find information that explained what <code>multiplicative</code> was. Could someone explain how <code>multiplicative</code> works?</p>",
        "id": 365699389,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686611362
    },
    {
        "content": "<p>I guess my big confusion is how multiplicative and additive structures relate.</p>",
        "id": 365700050,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686611634
    },
    {
        "content": "<p>I notice that when I use this definition: <code>@[reducible] def dimension (α : Type u) := multiplicative (α → ℚ)\n</code> The abelian group comes automatically, however, addition doesn't come (as to be expected). If I do <code>.to_additive</code> does this convert multiplication operations to addition? My guess was the <code>.to_additive</code> makes the dimensions act like we were manipulating a vector of exponent values, which are done under the operations of addition. If so, how does this work with the need to define the addition of dimensions to be idempotent? My other concern with this way is I'm not sure if the exponents are being added correctly. While I can say <code>area := length^2</code> I want the underlying code to have an area of 2 when indexed by the Length base dimension class. This is important when we try to implement the Buckingham pi theorem.</p>",
        "id": 365700660,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686611868
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/365203118\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"474115\">Max Bobbin</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/365179244\">said</a>:</p>\n<blockquote>\n<p>What do you mean by labeling your axes? The second option sounds like what I could be looking for, but I'm not familiar with homogeneous spaces</p>\n</blockquote>\n<p>Labeling your axes: I mean what Mario is suggesting, with the constructor names saying which units you'er using. The homogeneous space idea: I'm suggesting not using the real numbers but a 1-dimensional vector space with no fixed choice of basis. This would be the \"correct\" abstract unitless way to do it. So you just have some 1-d space V and then a non-zero element of V represents a measurement, and given two nonzero elements <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo separator=\"true\">,</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">v,w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> of V there's a unique real number <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>v</mi><mo>=</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">rv=w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>, but it doesn't make sense to say \"v=1\" or \"v=37\" or anything, until you choose the unit, i.e. pick a basis. The moment you pick a basis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> (e.g. 1 metre or 1 foot) then every <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">v\\in V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span> is of the form <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">re</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">re</span></span></span></span> for <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> a real number and now you can call <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span> \"r metres\" or \"r feet\" or whatever, although of course the value of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span> changes depending on which basis you pick.</p>\n</blockquote>\n<p>Unless I'm misunderstanding, the only problem I have with implementing this is I can't make dimensions into a module because they don't form an add_comm_monoid. The exponents of dimensions form one, I believe.</p>",
        "id": 365700962,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686611971
    },
    {
        "content": "<p>or wait, the vector space isn't over the dimensions, is it?</p>",
        "id": 365701594,
        "sender_full_name": "Max Bobbin",
        "timestamp": 1686612301
    },
    {
        "content": "<p><code>multiplicative G</code> is a type synonym for <code>G</code>; for each additive structure on <code>G</code> (<code>has_add</code>, <code>add_comm_monoid</code> etc), it defines the corresponding multiplicative structure which is mathematically the same structure with different notation.</p>",
        "id": 365701853,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1686612456
    },
    {
        "content": "<blockquote>\n<p>The abelian group comes automatically, however, addition doesn't come (as to be expected).</p>\n</blockquote>\n<p>I'd go as far as saying that you don't want the additive structure in the first place. Leave that to <code>monoid_algebra</code> to generate if you really want it.</p>",
        "id": 365703100,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686613180
    },
    {
        "content": "<blockquote>\n<p>If so, how does this work with the need to define the addition of dimensions to be idempotent?</p>\n</blockquote>\n<p>If you replace this with \"addition of (mixed) measurements\", then <code>monoid_algebra</code> handles this for you; <code>1 * of R meters + 2 * of R meters = 3 * of R meters</code></p>",
        "id": 365703694,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686613565
    },
    {
        "content": "<p>If you restrict yourself to well-typed measurements then the question does't even make sense</p>",
        "id": 365703728,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686613600
    },
    {
        "content": "<blockquote>\n<p>My other concern with this way is I'm not sure if the exponents are being added correctly.</p>\n</blockquote>\n<p>Write a theorem to prove that they are!</p>",
        "id": 365703745,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1686613621
    },
    {
        "content": "<p>I got time to define the identity element under addition for Quality and Measure. Also the identity element under multiplication - but that is trivial.</p>\n<p><a href=\"https://github.com/ctzurcanu/lean-measure/blob/main/LeanMeasure.lean\">https://github.com/ctzurcanu/lean-measure/blob/main/LeanMeasure.lean</a></p>\n<p>Practically I should be able to prove that :<br>\n(Measure , +, zero_measure) is an abelian group and also<br>\n(Measure, *, one_measure) is an abelian group<br>\n(Quality, +, zeroQ) is an abelian group and also<br>\n(Quality, *, oneQ) is an abelian group</p>\n<p>I will see if I can learn enough Lean to perform those.</p>",
        "id": 455216771,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722371634
    },
    {
        "content": "<p>If you find that your lib can benefit from that, let me know <span class=\"user-mention\" data-user-id=\"474115\">@Max Bobbin</span></p>",
        "id": 455216944,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722371692
    },
    {
        "content": "<p>Returning to this:</p>\n<p>I saw that the abelian group definition requires the result of the operation between an element and its inverse to be the identity element. But in the process if synthesizing the zero element (for addition), I change its type of Measure (or Quality). So the + produces the zero element just for that particular Quality. Does not conform to the Abelian Group definition.  And that is even after I already forced this zero Quality in the Quality additions, and substractions.</p>\n<p>Judging from the lack of answers to my previous messages I could guess that there is no use for having such a synthetic element. But I would love some confirmation from somebody in this field or who knows Lean proving better. </p>\n<p>The question is: Is the existence of such an element (that is almost like identity, but not perfectly so) useful for proving (human-driven or automatic) ?</p>\n<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span></p>",
        "id": 456222891,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722719800
    },
    {
        "content": "<p>The wording of your question is confusing me a little, but I think ultimately there are two ways to encode dimensions in Lean's dependent type theory:</p>\n<ul>\n<li>In the types, so that <code>1m + 1s</code> or <code>1m = 1s</code> is a type error</li>\n<li>Using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MonoidAlgebra#doc\">docs#MonoidAlgebra</a> (or something analogous), which allows <code>1m + 1s</code> and is such that <code>0s = 0m = 0kg = ...</code></li>\n</ul>",
        "id": 456223606,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722720325
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456223606\">said</a>:</p>\n<blockquote>\n<p>The wording of your question is confusing me a little, but I think ultimately there are two ways to encode dimensions in Lean's dependent type theory:</p>\n<ul>\n<li>In the types, so that <code>1m + 1s</code> or <code>1m = 1s</code> is a type error</li>\n<li>Using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MonoidAlgebra#doc\">docs#MonoidAlgebra</a> (or something analogous), which allows <code>1m + 1s</code> and is such that <code>0s = 0m = 0kg = ...</code></li>\n</ul>\n</blockquote>\n<p>I could have used to show some code from my lib to be more precise, but I thought that you probably don't have the time to look at the sources, so I tried to say in English.. as well as I can</p>",
        "id": 456223826,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722720528
    },
    {
        "content": "<p>I think your lean code above is an incorrect implementation of this second idea, where the mistake arises from using a plain dictionary to store the dimensions. You need to also require that the dictionary contains no zero dimensions, and that a zero <code>Quantity</code> always has the empty dimension</p>",
        "id": 456223836,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722720532
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456223836\">said</a>:</p>\n<blockquote>\n<p>I think your lean code above is an incorrect implementation of this second idea, where the mistake arises from using a plain dictionary to store the dimensions. You need to also require that the dictionary contains no zero dimensions.</p>\n</blockquote>\n<p>it does contain a zero-dim: it is the scalar</p>",
        "id": 456223932,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722720631
    },
    {
        "content": "<blockquote>\n<p>Judging from the lack of answers to my previous messages</p>\n</blockquote>\n<p>What previous messages? This seems to be your first post in this thread</p>",
        "id": 456223948,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722720643
    },
    {
        "content": "<p>(If this is a continuation of another thread, you should cross link it here)</p>",
        "id": 456223981,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722720683
    },
    {
        "content": "<p>As I understand it, your code distinguishes <code>{\"m\": 0}</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>) from <code>{}</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>), but these are mathematically the same</p>",
        "id": 456223987,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722720705
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456223948\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>Judging from the lack of answers to my previous messages</p>\n</blockquote>\n<p>What previous messages? This seems to be your first post in this thread</p>\n</blockquote>\n<p>my first post here was Jul 30. maybe I don't know how to use Zulip..</p>",
        "id": 456224059,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722720740
    },
    {
        "content": "<p>Mario, I think you must be running into a Zulip issue</p>",
        "id": 456224070,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722720755
    },
    {
        "content": "<p>oh whoops</p>",
        "id": 456224083,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722720777
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456223987\">said</a>:</p>\n<blockquote>\n<p>As I understand it, your code distinguishes <code>{\"m\": 0}</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span>) from <code>{}</code> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>), but these are mathematically the same</p>\n</blockquote>\n<p>You may be right. I tried both variants: to have scalar as a Quality too. but I should probably stick with an empty dict for that</p>",
        "id": 456224203,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722720889
    },
    {
        "content": "<p>Thinking about it more, you're in much deeper trouble here; to Lean, <code>{\"m\": 1, \"s\": -1} = {\"s\": -1, \"m\": 1}</code> is false! (Equality of <code>Batteries.HashMap</code> is by insertion order, only <code>==</code> is order-independent)</p>",
        "id": 456224286,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722720965
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456223606\">said</a>:</p>\n<blockquote>\n<p>The wording of your question is confusing me a little, but I think ultimately there are two ways to encode dimensions in Lean's dependent type theory:</p>\n<ul>\n<li>In the types, so that <code>1m + 1s</code> or <code>1m = 1s</code> is a type error</li>\n<li>Using <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MonoidAlgebra#doc\">docs#MonoidAlgebra</a> (or something analogous), which allows <code>1m + 1s</code> and is such that <code>0s = 0m = 0kg = ...</code></li>\n</ul>\n</blockquote>\n<p>Please note that I have read about Monoid Algebra and I was unable to understand how to apply.<br>\n<a href=\"#narrow/stream/445230-Lean-for-Scientists-and-Engineers-2024/topic/Dims.20and.20Units.20for.20Physics/near/454471604\">https://leanprover.zulipchat.com/#narrow/stream/445230-Lean-for-Scientists-and-Engineers-2024/topic/Dims.20and.20Units.20for.20Physics/near/454471604</a></p>",
        "id": 456224296,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722720982
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456224286\">said</a>:</p>\n<blockquote>\n<p>Thinking about it more, you're in much deeper trouble here; to Lean, <code>{\"m\": 1, \"s\": -1} = {\"s\": -1, \"m\": 1}</code> is false! (Equality of <code>Batteries.HashMap</code> is by insertion order, only <code>==</code> is order-independent)</p>\n</blockquote>\n<p>pff. that is news. I thought I had tested exactly for that case and reached my personal experience that it is not insert-dependent.</p>",
        "id": 456224740,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722721275
    },
    {
        "content": "<p>then don't bother. Maybe tell me if there is a structure in Lean that acts like a Python dict so I can correct my code</p>",
        "id": 456224908,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722721346
    },
    {
        "content": "<p>You can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quotient#doc\">docs#Quotient</a> to override the behavior of <code>=</code></p>",
        "id": 456225046,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722721409
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456225046\">said</a>:</p>\n<blockquote>\n<p>You can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quotient#doc\">docs#Quotient</a> to override the behavior of <code>=</code></p>\n</blockquote>\n<p>I parse this as: change the \"=\" for an extension of Batteries.Hashmap and use that extension and the docs for doing this should be in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quotent#doc\">docs#Quotent</a></p>",
        "id": 456225480,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722721579
    },
    {
        "content": "<p>Usually <code>docs#Foo</code> is not making the claim \"the docs for <code>Foo</code> will help you\", but the much weaker claim of \"I'm pretty sure writing <code>Foo</code> in your code would solve part of your problem, but the docs might not help much!\"</p>",
        "id": 456225760,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722721694
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456225760\">said</a>:</p>\n<blockquote>\n<p>Usually <code>docs#Foo</code> is not making the claim \"the docs for <code>Foo</code> will help you\", but the much weaker claim of \"I'm pretty sure writing <code>Foo</code> in your code would solve part of your problem, but the docs might not help much!\"</p>\n</blockquote>\n<p>Thank you for your time. Sorry I did not catch that problem myself. I thought I tested for it!</p>",
        "id": 456225929,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722721763
    },
    {
        "content": "<p>Indeed, <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quotient#doc\">docs#Quotient</a> is pretty useless here, and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quot#doc\">docs#Quot</a> (which is in the docstring of Quotient) leads to such a hugely long page that the doc browser struggles to jump to the right part of the page.</p>",
        "id": 456226066,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722721807
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Quot#doc\">docs#Quot</a> doesn't work at all for me</p>",
        "id": 456226188,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722721863
    },
    {
        "content": "<p>apparently the quotient constants (which are added by the magic <code>init_quot</code> command) are not supported by doc-gen</p>",
        "id": 456226235,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722721891
    },
    {
        "content": "<p>Strange.. nobody else trying to find the Python dict equivalent in  Lean? ChatGPT directed me to Batteries.HashMap.. it was not good advice</p>",
        "id": 456226324,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722721926
    },
    {
        "content": "<p>It was good advice (for the question you asked), the problem is that python only has <code>==</code> not <code>Eq</code></p>",
        "id": 456226401,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722721961
    },
    {
        "content": "<p>and there is not 1 lib of Lean that fully solved for dict as we imagine it?</p>",
        "id": 456226667,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722722055
    },
    {
        "content": "<p>there is a reason HashMap does not take a quotient itself - if it did you wouldn't be able to print its elements or iterate over the keys/values</p>",
        "id": 456228471,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722722870
    },
    {
        "content": "<p>If you want extensional equality of hashmaps you should be using <code>==</code> as eric suggests</p>",
        "id": 456228616,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722722908
    },
    {
        "content": "<p>Here's my toy implementation of a units library using <code>DirectSum</code> (which is really the same as <code>MonoidAlgebra</code>, but computable):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Quantity</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">meter</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">second</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">Π₀</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ℚ</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">single</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⨁</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Quantity</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Multiplicative</span><span class=\"bp\">.</span><span class=\"n\">toAdd</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeOut</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">q</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">BaseUnit</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"bp\">*↑</span><span class=\"n\">meter</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">*</span><span class=\"n\">second</span>\n</code></pre></div>\n<p>(this raises that there is a parenthesization bug in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp.instRepr#doc\">docs#DFinsupp.instRepr</a>)</p>",
        "id": 456228678,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722722939
    },
    {
        "content": "<p>The output is</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">fun₀</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">fun₀</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">BaseUnit</span><span class=\"bp\">.</span><span class=\"n\">meter</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>which should really be</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">fun₀</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fun₀</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">BaseUnit</span><span class=\"bp\">.</span><span class=\"n\">meter</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>which reads as <code>3m^1 + 2</code></p>",
        "id": 456228927,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723052
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456228616\">said</a>:</p>\n<blockquote>\n<p>If you want extensional equality of hashmaps you should be using <code>==</code> as eric suggests</p>\n</blockquote>\n<p>I understand that: if I change all places in my code where I used \"=\" with \"==\" about HashMaps, the problem should be solved.</p>",
        "id": 456229056,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723111
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456228678\">said</a>:</p>\n<blockquote>\n<p>Here's my toy implementation of a units library using <code>DirectSum</code> (which is really the same as <code>MonoidAlgebra</code>, but computable):</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">autoImplicit</span><span class=\"w\"> </span><span class=\"n\">false</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span>\n\n<span class=\"kn\">namespace</span><span class=\"w\"> </span><span class=\"n\">Quantity</span>\n\n<span class=\"kn\">inductive</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">meter</span>\n<span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">second</span>\n<span class=\"n\">deriving</span><span class=\"w\"> </span><span class=\"n\">DecidableEq</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Repr</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">Π₀</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">ℚ</span>\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">Multiplicative</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">BaseUnit</span><span class=\"w\"> </span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"kn\">where</span><span class=\"w\"> </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">ofAdd</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"bp\">.</span><span class=\"n\">single</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⨁</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PreUnit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">end</span><span class=\"w\"> </span><span class=\"n\">Quantity</span>\n\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">_</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstanceAs</span><span class=\"w\"> </span><span class=\"bp\">&lt;|</span><span class=\"w\"> </span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Coe</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Multiplicative</span><span class=\"bp\">.</span><span class=\"n\">toAdd</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Ring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Unit</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CoeOut</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">DirectSum</span><span class=\"bp\">.</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"n\">q</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">BaseUnit</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"n\">Quantity</span><span class=\"bp\">.</span><span class=\"n\">Mixed</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"bp\">*↑</span><span class=\"n\">meter</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"bp\">*</span><span class=\"n\">second</span>\n</code></pre></div>\n<p>(this raises that there is a parenthesization bug in <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=DFinsupp.instRepr#doc\">docs#DFinsupp.instRepr</a>)</p>\n</blockquote>\n<p>all is well. But I can't understand your Leans source... I need more training.</p>",
        "id": 456229220,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723177
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456229056\">said</a>:</p>\n<blockquote>\n<p>I understand that: if I change all places in my code where I used \"=\" with \"==\" about HashMaps, the problem should be solved.</p>\n</blockquote>\n<p>The issue with that plan is that <code>AddGroup</code> is about <code>=</code> not <code>==</code></p>",
        "id": 456229246,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723193
    },
    {
        "content": "<blockquote>\n<p>But I can't understand your Leans source... I need more training.</p>\n</blockquote>\n<p>This is partly my fault for writing it quickly without documentation. Perhaps I should just publish a library out of this one day...</p>",
        "id": 456229305,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723233
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456229246\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456229056\">said</a>:</p>\n<blockquote>\n<p>I understand that: if I change all places in my code where I used \"=\" with \"==\" about HashMaps, the problem should be solved.</p>\n</blockquote>\n<p>The issue with that plan is that <code>AddGroup</code> is about <code>=</code> not <code>==</code></p>\n</blockquote>\n<p>so I have to force a new type of = over the old one with a technique that is documented on a very long web page</p>",
        "id": 456229449,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723280
    },
    {
        "content": "<p>I will try my luck with ChatGPT tomorrow with this change form the old = to new = for HashMap. My eyes already hurt.. Thank you both for your time.</p>",
        "id": 456229748,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723412
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>, am I right in saying that <code>RBMap</code> has order-independent semantics?</p>",
        "id": 456230228,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723637
    },
    {
        "content": "<p>yes</p>",
        "id": 456230247,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723659
    },
    {
        "content": "<p>RBMap also doesn't have extensional <code>=</code> though, because <code>=</code> can observe the tree balance</p>",
        "id": 456230272,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723688
    },
    {
        "content": "<p>Is there a proposition that states an RBMap is in normal form?</p>",
        "id": 456230307,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723715
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230228\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span>, am I right in saying that <code>RBMap</code> has order-independent semantics?</p>\n</blockquote>\n<p>just to be clear: I tried first with RBMap. I was unable to imagine how it can be used as dict.</p>",
        "id": 456230321,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723722
    },
    {
        "content": "<p>there is no such thing</p>",
        "id": 456230343,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723722
    },
    {
        "content": "<p>RBMaps are always balanced, but there are multiple ways to be balanced</p>",
        "id": 456230403,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723756
    },
    {
        "content": "<p>it does not enforce strict balance because that is too expensive to maintain as an invariant</p>",
        "id": 456230443,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723793
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230321\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230228\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span>, am I right in saying that <code>RBMap</code> has order-independent semantics?</p>\n</blockquote>\n<p>just to be clear: I tried first with RBMap. I was unable to imagine how it can be used as dict.</p>\n</blockquote>\n<p><code>RBMap</code> and <code>HashMap</code> have almost identical API when used as a dict</p>",
        "id": 456230605,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723880
    },
    {
        "content": "<p>the main user-level difference is that HashMap expects the keys to be hashable while RBMap expects the keys to be ordered</p>",
        "id": 456230656,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722723921
    },
    {
        "content": "<p>Here's how to use <code>Quotient</code> to make hash maps order-invariant:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Hash maps with extensional equality. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">HashMapQuotient</span><span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Hashable</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">HashMap</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">))</span>\n</code></pre></div>",
        "id": 456230693,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722723956
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230605\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230321\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230228\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span>, am I right in saying that <code>RBMap</code> has order-independent semantics?</p>\n</blockquote>\n<p>just to be clear: I tried first with RBMap. I was unable to imagine how it can be used as dict.</p>\n</blockquote>\n<p><code>RBMap</code> and <code>HashMap</code> have almost identical API when used as a dict</p>\n</blockquote>\n<p>I was in such beginner stages of using Lean that I did not know even how to import RBMap! I tried some things but they were form Lean 3 docs..</p>",
        "id": 456230740,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722723972
    },
    {
        "content": "<p>(note that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.RBMap#doc\">docs#Lean.RBMap</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Batteries.RBMap#doc\">docs#Batteries.RBMap</a> are different things)</p>",
        "id": 456230787,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722724002
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230787\">said</a>:</p>\n<blockquote>\n<p>(note that <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.RBMap#doc\">docs#Lean.RBMap</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Batteries.RBMap#doc\">docs#Batteries.RBMap</a> are different things)</p>\n</blockquote>\n<p>maybe I was confused between..</p>",
        "id": 456230839,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722724041
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230693\">said</a>:</p>\n<blockquote>\n<p>Here's how to use <code>Quotient</code> to make hash maps order-invariant:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Hash maps with extensional equality. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">HashMapQuotient</span><span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Hashable</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">HashMap</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">))</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>I will do this tomorrow (read later today). I'm on Paris time.. 0:30 am here..</p>",
        "id": 456230983,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722724117
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456230693\">said</a>:</p>\n<blockquote>\n<p>Here's how to use <code>Quotient</code> to make hash maps order-invariant:</p>\n<p><div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"o\">)</span>\n\n<span class=\"sd\">/-- Hash maps with extensional equality. -/</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">Batteries</span><span class=\"bp\">.</span><span class=\"n\">HashMapQuotient</span><span class=\"w\">  </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Hashable</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">DecidableEq</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Setoid</span><span class=\"bp\">.</span><span class=\"n\">ker</span><span class=\"w\"> </span><span class=\"n\">HashMap</span><span class=\"bp\">.</span><span class=\"n\">find?</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Setoid</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">HashMap</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"n\">β</span><span class=\"o\">))</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>using this and defining Decideable I was able to:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">accel1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">time</span>\n<span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">accel2</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">oneQ</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"bp\">/</span><span class=\"w\"> </span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">length</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">QtoString</span><span class=\"w\"> </span><span class=\"n\">accel1</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">QtoString</span><span class=\"w\"> </span><span class=\"n\">accel2</span>\n\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">accel1</span><span class=\"w\"> </span><span class=\"bp\">==</span><span class=\"w\"> </span><span class=\"n\">accel2</span><span class=\"w\"> </span><span class=\"c1\">-- this is true</span>\n<span class=\"bp\">#</span><span class=\"n\">eval</span><span class=\"w\"> </span><span class=\"n\">accel1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">accel2</span><span class=\"w\"> </span><span class=\"c1\">-- this is true too!</span>\n</code></pre></div>",
        "id": 456339224,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722785277
    },
    {
        "content": "<p>also: I think I'm able to imagine correctly the measurable space (geometrically). So now I see that a zeroQ (identity element for + on Quality/Dimension) is not needed, is not elegant, worse: it produces bad effects: it forces existence of inverse of Quality under +. And that may change that nature of the Quality.<br>\nNot good: Quality is an essence, semantically. Therefore there needs to be at least one operation that does not change its value.</p>\n<p>What I imagined was a cylinder:</p>\n<p><a href=\"/user_uploads/3121/gCjH4iNEDL6hCfKc5JgBOZUl/Screenshot-2024-08-04-at-17.35.04.png\">Screenshot-2024-08-04-at-17.35.04.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/gCjH4iNEDL6hCfKc5JgBOZUl/Screenshot-2024-08-04-at-17.35.04.png\" title=\"Screenshot-2024-08-04-at-17.35.04.png\"><img data-original-dimensions=\"1432x1012\" src=\"/user_uploads/thumbnail/3121/gCjH4iNEDL6hCfKc5JgBOZUl/Screenshot-2024-08-04-at-17.35.04.png/840x560.webp\"></a></div><p>section at plane scalar = 0:</p>\n<p><a href=\"/user_uploads/3121/TTg1Fy05GDDuOwZRy_mkXfei/Screenshot-2024-08-04-at-17.36.05.png\">Screenshot-2024-08-04-at-17.36.05.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/TTg1Fy05GDDuOwZRy_mkXfei/Screenshot-2024-08-04-at-17.36.05.png\" title=\"Screenshot-2024-08-04-at-17.36.05.png\"><img data-original-dimensions=\"1202x1022\" src=\"/user_uploads/thumbnail/3121/TTg1Fy05GDDuOwZRy_mkXfei/Screenshot-2024-08-04-at-17.36.05.png/840x560.webp\"></a></div>",
        "id": 456341219,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722785892
    },
    {
        "content": "<p>in the center is the scalar Quality and radiates qualities with and increasing and decreasing powers. So the inverses are on the diameter</p>",
        "id": 456341503,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722785983
    },
    {
        "content": "<p>the central axis of the cylinder is \\R</p>",
        "id": 456341837,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722786064
    },
    {
        "content": "<p>I wonder what rational or even irrational powers of the Qualities may mean. They certainly have where to be placed in this space..</p>",
        "id": 456342056,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722786127
    },
    {
        "content": "<p>I don't really understand what you're using the word \"quality\" to mean, or what you intend to show with those diagrams. If you mean something like \"compound base unit\", then the visualization of meters and seconds is just the 2D plane, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span> is at (2, 0) and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi mathvariant=\"normal\">/</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">m/s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">s</span></span></span></span> is at (1, -1), and multiplication of these base units is just addition in the plane. Fractional powers are just fractional points in this plane.</p>",
        "id": 456344802,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722786866
    },
    {
        "content": "<p>Quality = Dimension.</p>\n<p>The cylinder is the measurement: quality x quantity. the set of points that are at the intersection of the plane specific for a \\R number is the quantity and the points where it intersects the axes of each quality define the combination that is the resultant Quality.</p>\n<p>It is not important that ppl understand this imagination, but I used it to understand that + is not supposed to change the composed Quality, but * will (unless with a scalar). <br>\nSo using a combination of those operations one can visit the whole length of the parallel axes.</p>",
        "id": 456347788,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722787619
    },
    {
        "content": "<p>Imagining this I could see the usefulness of grouping dimensions as <code>has_length</code> for all those that have positive and negative values of the powers of L. <span class=\"user-mention\" data-user-id=\"474115\">@Max Bobbin</span></p>",
        "id": 456348307,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722787772
    },
    {
        "content": "<p>Now I would like very much to understand and obtain all that was described by <span class=\"user-mention\" data-user-id=\"310045\">@Eric Wieser</span> in his <code>namespace Quantity</code> with the eventual benefit that additional base units can be added.</p>",
        "id": 456349421,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722788057
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456344802\">said</a>:</p>\n<blockquote>\n<p>I don't really understand what you're using the word \"quality\" to mean, or what you intend to show with those diagrams. If you mean something like \"compound base unit\", then the visualization of meters and seconds is just the 2D plane, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span> is at (2, 0) and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi mathvariant=\"normal\">/</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">m/s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">s</span></span></span></span> is at (1, -1), and multiplication of these base units is just addition in the plane. Fractional powers are just fractional points in this plane.</p>\n</blockquote>\n<p>yes, I can see the space where these have room. I cannot imagine what <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mo stretchy=\"false\">(</mo></msup><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">m^(1/2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mopen mtight\">(</span></span></span></span></span></span></span></span><span class=\"mord\">1/2</span><span class=\"mclose\">)</span></span></span></span> or <span class=\"tex-error\">$$m^\\PI$$</span> means, physically</p>",
        "id": 456350829,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722788424
    },
    {
        "content": "<p>Units of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mrow><mi mathvariant=\"normal\">k</mi><mi mathvariant=\"normal\">g</mi></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{\\mathrm{kg}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.205em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.835em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">kg</span></span></span></span><span style=\"top:-2.795em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.205em;\"><span></span></span></span></span></span></span></span></span> are not that unusual, e.g. <a href=\"https://en.wikipedia.org/wiki/Harmonic_oscillator#Simple_harmonic_oscillator\">https://en.wikipedia.org/wiki/Harmonic_oscillator#Simple_harmonic_oscillator</a></p>",
        "id": 456353359,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722789353
    },
    {
        "content": "<p>According to this answer, there are irrational dimensions <a href=\"https://physics.stackexchange.com/a/14268\">https://physics.stackexchange.com/a/14268</a></p>",
        "id": 456353368,
        "sender_full_name": "Yakov Pechersky",
        "timestamp": 1722789360
    },
    {
        "content": "<p>my favorite counterexample to formal unit analysis systems is <a href=\"https://en.wikipedia.org/wiki/Tsiolkovsky_rocket_equation\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">k</mi><mi mathvariant=\"normal\">g</mi></mrow><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ln(\\mathrm{kg})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">kg</span></span><span class=\"mclose\">)</span></span></span></span></a></p>",
        "id": 456353751,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722789686
    },
    {
        "content": "<p>Can you elaborate on that? It's not immediately obvious to me where the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">k</mi><mi mathvariant=\"normal\">g</mi></mrow><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ln(\\mathrm{kg})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">kg</span></span><span class=\"mclose\">)</span></span></span></span> is hiding on that page</p>",
        "id": 456354837,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722790433
    },
    {
        "content": "<p>Is the issue somehow related to expanding <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mfrac><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">\\ln{\\frac{m_1}{m_2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1566em;vertical-align:-0.4451em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7115em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span> as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>1</mn></msub><mo>−</mo><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ln{m_1} - \\ln{m_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>? Can you just not do that expansion?</p>",
        "id": 456355207,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722790553
    },
    {
        "content": "<p>This seems related to how you can't just average <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> points in an affine space in the usual way, because you're not allowed to add them together without moving to a vector space and back.</p>",
        "id": 456355471,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722790618
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456222891\">said</a>:</p>\n<blockquote>\n<p>Judging from the lack of answers to my previous messages I could guess that there is no use for having such a synthetic element. But I would love some confirmation from somebody in this field or who knows Lean proving better.</p>\n</blockquote>\n<p>Sorry for the slow response. I know this is related to my group’s work; I was at a conference all week, and Max Bobbin graduated and isn’t working much with Lean anymore. But we’re really interested in this!</p>\n<p>It’s also been tough to respond when y’all can’t look at the latest version of dimensional analysis that we built. I’m still waiting for past group members to transfer the latest version of the code so I can make it public. The public version of our code is really old (still Lean 3; we have a Lean 4 version now).</p>",
        "id": 456369833,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722796189
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456226324\">said</a>:</p>\n<blockquote>\n<p>Strange.. nobody else trying to find the Python dict equivalent in  Lean? ChatGPT directed me to Batteries.HashMap.. it was not good advice</p>\n</blockquote>\n<p>I would be interested in this. Lots of scientists and engineers learn to code in Python, and having an idea of “this is how you translate a ____ in Python to Lean” would be nice. Dictionaries, classes, lists, tuples, etc. It could make for a nice cheat sheet. But maybe worth discussing in a separate thread.</p>",
        "id": 456370766,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722796468
    },
    {
        "content": "<p>Or a lean cheat sheet that also has proofs that those translations behave as you would expect them to…</p>",
        "id": 456371413,
        "sender_full_name": "Josha Dekker",
        "timestamp": 1722796699
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"308899\">Yakov Pechersky</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456353368\">said</a>:</p>\n<blockquote>\n<p>According to this answer, there are irrational dimensions <a href=\"https://physics.stackexchange.com/a/14268\">https://physics.stackexchange.com/a/14268</a></p>\n</blockquote>\n<p>Oh! Interesting cases. I was only aware of cases that need rational powers, those seem to cover most cases. We built our dimension object assuming powers could be rational, but not irrational. Hmmm.</p>",
        "id": 456371432,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722796706
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110049\">Mario Carneiro</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456353751\">said</a>:</p>\n<blockquote>\n<p>my favorite counterexample to formal unit analysis systems is <a href=\"https://en.wikipedia.org/wiki/Tsiolkovsky_rocket_equation\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mrow><mi mathvariant=\"normal\">k</mi><mi mathvariant=\"normal\">g</mi></mrow><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ln(\\mathrm{kg})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathrm\" style=\"margin-right:0.01389em;\">kg</span></span><span class=\"mclose\">)</span></span></span></span></a></p>\n</blockquote>\n<p>In the rocket equation, ln is applied to a unitless ratio of masses, so still okay. Formally, I don’t know of many “proper” uses of ln or exp in which the argument has dimensions. </p>\n<p>Nonetheless, the docs for this unit system in Python points out a few useful cases, like when you want to plot a dimensional quantity on a log scale.<br>\n<a href=\"https://unyt.readthedocs.io/en/stable/usage.html#powers-logarithms-exponentials-and-trigonometric-functions\">https://unyt.readthedocs.io/en/stable/usage.html#powers-logarithms-exponentials-and-trigonometric-functions</a></p>",
        "id": 456372027,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722796954
    },
    {
        "content": "<p>Here’s a real case of an equation with log applied to something with units: <br>\n<a href=\"https://en.m.wikipedia.org/wiki/Antoine_equation\">https://en.m.wikipedia.org/wiki/Antoine_equation</a></p>\n<p>It’s recognized as a semi-empirical relationship, so it’s not properly derivable from other equations. Furthermore, because it has log (p) (and not log (p/p_reference) or something like that, which would make it dimensionless), the constants A, B, and C are weirdly dependent on the units of P and T. In a normal equation, you can just say “k_B is 1.380649×10−23 J/K” and “the density of water at this temperature and pressure is 1 g/cm^3” - these other things in the equation can be expressed in any kinds of units and it will all be sensible once conversions are finished. </p>\n<p>But in Antoine’s equation, you need to report your data like “A, B, and C are _____ when T is in K and p is in Pa” or “A, B, and C are ____ when T is in degrees C and p is in atm.” Ensuring these are correct is likely harder to do in a principled way.</p>",
        "id": 456373228,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722797567
    },
    {
        "content": "<p>It seems like this can be fixed by adding a <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mi>A</mi></msup></mrow><annotation encoding=\"application/x-tex\">10^A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">A</span></span></span></span></span></span></span></span></span></span></span> to the LHS in a suitable way?</p>",
        "id": 456373760,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722797761
    },
    {
        "content": "<p>That is, this just seems like the sort of type-sloppy nonsense that would be rephrased before writing down in lean, and the rephrasing would make the problem go away</p>",
        "id": 456374063,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722797862
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"424214\">Tyler Josephson ⚛️</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456370766\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456226324\">said</a>:</p>\n<blockquote>\n<p>Strange.. nobody else trying to find the Python dict equivalent in  Lean? ChatGPT directed me to Batteries.HashMap.. it was not good advice</p>\n</blockquote>\n<p>I would be interested in this. Lots of scientists and engineers learn to code in Python, and having an idea of “this is how you translate a ____ in Python to Lean” would be nice. Dictionaries, classes, lists, tuples, etc. It could make for a nice cheat sheet. But maybe worth discussing in a separate thread.</p>\n</blockquote>\n<p>This is tempting but also very dangerous. Those are extremely different programming languages, and we really want to train people in writing idiomatic Lean code, not python code in Lean. This is not specific to Lean and python, this apply to any pair of very different programming languages.</p>",
        "id": 456382550,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1722800216
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456374063\">said</a>:</p>\n<blockquote>\n<p>That is, this just seems like the sort of type-sloppy nonsense that would be rephrased before writing down in lean, and the rephrasing would make the problem go away</p>\n</blockquote>\n<p>Right. It’s awkward. I think it’s better to just disallow this and enforce that ln and exp operate on dimensionless quantities, and maybe a flag to optionally allow some behavior along the convention that unyt uses and return no dimensions. Antoine’s Equation is the 1% exception among the 99% of cases in which we want type checking to enforce the rules.</p>",
        "id": 456384239,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722801223
    },
    {
        "content": "<p>I knew only about the irrational length, area, and volume for fractals. Not sure if related, but it could be to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>m</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">m^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span> if we refer to shoreline geography for example or porosity.<br>\nIt would be fascinating for the library to link to such examples for other basic or combined dimensions.</p>",
        "id": 456389671,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722803364
    },
    {
        "content": "<p>So I have an interest in making or using a library for measurement that has dimensional analysis as a side-offer, but where the user can add his own dimensions.<br>\nIf I make it: I want it to be maximally flexible. That means exponents in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>. At least.</p>\n<p>Now the new question: is there any case where exponents in <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">C</mi></mrow><annotation encoding=\"application/x-tex\">\\Complex</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">C</span></span></span></span> or other more complex type are needed?</p>",
        "id": 456390069,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722803647
    },
    {
        "content": "<p>(Should I open another subject for this? How is the norm?)</p>",
        "id": 456390151,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722803742
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456355207\">said</a>:</p>\n<blockquote>\n<p>Is the issue somehow related to expanding <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><mfrac><msub><mi>m</mi><mn>1</mn></msub><msub><mi>m</mi><mn>2</mn></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">\\ln{\\frac{m_1}{m_2}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1566em;vertical-align:-0.4451em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7115em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4101em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span> as <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>1</mn></msub><mo>−</mo><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ln{m_1} - \\ln{m_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>? Can you just not do that expansion?</p>\n</blockquote>\n<p>Yes of course you can do so, but this is generally the case for any unitful quantity, you always need to combine it with other things to make it unitless before you can do anything mathematically nontrivial with it. But actually it is sensible to perform the separation <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>1</mn></msub><mo>−</mo><mi>ln</mi><mo>⁡</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\ln{m_1} - \\ln{m_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mop\">ln</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>, since <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> just plays the role of a reference mass and can be viewed in a similar spirit as the zero point of potential energy - the physics is invariant under shifting everything additively, so you can pick the zero point corresponding to some mass as your \"unit\", and when translating to another unit you need to perform a shift instead of a multiplication by a factor</p>",
        "id": 456409538,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722817449
    },
    {
        "content": "<p>the point of a unit system is so that you can make sense of the individual components of physical equations <em>without</em> having to say that certain pieces can't be separated until they are unitless-ized</p>",
        "id": 456409747,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722817609
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456355471\">said</a>:</p>\n<blockquote>\n<p>This seems related to how you can't just average <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> points in an affine space in the usual way, because you're not allowed to add them together without moving to a vector space and back.</p>\n</blockquote>\n<p>Yes, affine spaces are another example where this shifting operation comes up. There is no designated zero point in real physical space, and picking your zero point has some of the characteristics of choosing a unit</p>",
        "id": 456409952,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722817766
    },
    {
        "content": "<p>Somehow I sense <a href=\"https://en.wikipedia.org/wiki/Noether%27s_theorem\">Noether's theorem</a> hiding behind these observations...</p>",
        "id": 456410078,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1722817842
    },
    {
        "content": "<p>In the rocket equation, though, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">m_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> isn't an arbitrary reference point that can be chosen without changing the physics, but something concrete about the rocket in question, is it?</p>",
        "id": 456412693,
        "sender_full_name": "Joachim Breitner",
        "timestamp": 1722819934
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110031\">Patrick Massot</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456382550\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"424214\">Tyler Josephson ⚛️</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456370766\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"735031\">Christian Tzurcanu</span> <a href=\"#narrow/stream/116395-maths/topic/Defining.20a.20Type.20with.20multiple.20zeros/near/456226324\">said</a>:</p>\n<blockquote>\n<p>Strange.. nobody else trying to find the Python dict equivalent in  Lean? ChatGPT directed me to Batteries.HashMap.. it was not good advice</p>\n</blockquote>\n<p>I would be interested in this. Lots of scientists and engineers learn to code in Python, and having an idea of “this is how you translate a ____ in Python to Lean” would be nice. Dictionaries, classes, lists, tuples, etc. It could make for a nice cheat sheet. But maybe worth discussing in a separate thread.</p>\n</blockquote>\n<p>This is tempting but also very dangerous. Those are extremely different programming languages, and we really want to train people in writing idiomatic Lean code, not python code in Lean. This is not specific to Lean and python, this apply to any pair of very different programming languages.</p>\n</blockquote>\n<p>It is tempting for good reason: like in a proving system, in the mind of the programmer, he has to root new knowledge in the old. So we can preface the code with an explanation of the differences and have both benefits: of having a new paradigm and welcoming people who know of old ones.</p>",
        "id": 456464557,
        "sender_full_name": "Christian Tzurcanu",
        "timestamp": 1722843349
    },
    {
        "content": "<p>I guess a cheat sheet isn’t the right idea, because one does not simply translate across these very different languages. But, in my class tomorrow, I am introducing recursion, and I’m showing examples in both Python and Lean. Part of the idea, is that Python programmers would use loops for lots of programming tasks, but these need to be recursive functions if we’re going to implement them in Lean and prove things like termination. So I’ll have for loop in Python, recursive function in Python, and recursive function in Lean. But all the context around this means it can work as a slide deck / long-form explanation, but a cheat sheet wouldn’t make sense. FPIL brings in other languages every once in a while, but definitely not as if there’s a one-to-one mapping between such things.</p>",
        "id": 456573751,
        "sender_full_name": "Tyler Josephson ⚛️",
        "timestamp": 1722865721
    },
    {
        "content": "<p>Arguably lean also uses for loops for some programming tasks, but the resulting function is currently tricky to prove things about (due to missing API lemmas around for loops)</p>",
        "id": 456574380,
        "sender_full_name": "Eric Wieser",
        "timestamp": 1722865891
    },
    {
        "content": "<p>6 messages were moved from this topic to <a class=\"stream-topic\" data-stream-id=\"113489\" href=\"/#narrow/stream/113489-new-members/topic/Ordering.20strings\">#new members &gt; Ordering strings</a> by <span class=\"user-mention silent\" data-user-id=\"310045\">Eric Wieser</span>.</p>",
        "id": 456863701,
        "sender_full_name": "Notification Bot",
        "timestamp": 1722952803
    }
]