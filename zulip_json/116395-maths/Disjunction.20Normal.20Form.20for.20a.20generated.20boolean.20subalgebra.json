[
    {
        "content": "<p>Context, which you can skip: In algebraic geometry, a constructible set in the prime spectrum of a ring <code>R</code> is an element of the boolean subalgebra of <code>Set (PrimeSpectrum R)</code> generated by open sets. I need an induction principle for constructible sets of the following form:</p>\n<blockquote>\n<p>Let <code>P</code> be a predicate on <code>Set (PrimeSpectrum R)</code>. If <code>b</code> is a topological basis for <code>PrimeSpectrum R</code> and a few side conditions are fulfilled, then <code>P</code> holds on all constructible sets if it is preserved under union and holds on sets of the form <code>b i \\ ⋃ j ∈ s, b j</code> where <code>s</code> is a finite set.</p>\n</blockquote>",
        "id": 489910784,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734597402
    },
    {
        "content": "<p>What you should definitely read: This induction principle feels a lot like Disjunction Normal Form from boolean formulas/circuits. So I thought I would try proving an induction principle based on the DNF. However, this seems hard without first defining boolean formulas/circuits.</p>",
        "id": 489911296,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734597615
    },
    {
        "content": "<p>Here's my attempt so far:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Order</span><span class=\"bp\">.</span><span class=\"n\">BooleanSubalgebra</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Spectral</span><span class=\"bp\">.</span><span class=\"n\">Hom</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span>\n\n<span class=\"sd\">/-- An induction principle for closure membership, based on the disjunctive normal form. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">elab_as_elim</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">BooleanSubalgebra</span><span class=\"bp\">.</span><span class=\"n\">closure_dnf_induction</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BooleanAlgebra</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">dnf</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">x</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">closure</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">hx</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"sd\">/-- The actual induction principle I care about, motivated by the Zariski topology. -/</span>\n<span class=\"kd\">@[</span><span class=\"n\">elab_as_elim</span><span class=\"kd\">]</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">IsConstructible</span><span class=\"bp\">.</span><span class=\"n\">induction_of_isTopologicalBasis</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">CompactSpace</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">BooleanSubalgebra</span><span class=\"bp\">.</span><span class=\"n\">closure</span>\n<span class=\"w\">      </span><span class=\"o\">{</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">U</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)},</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">}</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ι</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">basis</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsTopologicalBasis</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">range</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">compact_inter</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">))</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">sdiff</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"bp\">.</span><span class=\"n\">Finite</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"bp\">\\</span><span class=\"w\"> </span><span class=\"bp\">⋃</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">j</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- easy to prove</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">union</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"n\">ht</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∪</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"gr\">sorry</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"c1\">-- easy to prove</span>\n<span class=\"w\">    </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">α</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">BooleanSubalgebra</span><span class=\"bp\">.</span><span class=\"n\">closure</span>\n<span class=\"w\">      </span><span class=\"o\">{</span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">|</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">⦃</span><span class=\"n\">s</span><span class=\"o\">⦄,</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsOpen</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">IsCompact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∩</span><span class=\"w\"> </span><span class=\"n\">U</span><span class=\"o\">)})</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">P</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">hs</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 489911341,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734597629
    },
    {
        "content": "<ol>\n<li>Has anyone got code about boolean formulas/circuits? If so, code about the DNF/CNF?</li>\n<li>Do people agree with my analysis of the situation?</li>\n</ol>",
        "id": 489911503,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734597690
    },
    {
        "content": "<p>This is maybe close to what you're looking for: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=supClosure_infClosure#doc\">docs#supClosure_infClosure</a></p>",
        "id": 489982938,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1734620713
    },
    {
        "content": "<p>The existence of DNF is equivalent to the statement that the Boolean subalgebra closure of a set <code>s</code> is equal to the sup closure of the inf closure of the complement closure of <code>s ∪ {0, 1}</code>. I do not think this statement is in mathlib, but <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=supClosure_infClosure#doc\">docs#supClosure_infClosure</a> is at least only a few steps away.</p>",
        "id": 489983929,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1734621009
    },
    {
        "content": "<p>There is first-order logic in mathlib, but I am not sure if there is the propositional calculus (zeroth-order logic) with propositions as variables</p>",
        "id": 489987232,
        "sender_full_name": "Mitchell Lee",
        "timestamp": 1734621960
    },
    {
        "content": "<p>Just to point out that your definition of constructible is incorrect in general, you have to take the boolean algebra generated by <em>quasicompact</em> open sets (in a general scheme, that would be <em>retrocompact</em>).</p>",
        "id": 490167978,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703698
    },
    {
        "content": "<p>In the spectrum of a noetherian ring, any open set will be quasicompact, hence your definition is often correct.</p>",
        "id": 490168232,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703787
    },
    {
        "content": "<p>Is that not exactly what I have written in <a href=\"https://github.com/leanprover-community/mathlib4/pull/20054\">#20054</a>, Antoine?</p>",
        "id": 490168250,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734703792
    },
    {
        "content": "<p>Yes, but not above.</p>",
        "id": 490168441,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703839
    },
    {
        "content": "<p>Ah yeah sure <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> I didn't want to scare the computer scientists away with big scary words like \"retro-compact\"</p>",
        "id": 490168550,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734703873
    },
    {
        "content": "<p>For you, is compact the same as quasi-compact?</p>",
        "id": 490168557,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703874
    },
    {
        "content": "<p>But then you scared me.</p>",
        "id": 490168628,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703901
    },
    {
        "content": "<p>Mathematician's compact = algebraic geometer's quasi-compact, have I lived in a lie?</p>",
        "id": 490168662,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734703912
    },
    {
        "content": "<p>I think in US/UK terminology, compact does not imply Hausdorff, and that's probably the same in mathlib, so probably you're OK.</p>",
        "id": 490168880,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734703973
    },
    {
        "content": "<p>Indeed: <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=CompactSpace#doc\">docs#CompactSpace</a></p>",
        "id": 490168947,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734704002
    },
    {
        "content": "<p>For your initial question: you need an induction lemma for the boolean subalgebra generated by a set of a boole algebra.</p>",
        "id": 490169142,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734704065
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"695266\">Mitchell Lee</span> <a href=\"#narrow/channel/116395-maths/topic/Disjunction.20Normal.20Form.20for.20a.20generated.20boolean.20subalgebra/near/489983929\">said</a>:</p>\n<blockquote>\n<p>The existence of DNF is equivalent to the statement that the Boolean subalgebra closure of a set <code>s</code> is equal to the sup closure of the inf closure of the complement closure of <code>s ∪ {0, 1}</code>. I do not think this statement is in mathlib, but <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=supClosure_infClosure#doc\">docs#supClosure_infClosure</a> is at least only a few steps away.</p>\n</blockquote>\n<p>Quite a mouthful, but I like it! Something like <code>BooleanSubalgebra.closure s = supClosure (infClosure (s ∪ {a | aᶜ ∈ s} ∪ {⊥, ⊤}))</code></p>",
        "id": 490169231,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734704099
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130609\">Antoine Chambert-Loir</span> <a href=\"#narrow/channel/116395-maths/topic/Disjunction.20Normal.20Form.20for.20a.20generated.20boolean.20subalgebra/near/490169142\">said</a>:</p>\n<blockquote>\n<p>you need an induction lemma for the boolean subalgebra generated by a set of a boole algebra.</p>\n</blockquote>\n<p>Is that not exactly what I stated in my initial messages? or is a \"boole algebra\" something I don't know?</p>",
        "id": 490169455,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1734704166
    },
    {
        "content": "<p>yes, i was just confused by your invocation of dnf.</p>",
        "id": 490407971,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1734890934
    }
]