[
    {
        "content": "<p>Hi, it looks like the formalization of <a href=\"https://en.wikipedia.org/wiki/Riesz%E2%80%93Markov%E2%80%93Kakutani_representation_theorem\">https://en.wikipedia.org/wiki/Riesz%E2%80%93Markov%E2%80%93Kakutani_representation_theorem</a> started in <a href=\"https://github.com/leanprover-community/mathlib/pull/16367\">!3#16367</a> was never completed.</p>",
        "id": 476638387,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728854416
    },
    {
        "content": "<p>Where can I find the informal proof that was being formalized in this PR?</p>",
        "id": 476638522,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728854538
    },
    {
        "content": "<p>I don't know the author of that PR? There are two J. Reimann's on zulip though...</p>",
        "id": 476758069,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1728905497
    },
    {
        "content": "<p>According to the discussion <a href=\"#narrow/stream/144837-PR-reviews/topic/.2317027.20Riesz-Markov-Kakutani\">here</a> The author is probably <span class=\"user-mention\" data-user-id=\"513978\">@Jesse Reimann</span></p>",
        "id": 476759083,
        "sender_full_name": "Andrew Yang",
        "timestamp": 1728905763
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"382902\">@Yoh Tanimoto</span> might have been working on this as well.</p>",
        "id": 476770102,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728908608
    },
    {
        "content": "<p>Yes that was me! The proof was done in Lean 3, I think <span class=\"user-mention\" data-user-id=\"373986\">@Kalle Kytölä</span> has previously mentioned something about porting it to Lean 4, but I don't know what the status of that is <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 476780721,
        "sender_full_name": "Jesse Reimann",
        "timestamp": 1728911072
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513978\">@Jesse Reimann</span> proved Riesz-Markov-Kakutani representation theorem for compact Hausdorff spaces (which have some nice aspects for probability applications and which can be used to get the locally compact case, too, but this generalization was not done) in Lean3. The Mathlib PRs of that work got stalled for a long time because there were no multiplication and (truncated) subtraction operations defined on bounded continuous <em>nonnegative</em> functions, which were used in the proof.</p>\n<p>Since then, my understanding is that <span class=\"user-mention\" data-user-id=\"382902\">@Yoh Tanimoto</span> proved Riesz-Markov-Kakutani representation theorem in Lean4 for <em>locally compact</em> Hausdorff spaces (i.e. directly the natural generality), and it was discussed in <a href=\"https://github.com/leanprover-community/mathlib4/pull/12290\">#12290</a> that although the multiplication and subtraction sticking points were finally fixed in <a href=\"https://github.com/leanprover-community/mathlib4/pull/12790\">#12790</a> and <a href=\"https://github.com/leanprover-community/mathlib4/pull/12559\">#12559</a>, Yoh's version seemed the right way forward.</p>\n<p>(If that assessment has changed, it is possible to port Jesse's code to Lean4 and refactor it to use the subtraction and multiplication instead of the workarounds that were needed originally. But the porting of Jesse's code to Lean4 is not done yet.)</p>",
        "id": 476783732,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1728911825
    },
    {
        "content": "<p>It looks like <a href=\"https://github.com/leanprover-community/mathlib4/pull/12290\">#12290</a> is currently stuck on <a href=\"https://github.com/leanprover-community/mathlib4/pull/12266\">#12266</a> which is marked <code>help-wanted</code>. I think <span class=\"user-mention\" data-user-id=\"214703\">@Yury G. Kudryashov</span> promised to have a look, but that hasn't yet happened.</p>",
        "id": 476785698,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728912297
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/Riesz.20representation.20theorem/near/476638522\">said</a>:</p>\n<blockquote>\n<p>Where can I find the informal proof that was being formalized in this PR?</p>\n</blockquote>\n<p>The informal proof that Jesse originally started with was Rudin's proof in Real and Complex Analysis, Chapter 2 (except we did simplifications for compact rather than locally compact case with my probability applications in mind). But at some point we noticed that Mathlib had good existing results on <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Content#doc\">docs#MeasureTheory.Content</a>, and we switched to a version that does not literally follow any reference I know of. Sorry about an unhelpful answer! But basically the version Jesse formalized is Rudin, rewritten using existing results on contents, and simplified for the compact case (first).</p>",
        "id": 476785712,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1728912300
    },
    {
        "content": "<p>Yes, if we want to prove the RMK theorem on a locally compact T2 space, I think we need something like <a href=\"https://github.com/leanprover-community/mathlib4/pull/12266\">#12266</a> or its variation as partition of unity to prove that the measure constructed with <code>rieszContentAux</code> gives back the functional <code>Λ</code>. </p>\n<p>There is another question/option of the field, either <code>Real</code> or <code>NNReal</code>. My understanding is that we should first prove it for <code>NNReal</code> but I wrote <a href=\"https://github.com/leanprover-community/mathlib4/pull/12290\">#12290</a> for <code>Real</code>. To switch to <code>NNReal</code>, Kalle's PRs should suffice, but I haven't worked on it. Probably one can prove that <code>rieszContentAux</code> is indeed a content without <a href=\"https://github.com/leanprover-community/mathlib4/pull/12266\">#12266</a>.</p>",
        "id": 476800148,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1728915947
    },
    {
        "content": "<p>Correct, showing that <code>rieszContentAux</code> is indeed a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Content#doc\">docs#MeasureTheory.Content</a>, became short after the subtraction and multiplication of bounded continuous functions were generalized (included below again). The remaining parts after that of the <em>compact Hausdorff case</em> were to (1) obtain a measure from the content and (2) characterize it as the unique measure whose <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.lintegral#doc\">docs#MeasureTheory.lintegral</a> reproduces the given positive linear functional. Those are a bit longer than the code below, but not huge. However, this approach would indeed leave one to handle the locally compact case separately, so Yoh's handling of that directly sounded appealing.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Classical</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"w\"> </span><span class=\"n\">ENNReal</span><span class=\"w\"> </span><span class=\"n\">BoundedContinuousFunction</span>\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">MeasureTheory</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Function</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NormalSpace</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">exists_bounded_zero_one_of_closed_nnreal</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s_closed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsClosed</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t_closed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsClosed</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Disjoint</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">→ᵇ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">EqOn</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">EqOn</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"bp\">⇑</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">g</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g_zero_on_s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g_one_on_t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g_bdd</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_bounded_zero_one_of_closed</span><span class=\"w\"> </span><span class=\"n\">s_closed</span><span class=\"w\"> </span><span class=\"n\">t_closed</span><span class=\"w\"> </span><span class=\"n\">disj</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">g</span><span class=\"bp\">.</span><span class=\"n\">nnrealPart</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_s</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">g_zero_on_s</span><span class=\"w\"> </span><span class=\"n\">x_in_s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_t</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">g_one_on_t</span><span class=\"w\"> </span><span class=\"n\">x_in_t</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[(</span><span class=\"n\">g_bdd</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"m\">2</span><span class=\"o\">]</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">exists_sum_one_of_closed_nnreal</span>\n<span class=\"w\">    </span><span class=\"o\">{</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s_closed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsClosed</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">t_closed</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsClosed</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Disjoint</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Z</span><span class=\"w\"> </span><span class=\"bp\">→ᵇ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">EqOn</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">EqOn</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"bp\">∧</span><span class=\"w\"> </span><span class=\"n\">f₁</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">f₂</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f_zero_on_s</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f_one_on_t</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f_bdd</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_bounded_zero_one_of_closed_nnreal</span><span class=\"w\"> </span><span class=\"n\">s_closed</span><span class=\"w\"> </span><span class=\"n\">t_closed</span><span class=\"w\"> </span><span class=\"n\">disj</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">?_⟩</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_s</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">f_zero_on_s</span><span class=\"w\"> </span><span class=\"n\">x_in_s</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_t</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">f_one_on_t</span><span class=\"w\"> </span><span class=\"n\">x_in_t</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">only</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BoundedContinuousFunction</span><span class=\"bp\">.</span><span class=\"n\">coe_add</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">BoundedContinuousFunction</span><span class=\"bp\">.</span><span class=\"n\">coe_sub</span><span class=\"o\">,</span>\n<span class=\"w\">               </span><span class=\"n\">BoundedContinuousFunction</span><span class=\"bp\">.</span><span class=\"n\">coe_one</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">add_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">sub_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Pi</span><span class=\"bp\">.</span><span class=\"n\">one_apply</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">coe_add</span><span class=\"o\">,</span>\n<span class=\"w\">               </span><span class=\"n\">NNReal</span><span class=\"bp\">.</span><span class=\"n\">coe_one</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"n\">norm_cast</span>\n<span class=\"w\">    </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">tsub_add_cancel_of_le</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f_bdd</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">)</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">T2Space</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MeasurableSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">BorelSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→ᵇ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux_union</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">TopologicalSpace</span><span class=\"bp\">.</span><span class=\"n\">Compacts</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">disj</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Disjoint</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">rieszContentAux</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">le_antisymm</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rieszContentAux_sup_le</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"n\">refine</span><span class=\"w\"> </span><span class=\"n\">le_csInf</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rieszContentAux_image_nonempty</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K₁</span><span class=\"w\"> </span><span class=\"bp\">⊔</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"o\">))</span><span class=\"w\"> </span><span class=\"bp\">?_</span>\n<span class=\"w\">  </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">f</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">hf</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Λf_eq_b</span><span class=\"bp\">⟩⟩</span>\n<span class=\"w\">  </span><span class=\"k\">obtain</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"n\">g₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">g₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hg₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sum_g</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">exists_sum_one_of_closed_nnreal</span><span class=\"w\"> </span><span class=\"n\">K₁</span><span class=\"bp\">.</span><span class=\"n\">isCompact</span><span class=\"bp\">.</span><span class=\"n\">isClosed</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"bp\">.</span><span class=\"n\">isCompact</span><span class=\"bp\">.</span><span class=\"n\">isClosed</span><span class=\"w\"> </span><span class=\"n\">disj</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">f_eq_sum</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">g₁</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">g₂</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">RightDistribClass</span><span class=\"bp\">.</span><span class=\"n\">right_distrib</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">sum_g</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"n\">rw</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"bp\">←</span><span class=\"w\"> </span><span class=\"n\">Λf_eq_b</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">f_eq_sum</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">map_add</span><span class=\"o\">]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">aux₁</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">K₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g₁</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_K₁</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hg₁</span><span class=\"w\"> </span><span class=\"n\">x_in_K₁</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mem_union_left</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">x_in_K₁</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">aux₂</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">K₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g₂</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"n\">x_in_K₂</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">hg₂</span><span class=\"w\"> </span><span class=\"n\">x_in_K₂</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">hf</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">mem_union_right</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">x_in_K₂</span><span class=\"o\">)]</span>\n<span class=\"w\">  </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"n\">add_le_add</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rieszContentAux_le</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">aux₁</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">rieszContentAux_le</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">aux₂</span><span class=\"o\">)</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">rieszContent</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→ᵇ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Content</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">toFun</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux</span><span class=\"w\"> </span><span class=\"n\">Λ</span>\n<span class=\"w\">  </span><span class=\"n\">mono'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux_mono</span><span class=\"w\"> </span><span class=\"n\">Λ</span>\n<span class=\"w\">  </span><span class=\"n\">sup_disjoint'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">fun</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">disj</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">↦</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux_union</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">disj</span>\n<span class=\"w\">  </span><span class=\"n\">sup_le'</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">rieszContentAux_sup_le</span><span class=\"w\"> </span><span class=\"n\">Λ</span>\n</code></pre></div>",
        "id": 476808238,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1728918633
    },
    {
        "content": "<p>And yes, there was the question of how much to use <code>NNReal</code> and at which point to get the results to <code>Real</code>. I am almost sure we want both kinds of versions in Mathlib, and which one to use first, and which one to obtain as a consequence, I view it as a bit of an implementation detail choice that different authors would have different preferences about. (I remember <span class=\"user-mention\" data-user-id=\"268315\">@Anatole Dedecker</span> was not enthusiastic about working with <code>NNReal</code>-linear and <code>NNReal</code>-valued functionals on continuous <code>NNReal</code>-valued functions as a way to guarantee the positivity of the functional, but to me this made sense, because measures are fundamentally already <code>ENNReal</code> valued <code>ENNReal</code>-linear functionals on <code>ENNReal</code>-valued functions, via the Lebesgue integral. Talking about positivity of the functional and jumping directly to Bochner integral I did not find as appropriate, because Bochner integral is meant for more general value spaces than the one-dimensional linearly ordered one where we have the notion of positivity. Anyway, once either implementation is done, getting the other is easy.)</p>",
        "id": 476809211,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1728918989
    },
    {
        "content": "<p>I've thought a bit about how to deal with selfadjoint and positive linear functionals but I don't have any time to write much about it today. I'll try to remember to post my thoughts here soon. However, I would agree with Anatole that you probably want to stick with <code>ℝ</code>, and avoid <code>ℝ≥0</code>. That being said, in the continuous functional calculus, we have opted for an <code>ℝ≥0</code> version too, and I think it is the right decision, despite the major headaches it causes sometimes. I think that the situation of positive linear functionals is a bit different though.</p>",
        "id": 476833539,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1728929775
    },
    {
        "content": "<p>I'm sorry for stalling this in review. I'll do my best to review it tonight.</p>",
        "id": 476842618,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1728934583
    },
    {
        "content": "<p>as for <a href=\"https://github.com/leanprover-community/mathlib4/pull/12266\">#12266</a>, probably I should write a variation of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/PartitionOfUnity.html#BumpCovering.exists_isSubordinate_of_prop\">exists_isSubordinate_of_prop</a> where <code>X</code> is locally compact and T2 but <code>s</code> is compact?</p>",
        "id": 477208781,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729083361
    },
    {
        "content": "<p>I'm sorry for another delay. I'm too busy at my day job. I'll have a look in ~3h after a meeting at the office.</p>",
        "id": 477239579,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729091249
    },
    {
        "content": "<p>Is there a new Urysohn's-like statement (for <code>s</code> and <code>t</code> with some properties, there exist a continuous function that is 0 on <code>s</code> and <code>1</code> on <code>t</code>) behind the new \"partition of unity\" statement? If yes, could you please formulate it (formally or informally)?</p>",
        "id": 477312248,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729117405
    },
    {
        "content": "<p>I think I need <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/PartitionOfUnity.html#PartitionOfUnity.exists_isSubordinate\">PartitionOfUnity.exists_isSubordinate</a> with <code>T2Space X</code> but <code>IsCompact s</code>. The current theorem takes <code>NormalSpace X</code> because so does <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/PartitionOfUnity.html#BumpCovering.exists_isSubordinate\">BumpCovering.exists_isSubordinate</a>, which depends on <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/ShrinkingLemma.html#exists_iUnion_eq_closure_subset\">the shrinking lemma</a>. But I guess I can prove an analogue if <code>X</code> is T2 locally compact and <code>s</code> is compact?</p>",
        "id": 477322935,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729124170
    },
    {
        "content": "<p>Could you please revert to a version that had all the theorems you want with complete proofs?</p>",
        "id": 477325659,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729126221
    },
    {
        "content": "<p>I'll look into a way to make it work with our API then.</p>",
        "id": 477325680,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729126246
    },
    {
        "content": "<p>I restored the old version in <code>Topology.UrysohnLemma</code>. Meanwhile I'm trying to see if the shrinking lemma can be adapted to my case.</p>",
        "id": 477408100,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729160292
    },
    {
        "content": "<p>I'll have a look tonight.</p>",
        "id": 477517925,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729196343
    },
    {
        "content": "<p>The PR description talks about normal T2 spaces while your replies indicate that your goal is to drop the <code>NormalSpace</code> assumption.</p>",
        "id": 477578256,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729231455
    },
    {
        "content": "<p>It looks like the theorem doesn't assume <code>[NormalSpace]</code>.</p>",
        "id": 477579627,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729232027
    },
    {
        "content": "<p>sorry, indeed \"normal T2 space\" didn't make sense. I meant \"locally compact T2 space\" (updated).</p>\n<p>This PR splitted from <a href=\"https://github.com/leanprover-community/mathlib4/pull/12290\">#12290</a>, where the proof that the measure gives back <code>Λ</code> is missing, but is done in <a href=\"https://github.com/yoh-tanimoto/mathlib4/blob/yoh/yoh/RMK/linearRMK.lean\">https://github.com/yoh-tanimoto/mathlib4/blob/yoh/yoh/RMK/linearRMK.lean</a> . Here I need <a href=\"https://github.com/leanprover-community/mathlib4/pull/12266\">#12266</a>. First <span class=\"user-mention\" data-user-id=\"197836\">@Jireh Loreaux</span> pointed out that I could weaken <code>NormalSpace</code> to <code>T2Space</code>, then you and <span class=\"user-mention\" data-user-id=\"111080\">@Floris van Doorn</span> suggested to use <code>PartitionOfUnity</code> instead of Urysohn's lemma.</p>",
        "id": 477666866,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729261279
    },
    {
        "content": "<p>About the suggestion to use <code>PartitionOfUnity</code>: you can prove existence of a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=BumpCovering#doc\">docs#BumpCovering</a> using your approach, then get a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=PartitionOfUnity#doc\">docs#PartitionOfUnity</a> for free.</p>",
        "id": 477667218,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261382
    },
    {
        "content": "<p>This way you don't need to redo the algebraic part of the proof.</p>",
        "id": 477667377,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261434
    },
    {
        "content": "<p>I see, by \"your approach\" do you mean changing <code>NormalSpace</code> to <code>LocallyCompactSpace</code> <code>T2Space</code> with <code>IsCompact s</code> in <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/ShrinkingLemma.html#exists_iUnion_eq_closure_subset\">the Shrinking lemma</a> ?</p>",
        "id": 477667699,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729261515
    },
    {
        "content": "<p>Also, I think about introducing an intermediate predicate <code>IsUrysohnsPair (s t : Set X)</code> that says <code>∃ f : X → Real, Continuous f ∧ EqOn f 0 s ∧ EqOn f 1 t</code> and deduce various corollaries from there.</p>",
        "id": 477667775,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261539
    },
    {
        "content": "<p>By \"your approach\" I mean \"whatever you do in your long proof of your main theorem, I haven't read the proof yet\".</p>",
        "id": 477667928,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261574
    },
    {
        "content": "<p>BTW, it should be possible to generalize from <code>T2Space</code> to <code>R1Space</code>. Also note that <code>[R1Space X] [LocallyCompactSpace X]</code> implies <code>RegularSpace X</code>, so you can reuse some of <span class=\"user-mention\" data-user-id=\"110050\">@Sébastien Gouëzel</span> 's work on Urysohn's lemma for locally compact regular spaces.</p>",
        "id": 477668208,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261661
    },
    {
        "content": "<p>It looks like your Urysohn's-like lemma doesn't need <code>X</code> to be a locally compact space, so probably you can prove it before Sébastien's and use it to deduce Sébastien's version in case of a locally compact space.</p>",
        "id": 477668511,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261743
    },
    {
        "content": "<p>well, currently <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/PartitionOfUnity.html#BumpCovering.exists_isSubordinate_of_locallyFinite_of_prop\">BumpCovering.exists_isSubordinate_of_locallyFinite_of_prop</a> depends on <code>NormalSpace</code>, so I thought we needed a variation for <code>T2Space</code> (or <code>R1Space</code>) (+ <code>LocallyCompactSpace</code>), isn't it correct?</p>",
        "id": 477668910,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729261853
    },
    {
        "content": "<p>Note: please don't start the <code>IsUrysohnsPair</code> refactor, I want to do it myself.</p>",
        "id": 477668978,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261869
    },
    {
        "content": "<p>I think that a part of your proof constructs a <code>BumpCovering</code> (without using its definition).</p>",
        "id": 477669174,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261928
    },
    {
        "content": "<p>I haven't read your proof in an editor, so I don't understand the details yet. I can do it tomorrow.</p>",
        "id": 477669376,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729261999
    },
    {
        "content": "<p>probably <code>g</code> in my proof is a <code>BumpCovering</code>, I will have to check. But at this point isn't it better to have a variation of the shrinking lemma? On the other hand, it's not clear to me how to drop <code>LocallyCompactSpace</code>.</p>",
        "id": 477670808,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729262414
    },
    {
        "content": "<p>\"Add a version of the shrinking lemma\" is a possible way to go.</p>",
        "id": 477677960,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729264563
    },
    {
        "content": "<p>But I need to better understand your proof before giving this advice.</p>",
        "id": 477678078,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1729264594
    },
    {
        "content": "<p>I see</p>",
        "id": 477682642,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1729265954
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"513978\">@Jesse Reimann</span> do you have the Lean 3 code for the characterization of the Riesz measure (that the original linear functional <code>Λ</code> is written as the integral over the measure)? Is your <code>Λ</code> <code>NNReal</code>-linear? If so, how did you show the equality, did you use <code>le_antisymm</code> and proved the both inequalities?</p>",
        "id": 483963836,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1732298559
    },
    {
        "content": "<p>Aside, it's possible to factor this theorem via locales and valuations. In that way, one could fx generalize the proof to condensed type theory, or other constructive type theories.<br>\n<a href=\"http://www.doi.org/10.1007/s11083-010-9147-3\">http://www.doi.org/10.1007/s11083-010-9147-3</a><br>\n<a href=\"http://arxiv.org/abs/0808.2705\">http://arxiv.org/abs/0808.2705</a></p>",
        "id": 484143572,
        "sender_full_name": "Bas Spitters",
        "timestamp": 1732446844
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"382902\">Yoh Tanimoto</span> <a href=\"#narrow/channel/116395-maths/topic/Riesz.20representation.20theorem/near/483963836\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"513978\">Jesse Reimann</span> do you have the Lean 3 code for the characterization of the Riesz measure (that the original linear functional <code>Λ</code> is written as the integral over the measure)? Is your <code>Λ</code> <code>NNReal</code>-linear? If so, how did you show the equality, did you use <code>le_antisymm</code> and proved the both inequalities?</p>\n</blockquote>\n<p>I have some version of Jesse's old code. I am not sure what I have is the most up to date version, and I also no longer have Lean3 to even check that it compiles, and in any case the code required ad hoc workarounds that have become unnecessary now that subtraction and multiplication on <code>BoundedContinuousFunction</code> just work even for functions with <code>NNReal</code> values.</p>\n<p>The key is certainly to prove one direction of the inequality directly, and Jesse proved:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">functional_le_riesz_integral</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">→ᵇ</span><span class=\"w\"> </span><span class=\"n\">ℝ</span><span class=\"bp\">≥</span><span class=\"mi\">0</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">≤</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∫⁻</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"w\"> </span><span class=\"n\">coe</span><span class=\"w\"> </span><span class=\"bp\">∘</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∂</span><span class=\"o\">(</span><span class=\"n\">riesz_meas</span><span class=\"w\"> </span><span class=\"n\">Λ</span><span class=\"w\"> </span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">to_nnreal</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>I'm not sure how much the proof was ever cleaned up, this is certainly one of the longer proofs. (The strategy was basically the same as in Rudin's book, except that the compact case allowed for some simplifications, if I remember correctly.)</p>\n<p>This result is also enough. If we were working with real values, then the standard trick (after <code>le_antisymm</code>) to get the other inequality would be to apply to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">-f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>, and use <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\R</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">R</span></span></span></span>-linearity. But also with <code>NNReal</code> values, a similar trick still works. Namely, one can apply this to both <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo>:</mo><mo>=</mo><mi>M</mi><mo>−</mo><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">g := M - f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> where <code>M := nndist f 0</code> is \"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi><mo>:</mo><mo>=</mo><mi mathvariant=\"normal\">∥</mi><mi>f</mi><msub><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"normal\">∞</mi></msub></mrow><annotation encoding=\"application/x-tex\">M := \\|f\\|_\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>\". (In Jesse's code, this part used our ad hoc <code>bounded_continuous_function.nnreal_sub (bounded_continuous_function.const X M) f</code>, and became unnecessarily messy, but with current Mathlib it can be done in a clean way just using the now generalized subtraction on bounded continuous functions).</p>\n<p>I hope this at least clarifies the route that Jesse took in her proof. It is just like <span class=\"user-mention\" data-user-id=\"382902\">@Yoh Tanimoto</span> suggests, plus the observation that one direction of the inequality is enough, even with <code>NNReal</code> values.</p>",
        "id": 484147203,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1732450265
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"373986\">@Kalle Kytölä</span> thanks for your reply! I suspected this, and it's a problem for my current attempt, because <code>M - f</code> is surely bounded, but not compactly supported...</p>",
        "id": 484147403,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1732450465
    },
    {
        "content": "<p>Ouch, I see. That looks more annoying to deal with.</p>\n<p>I guess in principle one could replace <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>M</mi></mrow><annotation encoding=\"application/x-tex\">M</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span> with some compactly supported function that is larger than <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>. But I don't know how much of a headache that is to deal with, since its integral is not just an obvious value.</p>",
        "id": 484147521,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1732450568
    },
    {
        "content": "<p>I'm not sure, if you take a function <code>g</code> larger than <code>f</code>, I guess you need the equality of <code>Λ</code> and the integral for <code>g</code>, or do you have something else in mind?</p>",
        "id": 484147852,
        "sender_full_name": "Yoh Tanimoto",
        "timestamp": 1732450887
    },
    {
        "content": "<p>I'm sorry, yes, you are right. This just looks harder to deal with.</p>",
        "id": 484148012,
        "sender_full_name": "Kalle Kytölä",
        "timestamp": 1732451033
    }
]