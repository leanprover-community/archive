[
    {
        "content": "<p>I have formalized Tannaka duality for finite groups and I have been trying to make it suitable to be added to mathlib. <a href=\"https://github.com/ybenmeur/mathlib4/blob/master/Mathlib/Algebra/Category/ModuleCat/project.lean\">Here</a> is the current state.<br>\nThe \"Indicator\" section needs cleaning up and should maybe be implemented more generally, there's also the <code>eval_of_alghom</code> which might be interesting in general, and also it might be useful to generalize the representations <code>τᵣ</code> and <code>τₗ</code> as well (representations on spaces of functions with domain <code>G</code> by translations, induced by left and right multiplication in <code>G</code>), that is if these aren't already in mathlib. The rest is specific for the proof and I'm not sure how I'm supposed to deal with that honestly.</p>",
        "id": 499779041,
        "sender_full_name": "Yacine Benmeuraiem",
        "timestamp": 1739549592
    },
    {
        "content": "<p>To add some context, Yacine is a student in our \"Higher categories and formalization\" master's programme de Lyon, and this is his first formalization project. I encouraged him to submit it to mathlib.</p>",
        "id": 499786891,
        "sender_full_name": "Sophie Morel",
        "timestamp": 1739552157
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"751969\">@Yacine Benmeuraiem</span> your code doesn't compile for me -- mathlib wants <code>FDRep</code> to eat a <code>Field</code> and you've given it a <code>CommRing</code>.</p>",
        "id": 499796297,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739555239
    },
    {
        "content": "<p>Line 90: it's not ideal to make definitions in tactic mode, although here you're probably OK; tactic mode can introduce random <code>id</code>s and things which are not needed; maybe</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">def</span><span class=\"w\"> </span><span class=\"n\">T_fun</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Aut</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">LaxMonoidalFunctor</span><span class=\"bp\">.</span><span class=\"n\">isoOfComponents</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">T_app</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intro</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">exact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"bp\">.</span><span class=\"n\">comm</span><span class=\"w\"> </span><span class=\"n\">g</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">symm</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">intros</span><span class=\"bp\">;</span><span class=\"w\"> </span><span class=\"n\">rfl</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>is safer.</p>",
        "id": 499796980,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739555485
    },
    {
        "content": "<p><code>rfl</code> is better than <code>exact rfl</code> (it's both shorter and more powerful to use the tactic <code>rfl</code> than the term <code>rfl</code>).</p>",
        "id": 499797078,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739555520
    },
    {
        "content": "<p><code>abbrev e</code> would not be allowed in mathlib -- you can't just claim <code>e</code> in the root namespace for your function. Probably there is a way of doing this with notation? Similarly with <code>α</code> -- maybe everything should go in a <code>TannakaDuality</code> namespace or something?</p>",
        "id": 499797373,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739555608
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">mul_e</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">k</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">•</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">e</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">ext</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">    </span><span class=\"n\">by_cases</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">t</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">h</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"bp\">·</span><span class=\"w\"> </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">e_eq_of_ne</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"o\">]</span>\n</code></pre></div>\n<p>-- let the simplifier do the work, you often don't need to explicitly invoke stuff like <code>mul_zero</code>.</p>",
        "id": 499798222,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739555896
    },
    {
        "content": "<p>Instead of <code>intros</code> at the beginning of a structure field proof (e.g. in <code>\\phi</code>) you can move the inputs left of the <code>:=</code> e.g.</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"w\">  </span><span class=\"n\">map_smul'</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"bp\">_</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">    </span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Finset</span><span class=\"bp\">.</span><span class=\"n\">smul_sum</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">smul_smul</span><span class=\"o\">]</span>\n</code></pre></div>",
        "id": 499798847,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1739556115
    },
    {
        "content": "<p>Oh yes... I changed FDRep.lean but then I wanted to keep things in one file and I missed something... <code>Rep</code> takes a <code>Ring</code> so I was confused that <code>FDRep</code> needed a <code>Field</code>.<br>\nFor  <code>e</code> I was planning on replacing every instance with <code>Pi.single</code> (as I have with many notations that I was using at first), and similarly for <code>α</code>. I hadn't thought about using notation, it would be nice if that's okay to do.<br>\nI was thinking that declaring a bunch of auxiliary things specifically for one proof was not very nice, and maybe some of them could be squeezed in directly where they are used, but I'm not sure if that would be any better. Declaring a namespace sounds good.<br>\nThanks for the feedback!</p>",
        "id": 499807873,
        "sender_full_name": "Yacine Benmeuraiem",
        "timestamp": 1739559492
    },
    {
        "content": "<p>I created PRs <a href=\"https://github.com/leanprover-community/mathlib4/pull/22173\">#22173</a> <a href=\"https://github.com/leanprover-community/mathlib4/pull/22174\">#22174</a> <a href=\"https://github.com/leanprover-community/mathlib4/pull/22176\">#22176</a>.</p>",
        "id": 501188399,
        "sender_full_name": "Yacine Benmeuraiem",
        "timestamp": 1740172603
    },
    {
        "content": "<p>Very nice! May I suggest using <code>Finite</code> somewhere in the namespace? Just to leave room for a future Tannaka duality in full generality.</p>\n<p>Also, the notation that you set up in the file will be somewhat hard to guess outside of the file. For this reason, I think it is better to use longer names. Such as <code>forget</code> instead of <code>F</code>.</p>",
        "id": 501488854,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1740389428
    },
    {
        "content": "<p>Thanks! I went for the namespace <code>TannakaDuality.FiniteGroup</code> and implemented your suggestions.</p>",
        "id": 501637747,
        "sender_full_name": "Yacine Benmeuraiem",
        "timestamp": 1740427610
    },
    {
        "content": "<p>Now that the dependent PR has been merged, could you please merge <code>master</code> into your PR branch?</p>",
        "id": 502580065,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1740749787
    },
    {
        "content": "<p>Done <span aria-label=\"+1\" class=\"emoji emoji-1f44d\" role=\"img\" title=\"+1\">:+1:</span></p>",
        "id": 502646815,
        "sender_full_name": "Yacine Benmeuraiem",
        "timestamp": 1740769199
    }
]