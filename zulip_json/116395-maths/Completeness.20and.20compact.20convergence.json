[
    {
        "content": "<p>I just noticed that the following fails:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">ContinuousFunction</span><span class=\"bp\">.</span><span class=\"n\">Compact</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"c1\">-- fails</span>\n</code></pre></div>\n<p>Can we generalise <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousMap.instCompleteSpace#doc\">docs#ContinuousMap.instCompleteSpace</a> to cover this?</p>",
        "id": 464829091,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724499426
    },
    {
        "content": "<p>More precisely:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">TopologicalSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span>\n\n<span class=\"c1\">-- We have this:</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">MetricSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"c1\">-- `ContinuousMap.instCompleteSpace`</span>\n\n<span class=\"c1\">-- But presumably this is also true:</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">UniformSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- And even this (with some uncertainty about assumptions on `X`):</span>\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">LocallyCompactSpace</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">UniformSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span>\n<span class=\"w\">    </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">X</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 464829148,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724499442
    },
    {
        "content": "<p>I <em>think</em> they're all true. This file might be helpful in establishing them: <code>Mathlib.Topology.UniformSpace.CompactConvergence</code></p>",
        "id": 465061065,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1724636407
    },
    {
        "content": "<p>Agreed. Actually what I really wanted to know was whether this is true:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BaireSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>and I now realise even given the above, it's not clear (to me, though I'd guess \"yes\").</p>\n<p>Sadly I won't have time to do anything there for at least a few weeks but maybe I can nerd snipe <em>someone</em> :)</p>",
        "id": 465137133,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724665967
    },
    {
        "content": "<p>According to this <a href=\"https://en.wikipedia.org/wiki/Hemicompact_space\">https://en.wikipedia.org/wiki/Hemicompact_space</a></p>",
        "id": 465256654,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1724699569
    },
    {
        "content": "<p>C(R,R) is metrizable, so Baire-ness will follow from completeness</p>",
        "id": 465256701,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1724699592
    },
    {
        "content": "<p>I guess it may be helpful to think about C(R,R) as a closed subspace of C([0,1],R)^N</p>",
        "id": 465256820,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1724699648
    },
    {
        "content": "<p>Ah yes, thanks. Indeed looking more carefully now I see that we have <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=ContinuousMap.instIsCountablyGeneratedProdUniformityOfWeaklyLocallyCompactSpaceOfSigmaCompactSpace#doc\">docs#ContinuousMap.instIsCountablyGeneratedProdUniformityOfWeaklyLocallyCompactSpaceOfSigmaCompactSpace</a> and so as you say completeness is sufficient. Even Lean agrees:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">Baire</span><span class=\"bp\">.</span><span class=\"n\">CompleteMetrizable</span>\n<span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span><span class=\"bp\">.</span><span class=\"n\">Topology</span><span class=\"bp\">.</span><span class=\"n\">UniformSpace</span><span class=\"bp\">.</span><span class=\"n\">CompactConvergence</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"kn\">scoped</span><span class=\"w\"> </span><span class=\"n\">Uniformity</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ùì§</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">))</span><span class=\"bp\">.</span><span class=\"n\">IsCountablyGenerated</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"c1\">-- already exists</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">CompleteSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n\n<span class=\"kn\">example</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">BaireSpace</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"o\">(</span><span class=\"n\">‚Ñù</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">‚Ñù</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">inferInstance</span><span class=\"w\"> </span><span class=\"c1\">-- works given the sorried completeness</span>\n</code></pre></div>",
        "id": 465372465,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724748635
    },
    {
        "content": "<p>To prove this completeness, you can use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformOnFun.instCompleteSpace#doc\">docs#UniformOnFun.instCompleteSpace</a> with <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=UniformOnFun.isClosed_setOf_continuous#doc\">docs#UniformOnFun.isClosed_setOf_continuous</a></p>",
        "id": 465590961,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724803834
    },
    {
        "content": "<p>The right assumption on <code>X</code> is some kind of \"compactly generated\" but I didn't follow too closely which definition landed in Mathlib.</p>",
        "id": 465591039,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724803913
    },
    {
        "content": "<p>I was going to generalize this but forgot to do it.</p>",
        "id": 465591173,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724804002
    },
    {
        "content": "<p>If you're going to formalize this, then please make sure that it works both for <code>[WeaklyLocallyCompactSpace X]</code> and for <code>[SequentialSpace X]</code>.</p>",
        "id": 465598166,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1724805975
    },
    {
        "content": "<p>Oh I see you've done so much it's dead easy from here. Great!</p>\n<p>I wasn't intending to spend any time on this but you've made it so easy I've made <a href=\"https://github.com/leanprover-community/mathlib4/pull/16224\">#16224</a></p>",
        "id": 465829908,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724870729
    },
    {
        "content": "<p>Ooooh this is quite nice: the linter complained that the new instances I added made some compactness assumptions in the Continuous Functional Calculus redundant. So I ripped them out and found a bunch more were now redundant and then <code>shake</code> told me an import was now redundant so it got binned too.</p>\n<p>Basically as I battled to get CI passing, our tooling kept pointing out how to simplify the mathematics.</p>",
        "id": 465841714,
        "sender_full_name": "Oliver Nash",
        "timestamp": 1724875627
    },
    {
        "content": "<p>That's great! Thanks for simplifying our work!</p>",
        "id": 465859302,
        "sender_full_name": "Jireh Loreaux",
        "timestamp": 1724883995
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"240862\">Oliver Nash</span> <a href=\"#narrow/stream/116395-maths/topic/Completeness.20and.20compact.20convergence/near/465841714\">said</a>:</p>\n<blockquote>\n<p>Basically as I battled to get CI passing, our tooling kept pointing out how to simplify the mathematics.</p>\n</blockquote>\n<p>And along the way forced you to spend 10x time on a \"dead easy\" task. There goes your nice free evening. /s <span aria-label=\"rofl\" class=\"emoji emoji-1f923\" role=\"img\" title=\"rofl\">:rofl:</span></p>",
        "id": 465902483,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724906038
    },
    {
        "content": "<blockquote>\n<p>Mathlib.Analysis.CStarAlgebra.ContinuousFunctionalCalculus.Restrict 1933 1393 -540 (-27.94%)</p>\n</blockquote>\n<p>Quite a substantial import reduction! Congrats!</p>",
        "id": 465902704,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1724906085
    }
]