[
    {
        "content": "<p>(This is not a fully-formed idea yet, I'm just throwing something out there.)<br>\nI'm wondering if there's a way to make sense of the philosophy of going from local to global. For example, I would like to define the term \"locally free\" correctly. This means that I would have the property \"free\" defined, and then a function \"locally\" defined, say:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">Free</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"bp\">-</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"n\">Locally</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"bp\">-</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"bp\">-</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"bp\">-&gt;</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>so that I can do <code>Locally Free : R-Module -&gt; Prop</code>.</p>\n<p>I want to make sense of the type <code>R-Module -&gt; Prop</code> in terms of category theory. It's clear that this type is nonsense until it respects all isomorphisms, which sounds like a category theory statement.</p>\n<p>PS: I feel like meta-theoretically, all definable terms <code>R-Module -&gt; Prop</code> respect isomorphisms anyway.</p>",
        "id": 520599452,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748331351
    },
    {
        "content": "<p>Are you aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom.Locally#doc\">docs#RingHom.Locally</a>, which is something similar for properties of ring homomorphisms?</p>",
        "id": 520600404,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748331657
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"648495\">Christian Merten</span> <a href=\"#narrow/channel/116395-maths/topic/ring.20properties.3A.20local.20-.3E.20global/near/520600404\">said</a>:</p>\n<blockquote>\n<p>Are you aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom.Locally#doc\">docs#RingHom.Locally</a>, which is something similar for properties of ring homomorphisms?</p>\n</blockquote>\n<p>aha, thanks! that is not about modules, but it's still useful to know that it exists for ring homs. do you know what it's used for?</p>",
        "id": 520600732,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748331779
    },
    {
        "content": "<p>(btw: for locally free, we typically just say finite projective or finitely presented + flat. Things around <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.isOpen_freeLocus#doc\">docs#Module.isOpen_freeLocus</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.free_of_flat_of_isLocalRing#doc\">docs#Module.free_of_flat_of_isLocalRing</a> will be useful)</p>",
        "id": 520600865,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748331839
    },
    {
        "content": "<p>Wow!</p>",
        "id": 520601118,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748331932
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110064\">Kenny Lau</span> <a href=\"#narrow/channel/116395-maths/topic/ring.20properties.3A.20local.20-.3E.20global/near/520600732\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"648495\">Christian Merten</span> <a href=\"#narrow/channel/116395-maths/topic/ring.20properties.3A.20local.20-.3E.20global/near/520600404\">said</a>:</p>\n<blockquote>\n<p>Are you aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom.Locally#doc\">docs#RingHom.Locally</a>, which is something similar for properties of ring homomorphisms?</p>\n</blockquote>\n<p>aha, thanks! that is not about modules, but it's still useful to know that it exists for ring homs. do you know what it's used for?</p>\n</blockquote>\n<p>It is used to force certain properties of ring homs into the framework of <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=RingHom.PropertyIsLocal#doc\">docs#RingHom.PropertyIsLocal</a> that are not necessarily local on the target (i.e., geometric source). It is used to characterise smooth morphisms of schemes as locally standard smooth (see <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgebraicGeometry.instHasRingHomPropertyIsSmoothLocallyIsStandardSmooth#doc\">docs#AlgebraicGeometry.instHasRingHomPropertyIsSmoothLocallyIsStandardSmooth</a>)</p>",
        "id": 520601191,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748331958
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">LocallyFree</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Semiring</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommMonoid</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Free</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Projective</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span>\n\n<span class=\"kn\">variable</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">CommRing</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">AddCommGroup</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Module</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"o\">]</span>\n\n<span class=\"kn\">class</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">Invertible</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"kn\">extends</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">LocallyFree</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"kn\">where</span>\n<span class=\"w\">  </span><span class=\"n\">rank1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">âˆ€</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">PrimeSpectrum</span><span class=\"w\"> </span><span class=\"n\">R</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">Module</span><span class=\"bp\">.</span><span class=\"n\">rankAtStalk</span><span class=\"w\"> </span><span class=\"n\">M</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n</code></pre></div>\n<p><span class=\"user-mention\" data-user-id=\"648495\">@Christian Merten</span> so, is this the \"canonical\" way to write this?</p>",
        "id": 520603497,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748332719
    },
    {
        "content": "<p>Did you mean to say <code>Module.Finite</code> instead of <code>Module.Free</code> in the first <code>class</code>?</p>",
        "id": 520603602,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748332757
    },
    {
        "content": "<p>ah, yes, nice catch</p>",
        "id": 520603645,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748332776
    },
    {
        "content": "<p>oh wait, then it's not mathematically accurate unless for finite modules... lol</p>",
        "id": 520603750,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748332802
    },
    {
        "content": "<p>does anyone think that R[X] is \"locally free\"?</p>",
        "id": 520603813,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748332811
    },
    {
        "content": "<p>I would say \"locally free\" is rarely used in a non-finite context. I am not sure if you need a name for it anyway, you can just assume <code>[Module.Finite R M] [Module.Projective R M]</code>.</p>",
        "id": 520604000,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748332885
    },
    {
        "content": "<p><a href=\"https://stacks.math.columbia.edu/tag/00NV\">https://stacks.math.columbia.edu/tag/00NV</a><br>\nyes, I can confirm that people usually assume \"finite\", i'm just complaining about the name, i guess this is fine</p>",
        "id": 520604193,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748332955
    },
    {
        "content": "<p>Note that there is an open PR (<a href=\"https://github.com/leanprover-community/mathlib4/pull/22341\">#22341</a>) with some more API for <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Module.rankAtStalk#doc\">docs#Module.rankAtStalk</a></p>",
        "id": 520604280,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748332989
    },
    {
        "content": "<p>nice, thanks</p>",
        "id": 520604465,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748333048
    },
    {
        "content": "<p>Also <span class=\"user-mention\" data-user-id=\"224323\">@Junyan Xu</span> has thought about invertible modules and the picard group earlier this year (only thread I could find on the spot: <a class=\"stream-topic\" data-stream-id=\"116395\" href=\"/#narrow/channel/116395-maths/topic/Puzzles.20around.20Picard.20group/with/480258239\">#maths &gt; Puzzles around Picard group</a> )</p>",
        "id": 520604580,
        "sender_full_name": "Christian Merten",
        "timestamp": 1748333100
    },
    {
        "content": "<p>well, yeah i'm sure i'm not the first one to ask about this; kevin buzzard already asked this back in 2020: <a class=\"stream-topic\" data-stream-id=\"217875\" href=\"/#narrow/channel/217875-Is-there-code-for-X.3F/topic/invertible.20modules.20are.20f.2Eg.2E/with/206372552\">#Is there code for X? &gt; invertible modules are f.g.</a></p>",
        "id": 520604842,
        "sender_full_name": "Kenny Lau",
        "timestamp": 1748333172
    }
]