[
    {
        "content": "<p>tldr; I'd like some help finding the right statement/proof for showing that you can combine pullback squares in a certain way.</p>\n<p>i'm considering doing some small topos theory lemmas (eventually) about Lawvere-Tierney topologies. on the way to defining those, i came across the following lemma:</p>\n<p>Given two pullback squares where the top morphisms are <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><msub><mi>A</mi><mn>1</mn></msub><mo>→</mo><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">f : A_1 \\rightarrow Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo>:</mo><msub><mi>B</mi><mn>1</mn></msub><mo>→</mo><mi>Z</mi></mrow><annotation encoding=\"application/x-tex\">g : B_1 \\rightarrow Z</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span></span> respectively, there is a (specific) square which is a pullback square, where the top morphism is the diagonal of the pullback square of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>. (i.e. <a href=\"https://q.uiver.app/#q=WzAsMTYsWzAsMCwiQV8xIl0sWzAsMSwiQV8yIl0sWzEsMSwiQV8zIl0sWzEsMCwiWiJdLFsyLDAsIkJfMSJdLFszLDAsIloiXSxbMywxLCJCXzMiXSxbMiwyLCJBXzFcXHRpbWVzX1ogQl8xIl0sWzMsMiwiWiJdLFsyLDMsIkFfMlxcdGltZXMgQl8yIl0sWzMsMywiQV8zIFxcdGltZXMgQl8zIl0sWzIsMSwiQl8yIl0sWzUsMSwiWiJdLFs0LDAsIkFfMVxcdGltZXNfWiBCXzEiXSxbNSwwLCJBXzEiXSxbNCwxLCJCXzEiXSxbMCwzLCJmXzEiXSxbMywyLCJmXzMiLDJdLFswLDEsImZfMiIsMl0sWzEsMiwiZl80Il0sWzAsMiwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lciJ9fV0sWzQsNSwiZ18xIl0sWzUsNiwiZ18zIiwyXSxbNCw2LCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XSxbNyw4LCJcXHBpXzFcXGdnIGZfMSJdLFs5LDEwLCJmXzRcXHRpbWVzIGdfNCJdLFs3LDksIihcXHBpXzEgXFxnZyBmXzIsXFxwaV8yIFxcZ2cgZ18yKSIsMV0sWzgsMTAsIihmXzMsZ18zKSJdLFs3LDEwLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XSxbNCwxMSwiZ18yIiwyXSxbMTEsNiwiZ180Il0sWzE1LDEyLCJnXzEiLDJdLFsxNCwxMiwiZl8xIl0sWzEzLDE0LCJcXHBpXzEiXSxbMTMsMTUsIlxccGlfMiIsMl0sWzEzLDEyLCIiLDEseyJzdHlsZSI6eyJuYW1lIjoiY29ybmVyIn19XV0=\">this</a> diagram).</p>\n<p><a href=\"https://live.lean-lang.org/#codez=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\">I've proven this in lean</a>, but the proof is very verbal (read: lots of unfolding definitions, proving certain squares commute) in a way i wasn't used from the CategoryTheory part of the library.</p>\n<p>I suspect that this is because this is not the right (generality) lemma or not the right proof, but it might also be because i might have overlooked some clearer proof...</p>\n<p>Does anyone have suggestions for simplifying this statement/proof? (i'm also not convinced that my naming sense here is correct at all)</p>",
        "id": 542750565,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1759413868
    },
    {
        "content": "<p>If the category has binary products, then the pullback square of your lemma can be obtained as a vertical composition of two pullback squares:<br>\n<a href=\"/user_uploads/3121/xcs8dpi6dfGIOeXhzrhn2aHZ/diagram.png\">diagram.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/3121/xcs8dpi6dfGIOeXhzrhn2aHZ/diagram.png\" title=\"diagram.png\"><img data-original-content-type=\"image/png\" data-original-dimensions=\"585x480\" src=\"/user_uploads/thumbnail/3121/xcs8dpi6dfGIOeXhzrhn2aHZ/diagram.png/840x560.webp\"></a></div>",
        "id": 542778014,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759420524
    },
    {
        "content": "<p>The bottom square is obtained as a binary product of two pullback squares, and the top square relates the fiber product and the binary product via the diagonal of <code>Z</code>.</p>",
        "id": 542778087,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759420537
    },
    {
        "content": "<p>i don't think we have the binary product of pullback squares in mathlib, right?</p>",
        "id": 542778655,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1759420674
    },
    {
        "content": "<p>No, but at least, this splits the lemma into two general more basic tasks.</p>",
        "id": 542778794,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759420712
    },
    {
        "content": "<p>it's indeed an improvement in argument, i was just checking to prevent duplicate work</p>",
        "id": 542779058,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1759420776
    },
    {
        "content": "<p>but this argument does need all corner pairs to have products, rather than just the bottom two.</p>",
        "id": 542779392,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1759420860
    },
    {
        "content": "<p>This is the reason why I added \"If the category has binary products\", which should not be an issue for a topos!</p>",
        "id": 542780015,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759421028
    },
    {
        "content": "<p>Otherwise, I do not see how your proof could be improved significantly!</p>",
        "id": 542780298,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759421102
    },
    {
        "content": "<p>do you think that mathlib would accept the form where you just assume <code>HasBinaryProducts C</code>+<code>HasPullback</code> (or even <code>HasFiniteLimits C</code>)? Or would it be rejected for being not as general as possible?</p>",
        "id": 542780489,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1759421156
    },
    {
        "content": "<p>If I am the one reviewing it, it would be fine :-) Nevertheless, I think it is important to allow arbitrary limit binary fans/pullback cones. For example, for binary products of pullback squares, we probably want a general version, and two corollaries phrased in terms of the binary product from the limits API and the chosen binary product (assuming <code>CartesianMonoidalCategory</code>).</p>",
        "id": 542783495,
        "sender_full_name": "Joël Riou",
        "timestamp": 1759422046
    }
]