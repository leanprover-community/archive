[
    {
        "content": "<p>Hi people, mathematician here trying to make sense of Lean by trying to formalise simple stuff. I'm currently trying to do the equivalence between the various formulations of the Axiom of Choice. Some of them I succeeded but I'm stuck in one of them which requires me to translate into Lean the following bit of mathematics: </p>\n<blockquote>\n<p>If <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> is a non-empty subset of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>×</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">A \\times Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> such that for any <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">x \\in A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> there exists exactly one <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>∈</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">y \\in Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">(x, y) \\in S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>, then there is a function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo>:</mo><mi>A</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding=\"application/x-tex\">f : A \\to Y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span></span> such that for all <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">x \\in A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>∈</mo><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">(x, f(x)) \\in S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span>.</p>\n</blockquote>\n<p>In fact, set-theoretically speaking the function <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> <em>is</em> the set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> itself. In the course of my proof in Lean, I managed to get to a context containing the following</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">Y</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span>\n<span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"n\">X</span>\n<span class=\"n\">S</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\">  </span><span class=\"n\">Set</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"bp\">×</span><span class=\"w\"> </span><span class=\"n\">Y</span><span class=\"o\">)</span>\n<span class=\"n\">ha</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Nonempty</span><span class=\"w\"> </span><span class=\"n\">A</span>\n<span class=\"n\">h1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∃</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">p</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"n\">x</span>\n<span class=\"n\">h2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">p₁</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"n\">p₂</span><span class=\"w\"> </span><span class=\"bp\">∈</span><span class=\"w\"> </span><span class=\"n\">S</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">p₁</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">p₂</span><span class=\"w\"> </span><span class=\"bp\">→</span><span class=\"w\"> </span><span class=\"n\">p₁</span><span class=\"bp\">.</span><span class=\"m\">1</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"n\">p₂</span><span class=\"bp\">.</span><span class=\"m\">1</span>\n</code></pre></div>\n<p>From this I haven't been able to deduce the existence of a Lean function <code>f : X → Y</code> satisfying the condition<br>\n<code>∀ x ∈ A, (x, f x) ∈ S</code>; but I'm not really sure I need to, because mathematically <code>S</code> as above is already the desired function.  Is it possible to obtain an actual Lean function <code>f</code> as  stated without an unreasonable amount of extra work?</p>",
        "id": 466046466,
        "sender_full_name": "Alexandre Soares",
        "timestamp": 1724945091
    },
    {
        "content": "<p><code>fun x =&gt; (h1 x).choose.2</code> should be such a function. proving that it is will likely be helped by <code>(h1 x).choose_spec</code></p>",
        "id": 466047334,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1724945337
    },
    {
        "content": "<p>(note the use of the axiom of choice in order to move from <code>h1 x : ∃ p ∈ S, p.1 = x</code> to <code>p : A × Y</code>)</p>",
        "id": 466047644,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1724945427
    },
    {
        "content": "<p>Welcome! Be careful that your choice of topic is maybe not the greatest idea. Things that are very close to the foundations are bound to expose foundational differences between Lean and what you are used to. This may be very distracting in your learning.</p>",
        "id": 466050279,
        "sender_full_name": "Patrick Massot",
        "timestamp": 1724946143
    },
    {
        "content": "<p>perhaps it would be useful to work with the <code>ZFSet</code>s in mathlib? (i don't know how user-friendly those are compared to the usual <code>Set</code> though...)</p>",
        "id": 466051267,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1724946368
    },
    {
        "content": "<p>also note that i merely know of their existence, i have no experience working with them.</p>",
        "id": 466051383,
        "sender_full_name": "Edward van de Meent",
        "timestamp": 1724946393
    },
    {
        "content": "<p>For a beginner, I would indeed avoid <code>ZFSet</code></p>",
        "id": 466052261,
        "sender_full_name": "Ruben Van de Velde",
        "timestamp": 1724946607
    },
    {
        "content": "<p>For a beginner, I would avoid set theory completely as Patrick said, because Lean's foundations are completely different. Even the meaning of \"axiom of choice\" is rather different in lean to set theory.</p>",
        "id": 466062283,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1724949049
    },
    {
        "content": "<p>Thank you all for your answers!</p>\n<p><span class=\"user-mention\" data-user-id=\"110031\">@Patrick Massot</span> I started in Lean by playing with some Analysis stuff and found it very satisfying. I should probably go back to that for now until I am more familiar with the idiosyncrasies of the foundations.</p>\n<p><span class=\"user-mention silent\" data-user-id=\"684366\">Edward van de Meent</span> <a href=\"#narrow/stream/116395-maths/topic/Still.20trying.20to.20grasp.20how.20far.20I.20should.20take.20formalizations/near/466047334\">said</a>:</p>\n<blockquote>\n<p><code>fun x =&gt; (h1 x).choose.2</code> should be such a function. proving that it is will likely be helped by <code>(h1 x).choose_spec</code></p>\n</blockquote>\n<p>My bad, I forgot to say that I wanted some construction that does not use <code>Classical.choose</code>. At some point I tricked myself into thinking I found a formalisation, as Lean wasn't complaining and the goal was cleared. But then I realized that I was using <code>choose</code>  in the middle of it and it makes the whole argument invalid, since I am trying to prove the Axiom of Choice itself.</p>",
        "id": 466099648,
        "sender_full_name": "Alexandre Soares",
        "timestamp": 1724960623
    },
    {
        "content": "<p>you should probably give a complete <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> statement then, to show what version of the axiom of choice you are assuming and proving</p>",
        "id": 466111688,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1724965124
    },
    {
        "content": "<p>if you are not assuming the axiom of choice, and you don't want to use <code>Classical.choose</code>, then it obviously can't be done: without some form of the axiom of choice or an equivalent you can't prove the axiom of choice. That's why it's an axiom in the first place</p>",
        "id": 466111808,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1724965189
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110049\">@Mario Carneiro</span>  what I posted above is practically a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a>, the only thing it needs is <code>import Mathlib</code> at the top and wrapping the judgements and desired conclusion in an <code>example</code>.</p>\n<p>The conclusion I originally described can obviously be done in Set Theory without the Axiom of Choice -- it's a trivial matter of checking that the set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>S</mi></mrow><annotation encoding=\"application/x-tex\">S</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span></span> satisfies the definition of a function.</p>",
        "id": 466148169,
        "sender_full_name": "Alexandre Soares",
        "timestamp": 1724986717
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"749859\">@Alexandre Soares</span> That's not what a <a href=\"https://leanprover-community.github.io/mwe.html\">#mwe</a> is, please read the link. You can use <code>extract_goal</code> to produce a complete example that can be copied, but it is very important when asking these kind of questions to give all the context in copy-pastable form</p>",
        "id": 466150211,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1724987980
    },
    {
        "content": "<p>What you posted above doesn't even say what the original hypotheses are, only some hypotheses in the middle, and it lacks a goal statement except in a rephrased form. As others have pointed out, for a question like this which is close to the foundations it is important to have the <em>exact</em> goal you are giving to lean because the details matter</p>",
        "id": 466150444,
        "sender_full_name": "Mario Carneiro",
        "timestamp": 1724988104
    }
]