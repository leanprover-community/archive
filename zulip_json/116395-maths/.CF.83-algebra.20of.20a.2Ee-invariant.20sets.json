[
    {
        "content": "<p>I'm going to define the σ-algebra of measurable sets that are a.e.-invariant under a given self-map <code>f</code>, as a <code>MeasurableSpace</code>. I have a few questions:</p>\n<ul>\n<li>how should I call it?</li>\n<li>should I have a separate definition without a measurability assumption (possibly, for any countably generated filter instead of <code>μ.ae</code>), then take <code>inf</code> with the instance?</li>\n<li>should I use <code>MeasurableSet</code> or <code>NullMeasurableSet</code>?</li>\n</ul>",
        "id": 389108796,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693892373
    },
    {
        "content": "<p>My thoughts:</p>\n<ul>\n<li><code>AEInvariants</code>? What are existing names for sigma-algebras?</li>\n<li>I don't know of any application without measurability</li>\n<li>If you define it for <code>MeasurableSet</code>, then you can also use it for <code>NullMeasurableSet</code>, right?</li>\n</ul>",
        "id": 389114762,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1693895342
    },
    {
        "content": "<p>I would define two sigma-algebras, <code>f.Invariants</code> and <code>f.AEInvariants μ</code>. The first one would be the set of measurable sets which coincide exactly with their preimage, the second one the set of null-measurable sets which coincide ae with their preimage. If I'm not mistaken, both of these are sigma-algebras even if <code>f</code> is not measurable.</p>",
        "id": 389115226,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1693895557
    },
    {
        "content": "<p>Btw, if you want to formalize Birkhoff, the nicest proof I know is the one in Hasselblatt-Katok, which I formalized in Isabelle in <a href=\"https://www.isa-afp.org/browser_info/current/AFP/Ergodic_Theory/Invariants.html\">https://www.isa-afp.org/browser_info/current/AFP/Ergodic_Theory/Invariants.html</a>. I describe the proof informally in this document (look for <code>subsection ‹Birkhoff theorem›</code>)</p>",
        "id": 389115653,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1693895780
    },
    {
        "content": "<p>I have a printed version of Hasselblatt-Katok, and I read the proof there today.</p>",
        "id": 389117382,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693896532
    },
    {
        "content": "<p>I'm going to add <code>MeasurableSpace.invariants</code> and <code>MeasurableSpace.aeinvariants</code></p>",
        "id": 389117999,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693896808
    },
    {
        "content": "<p>It would be nice to have these defined for an arbitrary equivalence relation rather than just the one generated by a single function.</p>",
        "id": 389265912,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1693942240
    },
    {
        "content": "<p>It's not an equivalence relation if <code>f</code> is not injective.</p>",
        "id": 389269034,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693943419
    },
    {
        "content": "<p>What definition do you have in mind for an arbitrafy equivalence relation?</p>",
        "id": 389269090,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693943446
    },
    {
        "content": "<p>(note: for sets invariant under the action of a monoid, we can use <code>⨅ g, invariants (g • ·)</code></p>",
        "id": 389269226,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693943504
    },
    {
        "content": "<p>By a set <code>s</code> being <code>E</code> invariant, for <code>E</code> an equivalence relation, I mean that whenever <code>x E y</code> and <code>x \\in s</code>, then <code>y \\in s</code>.</p>\n<p>Am I misunderstanding the definition of <code>f</code> invariant, or is it the same as invariant for the equivalence relation generated by (the graph of) <code>f</code>?</p>",
        "id": 389318786,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1693965282
    },
    {
        "content": "<p>I meant <code>f ⁻¹' s = s</code> (or a.e. equal to).</p>",
        "id": 389322576,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693967185
    },
    {
        "content": "<p>That's equivalent right?</p>",
        "id": 389327392,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1693969737
    },
    {
        "content": "<p>For <code>a.e.</code>?</p>",
        "id": 389329721,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693970992
    },
    {
        "content": "<p><del>I'm mostly interested in the a.e. version.</del> not sure</p>",
        "id": 389329792,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1693971014
    },
    {
        "content": "<p>hmm I agree that for a.e. it is not so clear. Maybe it would indeed be best to stick with a single function if that's what you're more interested in.</p>",
        "id": 389332829,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1693972871
    },
    {
        "content": "<p>It seems that if we define <code>invariants</code>, then <code>aeinvariants</code> is just <code>NullMeasurableSet</code>s for <code>invariants</code>.</p>",
        "id": 389775344,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694130225
    },
    {
        "content": "<p>It depends on your precise definitions. If <code>invariants</code> are all the measurable sets that coincide exactly with their preimage while <code>aeinvariants</code> are all the null-measurable sets that coincide ae with their preimage, then they don't coincide even when changing the sigma-algebra.</p>",
        "id": 389812183,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1694150814
    },
    {
        "content": "<p>Indeed, for each null-measurable set <code>s</code> that is a.e. equal to its preimage we can find a null-measurable set <code>t</code> that is a.e. equal to its preimage but there is no guarantee that <code>t</code> will be measurable.</p>",
        "id": 389819234,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694154854
    },
    {
        "content": "<p>Scratch that.</p>",
        "id": 389819446,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694154998
    },
    {
        "content": "<p>I'll think again when I feel better.</p>",
        "id": 389819480,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694155018
    },
    {
        "content": "<p>For a quasi measure preserving <code>f</code> we can take a measurable <code>t</code> that is a.e. equal to <code>s</code>, then use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=MeasureTheory.Measure.QuasiMeasurePreserving.exists_preimage_eq_of_preimage_ae#doc\">docs#MeasureTheory.Measure.QuasiMeasurePreserving.exists_preimage_eq_of_preimage_ae</a></p>",
        "id": 389819797,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694155186
    },
    {
        "content": "<p>Thus any set from <code>aeinvariants</code> is a <code>NullMeasurableSet</code> w.r.t. <code>μ.trim (invariants f)</code></p>",
        "id": 389819907,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694155236
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"214703\">Yury G. Kudryashov</span> <a href=\"#narrow/stream/116395-maths/topic/.CF.83-algebra.20of.20a.2Ee-invariant.20sets/near/389819907\">said</a>:</p>\n<blockquote>\n<p>Thus any set from <code>aeinvariants</code> is a <code>NullMeasurableSet</code> w.r.t. <code>μ.trim (invariants f)</code></p>\n</blockquote>\n<p>Yes, I think that is correct.</p>",
        "id": 389821733,
        "sender_full_name": "Sebastien Gouezel",
        "timestamp": 1694156153
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"464202\">@Felix Weilacher</span> Do you have a use case for <code>relInvariants</code>?</p>",
        "id": 389989450,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694232539
    },
    {
        "content": "<p>Nothing I plan to formalize in the near future, but it's pretty common in ergodic theory to think about countable Borel equivalence relations (and measures which are ergodic w.r.t. them) in the abstract. Even though these are often induced by a group action as you mentioned, it's a useful piece of abstraction.</p>",
        "id": 390048240,
        "sender_full_name": "Felix Weilacher",
        "timestamp": 1694276958
    },
    {
        "content": "<p>I suggest that we define <code>invariants</code> now, then add <code>relInvariants</code> and prove <code>invariants f = relInvariants (f ⋅ = ⋅)</code> when needed.</p>",
        "id": 390063228,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694292216
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib4/pull/7054\">#7054</a> (depends on <a href=\"https://github.com/leanprover-community/mathlib4/pull/7045\">#7045</a>)</p>",
        "id": 390063240,
        "sender_full_name": "Yury G. Kudryashov",
        "timestamp": 1694292233
    }
]