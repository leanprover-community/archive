[
    {
        "content": "<p>In <a href=\"https://github.com/leanprover-community/mathlib4/pull/23533\">#23533</a>, I give a definition of a CM-extension of number fields:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span><span class=\"w\"> </span><span class=\"n\">IsCMExtension</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span>\n<span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Algebra</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span>\n<span class=\"w\">  </span><span class=\"kd\">extends</span><span class=\"w\"> </span><span class=\"n\">IsTotallyReal</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">IsTotallyComplex</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">finrank_eq_two'</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Module.finrank</span><span class=\"w\"> </span><span class=\"n\">F</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n</code></pre></div>\n<p>then I prove some results about these extensions in series of PR with, in the end, the proof of the relation between the regulators of <code>F</code> and <code>K</code>.</p>\n<p>In another series of PR starting with <a href=\"https://github.com/leanprover-community/mathlib4/pull/23760\">#23760</a>, I define <code>maximalRealSubfield K</code> (I guess the name is self-explanatory) and make the following definition:</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"n\">abbrev</span><span class=\"w\"> </span><span class=\"n\">IsCM</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">IsCMExtension</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">maximalRealSubfield</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">K</span>\n</code></pre></div>\n<p>and prove that if there exists <code>F</code> such that <code>IsCMExtension F K</code> then <code>IsCM K</code> since in this situation <code>F</code> and <code>maximalRealSubfield K</code> are isomorphic. Indeed, if <code>K</code> is a CM-field then it is a CM-field over its maximal real subfield.</p>\n<p>In his review of <a href=\"https://github.com/leanprover-community/mathlib4/pull/23533\">#23533</a> (and in private DMs),  <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span>  remarked that he's not sure about the necessity to have <code>IsCMExtension</code> since if we have <code>IsCMExtension F K</code>, then we know that <code>F</code> will always be, essentially, equal to <code>maximalRealSubfield K</code>, so (a modified version of) <code>IsCM</code> should be enough. That's definitely true but I think it still worthwhile to keep<br>\n<code>IsCMExtension</code> (maybe as a def rather than a class) since I believe it will allow for more flexibility. Note that it is possible that I am not doing a very good job at presenting <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span>  position -- and if so, I am very sorry --, but I am sure he will be able to state it more correctly if needed.</p>\n<p>In any case, since <span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span>  and I were not able to reach a consensus, we decided to create this post to ask for some remarks, suggestions and advices from the community.</p>",
        "id": 511400641,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1744289420
    },
    {
        "content": "<p>I haven't thought long about this, but I guess it will be quite convenient to have the flexibility of <code>IsCMExtension</code>, for example when looking at <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}(i) / \\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathbb\">Q</span></span></span></span>.</p>",
        "id": 511403317,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744290121
    },
    {
        "content": "<p>I am quite conflicted about this sort of question. I wanted to prove a bunch of results about adeles of a general number field by showing <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"double-struck\">A</mi><mi>K</mi></msub><mo>=</mo><msub><mi mathvariant=\"double-struck\">A</mi><mi mathvariant=\"double-struck\">Q</mi></msub><mo>⊗</mo><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{A}_K=\\mathbb{A}_{\\mathbb{Q}}\\otimes K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9556em;vertical-align:-0.2667em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⊗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> (WIP in FLT) and then proving stuff for the adeles of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span>, but the way mathlib was set up a few months ago this involved having to prove results about the integers of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> which looked like a far less convenient object than <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span>. So I made a PR to allow adeles of a number field to supply its own integer ring rather than \"the ring of integers of the number field\" but whilst I was waiting for it to get merged I got the hang of the integers of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span> and ultimately just proved everything I needed for them anyway (they're isomorphic to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord mathbb\">Z</span></span></span></span> and this is good enough in practice for what I needed). So now I just don't know whether this extra flexibility is useful or not. But my instinct is to allow it, just in case it is :-)</p>",
        "id": 511411400,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744291853
    },
    {
        "content": "<p>Should we introduce <code>IsRingOfIntegers A K</code> with an instance for <code>IsRingOfIntegers Z Q</code>?</p>",
        "id": 511412847,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1744292166
    },
    {
        "content": "<p>What are the typeclasses on K making this meaningful?</p>",
        "id": 511413169,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744292245
    },
    {
        "content": "<p>Maybe just <code>NumberField K</code> for now.</p>",
        "id": 511413584,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1744292346
    },
    {
        "content": "<p>The function field case is more subtle, of course</p>",
        "id": 511413660,
        "sender_full_name": "Adam Topaz",
        "timestamp": 1744292365
    },
    {
        "content": "<p>Do we want S-integers? This is more complicated because the S is currently <code>HeightOneSpectrum A</code> rather than depending on <code>K</code> alone.</p>",
        "id": 511414272,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744292497
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs\">#docs4</a> <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/DedekindDomain/SInteger.html\">Set.integer</a></p>",
        "id": 511421453,
        "sender_full_name": "David Ang",
        "timestamp": 1744294120
    },
    {
        "content": "<p>But what we want is <code>IsInteger</code>, not <code>Integer</code></p>",
        "id": 511421903,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744294225
    },
    {
        "content": "<p>There's also Nonarch local fields of course!</p>",
        "id": 511422010,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1744294255
    },
    {
        "content": "<p>For number fiels we basically already have it, <code>IsIntegralClosure Z ...</code></p>",
        "id": 511423899,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1744294671
    },
    {
        "content": "<p>It seems to me that we are departing from <span class=\"user-mention\" data-user-id=\"488648\">@Xavier Roblot</span> 's initial topic of CM fields. Let me try to explain why I believe that a class <code>IsCMExtension</code> is not very useful, and even on my opinion a bit unfortunate, unlike <code>IsCMField</code>. It seems to meet that being CM is really an absolute notion, not a relative one, so carrying over the totally real subfield is useless, it just makes it necessary to define it before stating that a field is CM. For instance, the Hilbert class field of an imaginary quadratic field whose class group is a 2-group is CM, but the totally real subfield is nasty to describe.</p>",
        "id": 511441485,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744298772
    },
    {
        "content": "<p>Moreover, two non definitionally equal descriptions of the totally real subfield for the same CM field would give rise to two different terms, so if you start with a pair <code>F K</code> that is a CM extension, most probably <code>F</code> will be different from <code>K+</code>, so you also end up with the CM extension <code>K+ K</code>.</p>",
        "id": 511442082,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744298909
    },
    {
        "content": "<p>Finally, I do not really see how type class inference night fire, because I see no example of an <code>Algebra F K</code> instance that woould be promoted to <code>IsCMExtension</code> automatically.</p>",
        "id": 511442538,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744299016
    },
    {
        "content": "<p>IMHO we need the classes <code>IsCMField</code> and a more general one <code>IsQuadraticExtension</code> (for very general fields beyond number fields) and an instance of <code>IsCMField K</code> out of a <code>IsTotallyImmaginary K</code>, <code>IsTotallyReal F</code> and <code>IsQuadraticExtension F K</code>.</p>",
        "id": 511443181,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744299167
    },
    {
        "content": "<p>The disadvantage of having both classes <code>IsCMField K</code> and <code>IsCMExtension F K</code> is the high risk of code duplication, plus a flurry design, where it would not be clear if we want to develop the library for one or for the other class, ending up with some contributors developing one and  other developing the other.</p>",
        "id": 511443705,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744299293
    },
    {
        "content": "<p>So the idea in the current design is that if there is a <code>IsCM K</code> instance (I guess that's what Filippo calls <code>IsCMField K</code>) then automatically a <code>IsCMExtension (maximalRealSubfield K) K</code> instance is added and thus all the general results about <code>IsCMExtension</code> can be applied to <code>maximalRealSubfield K</code>. </p>\n<p>I agree that there is a chance that people start developing results about <code>maximalRealSubfield K</code> under the <code>IsCM K</code> instance rather than use the general case given by <code>IsCMExtension F K</code>. I was planning to add a remark in the implementation notes against doing that. </p>\n<p>In any case, whether we call it <code>IsCMExtension</code> or decide to not give it a name, we need something that says: \"this is the maximal real subfield of this totally complex number field\", thus why not develop the API for this general case...</p>",
        "id": 511464342,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1744304897
    },
    {
        "content": "<p>I think that one point is to decide whether to steer they library towards proving results for CM fields or for pairs of a CM field together with a totally real subfield. My idea is that the former is preferable, and that all results I can think of that speak about the totally real subfield should just depend on the general setting of quadratic extensions (plus tot. imaginary/real assumptions)</p>",
        "id": 511472013,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744306312
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"300245\">@Filippo A. E. Nuccio</span> So do I understand correctly that you are advocating for <code>IsCM K</code> and that Xavier's <code>IsCMExtension F K</code> is spelled as <code>[IsTotallyReal F] [IsCM K] [IsQuadratic F K]</code> instead?</p>",
        "id": 511489616,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744311646
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/channel/116395-maths/topic/CM-extensions.20of.20number.20fields/near/511489616\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> So do I understand correctly that you are advocating for <code>IsCM K</code> and that Xavier's <code>IsCMExtension F K</code> is spelled as <code>[IsTotallyReal F] [IsCM K] [IsQuadratic F K]</code> instead?</p>\n</blockquote>\n<p>Yes, this is precisely what I have in mind.</p>",
        "id": 511580741,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744356615
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"488648\">@Xavier Roblot</span> To me <span aria-label=\"up\" class=\"emoji emoji-2b06\" role=\"img\" title=\"up\">:up:</span> seems a reasonable design. What do you think of it?<br>\nBecause <code>IsCM K</code> will not be able to be inferred from <code>[IsCMExtension ?F K]</code> if <code>?F</code> is unknown. For that reason, I think <span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span>'s suggestion is a good one.</p>",
        "id": 512072746,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744635400
    },
    {
        "content": "<p>Note that in the spelling <code>[IsTotallyReal F] [IsCM K] [IsQuadratic F K]</code>, the only necessary information provided by <code>IsCM K</code> is that <code>K</code> is totally complex and thus the spelling:<br>\n<code>[IsTotallyReal F] [IsTotallyComplex K] [IsQuadratic F K]</code> is probably better (which is more or less the content of <code>IsCMExtension</code>). So the suggestion is, I guess, to not define the class <code>IsCMExtension</code> but to use instead the corresponding explicit hypothesis to prove the general results about CM extensions.</p>",
        "id": 512259189,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1744705834
    },
    {
        "content": "<p>Now, that means that to be able to use the results proved in the general case above to the special case of <code>maximalRealSubfield K</code>, it will be necessary to do something like that</p>\n<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">class</span><span class=\"w\"> </span><span class=\"n\">IsCM</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Prop</span><span class=\"w\"> </span><span class=\"n\">where</span>\n<span class=\"w\">  </span><span class=\"n\">isTotallyReal</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsTotallyReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">maximalRealSubfield</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"n\">isQuadratic</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsQuadratic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">maximalRealSubfield</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">K</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsCM</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsTotallyReal</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">maximalRealSubfield</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n\n<span class=\"kd\">instance</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Type</span><span class=\"bp\">*</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">Field</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">IsCM</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsQuadratic</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">maximalRealSubfield</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span>\n</code></pre></div>\n<p>But I guess that's okay.</p>",
        "id": 512259410,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1744705897
    },
    {
        "content": "<p>For the <code>IsCM</code> class, isn't the maximal real subfield totally real by def? Or how is it defined?</p>",
        "id": 512260754,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1744706297
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"488648\">Xavier Roblot</span> <a href=\"#narrow/channel/116395-maths/topic/CM-extensions.20of.20number.20fields/near/512259189\">said</a>:</p>\n<blockquote>\n<p>Note that in the spelling <code>[IsTotallyReal F] [IsCM K] [IsQuadratic F K]</code>, the only necessary information provided by <code>IsCM K</code> is that <code>K</code> is totally complex and thus the spelling:<br>\n<code>[IsTotallyReal F] [IsTotallyComplex K] [IsQuadratic F K]</code> is probably better (which is more or less the content of <code>IsCMExtension</code>). So the suggestion is, I guess, to not define the class <code>IsCMExtension</code> but to use instead the corresponding explicit hypothesis to prove the general results about CM extensions.</p>\n</blockquote>\n<p>I agree that in the presence of <code>[IsTotallyReal F] [IsQuadratic F K]</code> the two assumptions <code>[IsTotallyComplex K]</code> and <code> [IsCM K]</code> are equivalent. And it definitely should be a lemma!<br>\nBut this is not something that TC synthesis can figure out. It can do the direction <code>IsCM K -&gt; IsTotallyComplex K</code>. But the converse is not possible, because it will have to pull <code>F</code> out of thin air.</p>\n<p>That's why I would consider keeping the <code>IsCM K</code> hypothesis in place in examples where we want to reason flexibly about the totally real subfield.</p>",
        "id": 512261034,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1744706381
    }
]