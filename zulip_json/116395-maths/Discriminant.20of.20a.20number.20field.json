[
    {
        "content": "<p>To work on flt-regular we will need the discriminant of a number field. The usual <a href=\"https://en.wikipedia.org/wiki/Discriminant_of_an_algebraic_number_field\">definition</a> uses embeddings in the complex numbers.</p>\n<p>I propose to define it as the determinant of the matrix given by the trace of all the products of an integral basis of the ring of integers.</p>\n<p>Any ideas about this definition?</p>",
        "id": 259517408,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635510766
    },
    {
        "content": "<p>Note that we already have <a href=\"https://leanprover-community.github.io/mathlib_docs/find/algebra.trace\">docs#algebra.trace</a></p>",
        "id": 259517611,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635510886
    },
    {
        "content": "<p>This I guess would be an easy way to define it, but having the embedding definition is handy for proving things about discriminants. So I'm not sure if we've just made our proofs more annoying (although maybe for <code>flt_regular</code> we can get away with it).</p>",
        "id": 259518654,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1635511557
    },
    {
        "content": "<p>The problem with the other definition is that we have to choose an algebraic closure (or work inside <code>C</code>) from the beginning. But if at some point we want to add something to our base field, like the root of a polynomial and we use <a href=\"https://leanprover-community.github.io/mathlib_docs/find/adjoin_root\">docs#adjoin_root</a>, we are note anymore in the same algebraic closure. We can of course add the relevant root from the algebraic closure, but we don't have the API for <code>adjoint_root</code>.</p>",
        "id": 259521081,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635512831
    },
    {
        "content": "<p>It might not be relevant for flt-regular but at some point we'll need the theorem saying the rank of the unit group is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>+</mo><mi>s</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r+s-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> and we'll need embeddings in the complexes for this too.</p>",
        "id": 259521110,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635512842
    },
    {
        "content": "<p>Sure, sooner or later embeddings are needed for algebraic number theory. But a number field is not a subfield of <code>C</code>, so it seems quite unnatural to work only in <code>C</code>.</p>",
        "id": 259521277,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635512924
    },
    {
        "content": "<p>One also wants the concept of the determinant of an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-tuple (e.g. isn't this the way one proves that certain rings are the full ring of integers, you find a potential ring of integers, like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">[</mo><mi>α</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}[\\alpha]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">]</span></span></span></span> in some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}(\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span>, compute the discriminant of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-tuple <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>α</mi><mo separator=\"true\">,</mo><msup><mi>α</mi><mn>2</mn></msup><mo separator=\"true\">,</mo><mo>…</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{1,\\alpha,\\alpha^2,\\ldots\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mclose\">}</span></span></span></span>, and then argue that if the ring were any bigger then its discriminant would not be an integer).</p>",
        "id": 259521498,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635513045
    },
    {
        "content": "<p>How do Pari and LMFDB do it? I doubt they use complexes. I think the determinant of the trace form is a fine idea.</p>",
        "id": 259521784,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635513180
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/259521498\">said</a>:</p>\n<blockquote>\n<p>One also wants the concept of the determinant of an <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-tuple (e.g. isn't this the way one proves that certain rings are the full ring of integers, you find a potential ring of integers, like <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Z</mi><mo stretchy=\"false\">[</mo><mi>α</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Z}[\\alpha]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Z</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">]</span></span></span></span> in some <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}(\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span>, compute the discriminant of the <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>-tuple <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>α</mi><mo separator=\"true\">,</mo><msup><mi>α</mi><mn>2</mn></msup><mo separator=\"true\">,</mo><mo>…</mo><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{1,\\alpha,\\alpha^2,\\ldots\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">…</span><span class=\"mclose\">}</span></span></span></span>, and then argue that if the ring were any bigger then its discriminant would not be an integer).</p>\n</blockquote>\n<p>You can still do this with this Ricardo's definition, just take the det of the matrix of  traces of the products of the elements.</p>",
        "id": 259521859,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1635513224
    },
    {
        "content": "<p>Exactly, this works out of the box for a tuple of elements in a <code>R</code>-algebra <code>A</code>, without any assumption.</p>",
        "id": 259522021,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635513302
    },
    {
        "content": "<p>I guess that to take the trace you need finitely generated and projective (maybe finitely presented in the non-Noetherian case)</p>",
        "id": 259523252,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635513881
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"kd\">noncomputable</span> <span class=\"kd\">def</span> <span class=\"n\">trace</span> <span class=\"o\">:</span> <span class=\"n\">S</span> <span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"o\">(</span><span class=\"n\">linear_map.trace</span> <span class=\"n\">R</span> <span class=\"n\">S</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">comp</span> <span class=\"o\">(</span><span class=\"n\">lmul</span> <span class=\"n\">R</span> <span class=\"n\">S</span><span class=\"o\">)</span><span class=\"bp\">.</span><span class=\"n\">to_linear_map</span>\n</code></pre></div>\n<p>No assumptions <span aria-label=\"big smile\" class=\"emoji emoji-1f604\" role=\"img\" title=\"big smile\">:big_smile:</span></p>",
        "id": 259523547,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635514018
    },
    {
        "content": "<p>It's probably not very well behaved in general, but it's there.</p>",
        "id": 259523584,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635514037
    },
    {
        "content": "<p>?! Does it give the right thing in a projective non-free example?</p>",
        "id": 259523873,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635514197
    },
    {
        "content": "<p>Not that it matters for fields, but still...</p>",
        "id": 259523940,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635514215
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"Lean\"><pre><span></span><code><span class=\"sd\">/-- Trace of an endomorphism independent of basis. -/</span>\n<span class=\"kd\">def</span> <span class=\"n\">trace</span> <span class=\"o\">:</span> <span class=\"o\">(</span><span class=\"n\">M</span> <span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"n\">M</span><span class=\"o\">)</span> <span class=\"bp\">→ₗ</span><span class=\"o\">[</span><span class=\"n\">R</span><span class=\"o\">]</span> <span class=\"n\">R</span> <span class=\"o\">:=</span>\n<span class=\"k\">if</span> <span class=\"n\">H</span> <span class=\"o\">:</span> <span class=\"bp\">∃</span> <span class=\"o\">(</span><span class=\"n\">s</span> <span class=\"o\">:</span> <span class=\"n\">finset</span> <span class=\"n\">M</span><span class=\"o\">),</span> <span class=\"n\">nonempty</span> <span class=\"o\">(</span><span class=\"n\">basis</span> <span class=\"n\">s</span> <span class=\"n\">R</span> <span class=\"n\">M</span><span class=\"o\">)</span>\n<span class=\"k\">then</span> <span class=\"n\">trace_aux</span> <span class=\"n\">R</span> <span class=\"n\">H.some_spec.some</span>\n<span class=\"k\">else</span> <span class=\"mi\">0</span>\n</code></pre></div>\n<p>youch</p>",
        "id": 259524028,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635514264
    },
    {
        "content": "<p>the definition should have a health warning</p>",
        "id": 259524057,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635514283
    },
    {
        "content": "<p><span aria-label=\"scream\" class=\"emoji emoji-1f631\" role=\"img\" title=\"scream\">:scream:</span></p>",
        "id": 259524235,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635514365
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"238446\">@Anne Baanen</span> I know you're on holiday so this can definitely wait. If <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">A\\to B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> is a morphism of commutative rings and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> is <em>not</em> a finite free <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span>-module but if it is _locally_ finite free (for example a non-zero ideal of a Dedekind domain is not always principal i.e. free but it is always locally free of rank 1) then there's still a notion of trace, which will be used by people in the algebra community. On the other hand what we currently have covers most usages of the word (but perhaps not what we want in this thread, if we start doing traces from <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> to <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> if <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span> is the integers in a number field and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">A</span></span></span></span> is the integers in a smaller number field). I guess also there is a notion of trace in the theory of Banach spaces, where the endomorphisms are of infinite-dimensional spaces but there might be a good notion of trace anyway (morally the sum of the eigenvalues happens to converge). Maybe this is just an unsolvable problem -- maybe the algebraists / algebraic number theorists need to define <code>relative_trace</code> or something, and the Banach space people need to define <code>banach_trace</code> ...</p>",
        "id": 259524935,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635514667
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/259521784\">said</a>:</p>\n<blockquote>\n<p>How do Pari and LMFDB do it? I doubt they use complexes. I think the determinant of the trace form is a fine idea.</p>\n</blockquote>\n<p>I expect they compute an integral basis and then use the trace form. Computing the discriminant of the defining polynomial can be done without embeddings by using resultants and from there I think one can start to generate the integral basis.</p>",
        "id": 259525518,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1635514936
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"110038\">@Kevin Buzzard</span> For infinite dimensional spaces, you indeed have (at least) two notions of traces:</p>\n<ol>\n<li>The algebraic one, for endomorphisms of finite rank. </li>\n<li>For (say Banach) spaces,  analytic one, defined on the subspace of “endomorphisms with finite trace”, which are limits of operators of finite rank, defined by a formula $\\sum a_i f_i \\otimes e_i$ (where $(a_i)$ is a summable family of scalars, $f_i$ an bounded family of linear forms, $e_i$ a bounded family of vectors), and the trace is $\\sum a_i f_i(e_i)$.</li>\n</ol>\n<p>In Hilbert spaces, (2) coincides with the linear span of hermitian endomorphisms whose sum of eigenvalues converges.</p>",
        "id": 259527554,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1635515817
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/259521110\">said</a>:</p>\n<blockquote>\n<p>It might not be relevant for flt-regular but at some point we'll need the theorem saying the rank of the unit group is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>+</mo><mi>s</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r+s-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.66666em;vertical-align:-0.08333em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span> and we'll need embeddings in the complexes for this too.</p>\n</blockquote>\n<p>We might even need it here. At some point,  the proofs I've seen use something like \"An algebraic integer all of whose conjugates have absolute value one is a root of unity\" and I'm not sure if you get away without using embeddings. But I could be wrong.</p>",
        "id": 259529755,
        "sender_full_name": "Chris Birkbeck",
        "timestamp": 1635516658
    },
    {
        "content": "<p>Yes you need embeddings for that, or all the infinite norms</p>",
        "id": 259559628,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1635529579
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"389019\">Chris Birkbeck</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/259525518\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"110038\">Kevin Buzzard</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/259521784\">said</a>:</p>\n<blockquote>\n<p>How do Pari and LMFDB do it? I doubt they use complexes. I think the determinant of the trace form is a fine idea.</p>\n</blockquote>\n<p>I expect they compute an integral basis and then use the trace form. Computing the discriminant of the defining polynomial can be done without embeddings by using resultants and from there I think one can start to generate the integral basis.</p>\n</blockquote>\n<p>Sage's NumberField definitely doesn't need an embedding to give you its discriminant.</p>",
        "id": 259998793,
        "sender_full_name": "Dima Pasechnik",
        "timestamp": 1635861631
    },
    {
        "content": "<p>In flt-regular we went for the definition that uses the trace. <a href=\"https://github.com/leanprover-community/flt-regular/blob/20df55f180ea139206e1b2effe2781669f5bd4ed/src/number_theory/discriminant/basic.lean#L161\">Here</a> is a proof that this is the same as using embeddings.</p>",
        "id": 260137419,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1635947914
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib_docs/find/algebra.discr\">docs#algebra.discr</a> has now a reasonable API, and, with <a href=\"https://github.com/leanprover-community/mathlib/pull/11396\">#11396</a>, mathlib will know that the discriminant is integral.</p>\n<p>I wrote this for the flt-regular project, and I think I have proved more or less the results we need there (we computed the discriminant of the <code>p</code>-th cyclotomic field). If someone is looking for a good first project I think it would be very nice to develop the API for the discriminant <em>of a number field</em>, rather than of a family of vectors, as a well defined integer. All the relevant results are already there so it shouldn't be too difficult. I don't think we need this so I am not going to work on it anytime soon.</p>",
        "id": 267789626,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642023473
    },
    {
        "content": "<p>cc <span class=\"user-mention\" data-user-id=\"325022\">@Elias Caeiro</span></p>",
        "id": 267789746,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1642023530
    },
    {
        "content": "<p>And of course then we will want arithmetic of quadratic fields!</p>",
        "id": 267789839,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642023594
    },
    {
        "content": "<p>I can't cc them twice <span aria-label=\"laughing\" class=\"emoji emoji-1f606\" role=\"img\" title=\"laughing\">:laughing:</span></p>",
        "id": 267789897,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1642023608
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span> how about adding this project (or two projects) as a github issue? Maybe as part of <a href=\"https://github.com/leanprover-community/mathlib/projects/3\">https://github.com/leanprover-community/mathlib/projects/3</a></p>",
        "id": 267790345,
        "sender_full_name": "Alex J. Best",
        "timestamp": 1642023861
    },
    {
        "content": "<p>Good idea!</p>",
        "id": 267790518,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642023946
    },
    {
        "content": "<p><a href=\"https://github.com/leanprover-community/mathlib/issues/11407\">Done</a></p>",
        "id": 267793924,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642025684
    },
    {
        "content": "<p>What's the sign of this \"well-defined integer\"? Is there ambiguity in the literature?</p>",
        "id": 267832255,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642058630
    },
    {
        "content": "<p>It depends on the number field. The discriminant scales by determinant-squared under change of basis, so the discriminant of a number field is well-defined modulo <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"double-struck\">Z</mi><mo>×</mo></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>=</mo><mo stretchy=\"false\">{</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">(\\Z^\\times)^2 = \\{1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbb\">Z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">×</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span></p>",
        "id": 267835699,
        "sender_full_name": "David Wärn",
        "timestamp": 1642061556
    },
    {
        "content": "<p>That doesn't stop there being ambiguity in the literature</p>",
        "id": 267835923,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642061748
    },
    {
        "content": "<p>So you're asking how the literature scales under change of author?</p>",
        "id": 267836421,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1642062113
    },
    {
        "content": "<p>I guess we make the sensible choice and hope that most other people do too. In the relative setting the discriminant can only be defined as an ideal but as David says in the absolute situation there seems to be a canonical generator</p>",
        "id": 267836503,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642062152
    },
    {
        "content": "<p>It would be interesting to start writing down solutions to Mordell equations y^2=x^3+n for small nonzero integers. Each equation only has finitely many integer solutions but as n increases so do the amount of techniques that one needs to solve them</p>",
        "id": 267836788,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642062376
    },
    {
        "content": "<p>IIRC I set a nasty one of these as a codewars kata</p>",
        "id": 267836825,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642062407
    },
    {
        "content": "<p>The sign is <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><msup><mo stretchy=\"false\">)</mo><msub><mi>r</mi><mn>2</mn></msub></msup></mrow><annotation encoding=\"application/x-tex\">(-1)^{r_2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>, isn't it? (Here <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>r</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">r_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> is the number of complex places of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span>.)</p>",
        "id": 267843794,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642066398
    },
    {
        "content": "<p>Note that I am talking about the discriminant <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">K/\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord\">/</span><span class=\"mord mathbb\">Q</span></span></span></span>, I don't see any ambiguity here: take any algebraic integer <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> such that <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi><mo>=</mo><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">K=\\mathbb{Q}(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span> and then set <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">Δ</mi><mrow><mi>K</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"double-struck\">Q</mi></mrow></msub><mo>=</mo><mi mathvariant=\"normal\">discr</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>x</mi><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><msup><mi>x</mi><mrow><mi>d</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\Delta_{K/\\mathbb{Q}}=\\operatorname{discr}(1,x,\\ldots,x^{d-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0385em;vertical-align:-0.3552em;\"></span><span class=\"mord\"><span class=\"mord\">Δ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span><span class=\"mord mtight\">/</span><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">discr</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>, where <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>d</mi><mo>=</mo><msub><mrow><mi>dim</mi><mo>⁡</mo></mrow><mi mathvariant=\"double-struck\">Q</mi></msub><mo stretchy=\"false\">(</mo><mi>K</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d=\\dim_{\\mathbb{Q}}(K)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0167em;vertical-align:-0.2667em;\"></span><span class=\"mop\"><span class=\"mop\">dim</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3322em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbb mtight\">Q</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2667em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"mclose\">)</span></span></span></span>.</p>",
        "id": 267844004,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642066533
    },
    {
        "content": "<p>Right. I'm just familiar with the general theory, where the discriminant is usually define as an ideal of the bottom ring, and the different (in the LCI case) as an ideal of the top ring</p>",
        "id": 267854103,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642072285
    },
    {
        "content": "<p>I don't think I'd ever internalised that in the absolute case the ideal had a canonical generator. Most of the more advanced results about discriminant are only about primes dividing it or its absolute value, and here the sign doesn't matter</p>",
        "id": 267854253,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1642072370
    },
    {
        "content": "<p>I certainly  agree that the real discriminant is an ideal, and sooner or later we will need it... time to have the trace of for projective modules I guess!</p>",
        "id": 267864706,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1642078711
    },
    {
        "content": "<p>I am reviving this old topic, since I added PR <a href=\"https://github.com/leanprover-community/mathlib4/pull/6394\">#6394</a> as an attempt at defining the discriminant of a number field. In this PR, it is defined classically as the discriminant of a ℤ-basis of the ring of integers with an additional result to prove that it does not depend on the choice of the basis. However, <span class=\"user-mention\" data-user-id=\"130384\">@Riccardo Brasca</span>  suggested that maybe the discriminant should be defined as an ideal and not an integer. You can see our discussion there. Still, we thought it would be a good idea to ask for some more opinions here.</p>",
        "id": 388054861,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1693383567
    },
    {
        "content": "<p>\"a good ideal\" <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 388055116,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1693383660
    },
    {
        "content": "<p>I think we need both: the discriminant as ideal, and the absolute discriminant as integer. And the glue: ideals in <code>Z</code> are the same as natural numbers.</p>",
        "id": 388065334,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1693387336
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/388065334\">said</a>:</p>\n<blockquote>\n<p>I think we need both: the discriminant as ideal, and the absolute discriminant as integer. And the glue: ideals in <code>Z</code> are the same as natural numbers.</p>\n</blockquote>\n<p>I agree except that I would call <code>relative discriminant</code> the one that is an ideal and <code>(absolute) discriminant</code> the one that is an integer to stick with the usual convention: see <a href=\"https://en.wikipedia.org/wiki/Discriminant_of_an_algebraic_number_field\">https://en.wikipedia.org/wiki/Discriminant_of_an_algebraic_number_field</a></p>",
        "id": 388066260,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1693387592
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"112680\">Johan Commelin</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/388065334\">said</a>:</p>\n<blockquote>\n<p>I think we need both: the discriminant as ideal, and the absolute discriminant as integer. And the glue: ideals in <code>Z</code> are the same as natural numbers.</p>\n</blockquote>\n<p>We will definitely want both: the absolute discriminant has a well-defined sign, which can't be recovered from the discriminant as an ideal (and this sign carries interesting information – if you just take the absolute values everywhere, you lose the rather elegant theorem that discriminants of number fields are always 0 or 1 mod 4).</p>",
        "id": 388071988,
        "sender_full_name": "David Loeffler",
        "timestamp": 1693389563
    },
    {
        "content": "<p>Aah, of course! Yes, you're right.</p>",
        "id": 388072834,
        "sender_full_name": "Johan Commelin",
        "timestamp": 1693389845
    },
    {
        "content": "<p>My main concern is not about having it as an ideal or an integer: it is about defining it using a Z basis or a Q basis made of integral elements (I am on mobile sorry). I have the impression that what we do mathematically is the former option (for example we often compute the discriminant before computing the ring of integers).</p>",
        "id": 388213091,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693438992
    },
    {
        "content": "<p>For example for cyclotomic fields we do exactly this: we compute the discriminant of the field, and we use it to describe the ring of integers.</p>",
        "id": 388213305,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693439132
    },
    {
        "content": "<p>Surely we need both; relative discriminant as an ideal of the integers of the bottom field for a finite extension of global fields (and can't this definition be made in some huge generality for finite locally free extensions of comm rings) (and also different as ideal of top ring of integers?) and also absolute discriminant as a number for number fields over Q</p>",
        "id": 388213895,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1693439464
    },
    {
        "content": "<p>@Kevin you seem to be answering the previous question :-)</p>\n<p>If I understand Riccardo's point: it's probably going to be useful to have the definition (and some properties) of the discriminant of a specific Q-basis of K, <em>without</em> assuming a priori that this basis is a Z-basis of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (because then we can use discriminants as a tool to actually compute <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>). And for this, we need a version of discriminant as an actual number – applying generalities about locally free ring extensions will just give us an ideal of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span>, which is not terribly useful.</p>",
        "id": 388273948,
        "sender_full_name": "David Loeffler",
        "timestamp": 1693470165
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"481963\">David Loeffler</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/388273948\">said</a>:</p>\n<blockquote>\n<p>If I understand Riccardo's point: it's probably going to be useful to have the definition (and some properties) of the discriminant of a specific Q-basis of K, <em>without</em> assuming a priori that this basis is a Z-basis of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> (because then we can use discriminants as a tool to actually compute <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>O</mi><mi>K</mi></msub></mrow><annotation encoding=\"application/x-tex\">O_K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">K</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>). And for this, we need a version of discriminant as an actual number – applying generalities about locally free ring extensions will just give us an ideal of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8556em;vertical-align:-0.1667em;\"></span><span class=\"mord mathbb\">Q</span></span></span></span>, which is not terribly useful.</p>\n</blockquote>\n<p>But isn't it what <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Algebra.discr#doc\">docs#Algebra.discr</a> does?</p>",
        "id": 388277722,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1693471552
    },
    {
        "content": "<p>Yes, let's forget about ideals for the moment, I agree the absolute discriminant is a number. If you use <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Algebra.discr#doc\">docs#Algebra.discr</a> you get a rational number, but there is a result saying it is integral if the basis is made of integral elements, and another one saying that it does not depend on the basis (I am still on mobile...). I think we should use these two results to define the discriminant as a well defined integer.</p>",
        "id": 388281139,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693472847
    },
    {
        "content": "<p>When you say basis, you mean basis of what?  The discriminant does not depend of the bases if they define the same order. The discriminant of a basis of algebraic integers is the discriminant of the field iff it is a basis of the maximal order. I am afraid I do not understand what you mean...</p>\n<p>In any case, it is not necessary to make a quick decision for this PR. We can wait until you are back in front of a computer if it's easier for you.</p>",
        "id": 388282299,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1693473285
    },
    {
        "content": "<p>Maybe I don't remember your definition, but you use a Z basis of O K, right? My proposition is to use a Q basis of K made of integral elements, using <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Discriminant.html#Algebra.discr_eq_discr_of_toMatrix_coeff_isIntegral\">https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Discriminant.html#Algebra.discr_eq_discr_of_toMatrix_coeff_isIntegral</a></p>",
        "id": 388290338,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693476366
    },
    {
        "content": "<p>Mmh, wait, we need that the change of basis is integral, so in practice it looks like a Z basis of O K</p>",
        "id": 388290552,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693476463
    },
    {
        "content": "<p>In any case I think it is important to have some result that makes possibile to compute the absolute discriminant without knowing what O K is</p>",
        "id": 388290784,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693476561
    },
    {
        "content": "<p>It's possible I am confused by what is done for cyclotomic fields: I thought the strategy to compute O K in this case is \"the discriminant is p^..., then the minimal polynomial of a certain generator is eiseinstein at p, so blah blah\". But I now realize the at the beginning we don't know that p^... is the actual discriminant of the ring of integers, but rather of the order given by the primitive root</p>",
        "id": 388292817,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693477438
    },
    {
        "content": "<p>In particular your definition is absolutely correct, sorry for all the noise</p>",
        "id": 388292951,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1693477477
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/stream/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/388292951\">said</a>:</p>\n<blockquote>\n<p>In particular your definition is absolutely correct, sorry for all the noise</p>\n</blockquote>\n<p>No problem <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 388315794,
        "sender_full_name": "Xavier Roblot",
        "timestamp": 1693485922
    },
    {
        "content": "<p>I would say that discriminant and different are also defined for orders, as ideals, compatibly with localization. When ground field is Q, more happens. ..</p>",
        "id": 389110439,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1693893226
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"130384\">Riccardo Brasca</span> <a href=\"#narrow/channel/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/388281139\">said</a>:</p>\n<blockquote>\n<p>we should use these two results to define the discriminant as a well defined integer</p>\n</blockquote>\n<p>Did this ever happen?</p>",
        "id": 569945180,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769337355
    },
    {
        "content": "<p><a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/NumberField/Discriminant/Defs.html#NumberField.discr\">NumberField.discr</a></p>",
        "id": 569945313,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769337507
    },
    {
        "content": "<p>And this is the same discriminant as in <a href=\"https://en.wikipedia.org/wiki/Quadratic_field#Discriminant\">\"discriminant of a quadratic field\"</a>, right?</p>",
        "id": 569945402,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769337605
    },
    {
        "content": "<p>Yes, it is what usually people call \"the discriminant of a number field\" in a first class in number theory.</p>",
        "id": 569945479,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769337688
    },
    {
        "content": "<p>It's just the discriminant of any <code>ℤ</code>-basis of <code>𝓞 K</code>. The coincidence is that if you change basis then the discriminant is multiplied by the square of the determinant of the base change matrix (<a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Discriminant.html#Algebra.discr_of_matrix_vecMul\">Algebra.discr_of_matrix_vecMul</a> and friends), so for <code>ℤ</code> it's multiplied by <code>1</code>.</p>",
        "id": 569945658,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769337891
    },
    {
        "content": "<p>For formal-conjectures, I need the characterisation of which integers arise as the discriminant of a quadratic field. I am thinking of either doing it myself or giving it to someone as a beginner project</p>",
        "id": 569945893,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769338226
    },
    {
        "content": "<p>We don't have a definition of \"quadratic field\". What would such a definition look like? Right now, I am thinking of simply using \"<code>QuadraticAlgebra ℚ d 0</code> for some <code>d ≠ 1</code> that's <code>Squarefree d</code>\"</p>",
        "id": 569946052,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769338428
    },
    {
        "content": "<p>At ItaLean we computed the ring of integers (not the discriminant). You can find it <a href=\"https://github.com/sacerdot/QuadraticIntegers/blob/main/QuadraticIntegers/RingOfIntegers.lean\">here</a>.</p>",
        "id": 569946085,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769338458
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/569946052\">said</a>:</p>\n<blockquote>\n<p>We don't have a definition of \"quadratic field\". What would such a definition look like? Right now, I am thinking of simply using \"<code>QuadraticAlgebra ℚ d 0</code> for some <code>d ≠ 1</code> that's <code>Squarefree d</code>\"</p>\n</blockquote>\n<p>We took the same approach.</p>",
        "id": 569946094,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769338474
    },
    {
        "content": "<p>We used the general trace and norm, but one should probably use the version for quadratic algebras (I think the norm is there but not the trace).</p>",
        "id": 569946152,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769338533
    },
    {
        "content": "<p>Wait, there is a quadratic algebra-specific norm?</p>",
        "id": 569946242,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769338631
    },
    {
        "content": "<p>I mean <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/Algebra/QuadraticAlgebra/Basic.html#QuadraticAlgebra.norm\">QuadraticAlgebra.norm</a></p>",
        "id": 569946885,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769339225
    },
    {
        "content": "<p>I think in all reasonable cases it's the same as <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/RingTheory/Norm/Defs.html#Algebra.norm\">Algebra.norm</a> but it's defined by hand.</p>",
        "id": 569947201,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769339525
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"387244\">Yaël Dillies</span> <a href=\"#narrow/channel/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/569946052\">said</a>:</p>\n<blockquote>\n<p>We don't have a definition of \"quadratic field\". What would such a definition look like? Right now, I am thinking of simply using \"<code>QuadraticAlgebra ℚ d 0</code> for some <code>d ≠ 1</code> that's <code>Squarefree d</code>\"</p>\n</blockquote>\n<p>I would say <code>NumberField K</code> + <code>finrank Q K = 2</code>.</p>",
        "id": 569948801,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1769341475
    },
    {
        "content": "<p>I think the question here is how to write in Lean \"let <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span></span> be <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><msqrt><mi>d</mi></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}(\\sqrt{d})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1822em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-2.8922em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1078em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>\", not any quadratic field. IIRC <code>QuadraticAlgebra</code> was introduced exactly for this reason.</p>",
        "id": 569950628,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769343464
    },
    {
        "content": "<p>Actually, I was more thinking of the question that Antoine addressed</p>",
        "id": 569951009,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769343940
    },
    {
        "content": "<p>I may be wrong, but if you want to compute the discriminant and say something like \"it's <code>d</code> or <code>4d</code>\" you need <code>d</code> and it seems easier using <code>QuadraticAlgebra</code>.</p>",
        "id": 569952988,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1769345978
    },
    {
        "content": "<p>You are correct for the computation, but at the end I want to wrap the computation up into \"The discriminants of quadratic fields are exactly ...\", at which point I don't need the <code>d</code></p>",
        "id": 569953187,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769346195
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> you want <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Algebra.IsQuadraticExtension#doc\">docs#Algebra.IsQuadraticExtension</a></p>",
        "id": 569963236,
        "sender_full_name": "Artie Khovanov",
        "timestamp": 1769356859
    },
    {
        "content": "<p>I am confused now. There is nothing relating <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Algebra.IsQuadraticExtension#doc\">docs#Algebra.IsQuadraticExtension</a> and <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NumberField#doc\">docs#NumberField</a>. In In particular, just assuming <code>IsQuadraticExtension ℚ K</code> doesn't let me talk about <code>NumberField.discr K</code>. What am I supposed to do?</p>",
        "id": 570019966,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769410523
    },
    {
        "content": "<p>I guess a general quadratic extension won't be a number field (because it might have nilpotents or it might be Q+Q)</p>",
        "id": 570023796,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769412554
    },
    {
        "content": "<p>But what about a quadratic extension that is also a field?</p>",
        "id": 570024328,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769412771
    },
    {
        "content": "<p>Then I should think that this is a number field by definition, but I'm not sure I can convince typeclass inference of this because it's the condition that b^2-4ac isn't a square.</p>",
        "id": 570025741,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769413509
    },
    {
        "content": "<p>NumberField is just a poorly-named Prop, right? So just assume it?</p>",
        "id": 570025906,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769413590
    },
    {
        "content": "<p>Yes, but I was wondering if I could first show more generally that a quadratic extension must be of the form <code>QuadraticAlgebra R a b</code></p>",
        "id": 570026116,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769413686
    },
    {
        "content": "<p>Alternatively extend the concept of discriminant to finite separable Q-algebras and then you just have to demand that b^2-4ac isn't zero :-)</p>\n<p>I very much for hope that it's true that for any field at all, a quadratic extension must be of this form, because I thought that was the point of QuadraticAlgebra</p>",
        "id": 570026236,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769413742
    },
    {
        "content": "<p>Yes, that's my reasoning too. Proof by name <span aria-label=\"grinning face with smiling eyes\" class=\"emoji emoji-1f601\" role=\"img\" title=\"grinning face with smiling eyes\">:grinning_face_with_smiling_eyes:</span></p>",
        "id": 570026339,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769413777
    },
    {
        "content": "<p>You extend {1} to a basis {1,x} and then write x^2 as a linear combination of the basis elements</p>",
        "id": 570026506,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769413848
    },
    {
        "content": "<p>Maybe the answer is that <code>NumberField.discr</code> gets renamed to <code>Algebra.discr</code> (and generalised), and <code>Algebra discr</code> gets renamed to <code>Algebra.discrBasis</code>?</p>",
        "id": 570026573,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1769413883
    },
    {
        "content": "<p>But a general algebra has no discriminant, maybe it has a discriminant ideal or something. The weird thing about number fields (and more generally finite separable Q-algebras, which is just a pompous way of saying finite products of number fields) is that they have a well-defined integer discriminant. This is exactly why we have NumberField.discr . This is an arithmetic fact, not an algebraic one.</p>",
        "id": 570039215,
        "sender_full_name": "Kevin Buzzard",
        "timestamp": 1769418307
    },
    {
        "content": "<p>That's why the <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QuadraticAlgebra.instField#doc\">docs#QuadraticAlgebra.instField</a> has a <code>Fact</code> argument. It would be a reasonable starting point for that project to add the appropriate <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=NumberField#doc\">docs#NumberField</a> instance and prove that, conversely, any number field of degree 2 can be represented (has an <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=AlgEquiv#doc\">docs#AlgEquiv</a>) as a <a href=\"https://leanprover-community.github.io/mathlib4_docs/find/?pattern=QuadraticAlgebra#doc\">docs#QuadraticAlgebra</a>.</p>",
        "id": 570335219,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1769524281
    },
    {
        "content": "<p>Note that you will not only prove that the number field of degree 2 is a quadratic algebra, but also that its ring of integers is, or that any integral domain which is of rank 2 over the integers is a quadratic algebra.</p>",
        "id": 570335815,
        "sender_full_name": "Antoine Chambert-Loir",
        "timestamp": 1769524410
    },
    {
        "content": "<p>hi all, wondering what is the latest regarding discriminants of quadratic numbers fields defined via <code>QuadraticAlgebra</code>? i'm trying to verify a particular discriminant as in the following MWE:</p>\n<div class=\"codehilite\" data-code-language=\"Lean4\"><pre><span></span><code><span class=\"kn\">import</span><span class=\"w\"> </span><span class=\"n\">Mathlib</span>\n\n<span class=\"kn\">open</span><span class=\"w\"> </span><span class=\"n\">Polynomial</span><span class=\"w\"> </span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">QuadraticAlgebra</span><span class=\"w\"> </span><span class=\"n\">RingOfIntegers</span><span class=\"w\"> </span><span class=\"n\">Algebra</span>\n\n<span class=\"kn\">noncomputable</span><span class=\"w\"> </span><span class=\"kn\">section</span>\n\n<span class=\"kn\">abbrev</span><span class=\"w\"> </span><span class=\"n\">f_minpoly</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">[</span><span class=\"n\">X</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">-</span><span class=\"w\"> </span><span class=\"n\">X</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"n\">C</span><span class=\"w\"> </span><span class=\"mi\">2</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Irreducible</span><span class=\"w\"> </span><span class=\"n\">f_minpoly</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"bp\">⟨</span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">admit</span><span class=\"bp\">⟩</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"K\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"n\">QuadraticAlgebra</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"mi\">1</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Fact</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">∀</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">),</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"bp\">^</span><span class=\"w\"> </span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"bp\">≠</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">-</span><span class=\"mi\">2</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">+</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ℚ</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"bp\">*</span><span class=\"w\"> </span><span class=\"n\">r</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">admit</span>\n\n<span class=\"kn\">instance</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">NumberField</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">admit</span>\n\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"R\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">𝓞</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">is_integral_ω</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IsIntegral</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">ω</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">admit</span>\n\n<span class=\"kn\">set_option</span><span class=\"w\"> </span><span class=\"n\">quotPrecheck</span><span class=\"w\"> </span><span class=\"n\">false</span><span class=\"w\"> </span><span class=\"k\">in</span>\n<span class=\"kn\">notation</span><span class=\"w\"> </span><span class=\"s2\">\"θ\"</span><span class=\"w\"> </span><span class=\"bp\">=&gt;</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"bp\">⟨</span><span class=\"n\">ω</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">is_integral_ω</span><span class=\"bp\">⟩</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">𝓞</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"o\">)</span>\n\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">span_eq_top</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">adjoin</span><span class=\"w\"> </span><span class=\"n\">ℤ</span><span class=\"w\"> </span><span class=\"o\">{</span><span class=\"n\">θ</span><span class=\"o\">}</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"bp\">⊤</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n\n<span class=\"c1\">-- apparently `discr` is the absolute discriminant; will likely use `span_eq_top`</span>\n<span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">K_discriminant_abs</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">discr</span><span class=\"w\"> </span><span class=\"n\">K</span><span class=\"w\"> </span><span class=\"bp\">=</span><span class=\"w\"> </span><span class=\"mi\">7</span><span class=\"w\"> </span><span class=\"o\">:=</span><span class=\"w\"> </span><span class=\"k\">by</span>\n<span class=\"w\">  </span><span class=\"gr\">sorry</span>\n</code></pre></div>",
        "id": 574503761,
        "sender_full_name": "Barinder S Banwait",
        "timestamp": 1771420237
    },
    {
        "content": "<p>Can you explain exactly what you want to achieve here? Are you trying to state that the discriminant of some quadratic field is 7? But what is your long-term goal?</p>",
        "id": 574619794,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1771455518
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"300245\">Filippo A. E. Nuccio</span> <a href=\"#narrow/channel/116395-maths/topic/Discriminant.20of.20a.20number.20field/near/574619794\">said</a>:</p>\n<blockquote>\n<p>Can you explain exactly what you want to achieve here? Are you trying to state that the discriminant of some quadratic field is 7? But what is your long-term goal?</p>\n</blockquote>\n<p>Formalising the proof that the absolute discriminant of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"double-struck\">Q</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mo>−</mo><mn>7</mn></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbb{Q}(\\sqrt{-7})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1156em;vertical-align:-0.25em;\"></span><span class=\"mord mathbb\">Q</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8656em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">−</span><span class=\"mord\">7</span></span></span><span style=\"top:-2.8256em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewBox=\"0 0 400000 1080\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1744em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> equals 7 is the main* last missing piece in my first Lean project of <a href=\"https://barindersbanwait.com/ramanujan_nagell/\">Formalising the proof of the Ramanujan--Nagell theorem</a>. (*: There are some missing details in the proof that the units are just <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span> which probably won't be too difficult to fill). See the dependency graph there for the status.</p>\n<p>That's why I'm quite motivated to know if discriminants of QuadraticAlgebra instances (at least when they're fields) have been done yet, or if they're in progress.</p>\n<p>If nobody's working on this, then I'd be happy to do so.</p>",
        "id": 574658716,
        "sender_full_name": "Barinder S Banwait",
        "timestamp": 1771483682
    },
    {
        "content": "<p>I think <span class=\"user-mention\" data-user-id=\"387244\">@Yaël Dillies</span> was interested in computing the discriminant.</p>",
        "id": 574666137,
        "sender_full_name": "Riccardo Brasca",
        "timestamp": 1771487891
    },
    {
        "content": "<p>Indeed I am (see earlier messages), but I haven't had time to do so yet. I probably won't get to it before another month, so feel free to give it a go!</p>",
        "id": 574782533,
        "sender_full_name": "Yaël Dillies",
        "timestamp": 1771521588
    },
    {
        "content": "<p>For the units, you are aware of <a href=\"https://leanprover-community.github.io/mathlib4_docs/Mathlib/NumberTheory/NumberField/Units/DirichletTheorem.html#NumberField.Units.rank_modTorsion\">NumberField.Units.rank_modTorsion</a> , right?</p>",
        "id": 575305378,
        "sender_full_name": "Filippo A. E. Nuccio",
        "timestamp": 1771855356
    }
]